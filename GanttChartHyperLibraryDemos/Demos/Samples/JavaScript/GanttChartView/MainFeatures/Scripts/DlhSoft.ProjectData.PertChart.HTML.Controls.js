var DlhSoft;"undefined"===typeof DlhSoft&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)});DlhSoft.assemblies.push({assembly:"DlhSoft.ProjectData.PertChart.HTML.Controls",company:"DlhSoft",product:"Project Data Modern Library",version:"5.3.0.2",copyright:"Copyright \u00a9 2012-2014 DlhSoft",title:"Project Data PERT Chart HTML Controls",description:"Project Data PERT Chart related HTML client components"});
DlhSoft.buildReleaseDate=function(L,M,O){L=new Date(L,M-1,O);return L>DlhSoft.buildReleaseDate?L:DlhSoft.buildReleaseDate}(2014,6,19);var _0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{");
void 0==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var L=_0x5c25[1],M=_0x5c25[2],O=[],T=[],U=_0x5c25[3],Z=function(G,D){if(typeof G!==M||typeof D!==M)return!1;if(D==U)return!0;var J=D[_0x5c25[11]](_0x5c25[10]);if(0<=J){var x=D[_0x5c25[12]](0,J),v,C=x[_0x5c25[11]](_0x5c25[10]);if(0<=C)try{v=new Date(parseInt(x[_0x5c25[12]](C+1)))}catch(t){}typeof v===L&&(v=new Date(2013,11,31));if(DlhSoft[_0x5c25[13]]>v)return!1;x=x+_0x5c25[10]+G;for(i=v=0;i<x[_0x5c25[5]];i++)C=x[_0x5c25[14]](i),v=(v<<5)-
v+C,v&=v;0>v&&(v=Math[_0x5c25[15]](2,32)-v);x=v.toString(16)[_0x5c25[16]]();J=D[_0x5c25[12]](J+1);if(x==J)return!0}return!1},P=function(G,D,J,x,v){var C=_0x5c25[17],t=_0x5c25[18],K=typeof ComponentSource===L||!ComponentSource?t+_0x5c25[19]+x+_0x5c25[20]+v:_0x5c25[21],E=x+_0x5c25[22]+v+_0x5c25[23],H=_0x5c25[24],F=_0x5c25[25],I=_0x5c25[26];setTimeout(function(){var A=G[_0x5c25[27]],v=A[_0x5c25[29]](_0x5c25[28]);v[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var x=A[_0x5c25[29]](_0x5c25[28]);x[_0x5c25[32]](_0x5c25[30],
_0x5c25[33]);var B=A[_0x5c25[29]](_0x5c25[28]);B[_0x5c25[32]](_0x5c25[30],_0x5c25[34]);x[_0x5c25[35]](B);B[_0x5c25[35]](A[_0x5c25[36]](C));x[_0x5c25[35]](A[_0x5c25[36]](H+_0x5c25[10]));B=A[_0x5c25[29]](_0x5c25[28]);B[_0x5c25[32]](_0x5c25[30],_0x5c25[37]);B[_0x5c25[35]](A[_0x5c25[36]](D));x[_0x5c25[35]](B);x[_0x5c25[35]](A[_0x5c25[36]](F+_0x5c25[10]));B=A[_0x5c25[29]](_0x5c25[28]);B[_0x5c25[32]](_0x5c25[30],_0x5c25[37]);B[_0x5c25[35]](A[_0x5c25[36]](E));x[_0x5c25[35]](B);x[_0x5c25[35]](A[_0x5c25[36]](I+
_0x5c25[10]));B=A[_0x5c25[29]](_0x5c25[28]);B[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var t=A[_0x5c25[29]](_0x5c25[39]);t[_0x5c25[32]](_0x5c25[30],_0x5c25[40]);t[_0x5c25[32]](_0x5c25[41],K);t[_0x5c25[32]](_0x5c25[42],_0x5c25[43]);t[_0x5c25[35]](A[_0x5c25[36]](_0x5c25[44]));B[_0x5c25[35]](t);t=A[_0x5c25[29]](_0x5c25[39]);t[_0x5c25[32]](_0x5c25[30],_0x5c25[45]);t[_0x5c25[32]](_0x5c25[41],_0x5c25[46]);t[_0x5c25[35]](A[_0x5c25[36]](_0x5c25[47]));t[_0x5c25[50]](_0x5c25[48],function(){G[_0x5c25[49]](v);T[_0x5c25[7]](J)},
!1);B[_0x5c25[35]](t);x[_0x5c25[35]](B);v[_0x5c25[35]](x);G[_0x5c25[35]](v)},0);setTimeout(function(){alert(C+_0x5c25[51]+H+_0x5c25[52]+D+_0x5c25[51]+F+_0x5c25[53]+E+_0x5c25[51]+I+_0x5c25[4])},6E5)};return{setLicense:function(G,D){O[_0x5c25[7]]({type:G,content:D})},validate:function(G,D,J,x,v,C,t){for(var D=D+_0x5c25[4]+J,K=0;K<T[_0x5c25[5]];K++)if(T[K]==D)return;a:if(typeof C!==M&&typeof t!==L&&(t[_0x5c25[6]]!==L&&(C=t[_0x5c25[6]]),typeof t===M&&(C=t)),typeof C!==M)for(t=0;t<O[_0x5c25[5]];t++)if(K=
O[t],K[_0x5c25[8]]==D&&typeof K[_0x5c25[9]]===M){C=K[_0x5c25[9]];break a}Z(D,C)?G[_0x5c25[6]]=C:P(G,J,D,x,v)}}}());void 0==DlhSoft.Controls&&(DlhSoft.Controls={});void 0==DlhSoft.Controls.Pert&&(DlhSoft.Controls.Pert={});
void 0==DlhSoft.Controls.Pert.PertChartView&&(DlhSoft.Controls.Pert.PertChartView=function(){var L=function(b,g,f,d){var a=["DlhSoft.Controls.Pert","PertChartView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];DlhSoft[a[5]][a[4]](b,a[0],a[1],a[2],a[3],d,f);b.isInitializing=true;if(typeof b.items!=="undefined")for(d=0;d<b.items.length;d++)delete b.items[d].successors;typeof f!=="object"&&(f={});U(g,f);T(f,g,b);ja(b,g,f);Z(g);var e=J(b,g,f),d=b.ownerDocument,a=d.createElement("div");
a.setAttribute("style","font-family: Arial; font-size: small; overflow: auto");var l=d.createElement("div");typeof f.containerClass!=="undefined"&&l.setAttribute("class",f.containerClass);typeof f.containerStyle!=="undefined"&&l.setAttribute("style",f.containerStyle);a.appendChild(l);var c=d.createElement("div");c.setAttribute("style","border: solid 1px "+f.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden");
l.appendChild(c);l=d.createElement("div");l.setAttribute("style","overflow: auto");c.appendChild(l);var h=d.createElement("div");h.setAttribute("style","overflow: "+(typeof f.isExport==="undefined"||!f.isExport?"auto":"hidden")+"; height: "+e);l.appendChild(h);var c=C(g,f),j=t(g,f),u=d.createElement("div");u.setAttribute("style","float: left; overflow: hidden; width: "+c+"px; height: "+j+"px");h.appendChild(u);e=d.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("style","width: "+
c+"px; height: "+j+"px");c=f.styleDefinitionTemplate();e.appendChild(c);e.chartAreaDefinitions=c;c=function(){setTimeout(function(){try{var a=u.chartArea,e=a.chartAreaDefinitions;a.removeChild(e);a.childNodes.length>0?a.insertBefore(e,a.childNodes[0]):a.appendChild(e)}catch(c){}},0)};e.addEventListener("mousedown",c,true);d.addEventListener("mouseup",c,true);u.appendChild(e);u.chartArea=e;var y;setTimeout(function(){y=b.clientHeight},0);typeof b.heightUpdateTimer!=="undefined"&&clearInterval(b.heightUpdateTimer);
b.heightUpdateTimer=setInterval(function(){try{if(!(b.clientHeight<=0)){var a=b.clientHeight;if(a!=y){var e=J(b,g,f);h.style.height=e;y=a}}}catch(c){try{clearInterval(b.heightUpdateTimer)}catch(j){}}},100);u.container=h;b.chartContainer=l;b.chartContent=u;b.chartContentContainer=h;h.isInitializing=true;ka(b,a);K(u,e,g,f);h.isInitializing=false;b.isInitializing=false;b.isInitialized=true;return b},M=function(b){L(b,b.items,b.settings,b.license)},O=function(b){if(typeof b.timeSpanFormatter==="undefined")b.timeSpanFormatter=
v;if(typeof b.itemPropertyChangeHandler==="undefined")b.itemPropertyChangeHandler=function(){};if(typeof b.target==="undefined")b.target="Standard";if(typeof b.theme==="undefined")b.theme="Modern"},T=function(b,g,f){O(b);if(typeof b.border==="undefined")switch(b.theme){default:b.border="#e0e0e0";break;case "ModernBordered":case "Aero":b.border="#9a9a9a"}if(typeof b.canUserRearrangeItems==="undefined")b.canUserRearrangeItems=true;if(typeof b.snapRearrangedItemsToGuidelines==="undefined")b.snapRearrangedItemsToGuidelines=
true;if(typeof b.itemWidth==="undefined")b.itemWidth=40;if(typeof b.itemHeight==="undefined")b.itemHeight=40;if(typeof b.aspectRatio==="undefined")b.aspectRatio=1;if(typeof b.shapeWidth==="undefined")b.shapeWidth=32;if(typeof b.shapeHeight==="undefined")b.shapeHeight=32;if(typeof b.styleDefinitionTemplate==="undefined")b.styleDefinitionTemplate=W(f,b);if(typeof b.dependencyTextBlockWidth==="undefined")b.dependencyTextBlockWidth=120;if(typeof b.shapeStyle==="undefined"&&b.shapeClass==null)b.shapeStyle=
"fill: White; stroke: #606060; stroke-width: 0.75px";if(typeof b.temporaryThumbStyle==="undefined"&&b.temporaryThumbClass==null)b.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; ";if(typeof b.dependencyLineStyle==="undefined"&&b.dependencyLineClass==null)b.dependencyLineStyle="stroke: #8080FF; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)";if(typeof b.virtualEffortDependencyLineStyle==="undefined"&&b.virtualEffortDependencyLineClass==
null)b.virtualEffortDependencyLineStyle="stroke: #8080FF; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)";if(typeof b.dependencyLineZoneStyle==="undefined"&&b.dependencyLineZoneClass==null)b.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none";if(typeof b.taskEventTemplate==="undefined")b.taskEventTemplate=aa();if(typeof b.dependencyTextStyle==="undefined")b.dependencyTextStyle="color: #606060; text-anchor: middle";if(typeof b.chartMargin===
"undefined")b.chartMargin=16;if(typeof b.isTaskEventToolTipVisible==="undefined")switch(b.target){default:b.isTaskEventToolTipVisible=true;break;case "Phone":b.isTaskEventToolTipVisible=false}if(typeof b.itemTemplate==="undefined")b.itemTemplate=X(b);if(typeof b.dependencyLineTemplate==="undefined")b.dependencyLineTemplate=ba();if(typeof b.isDependencyToolTipVisible==="undefined")b.isDependencyToolTipVisible=b.isTaskEventToolTipVisible;if(typeof b.predecessorItemTemplate==="undefined")b.predecessorItemTemplate=
la(b)},U=function(b){for(var g=0;g<b.length;g++){var f=b[g];if(typeof f==="string"){f={content:f};b[g]=f}if(typeof f.predecessors!=="undefined"){if(typeof f.predecessors==="string")f.predecessors=f.predecessors.split(",");for(var d=0;d<f.predecessors.length;d++){var a=f.predecessors[d];if(typeof a==="string"){a={item:a};f.predecessors[d]=a}if(typeof a.item==="string"){var e=parseInt(a.item)-1;a.item=e>=0&&e<b.length?b[e]:null}if(typeof a.effort==="string")a.effort=parseFloat(a.effort)}}if(typeof f.displayedRowIndex!==
"undefined")f.actualRowIndex=f.displayedRowIndex;if(typeof f.displayedColumnIndex!=="undefined")f.actualColumnIndex=f.displayedColumnIndex;if(typeof f.actualRowIndex==="undefined")f.actualRowIndex=0;if(typeof f.actualColumnIndex==="undefined")f.actualColumnIndex=0}},Z=function(b){b.positionedItems=[];b.maxRowIndex=null;for(var g=0;g<b.length;g++){var f=b[g],d=b;if(typeof f.displayedRowIndex==="undefined"){var a;if(typeof f.predecessors!=="undefined"){a=d.positionedItems;for(var e=[],l=f.predecessors,
c=0;c<a.length;c++)for(var h=a[c],j=0;j<l.length;j++)if(l[j].item==h){e.push(h);break}a=e}else a=null;if(a!=null){e=a;l=[];for(c=0;c<e.length;c++){h=e[c].actualRowIndex;l.indexOf(h)<0&&l.push(h)}e=l}else e=null;e=e!=null&&e.length>0?R(e):d.maxRowIndex!=null?d.maxRowIndex+1:0;l=l=void 0;if(typeof f.displayedColumnIndex==="undefined"){l=P(d.positionedItems,e);l=l.length>0?R(l)+1:0;c=a!=null?P(a,e):null;if(c!=null&&c.length>0){h=null;for(j=0;j<c.length;j++)if(h==null||c[j]<h)h=c[j];c=h+1}else c=null;
if(c!=null&&c!=l){e++;a=a!=null?G(a):null;l=a!=null&&a.length>0?R(a)+1:0}for(f.actualColumnIndex=l;D(d.positionedItems,e,l);)e++}else for(;;e++){l=P(d.positionedItems,e);l=l.length>0?R(l)+1:0;if(l<=f.actualColumnIndex)break}f.actualRowIndex=e}else if(typeof f.displayedColumnIndex==="undefined"){a=G(d.positionedItems);f.actualColumnIndex=a.length>0?R(a)+1:0}d.positionedItems.push(f);if(d.maxRowIndex==null||f.actualRowIndex>d.maxRowIndex)d.maxRowIndex=f.actualRowIndex}},P=function(b,g){for(var f=[],
d=0;d<b.length;d++){var a=b[d];if(a.actualRowIndex==g){a=a.actualColumnIndex;f.indexOf(a)<0&&f.push(a)}}return f},G=function(b){for(var g=[],f=0;f<b.length;f++){var d=b[f].actualColumnIndex;g.indexOf(d)<0&&g.push(d)}return g},D=function(b,g,f){for(var d=0;d<b.length;d++){var a=b[d];if(a.actualRowIndex==g&&a.actualColumnIndex==f)return true}return false},J=function(b,g,f){var d;if(b.isContentHeightInitialized&&b.isContentHeightAuto)d=g.length>0?"auto":f.itemHeight+"px";else{var a=b.clientHeight-2;
a<0&&(a=0);d=a+"px";if(a<f.itemHeight){if(!b.isContentHeightInitialized)b.isContentHeightAuto=true;d=g.length>0?"auto":f.itemHeight+"px"}b.isContentHeightInitialized=true}return d},x=function(b,g){var f=b.createElement("span");f.innerHTML=g;return f},v=function(b){return Math.ceil(b/36E5*1E4/100)/100+"h"},C=function(b,g){for(var f=0,d=0;d<b.length;d++)f=Math.max(f,b[d].actualColumnIndex);return g.itemWidth+f*(g.itemWidth+g.dependencyTextBlockWidth)+g.chartMargin*2},t=function(b,g){for(var f=0,d=0;d<
b.length;d++)f=Math.max(f,b[d].actualRowIndex);return g.itemHeight+f*(g.itemHeight+g.dependencyTextBlockWidth/g.aspectRatio)+g.chartMargin*2},K=function(b,g,f,d){for(b=0;b<f.length;b++){var a=f[b],e=E(a,d),l=H(a,d);g.appendChild(I(a,e,l,d))}},E=function(b,g){if(typeof b.displayedColumnIndex!=="undefined")b.actualColumnIndex=b.displayedColumnIndex;return Math.max(0,g.chartMargin+b.actualColumnIndex*(g.itemWidth+g.dependencyTextBlockWidth))},H=function(b,g){if(typeof b.displayedRowIndex!=="undefined")b.actualRowIndex=
b.displayedRowIndex;return Math.max(0,g.chartMargin+b.actualRowIndex*(g.itemHeight+g.dependencyTextBlockWidth/g.aspectRatio))},F=function(b){for(var g=[],f,d,a=0;a<b.length;a++){var e=b[a];if(typeof e.predecessors!=="undefined"&&e.predecessors.length>0)for(var l=0;l<e.predecessors.length;l++){var c=e.predecessors[l].item;if(typeof c!=="undefined"){f=true;for(d=0;d<g;d++)if(c==g[d]){f=false;break}if(f){A(c.chartItem,c,c.pertChartView.settings);f=E(c,c.pertChartView.settings);d=H(c,c.pertChartView.settings);
c.chartItem.setAttribute("transform","translate("+f+", "+d+")");g.push(c)}}}if(typeof e.predecessors!=="undefined"&&e.predecessors.length>0){f=true;for(d=0;d<g;d++)if(typeof e!=="undefined"&&e==g[d]){f=false;break}if(f){A(e.chartItem,e,e.pertChartView.settings);f=E(e,e.pertChartView.settings);d=H(e,e.pertChartView.settings);e.chartItem.setAttribute("transform","translate("+f+", "+d+")");g.push(e)}}}},I=function(b,g,f,d){var a=b.pertChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg",
"g");b.chartItem=a;a.setAttribute("style","-ms-touch-action: pinch-zoom");a.setAttribute("transform","translate("+g+", "+f+")");A(a,b,d);return a},A=function(b,g,f){for(var d=b.childNodes.length;d-- >0;)b.removeChild(b.childNodes[d]);if(typeof g.isShapeVisible==="undefined"||g.isShapeVisible){d=f.taskEventTemplate;if(typeof g.taskEventTemplate!=="undefined")d=g.taskEventTemplate;d=d(g);b.appendChild(d);if(typeof f.internalExtraTaskTemplate!=="undefined"){var a=f.internalExtraTaskTemplate(g);a!=null&&
b.appendChild(a)}if(typeof f.extraTaskEventTemplate!=="undefined"){a=f.extraTaskEventTemplate(g);a!=null&&b.appendChild(a)}if(f.isTaskEventToolTipVisible){a=f.itemTemplate;if(typeof g.template!=="undefined")a=g.template;d.appendChild(a(g))}if(typeof g.predecessors!=="undefined")for(d=0;d<g.predecessors.length;d++){a=g.predecessors[d];if(!((typeof g.pertChartView==="undefined"||g.pertChartView.items.indexOf(a.item))<0)){var e=f.dependencyLineTemplate(g,a);e.predecessorIndex=d;b.appendChild(e);if(f.isDependencyToolTipVisible){var l=
f.predecessorItemTemplate;if(typeof a.template!=="undefined")l=a.template;e.appendChild(l(g,a))}}}}},V=function(b){if(typeof b.isWaitingToRefreshChartItem==="undefined"){b.isWaitingToRefreshChartItem=true;setTimeout(function(){A(b.chartItem,b,b.pertChartView.settings);var g=E(b,b.pertChartView.settings),f=H(b,b.pertChartView.settings);b.chartItem.setAttribute("transform","translate("+g+", "+f+")");delete b.isWaitingToRefreshChartItem},0)}},Q=function(b){V(b)},B=function(b){if(typeof b.isWaitingToRefreshPredecessorItems===
"undefined"){b.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){F(b.pertChartView.items,b);delete b.isWaitingToRefreshPredecessorItems},0)}},$=function(b){if(typeof b.isWaitingToRefreshChartItem!=="undefined"||typeof b.isWaitingToRefreshPredecessorItems!=="undefined"){typeof b.isWaitingToRefreshChartItem==="undefined"&&V(b);typeof b.isWaitingToRefreshPredecessorItems==="undefined"&&B(b)}else{b.isWaitingToRefreshChartItem=true;b.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){A(b.chartItem,
b,b.pertChartView.settings);var g=E(b,b.pertChartView.settings),f=H(b,b.pertChartView.settings);b.chartItem.setAttribute("transform","translate("+g+", "+f+")");F(b.pertChartView.items,b);delete b.isWaitingToRefreshChartItem;delete b.isWaitingToRefreshPredecessorItems},0)}},W=function(b){return function(){var g=b.ownerDocument,f=g.createElementNS("http://www.w3.org/2000/svg","defs"),d=g.createElementNS("http://www.w3.org/2000/svg","marker");d.setAttribute("id","ArrowMarker");d.setAttribute("viewBox",
"0 0 10 10");d.setAttribute("refX","0");d.setAttribute("refY","5");d.setAttribute("markerUnits","strokeWidth");d.setAttribute("markerWidth","5");d.setAttribute("markerHeight","4");d.setAttribute("orient","auto");g=g.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("fill","#8080ff");g.setAttribute("d","M 0 0 L 10 5 L 0 10 z");d.appendChild(g);f.appendChild(d);return f}},X=function(){return function(b){var g=b.pertChartView.ownerDocument,f=g.createElementNS("http://www.w3.org/2000/svg",
"title");f.appendChild(x(g,typeof b.content!=="undefined"?b.content:""));return f}},aa=function(b,g,f){return function(d){var a=typeof g!=="undefined"?g:d.pertChartView,e=typeof f!=="undefined"?f:a.settings,l=typeof b!=="undefined"?b:a.items,c=a.ownerDocument,h;h=d.pertChartView.ownerDocument;if(typeof d.chartItemArea==="undefined")d.chartItemArea=h.createElementNS("http://www.w3.org/2000/svg","g");for(h=d.chartItemArea.childNodes.length;h-- >0;)d.chartItemArea.removeChild(d.chartItemArea.childNodes[h]);
h=d.chartItemArea;var j=(e.itemWidth-e.shapeWidth)/2,u=j+e.shapeWidth,y=(e.itemHeight-e.shapeHeight)/2,n=y+e.shapeHeight,o=e.shapeHeight,p,s=c.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("x",j);s.setAttribute("y",y);s.setAttribute("width",Math.max(0,u-j-1));s.setAttribute("height",Math.max(0,n-y-1));s.setAttribute("rx",e.shapeWidth/10);s.setAttribute("ry",e.shapeHeight/10);p=e.shapeClass;if(typeof d.shapeClass!=="undefined")p=d.shapeClass;typeof p!=="undefined"&&s.setAttribute("class",
p);p=e.shapeStyle;if(typeof d.shapeStyle!=="undefined")p=d.shapeStyle;typeof p!=="undefined"&&s.setAttribute("style",p);h.appendChild(s);s=c.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("x",(j+u)/2);s.setAttribute("y",n-o*1.5/8-6);s.setAttribute("style","font-weight: bold; text-anchor: middle");o=d.displayedText;typeof o==="undefined"&&(o="");s.appendChild(c.createTextNode(o));h.appendChild(s);if(e.canUserRearrangeItems){c=c.createElementNS("http://www.w3.org/2000/svg","rect");
c.setAttribute("x",j);c.setAttribute("y",y);c.setAttribute("width",Math.max(0,u-j-1));c.setAttribute("height",Math.max(0,n-y-1));c.setAttribute("style","fill: White; fill-opacity: 0; cursor: move");h.appendChild(c);ca(c,d,l,E(d,e),H(d,e),a,e)}return h}},ba=function(b,g){return function(b,d){var a=b.pertChartView,e=typeof g!=="undefined"?g:a.settings,a=a.ownerDocument,l=a.createElementNS("http://www.w3.org/2000/svg","g"),c=void 0,h=void 0,j,u="M ",c=E(b,e)-2,h=H(b,e)-2,y=E(d.item,e);j=H(d.item,e);
var n=E(b,e),o=H(b,e),p=Math.abs(n-y),s=Math.abs(o-j),r=e.shapeWidth+2,k=e.shapeHeight+2,q=r/2,z=k/2,m=Math.max(r,k),s=s<m*4;if(p<m)u=j<=o?u+(y+q-c+","+(j+k-h))+(" L "+(n+q-c)+","+(o-h)):u+(y+q-c+","+(j-h))+(" L "+(n+q-c)+","+(o+k-h));else{u=y<=n?u+(y+r-c+","+(j+z-h)):u+(y-c+","+(j+z-h));u=s?y<=n?u+(" L "+(n-c)+","+(o+z-h)):u+(" L "+(n+r-c)+","+(o+z-h)):j<=o?u+(" L "+(n+q-c)+","+(o-h)):u+(" L "+(n+q-c)+","+(o+k-h))}c=((y<=n?y:n)+(y>=n?y:n))/2+q-c;h=((j<=o?j:o)+(j>=o?j:o))/2+z-h;j=u;u=a.createElementNS("http://www.w3.org/2000/svg",
"path");u.setAttribute("d",j);typeof e.dependencyLineZoneClass!=="undefined"&&u.setAttribute("class",e.dependencyLineZoneClass);typeof e.dependencyLineZoneStyle!=="undefined"&&u.setAttribute("style",e.dependencyLineZoneStyle);l.appendChild(u);u=a.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d",j);if(typeof d.isEffortVirtual!=="undefined"?!d.isEffortVirtual:typeof d.effort!=="undefined"&&d.effort>0){j=e.dependencyLineClass;if(typeof d.dependencyLineClass!=="undefined")j=d.dependencyLineClass;
typeof j!=="undefined"&&u.setAttribute("class",j);j=e.dependencyLineStyle;if(typeof d.dependencyLineStyle!=="undefined")j=d.dependencyLineStyle}else{j=e.virtualEffortDependencyLineClass;if(typeof d.virtualEffortDependencyLineClass!=="undefined")j=d.virtualEffortDependencyLineClass;typeof j!=="undefined"&&u.setAttribute("class",j);j=e.virtualEffortDependencyLineStyle;if(typeof d.virtualEffortDependencyLineStyle!=="undefined")j=d.virtualEffortDependencyLineStyle}typeof j!=="undefined"&&u.setAttribute("style",
j);l.appendChild(u);u=a.createElementNS("http://www.w3.org/2000/svg","text");u.setAttribute("x",c);u.setAttribute("y",h-6);h=e.dependencyTextClass;if(typeof d.dependencyTextClass!=="undefined")h=d.dependencyTextClass;typeof h!=="undefined"&&u.setAttribute("class",h);e=e.dependencyTextStyle;if(typeof d.dependencyTextStyle!=="undefined")e=d.dependencyTextStyle;u.setAttribute("style",e);e=d.displayedText;typeof e==="undefined"&&(e="");u.appendChild(a.createTextNode(e));l.appendChild(u);return l}},la=
function(){return function(b,g){var f=b.pertChartView.ownerDocument,d=f.createElementNS("http://www.w3.org/2000/svg","title");d.appendChild(x(f,typeof g.content!=="undefined"?g.content:""));return d}},S=function(b,g,f,d){typeof b.pertChartView!=="undefined"&&b.pertChartView.settings.itemPropertyChangeHandler(b,g,f,d)},ca=function(b,g,f,d,a,e,l){b.addEventListener("mousedown",function(c){if(c.button==0){e.draggingItem=g;e.dragType="Position";e.style.cursor=b.style.cursor;e.draggingInitialX=c.clientX;
e.draggingInitialY=c.clientY;e.draggingInitialThumbXPosition=d;e.draggingInitialThumbYPosition=a;c.preventDefault()}},true);if(typeof e.draggableItems==="undefined")e.draggableItems=[];for(var c=false,h=0;h<e.draggableItems.length;h++)if(e.draggableItems[h]==g){c=true;break}if(!c){e.addEventListener("mousemove",function(a){if(!(typeof e.draggingItem==="undefined"||e.draggingItem!=g||e.dragType!="Position")){var c=a.clientX-e.draggingInitialX,b=a.clientY-e.draggingInitialY;var h=a.clientX;if(typeof e.draggingItem!==
"undefined"){var d=e,p=0;if(d.offsetParent){do{p=p+d.offsetLeft;d=d.offsetParent}while(d)}h=h-p;if(h<24){h=e.chartContentContainer.scrollLeft;e.chartContentContainer.scrollLeft=e.chartContentContainer.scrollLeft-48;h=h-e.chartContentContainer.scrollLeft;if(typeof e.draggingInitialThumbXPosition!=="undefined")e.draggingInitialThumbXPosition=e.draggingInitialThumbXPosition-h}else if(h>=e.chartContentContainer.clientWidth-24){h=e.chartContentContainer.scrollLeft;e.chartContentContainer.scrollLeft=e.chartContentContainer.scrollLeft+
48;h=e.chartContentContainer.scrollLeft-h;if(typeof e.draggingInitialThumbXPosition!=="undefined")e.draggingInitialThumbXPosition=e.draggingInitialThumbXPosition+h}}a=a.clientY;if(typeof e.draggingItem!=="undefined"){h=e;d=0;if(h.offsetParent){do{d=d+h.offsetTop;h=h.offsetParent}while(h)}a=a-d;if(a<24){a=e.chartContentContainer.scrollTop;e.chartContentContainer.scrollTop=e.chartContentContainer.scrollTop-48;a=a-e.chartContentContainer.scrollTop;if(typeof e.draggingInitialThumbYPosition!=="undefined")e.draggingInitialThumbYPosition=
e.draggingInitialThumbYPosition-a}else if(a>=e.chartContentContainer.clientHeight-24){a=e.chartContentContainer.scrollTop;e.chartContentContainer.scrollTop=e.chartContentContainer.scrollTop+48;a=e.chartContentContainer.scrollTop-a;if(typeof e.draggingInitialThumbYPosition!=="undefined")e.draggingInitialThumbYPosition=e.draggingInitialThumbYPosition+a}}delete e.draggingItem;e.draggingInitialThumbXPosition+c<0&&(c=-e.draggingInitialThumbXPosition);e.draggingInitialThumbYPosition+b<0&&(b=-e.draggingInitialThumbYPosition);
b=(e.draggingInitialThumbYPosition+b-l.chartMargin)/(l.itemHeight+l.dependencyTextBlockWidth/l.aspectRatio);l.snapRearrangedItemsToGuidelines&&(b=Math.round(b));g.actualRowIndex=b;c=(e.draggingInitialThumbXPosition+c-l.chartMargin)/(l.itemWidth+l.dependencyTextBlockWidth);l.snapRearrangedItemsToGuidelines&&(c=Math.round(c));g.actualColumnIndex=c;S(g,"actualRowIndex",true,false);S(g,"actualColumnIndex",true,false);typeof g.displayedColumnIndex!=="undefined"&&delete g.displayedColumnIndex;typeof g.displayedRowIndex!==
"undefined"&&delete g.displayedRowIndex;da(g,f,e.chartContent,l,false);e.draggingItem=g;e.draggingPerformed=true}},true);document.addEventListener("mouseup",function(a){if(!(a.button!=0||typeof e.draggingItem==="undefined"||e.draggingItem!=g||e.dragType!="Position")){da(g,f,e.chartContent,l,true);a=e.draggingItem;delete e.draggingItem;e.style.cursor="default";if(e.draggingPerformed){S(a,"actualColumnIndex",true,true);S(a,"actualRowIndex",true,true);delete e.draggingPerformed}}},true);e.draggableItems.push(g)}},
da=function(b,g,f,d,a){var e=b.pertChartView.ownerDocument;if(a){if(typeof f.temporaryRectangle!=="undefined"){e=f.chartArea;e.removeChild(f.temporaryRectangle);delete f.temporaryRectangle}A(b.chartItem,b,d);F(g,b);setTimeout(function(){N(f,g,d,true)},0)}else{if(typeof f.temporaryRectangle!=="undefined")a=f.temporaryRectangle;else{a=e.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",0);a.setAttribute("y",0);a.setAttribute("width",d.shapeWidth);a.setAttribute("height",d.shapeHeight);
a.setAttribute("rx",d.shapeWidth/10);a.setAttribute("ry",d.shapeHeight/10);typeof d.temporaryThumbClass!=="undefined"&&a.setAttribute("class",d.temporaryThumbClass);a.setAttribute("style",d.temporaryThumbStyle);f.temporaryRectangle=a;e=f.chartArea;e.appendChild(a)}e=E(b,d)+(d.itemWidth-d.shapeWidth)/2;b=H(b,d)+(d.itemHeight-d.shapeHeight)/2;a.setAttribute("transform","translate("+e+", "+b+")");setTimeout(function(){N(f,g,d,false)},0)}},N=function(b,g,f,d){var a=C(g,f),g=t(g,f);if(d||a>b.clientWidth)b.style.width=
a+"px";if(d||g>b.clientHeight)b.style.height=g+"px"},ka=function(b,g){for(var f=b.childNodes.length;f-- >0;)b.removeChild(b.childNodes[f]);b.appendChild(g)},ma=function(b,g){for(var f in g)f.indexOf("custom")!=0&&f.indexOf("description")!=0||typeof b[f]==="undefined"&&(b[f]=g[f])},ea=function(b,g,f,d,a,e,l,c){var c={isExport:true,canUserRearrangeItems:false,isTaskEventToolTipVisible:false,isDependencyToolTipVisible:false,containerClass:c.containerClass,containerStyle:c.containerStyle,border:c.border,
theme:c.theme,itemWidth:c.itemWidth,itemHeight:c.itemHeight,aspectRatio:c.aspectRatio,shapeWidth:c.shapeWidth,shapeHeight:c.shapeHeight,shapeClass:c.shapeClass,shapeStyle:c.shapeStyle,shapeCornerRadius:c.shapeCornerRadius,dependencyTextStyle:c.dependencyTextStyle,dependencyLineClass:c.dependencyLineClass,dependencyLineStyle:c.dependencyLineStyle,virtualEffortDependencyLineClass:c.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:c.virtualEffortDependencyLineStyle,dependencyTextBlockWidth:c.dependencyTextBlockWidth,
chartMargin:0,target:c.target,timeSpanFormatter:c.timeSpanFormatter,taskEventTemplate:c.taskEventTemplate,dependencyLineTemplate:c.dependencyLineTemplate},h=C(l,c),j=t(l,c);c.chartWidth=h+"px";c.chartHeight=j+"px";var u=h+2,h=j+2,y,n,o=false;if(f!=null&&typeof f.createElement!=="undefined")y=f;else{if(f!=null&&typeof f.focus!=="undefined")n=f;else{n=window.open("",f!=null?f:"_blank",typeof d!=="undefined"&&d&&(typeof e==="undefined"||e)?"width=320,height=100,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":
"");o=true}y=n.document}y.title=typeof b!=="undefined"?b:"Exported chart"+(typeof d!=="undefined"&&d?" (printable)":"");var b=[],p;for(p=0;p<l.length;p++){f=l[p];j={content:f.content,displayedText:f.displayedText,isShapeVisible:f.isShapeVisible,shapeClass:f.shapeClass,shapeStyle:f.shapeStyle,dependencyTextStyle:f.dependencyTextStyle,displayedRowIndex:f.actualRowIndex,displayedColumnIndex:f.actualColumnIndex,isExported:true};ma(j,f);b.push(j);f.exportItem=j}for(p=0;p<l.length;p++){f=l[p];j=f.exportItem;
if(typeof f.predecessors!=="undefined"){j.predecessors=[];for(var s=0;s<f.predecessors.length;s++){var r=f.predecessors[s];j.predecessors.push({item:r.item.exportItem,content:r.content,displayedText:r.displayedText,effort:r.effort,isEffortVirtual:r.isEffortVirtual,dependencyLineClass:r.dependencyLineClass,dependencyLineStyle:r.dependencyLineStyle,virtualEffortDependencyLineClass:r.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:r.virtualEffortDependencyLineStyle,dependencyTextStyle:r.dependencyTextStyle})}}}var k=
y.createElement("p");k.innerHTML=typeof g!=="undefined"?g:"";y.body.appendChild(k);var q=y.createElement("div");q.setAttribute("style","width: "+u+"px; height: "+h+"px");try{DlhSoft.Controls.Pert.PertChartView.initialize(q,b,c,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch(z){}setTimeout(function(){o&&y.body.setAttribute("style","margin: 0px");var c=y.createElement("div");c.appendChild(q);y.body.replaceChild(c,
k);if(a){c.setAttribute("style","width: "+q.offsetHeight+"px; height: "+u+"px; overflow: hidden");c=Math.round((q.offsetWidth-q.offsetHeight)/2);q.setAttribute("style","width: "+u+"px; transform: rotate(90deg) translateX("+c+"px) translateY("+c+"px); -webkit-transform: rotate(90deg) translateX("+c+"px) translateY("+c+"px)")}y.close();if(typeof n!==void 0){n.focus();if(typeof d!=="undefined"&&d){n.print();(typeof e==="undefined"||e)&&n.close()}}},0)},na=function(b,g){typeof b==="undefined"&&(b=0);
var f=Y(g);if(f==null)return[];for(var f=[f],d=fa(b,g),a=0;a<d.length;a++)f.push(d[a].dependentItem);return f},fa=function(b,g){var f=Y(g);if(f==null)return[];var d;a:{for(d=g.length;d-- >0;){var a=g[d];if(ga(a).length==0){d=a;break a}}d=null}if(d==null)return[];f=ha(f,d);d=[];for(a=0;a<f.length;a++)d.push(f[a]);return d},ha=function(b,g){if(b==null||g==null||b==g||typeof g.predecessors==="undefined")return[];var f=[],d=[],a,e=null;for(a=0;a<g.predecessors.length;a++){predecessorItem=g.predecessors[a];
predecessorItem.dependentItem=g;if(typeof predecessorItem.item!=="undefined"){var l=ia(b,predecessorItem.item);if(l!=null){if((typeof predecessorItem.isEffortVirtual==="undefined"||!predecessorItem.isEffortVirtual)&&predecessorItem.effort>0)l=l+predecessorItem.effort;if(e==null||l>=e){if(e==null||l>e){e=l;d=[]}d.push(predecessorItem)}}}}for(a=0;a<d.length;a++){for(var e=d[a],l=ha(b,e.item),c=0;c<l.length;c++)f.push(l[c]);f.push(e)}return f},Y=function(b){for(var g=0;g<b.length;g++){var f=b[g];if(typeof f.predecessors===
"undefined"||f.predecessors.length==0)return f}return null},ia=function(b,g){if(b==null||g==null)return null;if(b==g)return 0;for(var f=null,d=ga(b),a=0;a<d.length;a++){var e=d[a],l=ia(e.dependentItem,g);if(l!=null){l=l+(typeof e.predecessorItem.isEffortVirtual!=="undefined"&&e.predecessorItem.effort>0?e.predecessorItem.effort:0);l<0&&(l=0);if(f==null||l>f)f=l}}return f},ga=function(b){for(var g=[],f=b.pertChartView.items,d=0;d<f.length;d++){var a=f[d];if(typeof a.predecessors!=="undefined")for(var e=
0;e<a.predecessors.length;e++){var l=a.predecessors[e];typeof l.item!=="undefined"&&l.item==b&&g.push({dependentItem:a,predecessorItem:l})}}return g},R=function(b){for(var g=null,f=0;f<b.length;f++)if(g==null||b[f]>g)g=b[f];return g},ja=function(b,g,f){for(var d=0;d<g.length;d++)g[d].pertChartView=b;b.items=g;b.settings=f;b.refresh=function(){M(b)};b.refreshItems=function(){for(var a=0;a<g.length;a++){var e=g[a];V(e);B(e)}};b.refreshChartItems=function(){for(var a=0;a<g.length;a++)V(g[a])};b.refreshItem=
Q;b.refreshChartItem=V;b.refreshPredecessorItems=B;b.refreshItemGraph=$;b.scrollToItem=function(a){var e=E(a,f),b=e-a.pertChartView.chartContentContainer.scrollLeft;if(b<0)a.pertChartView.chartContentContainer.scrollLeft=e;else if(b>a.pertChartView.chartContentContainer.clientWidth-a.pertChartView.settings.itemWidth)a.pertChartView.chartContentContainer.scrollLeft=e-(a.pertChartView.chartContentContainer.clientWidth-a.pertChartView.settings.itemWidth);e=H(a,f);b=e-a.pertChartView.chartContentContainer.scrollTop;
if(b<0)a.pertChartView.chartContentContainer.scrollTop=e;else if(b>a.pertChartView.chartContentContainer.clientHeight-a.pertChartView.settings.itemHeight)a.pertChartView.chartContentContainer.scrollTop=e-(a.pertChartView.chartContentContainer.clientHeight-a.pertChartView.settings.itemHeight)};b.scrollToLeft=function(){b.chartContentContainer.scrollLeft=0};b.scrollToRight=function(){b.chartContentContainer.scrollLeft=b.chartContent.clientWidth};b.scrollToTop=function(){b.chartContentContainer.scrollTop=
0};b.scrollToBottom=function(){b.chartContentContainer.scrollTop=b.chartContent.clientHeight};b.getChartWidth=function(){return C(g,f)};b.getChartHeight=function(){return t(g,f)};b.getItemTop=function(a){return H(a,f)};b.getItemLeft=function(a){return E(a,f)};b.onItemPropertyChanged=S;b.initializeTasEventkDraggingThumbs=function(a,e,l,c){ca(a,e,b.items,l,c,b,b.settings)};b.exportContent=function(a,e){typeof a==="undefined"&&(a={});ea(a.title,a.preparingMessage,e,false,a.rotate,false,g,f)};b.print=
function(a){typeof a==="undefined"&&(a={});ea(a.title,a.preparingMessage,null,true,a.rotate,a.autoClose,g,f)};b.isItemCritical=function(a,e){return na(e,g).indexOf(a)>=0};b.isDependencyCritical=function(a,e){return fa(e,g).indexOf(a)>=0};b.getCriticalItems=function(a){return na(a,g)};b.getCriticalDependencies=function(a){return fa(a,g)};b.repositionEnds=function(){if(g.length!=0){for(var a=false,e=0;e<g.length;e++){for(var b=g[e],c=0,h=0;h<g.length;h++){var j=g[h];if(typeof j.predecessors!=="undefined"){for(var f=
0;f<j.predecessors.length;f++)if(typeof j.predecessors[f].item!=="undefined"&&j.predecessors[f].item==b){c++;if(c>1)break}if(c>1)break}}c>1&&(a=true)}e=g[0];e.displayedRowIndex=a?0.5:0;b=g[g.length-1];b.displayedRowIndex=a?0.5:0;$(e);$(b)}}};return{initialize:L,initializeItems:U,refresh:M,getDefaultStyleDefinitionTemplate:W,getDefaultTaskEventTemplate:aa,getDefaultItemTemplate:X,getDefaultDependencyLineTemplate:ba,getDefaultPredecessorItemTemplate:la,initializeTaskEventDraggingThumbs:function(b,g,
f,d){g.pertChartView.initializeTaskEventDraggingThumbs(b,g,f,d)},defaultTimeSpanFormatter:v}}());
void 0==DlhSoft.Controls.Pert.NetworkDiagramView&&(DlhSoft.Controls.Pert.NetworkDiagramView=function(){var L=function(a,e,b,c){var h=["DlhSoft.Controls.Pert","NetworkDiagramView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];DlhSoft[h[5]][h[4]](a,h[0],h[1],h[2],h[3],c,b);a.isInitializing=true;if(typeof a.items!=="undefined")for(c=0;c<a.items.length;c++)delete a.items[c].successors;typeof b!=="object"&&(b={});U(e,b);T(b,e,a);d(a,e,b);t(e,b);Z(e);var j=J(a,e,b),c=a.ownerDocument,
h=c.createElement("div");h.setAttribute("style","font-family: Arial; font-size: small; overflow: auto");var f=c.createElement("div");typeof b.containerClass!=="undefined"&&f.setAttribute("class",b.containerClass);typeof b.containerStyle!=="undefined"&&f.setAttribute("style",b.containerStyle);h.appendChild(f);var g=c.createElement("div");g.setAttribute("style","border: solid 1px "+b.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden");
f.appendChild(g);f=c.createElement("div");f.setAttribute("style","overflow: auto");g.appendChild(f);var n=c.createElement("div");n.setAttribute("style","overflow: "+(typeof b.isExport==="undefined"||!b.isExport?"auto":"hidden")+"; height: "+j);f.appendChild(n);var g=K(e,b),o=E(e,b),p=c.createElement("div");p.setAttribute("style","float: left; overflow: hidden; width: "+g+"px; height: "+o+"px");n.appendChild(p);j=c.createElementNS("http://www.w3.org/2000/svg","svg");j.setAttribute("style","width: "+
g+"px; height: "+o+"px");g=b.styleDefinitionTemplate();j.appendChild(g);j.chartAreaDefinitions=g;g=function(){setTimeout(function(){try{var a=p.chartArea,e=a.chartAreaDefinitions;a.removeChild(e);a.childNodes.length>0?a.insertBefore(e,a.childNodes[0]):a.appendChild(e)}catch(c){}},0)};j.addEventListener("mousedown",g,true);c.addEventListener("mouseup",g,true);p.appendChild(j);p.chartArea=j;var s;setTimeout(function(){s=a.clientHeight},0);typeof a.heightUpdateTimer!=="undefined"&&clearInterval(a.heightUpdateTimer);
a.heightUpdateTimer=setInterval(function(){try{if(!(a.clientHeight<=0)){var c=a.clientHeight;if(c!=s){var h=J(a,e,b);n.style.height=h;s=c}}}catch(j){try{clearInterval(a.heightUpdateTimer)}catch(f){}}},100);p.container=n;a.chartContainer=f;a.chartContent=p;a.chartContentContainer=n;n.isInitializing=true;na(a,h);H(p,j,e,b);n.isInitializing=false;a.isInitializing=false;a.isInitialized=true;return a},M=function(a){L(a,a.items,a.settings,a.license)},O=function(a){if(typeof a.dateTimeFormatter==="undefined")a.dateTimeFormatter=
v;if(typeof a.timeSpanFormatter==="undefined")a.timeSpanFormatter=C;if(typeof a.itemPropertyChangeHandler==="undefined")a.itemPropertyChangeHandler=function(){};if(typeof a.target==="undefined")a.target="Standard";if(typeof a.theme==="undefined")a.theme="Modern"},T=function(a,e,b){O(a);if(typeof a.border==="undefined")switch(a.theme){default:a.border="#e0e0e0";break;case "ModernBordered":case "Aero":a.border="#9a9a9a"}if(typeof a.canUserRearrangeItems==="undefined")a.canUserRearrangeItems=true;if(typeof a.snapRearrangedItemsToGuidelines===
"undefined")a.snapRearrangedItemsToGuidelines=true;if(typeof a.itemWidth==="undefined")a.itemWidth=220;if(typeof a.itemHeight==="undefined")a.itemHeight=100;if(typeof a.aspectRatio==="undefined")a.aspectRatio=1;if(typeof a.shapeWidth==="undefined")a.shapeWidth=212;if(typeof a.shapeHeight==="undefined")a.shapeHeight=92;if(typeof a.styleDefinitionTemplate==="undefined")a.styleDefinitionTemplate=aa(b,a);if(typeof a.shapeStyle==="undefined"&&a.shapeClass==null)a.shapeStyle="fill: White; stroke: #0000ff; stroke-width: 1px";
if(typeof a.milestoneStyle==="undefined"&&a.milestoneClass==null)a.milestoneStyle="fill: White; stroke: #000000; stroke-width: 1px";if(typeof a.temporaryThumbStyle==="undefined"&&a.temporaryThumbClass==null)a.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; ";if(typeof a.dependencyLineStyle==="undefined"&&a.dependencyLineClass==null)a.dependencyLineStyle="stroke: #8080FF; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)";if(typeof a.dependencyLineZoneStyle===
"undefined"&&a.dependencyLineZoneClass==null)a.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none";if(typeof a.taskTemplate==="undefined")a.taskTemplate=S();if(typeof a.minDependencyLineLength==="undefined")a.minDependencyLineLength=48;if(typeof a.diagramMargin==="undefined")a.diagramMargin=16;if(typeof a.isTaskToolTipVisible==="undefined")switch(a.target){default:a.isTaskToolTipVisible=true;break;case "Phone":a.isTaskToolTipVisible=false}if(typeof a.itemTemplate===
"undefined")a.itemTemplate=ba(a);if(typeof a.dependencyLineTemplate==="undefined")a.dependencyLineTemplate=ca();if(typeof a.isDependencyToolTipVisible==="undefined")a.isDependencyToolTipVisible=a.isTaskToolTipVisible;if(typeof a.predecessorItemTemplate==="undefined")a.predecessorItemTemplate=da(a)},U=function(a,e){for(var b=new Date,c=0;c<a.length;c++){var h=a[c];if(typeof h==="string"){h={content:h};a[c]=h}if(typeof h.earlyStart==="string"){try{h.earlyStart=Date.parse(h.earlyStart)}catch(j){h.earlyStart=
new Date(parseInt(h.earlyStart))}if(typeof e.isRelativeToTimezone==="undefined"||e.isRelativeToTimezone)h.earlyStart=new Date(h.earlyStart.valueOf()+b.getTimezoneOffset()*6E4)}if(typeof h.earlyFinish==="string"){try{h.earlyFinish=Date.parse(h.earlyFinish)}catch(f){h.earlyFinish=new Date(parseInt(h.earlyFinish))}if(typeof e.isRelativeToTimezone==="undefined"||e.isRelativeToTimezone)h.earlyFinish=new Date(h.earlyFinish.valueOf()+b.getTimezoneOffset()*6E4)}if(typeof h.lateStart==="string"){try{h.lateStart=
Date.parse(h.lateStart)}catch(g){h.lateStart=new Date(parseInt(h.lateStart))}if(typeof e.isRelativeToTimezone==="undefined"||e.isRelativeToTimezone)h.lateStart=new Date(h.lateStart.valueOf()+b.getTimezoneOffset()*6E4)}if(typeof h.lateFinish==="string"){try{h.lateFinish=Date.parse(h.lateFinish)}catch(d){h.lateFinish=new Date(parseInt(h.lateFinish))}if(typeof e.isRelativeToTimezone==="undefined"||e.isRelativeToTimezone)h.earlyFinish=new Date(h.earlyFinish.valueOf()+b.getTimezoneOffset()*6E4)}if(typeof h.effort===
"string")try{h.effort=parseInt(h.effort)}catch(o){}if(typeof h.isMilestone==="string")h.isMilestone=h.isMilestone.toLowerCase()==trueStringValue;if(typeof h.slack==="string")try{h.slack=parseInt(h.slack)}catch(p){}if(typeof h.predecessors!=="undefined"){if(typeof h.predecessors==="string")h.predecessors=h.predecessors.split(",");for(var s=0;s<h.predecessors.length;s++){var r=h.predecessors[s];if(typeof r==="string"){r={item:r};h.predecessors[s]=r}if(typeof r.item==="string"){var k=parseInt(r.item)-
1;r.item=k>=0&&k<a.length?a[k]:null}if(typeof r.lag==="string")r.lag=parseFloat(r.lag)}}if(typeof h.displayedRowIndex!=="undefined")h.actualRowIndex=h.displayedRowIndex;if(typeof h.displayedColumnIndex!=="undefined")h.actualColumnIndex=h.displayedColumnIndex;if(typeof h.actualRowIndex==="undefined")h.actualRowIndex=0;if(typeof h.actualColumnIndex==="undefined")h.actualColumnIndex=0}},Z=function(a){a.positionedItems=[];a.maxRowIndex=null;for(var e=0;e<a.length;e++){var l=a[e],c=a;if(typeof l.displayedRowIndex===
"undefined"){var h;if(typeof l.predecessors!=="undefined"){h=c.positionedItems;for(var j=[],f=l.predecessors,g=0;g<h.length;g++)for(var d=h[g],o=0;o<f.length;o++)if(f[o].item==d){j.push(d);break}h=j}else h=null;if(h!=null){j=h;f=[];for(g=0;g<j.length;g++){d=j[g].actualRowIndex;f.indexOf(d)<0&&f.push(d)}j=f}else j=null;j=j!=null&&j.length>0?b(j):c.maxRowIndex!=null?c.maxRowIndex+1:0;f=f=void 0;if(typeof l.displayedColumnIndex==="undefined"){f=P(c.positionedItems,j);f=f.length>0?b(f)+1:0;g=h!=null?
P(h,j):null;if(g!=null&&g.length>0){d=null;for(o=0;o<g.length;o++)if(d==null||g[o]<d)d=g[o];g=d+1}else g=null;if(g!=null&&g!=f){j++;h=h!=null?G(h):null;f=h!=null&&h.length>0?b(h)+1:0}for(l.actualColumnIndex=f;D(c.positionedItems,j,f);)j++}else for(;;j++){f=P(c.positionedItems,j);f=f.length>0?b(f)+1:0;if(f<=l.actualColumnIndex)break}l.actualRowIndex=j}else if(typeof l.displayedColumnIndex==="undefined"){h=G(c.positionedItems);l.actualColumnIndex=h.length>0?b(h)+1:0}c.positionedItems.push(l);if(c.maxRowIndex==
null||l.actualRowIndex>c.maxRowIndex)c.maxRowIndex=l.actualRowIndex}},P=function(a,e){for(var b=[],c=0;c<a.length;c++){var h=a[c];if(h.actualRowIndex==e){h=h.actualColumnIndex;b.indexOf(h)<0&&b.push(h)}}return b},G=function(a){for(var e=[],b=0;b<a.length;b++){var c=a[b].actualColumnIndex;e.indexOf(c)<0&&e.push(c)}return e},D=function(a,e,b){for(var c=0;c<a.length;c++){var h=a[c];if(h.actualRowIndex==e&&h.actualColumnIndex==b)return true}return false},J=function(a,e,b){var c;if(a.isContentHeightInitialized&&
a.isContentHeightAuto)c=e.length>0?"auto":b.itemHeight+"px";else{var h=a.clientHeight-2;h<0&&(h=0);c=h+"px";if(h<b.itemHeight){if(!a.isContentHeightInitialized)a.isContentHeightAuto=true;c=e.length>0?"auto":b.itemHeight+"px"}a.isContentHeightInitialized=true}return c},x=function(a,e){var b=a.createElement("span");b.innerHTML=e;return b},v=function(a){var e;e=a.getFullYear();var b=a.getMonth()+1;b<10&&(b="0"+b);var c=a.getDate();c<10&&(c="0"+c);e=b+"/"+c+"/"+e;b=a.getHours();b<10&&(b="0"+b.toString());
a=a.getMinutes();a<10&&(a="0"+a.toString());return e+" "+b+":"+a},C=function(a){return Math.ceil(a/36E5*1E4/100)/100+"h"},t=function(a){var e=new Date(Math.floor((new Date).valueOf()/864E5)*864E5),b=new Date,c,h;for(h=0;h<a.length;h++){c=a[h];c.index=h;var j=c.earlyStart,f=c.earlyFinish,g=c.lateStart,d=c.lateFinish;if(typeof c.earlyStart==="undefined")c.earlyStart=e;if(typeof c.earlyFinish==="undefined")c.earlyFinish=typeof c.isMilestone==="undefined"||!c.isMilestone?new Date(e.valueOf()+864E5):c.earlyStart;
if(typeof c.lateStart==="undefined")c.lateStart=e;if(typeof c.lateFinish==="undefined")c.lateFinish=typeof c.isMilestone==="undefined"||!c.isMilestone?new Date(e.valueOf()+864E5):c.lateStart;if(typeof c.isRelativeToTimezone==="undefined"||c.isRelativeToTimezone){c.earlyStart=new Date(c.earlyStart.valueOf()-b.getTimezoneOffset()*6E4);c.earlyFinish=new Date(c.earlyFinish.valueOf()-b.getTimezoneOffset()*6E4);c.lateStart=new Date(c.lateStart.valueOf()-b.getTimezoneOffset()*6E4);c.lateFinish=new Date(c.lateFinish.valueOf()-
b.getTimezoneOffset()*6E4);c.isRelativeToTimezone=false}if(typeof c.effort==="undefined")c.effort=0;if(typeof c.slack==="undefined")c.slack=0;if(typeof c.isMilestone==="undefined")c.isMilestone=false;(typeof j==="undefined"||c.earlyStart.valueOf()!=j.valueOf())&&N(c,"earlyStart",false,true);(typeof f==="undefined"||c.earlyFinish.valueOf()!=f.valueOf())&&N(c,"earlyFinish",false,true);(typeof g==="undefined"||c.lateStart.valueOf()!=g.valueOf())&&N(c,"lateStart",false,true);(typeof d==="undefined"||
c.lateFinish.valueOf()!=d.valueOf())&&N(c,"lateFinish",false,true)}},K=function(a,e){for(var b=0,c=0;c<a.length;c++)b=Math.max(b,a[c].actualColumnIndex);return e.itemWidth+b*(e.itemWidth+e.minDependencyLineLength)+e.diagramMargin*2},E=function(a,e){for(var b=0,c=0;c<a.length;c++)b=Math.max(b,a[c].actualRowIndex);return e.itemHeight+b*(e.itemHeight+e.minDependencyLineLength/e.aspectRatio)+e.diagramMargin*2},H=function(a,e,b,c){for(a=0;a<b.length;a++){var h=b[a],j=F(h,c),f=I(h,c);e.appendChild(V(h,
j,f,c))}},F=function(a,e){if(typeof a.displayedColumnIndex!=="undefined")a.actualColumnIndex=a.displayedColumnIndex;return Math.max(0,e.diagramMargin+a.actualColumnIndex*(e.itemWidth+e.minDependencyLineLength))},I=function(a,e){if(typeof a.displayedRowIndex!=="undefined")a.actualRowIndex=a.displayedRowIndex;return Math.max(0,e.diagramMargin+a.actualRowIndex*(e.itemHeight+e.minDependencyLineLength/e.aspectRatio))},A=function(a){for(var e=[],b,c,h=0;h<a.length;h++){var j=a[h];if(typeof j.predecessors!==
"undefined"&&j.predecessors.length>0)for(var f=0;f<j.predecessors.length;f++){var g=j.predecessors[f].item;if(typeof g!=="undefined"){b=true;for(c=0;c<e;c++)if(g==e[c]){b=false;break}if(b){Q(g.chartItem,g,g.networkDiagramView.settings);b=F(g,g.networkDiagramView.settings);c=I(g,g.networkDiagramView.settings);g.chartItem.setAttribute("transform","translate("+b+", "+c+")");e.push(g)}}}if(typeof j.predecessors!=="undefined"&&j.predecessors.length>0){b=true;for(c=0;c<e;c++)if(typeof j!=="undefined"&&
j==e[c]){b=false;break}if(b){Q(j.chartItem,j,j.networkDiagramView.settings);b=F(j,j.networkDiagramView.settings);c=I(j,j.networkDiagramView.settings);j.chartItem.setAttribute("transform","translate("+b+", "+c+")");e.push(j)}}}},V=function(a,e,b,c){var h=a.networkDiagramView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");a.chartItem=h;h.setAttribute("style","-ms-touch-action: pinch-zoom");h.setAttribute("transform","translate("+e+", "+b+")");Q(h,a,c);return h},Q=function(a,e,b){for(var c=
a.childNodes.length;c-- >0;)a.removeChild(a.childNodes[c]);if(typeof e.isShapeVisible==="undefined"||e.isShapeVisible){c=b.taskTemplate;if(typeof e.taskTemplate!=="undefined")c=e.taskTemplate;c=c(e);a.appendChild(c);if(typeof b.internalExtraTaskTemplate!=="undefined"){var h=b.internalExtraTaskTemplate(e);h!=null&&a.appendChild(h)}if(typeof b.extraTaskTemplate!=="undefined"){h=b.extraTaskTemplate(e);h!=null&&a.appendChild(h)}if(b.isTaskToolTipVisible){h=b.itemTemplate;if(typeof e.template!=="undefined")h=
e.template;c.appendChild(h(e))}if(typeof e.predecessors!=="undefined")for(c=0;c<e.predecessors.length;c++){h=e.predecessors[c];if(!((typeof e.networkDiagramView==="undefined"||e.networkDiagramView.items.indexOf(h.item))<0||typeof h.item.isShapeVisible!=="undefined"&&!h.item.isShapeVisible)){var j=b.dependencyLineTemplate(e,h);j.predecessorIndex=c;a.appendChild(j);if(b.isDependencyToolTipVisible){var f=b.predecessorItemTemplate;if(typeof h.template!=="undefined")f=h.template;j.appendChild(f(e,h))}}}}},
B=function(a){if(typeof a.isWaitingToRefreshChartItem==="undefined"){a.isWaitingToRefreshChartItem=true;setTimeout(function(){Q(a.chartItem,a,a.networkDiagramView.settings);var e=F(a,a.networkDiagramView.settings),b=I(a,a.networkDiagramView.settings);a.chartItem.setAttribute("transform","translate("+e+", "+b+")");delete a.isWaitingToRefreshChartItem},0)}},$=function(a){B(a)},W=function(a){if(typeof a.isWaitingToRefreshPredecessorItems==="undefined"){a.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){A(a.networkDiagramView.items,
a);delete a.isWaitingToRefreshPredecessorItems},0)}},X=function(a){if(typeof a.isWaitingToRefreshChartItem!=="undefined"||typeof a.isWaitingToRefreshPredecessorItems!=="undefined"){typeof a.isWaitingToRefreshChartItem==="undefined"&&B(a);typeof a.isWaitingToRefreshPredecessorItems==="undefined"&&W(a)}else{a.isWaitingToRefreshChartItem=true;a.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){Q(a.chartItem,a,a.networkDiagramView.settings);var e=F(a,a.networkDiagramView.settings),b=I(a,a.networkDiagramView.settings);
a.chartItem.setAttribute("transform","translate("+e+", "+b+")");A(a.networkDiagramView.items,a);delete a.isWaitingToRefreshChartItem;delete a.isWaitingToRefreshPredecessorItems},0)}},aa=function(a){return function(){var e=a.ownerDocument,b=e.createElementNS("http://www.w3.org/2000/svg","defs"),c=e.createElementNS("http://www.w3.org/2000/svg","marker");c.setAttribute("id","ArrowMarker");c.setAttribute("viewBox","0 0 10 10");c.setAttribute("refX","0");c.setAttribute("refY","5");c.setAttribute("markerUnits",
"strokeWidth");c.setAttribute("markerWidth","5");c.setAttribute("markerHeight","4");c.setAttribute("orient","auto");e=e.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("fill","#8080ff");e.setAttribute("d","M 0 0 L 10 5 L 0 10 z");c.appendChild(e);b.appendChild(c);return b}},ba=function(){return function(a){var b=a.networkDiagramView.ownerDocument,f=b.createElementNS("http://www.w3.org/2000/svg","title");f.appendChild(x(b,a.content));return f}},la=function(a){var b=a.networkDiagramView.ownerDocument;
if(typeof a.chartItemArea==="undefined")a.chartItemArea=b.createElementNS("http://www.w3.org/2000/svg","g");for(b=a.chartItemArea.childNodes.length;b-- >0;)a.chartItemArea.removeChild(a.chartItemArea.childNodes[b]);return a.chartItemArea},S=function(a,b,f){return function(c){var h=typeof b!=="undefined"?b:c.networkDiagramView,j=typeof f!=="undefined"?f:h.settings,g=typeof a!=="undefined"?a:h.items,d=h.ownerDocument,n=la(c),o=(j.itemWidth-j.shapeWidth)/2,p=o+j.shapeWidth,s=(j.itemHeight-j.shapeHeight)/
2,r=s+j.shapeHeight,k=0,q=j.shapeHeight,z=j.shapeWidth;if(c.isMilestone){k=z/16;o=o+k;p=p-k;z=z-2*k}if(c.isMilestone){var m=d.createElementNS("http://www.w3.org/2000/svg","polygon");m.setAttribute("points",o+","+s+" "+(o-k)+","+(s+r)/2+" "+o+","+r+" "+p+","+r+" "+(p+k)+","+(s+r)/2+" "+p+","+s);k=j.milestoneClass;if(typeof c.milestoneClass!=="undefined")k=c.milestoneClass;typeof k!=="undefined"&&m.setAttribute("class",k);k=j.milestoneStyle;if(typeof c.milestoneStyle!=="undefined")k=c.milestoneStyle;
typeof k!=="undefined"&&m.setAttribute("style",k);n.appendChild(m)}m=d.createElementNS("http://www.w3.org/2000/svg","rect");m.setAttribute("x",o);m.setAttribute("y",s);m.setAttribute("width",Math.max(0,p-o-1));m.setAttribute("height",Math.max(0,r-s-1));k=j.shapeClass;if(typeof c.shapeClass!=="undefined")k=c.shapeClass;typeof k!=="undefined"&&m.setAttribute("class",k);k=j.shapeStyle;if(typeof c.shapeStyle!=="undefined")k=c.shapeStyle;typeof k!=="undefined"&&m.setAttribute("style",k);n.appendChild(m);
k=d.createElementNS("http://www.w3.org/2000/svg","line");k.setAttribute("x1",o);k.setAttribute("y1",s+q*3/8);k.setAttribute("x2",p-1);k.setAttribute("y2",s+q*3/8);m=j.shapeClass;if(typeof c.shapeClass!=="undefined")m=c.shapeClass;typeof m!=="undefined"&&k.setAttribute("class",m);m=j.shapeStyle;if(typeof c.shapeStyle!=="undefined")m=c.shapeStyle;typeof m!=="undefined"&&k.setAttribute("style",m);n.appendChild(k);k=d.createElementNS("http://www.w3.org/2000/svg","line");k.setAttribute("x1",o);k.setAttribute("y1",
r-q*3/8);k.setAttribute("x2",p-1);k.setAttribute("y2",r-q*3/8);m=j.shapeClass;if(typeof c.shapeClass!=="undefined")m=c.shapeClass;typeof m!=="undefined"&&k.setAttribute("class",m);m=j.shapeStyle;if(typeof c.shapeStyle!=="undefined")m=c.shapeStyle;typeof m!=="undefined"&&k.setAttribute("style",m);n.appendChild(k);k=d.createElementNS("http://www.w3.org/2000/svg","line");k.setAttribute("x1",o+z*3/8);k.setAttribute("y1",s);k.setAttribute("x2",o+z*3/8);k.setAttribute("y2",s+q*3/8);m=j.shapeClass;if(typeof c.shapeClass!==
"undefined")m=c.shapeClass;typeof m!=="undefined"&&k.setAttribute("class",m);m=j.shapeStyle;if(typeof c.shapeStyle!=="undefined")m=c.shapeStyle;typeof m!=="undefined"&&k.setAttribute("style",m);n.appendChild(k);k=d.createElementNS("http://www.w3.org/2000/svg","line");k.setAttribute("x1",p-z*3/8);k.setAttribute("y1",s);k.setAttribute("x2",p-z*3/8);k.setAttribute("y2",s+q*3/8);m=j.shapeClass;if(typeof c.shapeClass!=="undefined")m=c.shapeClass;typeof m!=="undefined"&&k.setAttribute("class",m);m=j.shapeStyle;
if(typeof c.shapeStyle!=="undefined")m=c.shapeStyle;typeof m!=="undefined"&&k.setAttribute("style",m);n.appendChild(k);k=d.createElementNS("http://www.w3.org/2000/svg","line");k.setAttribute("x1",o+z*3/8);k.setAttribute("y1",r);k.setAttribute("x2",o+z*3/8);k.setAttribute("y2",r-q*3/8);m=j.shapeClass;if(typeof c.shapeClass!=="undefined")m=c.shapeClass;typeof m!=="undefined"&&k.setAttribute("class",m);m=j.shapeStyle;if(typeof c.shapeStyle!=="undefined")m=c.shapeStyle;typeof m!=="undefined"&&k.setAttribute("style",
m);n.appendChild(k);k=d.createElementNS("http://www.w3.org/2000/svg","line");k.setAttribute("x1",p-z*3/8);k.setAttribute("y1",r);k.setAttribute("x2",p-z*3/8);k.setAttribute("y2",r-q*3/8);m=j.shapeClass;if(typeof c.shapeClass!=="undefined")m=c.shapeClass;typeof m!=="undefined"&&k.setAttribute("class",m);m=j.shapeStyle;if(typeof c.shapeStyle!=="undefined")m=c.shapeStyle;typeof m!=="undefined"&&k.setAttribute("style",m);n.appendChild(k);m=d.createElementNS("http://www.w3.org/2000/svg","text");m.setAttribute("x",
(o+p)/2);m.setAttribute("y",r-q*3/8-6);m.setAttribute("style","font-weight: bold; text-anchor: middle");k=c.displayedText;typeof k==="undefined"&&(k="");m.appendChild(d.createTextNode(k));n.appendChild(m);var k=function(a){var a=j.dateTimeFormatter(new Date(a.valueOf()+(new Date).getTimezoneOffset()*6E4)),b;b=a.indexOf(" ");if(b>=0){value1=a.substr(0,b);value2=a.substr(b+1)}else{value1=a;value2=""}return[value1,value2]},m=k(c.earlyStart),w=d.createElementNS("http://www.w3.org/2000/svg","text");w.setAttribute("x",
o+z*3/8/2);w.setAttribute("y",r-q*5/8-20);w.setAttribute("style","text-anchor: middle");w.appendChild(d.createTextNode(m[0]));n.appendChild(w);w=d.createElementNS("http://www.w3.org/2000/svg","text");w.setAttribute("x",o+z*3/8/2);w.setAttribute("y",r-q*5/8-4);w.setAttribute("style","text-anchor: middle");w.appendChild(d.createTextNode(m[1]));n.appendChild(w);m=j.timeSpanFormatter(c.effort);w=d.createElementNS("http://www.w3.org/2000/svg","text");w.setAttribute("x",(o+p)/2);w.setAttribute("y",r-q*
5/8-12);w.setAttribute("style","text-anchor: middle");w.appendChild(d.createTextNode(m));n.appendChild(w);m=k(c.earlyFinish);w=d.createElementNS("http://www.w3.org/2000/svg","text");w.setAttribute("x",p-z*3/8/2);w.setAttribute("y",r-q*5/8-20);w.setAttribute("style","text-anchor: middle");w.appendChild(d.createTextNode(m[0]));n.appendChild(w);w=d.createElementNS("http://www.w3.org/2000/svg","text");w.setAttribute("x",p-z*3/8/2);w.setAttribute("y",r-q*5/8-4);w.setAttribute("style","text-anchor: middle");
w.appendChild(d.createTextNode(m[1]));n.appendChild(w);m=k(c.lateStart);q=d.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",o+z*3/8/2);q.setAttribute("y",r-20);q.setAttribute("style","text-anchor: middle");q.appendChild(d.createTextNode(m[0]));n.appendChild(q);q=d.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",o+z*3/8/2);q.setAttribute("y",r-4);q.setAttribute("style","text-anchor: middle");q.appendChild(d.createTextNode(m[1]));n.appendChild(q);m=j.timeSpanFormatter(c.slack);
q=d.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",(o+p)/2);q.setAttribute("y",r-12);q.setAttribute("style","text-anchor: middle");q.appendChild(d.createTextNode(m));n.appendChild(q);m=k(c.lateFinish);q=d.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",p-z*3/8/2);q.setAttribute("y",r-20);q.setAttribute("style","text-anchor: middle");q.appendChild(d.createTextNode(m[0]));n.appendChild(q);q=d.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",
p-z*3/8/2);q.setAttribute("y",r-4);q.setAttribute("style","text-anchor: middle");q.appendChild(d.createTextNode(m[1]));n.appendChild(q);if(j.canUserRearrangeItems){d=d.createElementNS("http://www.w3.org/2000/svg","rect");d.setAttribute("x",o);d.setAttribute("y",s);d.setAttribute("width",Math.max(0,p-o-1));d.setAttribute("height",Math.max(0,r-s-1));d.setAttribute("style","fill: White; fill-opacity: 0; cursor: move");n.appendChild(d);ka(d,c,g,F(c,j),I(c,j),h,j)}return n}},ca=function(a,b){return function(a,
c){var h=a.networkDiagramView,j=typeof b!=="undefined"?b:h.settings,f=h.ownerDocument,h=f.createElementNS("http://www.w3.org/2000/svg","g"),d;d="M ";var g=F(a,j)-2,o=I(a,j)-2,p=F(c.item,j),s=I(c.item,j),r=F(a,j),k=I(a,j),q=Math.abs(r-p),z=Math.abs(k-s),m=j.shapeWidth+2,w=j.shapeHeight+2,v=m/2,t=w/2,x=Math.max(m,w),z=z<x*4;if(q<x)d=s<=k?d+(p+v-g+","+(s+w-o))+(" L "+(r+v-g)+","+(k-o)):d+(p+v-g+","+(s-o))+(" L "+(r+v-g)+","+(k+w-o));else{d=p<=r?d+(p+m-g+","+(s+t-o)):d+(p-g+","+(s+t-o));d=z?p<=r?d+(" L "+
(r-g)+","+(k+t-o)):d+(" L "+(r+m-g)+","+(k+t-o)):s<=k?d+(" L "+(r+v-g)+","+(k-o)):d+(" L "+(r+v-g)+","+(k+w-o))}g=f.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("d",d);typeof j.dependencyLineZoneClass!=="undefined"&&g.setAttribute("class",j.dependencyLineZoneClass);typeof j.dependencyLineZoneStyle!=="undefined"&&g.setAttribute("style",j.dependencyLineZoneStyle);h.appendChild(g);f=f.createElementNS("http://www.w3.org/2000/svg","path");f.setAttribute("d",d);d=j.dependencyLineClass;
if(typeof c.dependencyLineClass!=="undefined")d=c.dependencyLineClass;typeof d!=="undefined"&&f.setAttribute("class",d);j=j.dependencyLineStyle;if(typeof c.dependencyLineStyle!=="undefined")j=c.dependencyLineStyle;typeof j!=="undefined"&&f.setAttribute("style",j);h.appendChild(f);return h}},da=function(){return function(a,b){var f=a.networkDiagramView.ownerDocument,c=f.createElementNS("http://www.w3.org/2000/svg","title");c.appendChild(x(f,b.item.displayedText+" - "+a.displayedText));return c}},N=
function(a,b,f,c){typeof a.networkDiagramView!=="undefined"&&a.networkDiagramView.settings.itemPropertyChangeHandler(a,b,f,c)},ka=function(a,b,f,c,h,j,d){a.addEventListener("mousedown",function(d){if(d.button==0){j.draggingItem=b;j.dragType="Position";j.style.cursor=a.style.cursor;j.draggingInitialX=d.clientX;j.draggingInitialY=d.clientY;j.draggingInitialThumbXPosition=c;j.draggingInitialThumbYPosition=h;d.preventDefault()}},true);if(typeof j.draggableItems==="undefined")j.draggableItems=[];for(var g=
false,n=0;n<j.draggableItems.length;n++)if(j.draggableItems[n]==b){g=true;break}if(!g){j.addEventListener("mousemove",function(a){if(!(typeof j.draggingItem==="undefined"||j.draggingItem!=b||j.dragType!="Position")){var c=a.clientX-j.draggingInitialX,h=a.clientY-j.draggingInitialY;var g=a.clientX;if(typeof j.draggingItem!=="undefined"){var k=j,n=0;if(k.offsetParent){do{n=n+k.offsetLeft;k=k.offsetParent}while(k)}g=g-n;if(g<24){g=j.chartContentContainer.scrollLeft;j.chartContentContainer.scrollLeft=
j.chartContentContainer.scrollLeft-48;g=g-j.chartContentContainer.scrollLeft;if(typeof j.draggingInitialThumbXPosition!=="undefined")j.draggingInitialThumbXPosition=j.draggingInitialThumbXPosition-g}else if(g>=j.chartContentContainer.clientWidth-24){g=j.chartContentContainer.scrollLeft;j.chartContentContainer.scrollLeft=j.chartContentContainer.scrollLeft+48;g=j.chartContentContainer.scrollLeft-g;if(typeof j.draggingInitialThumbXPosition!=="undefined")j.draggingInitialThumbXPosition=j.draggingInitialThumbXPosition+
g}}a=a.clientY;if(typeof j.draggingItem!=="undefined"){g=j;k=0;if(g.offsetParent){do{k=k+g.offsetTop;g=g.offsetParent}while(g)}a=a-k;if(a<24){a=j.chartContentContainer.scrollTop;j.chartContentContainer.scrollTop=j.chartContentContainer.scrollTop-48;a=a-j.chartContentContainer.scrollTop;if(typeof j.draggingInitialThumbYPosition!=="undefined")j.draggingInitialThumbYPosition=j.draggingInitialThumbYPosition-a}else if(a>=j.chartContentContainer.clientHeight-24){a=j.chartContentContainer.scrollTop;j.chartContentContainer.scrollTop=
j.chartContentContainer.scrollTop+48;a=j.chartContentContainer.scrollTop-a;if(typeof j.draggingInitialThumbYPosition!=="undefined")j.draggingInitialThumbYPosition=j.draggingInitialThumbYPosition+a}}delete j.draggingItem;j.draggingInitialThumbXPosition+c<0&&(c=-j.draggingInitialThumbXPosition);j.draggingInitialThumbYPosition+h<0&&(h=-j.draggingInitialThumbYPosition);h=(j.draggingInitialThumbYPosition+h-d.diagramMargin)/(d.itemHeight+d.minDependencyLineLength/d.aspectRatio);d.snapRearrangedItemsToGuidelines&&
(h=Math.round(h));b.actualRowIndex=h;c=(j.draggingInitialThumbXPosition+c-d.diagramMargin)/(d.itemWidth+d.minDependencyLineLength);d.snapRearrangedItemsToGuidelines&&(c=Math.round(c));b.actualColumnIndex=c;N(b,"actualRowIndex",true,false);N(b,"actualColumnIndex",true,false);typeof b.displayedColumnIndex!=="undefined"&&delete b.displayedColumnIndex;typeof b.displayedRowIndex!=="undefined"&&delete b.displayedRowIndex;ma(b,f,j.chartContent,d,false);j.draggingItem=b;j.draggingPerformed=true}},true);document.addEventListener("mouseup",
function(a){if(!(a.button!=0||typeof j.draggingItem==="undefined"||j.draggingItem!=b||j.dragType!="Position")){ma(b,f,j.chartContent,d,true);a=j.draggingItem;delete j.draggingItem;j.style.cursor="default";if(j.draggingPerformed){N(a,"actualColumnIndex",true,true);N(a,"actualRowIndex",true,true);delete j.draggingPerformed}}},true);j.draggableItems.push(b)}},ma=function(a,b,d,c,h){var j=a.networkDiagramView.ownerDocument;if(h){if(typeof d.temporaryRectangle!=="undefined"){j=d.chartArea;j.removeChild(d.temporaryRectangle);
delete d.temporaryRectangle}Q(a.chartItem,a,c);A(b,a);setTimeout(function(){ea(d,b,c,true)},0)}else{if(typeof d.temporaryRectangle!=="undefined")h=d.temporaryRectangle;else{h=j.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("x",0);h.setAttribute("y",0);h.setAttribute("width",c.shapeWidth);h.setAttribute("height",c.shapeHeight);typeof c.temporaryThumbClass!=="undefined"&&h.setAttribute("class",c.temporaryThumbClass);h.setAttribute("style",c.temporaryThumbStyle);d.temporaryRectangle=
h;j=d.chartArea;j.appendChild(h)}j=F(a,c)+(c.itemWidth-c.shapeWidth)/2;a=I(a,c)+(c.itemHeight-c.shapeHeight)/2;h.setAttribute("transform","translate("+j+", "+a+")");setTimeout(function(){ea(d,b,c,false)},0)}},ea=function(a,b,d,c){var h=K(b,d),b=E(b,d);if(c||h>a.clientWidth)a.style.width=h+"px";if(c||b>a.clientHeight)a.style.height=b+"px"},na=function(a,b){for(var d=a.childNodes.length;d-- >0;)a.removeChild(a.childNodes[d]);a.appendChild(b)},fa=function(a,b){for(var d in b)d.indexOf("custom")!=0&&
d.indexOf("description")!=0||typeof a[d]==="undefined"&&(a[d]=b[d])},ha=function(a,b,d,c,h,j,f,g,n){var d={isExport:true,canUserRearrangeItems:false,isTaskToolTipVisible:false,isDependencyToolTipVisible:false,containerClass:n.containerClass,containerStyle:n.containerStyle,border:n.border,theme:n.theme,itemWidth:n.itemWidth,itemHeight:n.itemHeight,aspectRatio:n.aspectRatio,shapeWidth:n.shapeWidth,shapeHeight:n.shapeHeight,shapeClass:n.shapeClass,milestoneClass:n.milestoneClass,shapeStyle:n.shapeStyle,
milestoneStyle:n.milestoneStyle,dependencyLineClass:n.dependencyLineClass,dependencyLineStyle:n.dependencyLineStyle,minDependencyLineLength:n.minDependencyLineLength,diagramMargin:0,target:n.target,dateTimeFormatter:n.dateTimeFormatter,timeSpanFormatter:n.timeSpanFormatter,isRelativeToTimezone:n.isRelativeToTimezone,taskTemplate:n.taskTemplate,dependencyLineTemplate:n.dependencyLineTemplate},n=K(g,d),o=E(g,d);d.chartWidth=n+"px";d.chartHeight=o+"px";var p=n+2,n=o+2,s,r,k=false;if(c!=null&&typeof c.createElement!==
"undefined")s=c;else{if(c!=null&&typeof c.focus!=="undefined")r=c;else{r=window.open("",c!=null?c:"_blank",typeof h!=="undefined"&&h&&(typeof f==="undefined"||f)?"width=320,height=100,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":"");k=true}s=r.document}s.title=typeof a!=="undefined"?a:"Exported diagram"+(typeof h!=="undefined"&&h?" (printable)":"");var a=[],q;for(q=0;q<g.length;q++){c=g[q];o={content:c.content,earlyStart:c.earlyStart,earlyFinish:c.earlyFinish,lateStart:c.lateStart,
lateFinish:c.lateFinish,isMilestone:c.isMilestone,effort:c.effort,slack:c.slack,isShapeVisible:c.isShapeVisible,isRelativeToTimezone:c.isRelativeToTimezone,shapeClass:c.shapeClass,milestoneClass:c.milestoneClass,shapeStyle:c.shapeStyle,milestoneStyle:c.milestoneStyle,displayedRowIndex:c.actualRowIndex,displayedColumnIndex:c.actualColumnIndex,isExported:true};fa(o,c);a.push(o);c.exportItem=o}for(q=0;q<g.length;q++){c=g[q];o=c.exportItem;if(typeof c.predecessors!=="undefined"){o.predecessors=[];for(var v=
0;v<c.predecessors.length;v++){var m=c.predecessors[v];o.predecessors.push({item:m.item.exportItem,dependencyLineClass:m.dependencyLineClass,dependencyLineStyle:m.dependencyLineStyle})}}}var w=s.createElement("p");w.innerHTML=typeof b!=="undefined"?b:"";s.body.appendChild(w);var t=s.createElement("div");t.setAttribute("style","width: "+p+"px; height: "+n+"px");try{DlhSoft.Controls.Pert.NetworkDiagramView.initialize(t,a,d,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch(x){}setTimeout(function(){k&&
s.body.setAttribute("style","margin: 0px");var a=s.createElement("div");a.appendChild(t);s.body.replaceChild(a,w);if(j){a.setAttribute("style","width: "+t.offsetHeight+"px; height: "+p+"px; overflow: hidden");a=Math.round((t.offsetWidth-t.offsetHeight)/2);t.setAttribute("style","width: "+p+"px; transform: rotate(90deg) translateX("+a+"px) translateY("+a+"px); -webkit-transform: rotate(90deg) translateX("+a+"px) translateY("+a+"px)")}s.close();if(typeof r!==void 0){r.focus();if(typeof h!=="undefined"&&
h){r.print();(typeof f==="undefined"||f)&&r.close()}}},0)},Y=function(a,b){var d;a:{for(d=0;d<b.length;d++){var c=b[d];if(typeof c.predecessors==="undefined"||c.predecessors.length==0){d=c;break a}}d=null}if(d==null)return[];var h;a:{for(c=b.length;c-- >0;){h=b[c];if(ja(h).length==0)break a}h=null}if(h==null)return[];c=[d];d=ga(d,h);for(h=0;h<d.length;h++)c.push(d[h]);return c},ia=function(a,b){for(var d=Y(a,b),c=[],h=0;h<d.length;h++){var f=d[h];if(typeof f.predecessors!=="undefined")for(var g=0;g<
f.predecessors.length;g++){var t=f.predecessors[g];typeof t.item!=="undefined"&&d.indexOf(t.item)>=0&&c.push(t)}}return c},ga=function(a,b){if(a==null||b==null||a==b||typeof b.predecessors==="undefined")return[];var d=[],c=[],h,f=null;for(h=0;h<b.predecessors.length;h++){predecessorItem=b.predecessors[h];if(typeof predecessorItem.item!=="undefined"){var g=R(a,predecessorItem.item);if(g!=null){predecessorItem.item.effort>0&&(g=g+predecessorItem.item.effort);if(f==null||g>=f){if(f==null||g>f){f=g;c=
[]}c.push(predecessorItem)}}}}for(h=0;h<c.length;h++){nextPredecessorItem=c[h];f=ga(a,nextPredecessorItem.item);for(g=0;g<f.length;g++)d.push(f[g]);d.push(b)}return d},R=function(a,b){if(a==null||b==null)return null;if(a==b)return 0;for(var d=null,c=ja(a),h=0;h<c.length;h++){var f=c[h],g=R(f.dependentItem,b);if(g!=null){g=g+(typeof f.predecessorItem.item!=="undefined"&&f.predecessorItem.item.effort>0?f.predecessorItem.item.effort:0);g<0&&(g=0);if(d==null||g>d)d=g}}return d},ja=function(a){for(var b=
[],d=a.networkDiagramView.items,c=0;c<d.length;c++){var h=d[c];if(typeof h.predecessors!=="undefined")for(var f=0;f<h.predecessors.length;f++){var g=h.predecessors[f];typeof g.item!=="undefined"&&g.item==a&&b.push({dependentItem:h,predecessorItem:g})}}return b},b=function(a){for(var b=null,d=0;d<a.length;d++)if(b==null||a[d]>b)b=a[d];return b},g=function(a){return typeof a!=="undefined"?new Date(a.valueOf()+a.getTimezoneOffset()*6E4):a},f=function(a){return typeof a!=="undefined"?new Date(a.valueOf()-
a.getTimezoneOffset()*6E4):a},d=function(a,b,d){for(var c=0;c<b.length;c++)b[c].networkDiagramView=a;a.items=b;a.settings=d;a.refresh=function(){M(a)};a.refreshItems=function(){for(var a=0;a<b.length;a++){var c=b[a];B(c);W(c)}};a.refreshChartItems=function(){for(var a=0;a<b.length;a++)B(b[a])};a.refreshItem=$;a.refreshChartItem=B;a.refreshPredecessorItems=W;a.refreshItemGraph=X;a.scrollToItem=function(a){var b=F(a,d),c=b-a.networkDiagramView.chartContentContainer.scrollLeft;if(c<0)a.networkDiagramView.chartContentContainer.scrollLeft=
b;else if(c>a.networkDiagramView.chartContentContainer.clientWidth-a.networkDiagramView.settings.itemWidth)a.networkDiagramView.chartContentContainer.scrollLeft=b-(a.networkDiagramView.chartContentContainer.clientWidth-a.networkDiagramView.settings.itemWidth);b=I(a,d);c=b-a.networkDiagramView.chartContentContainer.scrollTop;if(c<0)a.networkDiagramView.chartContentContainer.scrollTop=b;else if(c>a.networkDiagramView.chartContentContainer.clientHeight-a.networkDiagramView.settings.itemHeight)a.networkDiagramView.chartContentContainer.scrollTop=
b-(a.networkDiagramView.chartContentContainer.clientHeight-a.networkDiagramView.settings.itemHeight)};a.scrollToLeft=function(){a.chartContentContainer.scrollLeft=0};a.scrollToRight=function(){a.chartContentContainer.scrollLeft=a.chartContent.clientWidth};a.scrollToTop=function(){a.chartContentContainer.scrollTop=0};a.scrollToBottom=function(){a.chartContentContainer.scrollTop=a.chartContent.clientHeight};a.getChartWidth=function(){return K(b,d)};a.getChartHeight=function(){return E(b,d)};a.getItemTop=
function(a){return I(a,d)};a.getItemLeft=function(a){return F(a,d)};a.onItemPropertyChanged=N;a.initializeTaskDraggingThumbs=function(b,c,d,e){ka(b,c,a.items,d,e,a,a.settings)};a.exportContent=function(a,c){typeof a==="undefined"&&(a={});ha(a.title,a.preparingMessage,a.isRelativeToTimezone,c,false,a.rotate,false,b,d)};a.print=function(a){typeof a==="undefined"&&(a={});ha(a.title,a.preparingMessage,a.isRelativeToTimezone,null,true,a.rotate,a.autoClose,b,d)};a.isItemCritical=function(a,c){return Y(c,
b).indexOf(a)>=0};a.isDependencyCritical=function(a,c){return ia(c,b).indexOf(a)>=0};a.getCriticalItems=function(a){return Y(a,b)};a.getCriticalDependencies=function(a){return ia(a,b)};a.repositionEnds=function(){if(b.length!=0){for(var a=false,c=0;c<b.length;c++){for(var d=b[c],f=0,g=0;g<b.length;g++){var l=b[g];if(typeof l.predecessors!=="undefined"){for(var p=0;p<l.predecessors.length;p++)if(typeof l.predecessors[p].item!=="undefined"&&l.predecessors[p].item==d){f++;if(f>1)break}if(f>1)break}}f>
1&&(a=true)}c=b[0];c.displayedRowIndex=a?0.5:0;d=b[b.length-1];d.displayedRowIndex=a?0.5:0;X(c);X(d)}};a.getOutputDate=g;a.getInputDate=f};return{initialize:L,initializeItems:U,refresh:M,getDefaultStyleDefinitionTemplate:aa,getDefaultTaskTemplate:S,getDefaultItemTemplate:ba,getDefaultDependencyLineTemplate:ca,getDefaultPredecessorItemTemplate:da,initializeTaskDraggingThumbs:function(a,b,d,c){b.networkDiagramView.initializeTaskDraggingThumbs(a,b,d,c)},defaultDateTimeFormatter:function(a){return v(new Date(a.valueOf()+
(new Date).getTimezoneOffset()*6E4))},defaultTimeSpanFormatter:C,getOutputDate:g,getInputDate:f}}());
