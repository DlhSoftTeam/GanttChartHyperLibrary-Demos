var DlhSoft;"undefined"===typeof DlhSoft&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)});DlhSoft.assemblies.push({assembly:"DlhSoft.ProjectData.PertChart.HTML.Controls",company:"DlhSoft",product:"Project Data Modern Library",version:"5.3.20.0",copyright:"Copyright \u00a9 2012-2023 DlhSoft",title:"Project Data PERT Chart HTML Controls",description:"Project Data PERT Chart related HTML client components"});
DlhSoft.buildReleaseDate=function(l,I,L){l=new Date(l,I-1,L);return l>DlhSoft.buildReleaseDate?l:DlhSoft.buildReleaseDate}(2023,6,14);var _0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{");
void 0==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var l=_0x5c25[1],I=_0x5c25[2],L=[],R=[],Y=_0x5c25[3],S=function(H,A){if(typeof H!==I||typeof A!==I)return!1;if(A==Y)return!0;var M=A[_0x5c25[11]](_0x5c25[10]);if(0<=M){var F=A[_0x5c25[12]](0,M),y,C=F[_0x5c25[11]](_0x5c25[10]);if(0<=C)try{y=new Date(parseInt(F[_0x5c25[12]](C+1)))}catch(x){}typeof y===l&&(y=new Date(2013,11,31));if(DlhSoft[_0x5c25[13]]>y)return!1;F=F+_0x5c25[10]+H;for(i=y=0;i<F[_0x5c25[5]];i++)C=F[_0x5c25[14]](i),y=(y<<5)-
y+C,y&=y;0>y&&(y=Math[_0x5c25[15]](2,32)-y);F=y.toString(16)[_0x5c25[16]]();M=A[_0x5c25[12]](M+1);if(F==M)return!0}return!1},Z=function(H,A,I,F,y){var C=_0x5c25[17],x=_0x5c25[18],J=typeof ComponentSource===l||!ComponentSource?x+_0x5c25[19]+F+_0x5c25[20]+y:_0x5c25[21],L=F+_0x5c25[22]+y+_0x5c25[23],B=_0x5c25[24],G=_0x5c25[25],D=_0x5c25[26];setTimeout(function(){var l=H[_0x5c25[27]],y=l[_0x5c25[29]](_0x5c25[28]);y[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var x=l[_0x5c25[29]](_0x5c25[28]);x[_0x5c25[32]](_0x5c25[30],
_0x5c25[33]);var z=l[_0x5c25[29]](_0x5c25[28]);z[_0x5c25[32]](_0x5c25[30],_0x5c25[34]);x[_0x5c25[35]](z);z[_0x5c25[35]](l[_0x5c25[36]](C));x[_0x5c25[35]](l[_0x5c25[36]](B+_0x5c25[10]));z=l[_0x5c25[29]](_0x5c25[28]);z[_0x5c25[32]](_0x5c25[30],_0x5c25[37]);z[_0x5c25[35]](l[_0x5c25[36]](A));x[_0x5c25[35]](z);x[_0x5c25[35]](l[_0x5c25[36]](G+_0x5c25[10]));z=l[_0x5c25[29]](_0x5c25[28]);z[_0x5c25[32]](_0x5c25[30],_0x5c25[37]);z[_0x5c25[35]](l[_0x5c25[36]](L));x[_0x5c25[35]](z);x[_0x5c25[35]](l[_0x5c25[36]](D+
_0x5c25[10]));z=l[_0x5c25[29]](_0x5c25[28]);z[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var E=l[_0x5c25[29]](_0x5c25[39]);E[_0x5c25[32]](_0x5c25[30],_0x5c25[40]);E[_0x5c25[32]](_0x5c25[41],J);E[_0x5c25[32]](_0x5c25[42],_0x5c25[43]);E[_0x5c25[35]](l[_0x5c25[36]](_0x5c25[44]));z[_0x5c25[35]](E);E=l[_0x5c25[29]](_0x5c25[39]);E[_0x5c25[32]](_0x5c25[30],_0x5c25[45]);E[_0x5c25[32]](_0x5c25[41],_0x5c25[46]);E[_0x5c25[35]](l[_0x5c25[36]](_0x5c25[47]));E[_0x5c25[50]](_0x5c25[48],function(){H[_0x5c25[49]](y);R[_0x5c25[7]](I)},
!1);z[_0x5c25[35]](E);x[_0x5c25[35]](z);y[_0x5c25[35]](x);H[_0x5c25[35]](y)},0);setTimeout(function(){alert(C+_0x5c25[51]+B+_0x5c25[52]+A+_0x5c25[51]+G+_0x5c25[53]+L+_0x5c25[51]+D+_0x5c25[4])},600000)};return{setLicense:function(l,A){L[_0x5c25[7]]({type:l,content:A})},validate:function(H,A,M,F,y,C,x){for(var A=A+_0x5c25[4]+M,J=0;J<R[_0x5c25[5]];J++)if(R[J]==A)return;a:if(typeof C!==I&&typeof x!==l&&(x[_0x5c25[6]]!==l&&(C=x[_0x5c25[6]]),typeof x===I&&(C=x)),typeof C!==I)for(x=0;x<L[_0x5c25[5]];x++)if(J=
L[x],J[_0x5c25[8]]==A&&typeof J[_0x5c25[9]]===I){C=J[_0x5c25[9]];break a}S(A,C)?H[_0x5c25[6]]=C:Z(H,M,A,F,y)}}}());void 0==DlhSoft.Controls&&(DlhSoft.Controls={});void 0==DlhSoft.Controls.Pert&&(DlhSoft.Controls.Pert={});
void 0==DlhSoft.Controls.Pert.PertChartView&&(DlhSoft.Controls.Pert.PertChartView=function(){var l=function(b,e,c,f,a){b.internalEventListeners&&b.internalEventListeners.push({object:e,event:c,handler:f,useCapture:a});return f},I=function(b,e,c,f){var a=["DlhSoft.Controls.Pert","PertChartView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];DlhSoft[a[5]][a[4]](b,a[0],a[1],a[2],a[3],f,c);b.isInitializing=true;if(typeof b.initializedItems!=="undefined"){b.initializedItems.forEach(function(a){a.chartItemArea&&
a.chartItemArea.parentNode&&a.chartItemArea.parentNode.removeChild(a.chartItemArea);delete a.pertChartView;delete a.chartItem;delete a.chartItemArea});typeof b.draggableItems!=="undefined"&&delete b.draggableItems}b.initializedItems=e.slice();b.internalEventListeners&&b.internalEventListeners.forEach(function(a){a.object.removeEventListener(a.event,a.handler,a.useCapture)});b.internalEventListeners=[];if(typeof b.items!=="undefined")for(f=0;f<b.items.length;f++)delete b.items[f].successors;typeof c!==
"object"&&(c={});S(e,c);Y(c,e,b);ja(b,e,c);Z(e);var j=F(b,e,c),m=b.ownerDocument,f=m.createElement("div");f.setAttribute("style","font-family: "+(c.classic?"Arial":"system-ui, Arial")+"; font-size: "+(c.classic?"small":"12px")+"; overflow: auto");a=m.createElement("div");typeof c.containerClass!=="undefined"&&a.setAttribute("class",c.containerClass);typeof c.containerStyle!=="undefined"&&a.setAttribute("style",c.containerStyle);f.appendChild(a);var d=m.createElement("div");d.setAttribute("style",
"border: solid 1px "+c.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden");a.appendChild(d);a=m.createElement("div");a.setAttribute("style","overflow: auto");d.appendChild(a);var g=m.createElement("div");g.setAttribute("style","overflow: "+(typeof c.isExport==="undefined"||!c.isExport?"auto":"hidden")+"; height: "+j);a.appendChild(g);var d=x(e,
c),h=J(e,c),r=m.createElement("div");r.setAttribute("style","float: left; overflow: hidden; width: "+d+"px; height: "+h+"px");g.appendChild(r);j=m.createElementNS("http://www.w3.org/2000/svg","svg");j.setAttribute("style","width: "+d+"px; height: "+h+"px");d=c.styleDefinitionTemplate();j.appendChild(d);j.chartAreaDefinitions=d;d=function(){setTimeout(function(){try{var a=r.chartArea,j=a.chartAreaDefinitions;a.removeChild(j);a.childNodes.length>0?a.insertBefore(j,a.childNodes[0]):a.appendChild(j)}catch(d){}},
0)};j.addEventListener("mousedown",l(b,j,"mousedown",d,true),true);m.addEventListener("mouseup",l(b,m,"mouseup",d,true),true);r.appendChild(j);r.chartArea=j;var v;setTimeout(function(){v=b.clientHeight},0);typeof b.heightUpdateTimer!=="undefined"&&clearInterval(b.heightUpdateTimer);b.heightUpdateTimer=setInterval(function(){try{if(!(b.clientHeight<=0)){var a=b.clientHeight;if(a!=v){var j=F(b,e,c);g.style.height=j;v=a}}}catch(d){try{clearInterval(b.heightUpdateTimer)}catch(m){}}},100);var k=function(a,
j,d,b){var g;if(c.mouseHandler||c.mouseMoveHandler&&b=="mousemove"||c.mouseDownHandler&&b=="mousedown"||c.clickHandler&&b=="click"||c.doubleClickHandler&&b=="dblclick"){var h=a.which;!h&&a.button&&(a.button&1?h=1:a.button&4?h=2:a.button&2&&(h=3));g=d.getBoundingClientRect();var f=m.body,r=m.documentElement,d=g.left+(window.pageXOffset||r.scrollLeft||f.scrollLeft)-(r.clientLeft||f.clientLeft||0);g=Math.round(g.top+(window.pageYOffset||r.scrollTop||f.scrollTop)-(r.clientTop||f.clientTop||0));d=Math.round(d);
d=a.pageX-d;g=a.pageY-g;for(f=0;f<e.length;f++){var r=e[f],k=B(r,c),v=G(r,c);if(d>=k&&d<k+c.itemWidth&&g>=v&&g<v+c.itemHeight){c.mouseHandler&&c.mouseHandler(b,r,h,j,a);c.mouseMoveHandler&&b=="mousemove"&&c.mouseMoveHandler(r);c.mouseDownHandler&&b=="mousedown"&&c.mouseDownHandler(r,h);c.itemClickHandler&&b=="click"&&c.itemClickHandler(r);c.itemDoubleClickHandler&&b=="dblclick"&&c.itemDoubleClickHandler(r)}}}};r.addEventListener("mousemove",l(b,r,"mousemove",function(a){k(a,0,r,"mousemove")}));r.addEventListener("mousedown",
l(b,r,"mousedown",function(a){k(a,1,r,"mousedown")}));r.addEventListener("click",l(b,r,"click",function(a){k(a,1,r,"click")}));r.addEventListener("dblclick",l(b,r,"dblclick",function(a){k(a,2,r,"dblclick")}));r.addEventListener("click",l(b,r,"click",function(a){a.srcElement&&a.srcElement.nodeName!="rect"&&a.stopPropagation()},true),true);r.addEventListener("touchmove",l(b,r,"touchmove",function(a){b.draggingItem&&a.preventDefault()},true),true);r.container=g;b.chartContainer=a;b.chartContent=r;b.chartContentContainer=
g;g.isInitializing=true;ka(b,f);U(r,j,e,c);g.isInitializing=false;b.isInitializing=false;b.isInitialized=true;return b},L=function(b){I(b,b.items,b.settings,b.license)},R=function(b){if(typeof b.timeSpanFormatter==="undefined")b.timeSpanFormatter=C;if(typeof b.itemPropertyChangeHandler==="undefined")b.itemPropertyChangeHandler=function(){};if(typeof b.target==="undefined")b.target="Standard";if(typeof b.theme==="undefined")b.theme="Modern"},Y=function(b,e,c){R(b);if(typeof b.border==="undefined")switch(b.theme){default:b.border=
"#e0e0e0";break;case "ModernBordered":case "Aero":b.border="#9a9a9a"}if(typeof b.canUserRearrangeItems==="undefined")b.canUserRearrangeItems=true;if(typeof b.snapRearrangedItemsToGuidelines==="undefined")b.snapRearrangedItemsToGuidelines=true;if(typeof b.itemWidth==="undefined")b.itemWidth=40;if(typeof b.itemHeight==="undefined")b.itemHeight=40;if(typeof b.aspectRatio==="undefined")b.aspectRatio=1;if(typeof b.shapeWidth==="undefined")b.shapeWidth=32;if(typeof b.shapeHeight==="undefined")b.shapeHeight=
32;if(typeof b.styleDefinitionTemplate==="undefined")b.styleDefinitionTemplate=V(c,b);if(typeof b.dependencyTextBlockWidth==="undefined")b.dependencyTextBlockWidth=120;if(typeof b.shapeStyle==="undefined"&&b.shapeClass==null)b.shapeStyle="fill: White; stroke: #606060; stroke-width: 0.75px";if(typeof b.temporaryThumbStyle==="undefined"&&b.temporaryThumbClass==null)b.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; ";if(typeof b.dependencyLineStyle==="undefined"&&
b.dependencyLineClass==null)b.dependencyLineStyle="stroke: "+(b.classic?"#8080FF":"#3b87d9")+"; stroke-width: 0.65px; fill: none; marker-end: url(#PertArrowMarker)";if(typeof b.virtualEffortDependencyLineStyle==="undefined"&&b.virtualEffortDependencyLineClass==null)b.virtualEffortDependencyLineStyle="stroke: "+(b.classic?"#8080FF":"#3b87d9")+"; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#PertArrowMarker)";if(typeof b.dependencyLineZoneStyle==="undefined"&&b.dependencyLineZoneClass==
null)b.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none";if(typeof b.taskEventTemplate==="undefined")b.taskEventTemplate=$();if(typeof b.dependencyTextStyle==="undefined")b.dependencyTextStyle="color: #606060; text-anchor: middle";if(typeof b.chartMargin==="undefined")b.chartMargin=16;if(typeof b.isTaskEventToolTipVisible==="undefined")switch(b.target){default:b.isTaskEventToolTipVisible=true;break;case "Phone":b.isTaskEventToolTipVisible=false}if(typeof b.itemTemplate===
"undefined")b.itemTemplate=W(b);if(typeof b.dependencyLineTemplate==="undefined")b.dependencyLineTemplate=aa();if(typeof b.isDependencyToolTipVisible==="undefined")b.isDependencyToolTipVisible=b.isTaskEventToolTipVisible;if(typeof b.predecessorItemTemplate==="undefined")b.predecessorItemTemplate=la(b)},S=function(b){for(var e=0;e<b.length;e++){var c=b[e];if(typeof c==="string"){c={content:c};b[e]=c}if(typeof c.predecessors!=="undefined"){if(typeof c.predecessors==="string")c.predecessors=c.predecessors.split(",");
for(var f=0;f<c.predecessors.length;f++){var a=c.predecessors[f];if(typeof a==="string"){a={item:a};c.predecessors[f]=a}if(typeof a.item==="string"){var j=parseInt(a.item)-1;a.item=j>=0&&j<b.length?b[j]:null}if(typeof a.effort==="string")a.effort=parseFloat(a.effort)}}if(typeof c.displayedRowIndex!=="undefined")c.actualRowIndex=c.displayedRowIndex;if(typeof c.displayedColumnIndex!=="undefined")c.actualColumnIndex=c.displayedColumnIndex;if(typeof c.actualRowIndex==="undefined")c.actualRowIndex=0;if(typeof c.actualColumnIndex===
"undefined")c.actualColumnIndex=0}},Z=function(b){b.positionedItems=[];b.maxRowIndex=null;for(var e=0;e<b.length;e++){var c=b[e],f=b;if(typeof c.displayedRowIndex==="undefined"){var a;if(typeof c.predecessors!=="undefined"){a=f.positionedItems;for(var j=[],m=c.predecessors,d=0;d<a.length;d++)for(var g=a[d],h=0;h<m.length;h++)if(m[h].item==g){j.push(g);break}a=j}else a=null;if(a!=null){j=a;m=[];for(d=0;d<j.length;d++){g=j[d].actualRowIndex;m.indexOf(g)<0&&m.push(g)}j=m}else j=null;j=j!=null&&j.length>
0?P(j):f.maxRowIndex!=null?f.maxRowIndex+1:0;m=m=void 0;if(typeof c.displayedColumnIndex==="undefined"){m=H(f.positionedItems,j);m=m.length>0?P(m)+1:0;d=a!=null?H(a,j):null;if(d!=null&&d.length>0){g=null;for(h=0;h<d.length;h++)if(g==null||d[h]<g)g=d[h];d=g+1}else d=null;if(d!=null&&d!=m){j++;a=a!=null?A(a):null;m=a!=null&&a.length>0?P(a)+1:0}for(c.actualColumnIndex=m;M(f.positionedItems,j,m);)j++}else for(;;j++){m=H(f.positionedItems,j);m=m.length>0?P(m)+1:0;if(m<=c.actualColumnIndex)break}c.actualRowIndex=
j}else if(typeof c.displayedColumnIndex==="undefined"){a=A(f.positionedItems);c.actualColumnIndex=a.length>0?P(a)+1:0}f.positionedItems.push(c);if(f.maxRowIndex==null||c.actualRowIndex>f.maxRowIndex)f.maxRowIndex=c.actualRowIndex}},H=function(b,e){for(var c=[],f=0;f<b.length;f++){var a=b[f];if(a.actualRowIndex==e){a=a.actualColumnIndex;c.indexOf(a)<0&&c.push(a)}}return c},A=function(b){for(var e=[],c=0;c<b.length;c++){var f=b[c].actualColumnIndex;e.indexOf(f)<0&&e.push(f)}return e},M=function(b,e,
c){for(var f=0;f<b.length;f++){var a=b[f];if(a.actualRowIndex==e&&a.actualColumnIndex==c)return true}return false},F=function(b,e,c){var f;if(b.isContentHeightInitialized&&b.isContentHeightAuto)f=e.length>0?"auto":c.itemHeight+"px";else{var a=b.clientHeight-2;a<0&&(a=0);f=a+"px";if(a<c.itemHeight){if(!b.isContentHeightInitialized)b.isContentHeightAuto=true;f=e.length>0?"auto":c.itemHeight+"px"}b.isContentHeightInitialized=true}return f},y=function(b,e){var c=b.createElement("span");c.innerHTML=e;
return c},C=function(b){return Math.ceil(b/3600000*10000/100)/100+"h"},x=function(b,e){for(var c=0,f=0;f<b.length;f++)c=Math.max(c,b[f].actualColumnIndex);return e.itemWidth+c*(e.itemWidth+e.dependencyTextBlockWidth)+e.chartMargin*2},J=function(b,e){for(var c=0,f=0;f<b.length;f++)c=Math.max(c,b[f].actualRowIndex);return e.itemHeight+c*(e.itemHeight+e.dependencyTextBlockWidth/e.aspectRatio)+e.chartMargin*2},U=function(b,e,c,f){for(b=0;b<c.length;b++){var a=c[b],j=B(a,f),m=G(a,f);e.appendChild(K(a,
j,m,f))}},B=function(b,e){if(typeof b.displayedColumnIndex!=="undefined")b.actualColumnIndex=b.displayedColumnIndex;return Math.max(0,e.chartMargin+b.actualColumnIndex*(e.itemWidth+e.dependencyTextBlockWidth))},G=function(b,e){if(typeof b.displayedRowIndex!=="undefined")b.actualRowIndex=b.displayedRowIndex;return Math.max(0,e.chartMargin+b.actualRowIndex*(e.itemHeight+e.dependencyTextBlockWidth/e.aspectRatio))},D=function(b){for(var e=[],c,f,a=0;a<b.length;a++){var j=b[a];if(typeof j.predecessors!==
"undefined"&&j.predecessors.length>0)for(var m=0;m<j.predecessors.length;m++){var d=j.predecessors[m].item;if(typeof d!=="undefined"){c=true;for(f=0;f<e;f++)if(d==e[f]){c=false;break}if(c){O(d.chartItem,d,d.pertChartView.settings);c=B(d,d.pertChartView.settings);f=G(d,d.pertChartView.settings);d.chartItem.setAttribute("transform","translate("+c+", "+f+")");e.push(d)}}}if(typeof j.predecessors!=="undefined"&&j.predecessors.length>0){c=true;for(f=0;f<e;f++)if(typeof j!=="undefined"&&j==e[f]){c=false;
break}if(c){O(j.chartItem,j,j.pertChartView.settings);c=B(j,j.pertChartView.settings);f=G(j,j.pertChartView.settings);j.chartItem.setAttribute("transform","translate("+c+", "+f+")");e.push(j)}}}},K=function(b,e,c,f){var a=b.pertChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");b.chartItem=a;a.setAttribute("style","-ms-touch-action: pinch-zoom; touch-action: pinch-zoom");a.setAttribute("transform","translate("+e+", "+c+")");O(a,b,f);return a},O=function(b,e,c){for(var f=b.childNodes.length;f-- >
0;)b.removeChild(b.childNodes[f]);if(typeof e.isShapeVisible==="undefined"||e.isShapeVisible){f=c.taskEventTemplate;if(typeof e.taskEventTemplate!=="undefined")f=e.taskEventTemplate;f=f(e);b.appendChild(f);if(typeof c.internalExtraTaskTemplate!=="undefined"){var a=c.internalExtraTaskTemplate(e);a!=null&&b.appendChild(a)}if(typeof c.extraTaskEventTemplate!=="undefined"){a=c.extraTaskEventTemplate(e);a!=null&&b.appendChild(a)}if(c.isTaskEventToolTipVisible){a=c.itemTemplate;if(typeof e.template!=="undefined")a=
e.template;f.appendChild(a(e))}if(typeof e.predecessors!=="undefined")for(f=0;f<e.predecessors.length;f++){a=e.predecessors[f];if(!((typeof e.pertChartView==="undefined"||e.pertChartView.items.indexOf(a.item))<0)){var j=c.dependencyLineTemplate(e,a);j.predecessorIndex=f;(function(a){j.addEventListener("click",l(e.pertChartView,j,"click",function(j){c.dependencyLineClickHandler&&c.dependencyLineClickHandler(a,e,j)}));j.addEventListener("dblclick",l(e.pertChartView,j,"dblclick",function(j){c.dependencyLineDoubleClickHandler&&
c.dependencyLineDoubleClickHandler(a,e,j)}))})(a);b.appendChild(j);if(c.isDependencyToolTipVisible){var m=c.predecessorItemTemplate;if(typeof a.template!=="undefined")m=a.template;j.appendChild(m(e,a))}}}}},T=function(b){if(typeof b.isWaitingToRefreshChartItem==="undefined"){b.isWaitingToRefreshChartItem=true;setTimeout(function(){O(b.chartItem,b,b.pertChartView.settings);var e=B(b,b.pertChartView.settings),c=G(b,b.pertChartView.settings);b.chartItem.setAttribute("transform","translate("+e+", "+c+
")");delete b.isWaitingToRefreshChartItem},0)}},z=function(b){T(b)},E=function(b){if(typeof b.isWaitingToRefreshPredecessorItems==="undefined"){b.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){D(b.pertChartView.items,b);delete b.isWaitingToRefreshPredecessorItems},0)}},ba=function(b){if(typeof b.isWaitingToRefreshChartItem!=="undefined"||typeof b.isWaitingToRefreshPredecessorItems!=="undefined"){typeof b.isWaitingToRefreshChartItem==="undefined"&&T(b);typeof b.isWaitingToRefreshPredecessorItems===
"undefined"&&E(b)}else{b.isWaitingToRefreshChartItem=true;b.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){O(b.chartItem,b,b.pertChartView.settings);var e=B(b,b.pertChartView.settings),c=G(b,b.pertChartView.settings);b.chartItem.setAttribute("transform","translate("+e+", "+c+")");D(b.pertChartView.items,b);delete b.isWaitingToRefreshChartItem;delete b.isWaitingToRefreshPredecessorItems},0)}},V=function(b,e){return function(){var c=b.ownerDocument,f=c.createElementNS("http://www.w3.org/2000/svg",
"defs"),a=c.createElementNS("http://www.w3.org/2000/svg","marker");a.setAttribute("id","PertArrowMarker");a.setAttribute("viewBox","0 0 10 10");a.setAttribute("refX","0");a.setAttribute("refY","5");a.setAttribute("markerUnits","strokeWidth");a.setAttribute("markerWidth","5");a.setAttribute("markerHeight","4");a.setAttribute("orient","auto");c=c.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d","M 0 0 L 10 5 L 0 10 z");c.setAttribute("fill",e.arrowFill?e.arrowFill:e.theme=="Aero"?
"Blue":"#8080ff");a.appendChild(c);f.appendChild(a);return f}},W=function(){return function(b){var e=b.pertChartView.ownerDocument,c=e.createElementNS("http://www.w3.org/2000/svg","title");c.appendChild(y(e,typeof b.content!=="undefined"?b.content:""));return c}},$=function(b,e,c){return function(f){var a=typeof e!=="undefined"?e:f.pertChartView,j=typeof c!=="undefined"?c:a.settings,m=typeof b!=="undefined"?b:a.items,d=a.ownerDocument,g;g=f.pertChartView.ownerDocument;if(typeof f.chartItemArea===
"undefined")f.chartItemArea=g.createElementNS("http://www.w3.org/2000/svg","g");for(g=f.chartItemArea.childNodes.length;g-- >0;)f.chartItemArea.removeChild(f.chartItemArea.childNodes[g]);g=f.chartItemArea;var h=(j.itemWidth-j.shapeWidth)/2,r=h+j.shapeWidth,v=(j.itemHeight-j.shapeHeight)/2,k=v+j.shapeHeight,u=j.shapeHeight,o,s=d.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("x",h);s.setAttribute("y",v);s.setAttribute("width",Math.max(0,r-h-1));s.setAttribute("height",Math.max(0,
k-v-1));s.setAttribute("rx",j.shapeWidth/10);s.setAttribute("ry",j.shapeHeight/10);o=j.shapeClass;if(typeof f.shapeClass!=="undefined")o=f.shapeClass;if(typeof o!=="undefined")s.setAttribute("class",o);else{o=j.shapeStyle;if(typeof f.shapeStyle!=="undefined")o=f.shapeStyle;typeof o!=="undefined"&&s.setAttribute("style",o)}g.appendChild(s);s=d.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("x",(h+r)/2);s.setAttribute("y",k-u*1.5/8-6);s.setAttribute("style","font-weight: bold; text-anchor: middle");
u=f.displayedText;typeof u==="undefined"&&(u="");s.appendChild(d.createTextNode(u));g.appendChild(s);if(j.canUserRearrangeItems){d=d.createElementNS("http://www.w3.org/2000/svg","rect");d.setAttribute("x",h);d.setAttribute("y",v);d.setAttribute("width",Math.max(0,r-h-1));d.setAttribute("height",Math.max(0,k-v-1));d.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer");g.appendChild(d);ca(d,f,m,B(f,j),G(f,j),a,j)}return g}},aa=function(b,e){return function(b,f){var a=b.pertChartView,
j=typeof e!=="undefined"?e:a.settings,a=a.ownerDocument,m=a.createElementNS("http://www.w3.org/2000/svg","g"),d=void 0,g=void 0,h,r="M ",d=B(b,j)-2,g=G(b,j)-2,v=B(f.item,j);h=G(f.item,j);var k=B(b,j),u=G(b,j),o=Math.abs(k-v),s=Math.abs(u-h),t=j.shapeWidth+2,n=j.shapeHeight+2,q=t/2,w=n/2,p=Math.max(t,n),s=s<p*4;if(o<p)r=h<=u?r+(v+q-d+","+(h+n-g))+(" L "+(k+q-d)+","+(u-g)):r+(v+q-d+","+(h-g))+(" L "+(k+q-d)+","+(u+n-g));else{r=v<=k?r+(v+t-d+","+(h+w-g)):r+(v-d+","+(h+w-g));r=s?v<=k?r+(" L "+(k-d)+","+
(u+w-g)):r+(" L "+(k+t-d)+","+(u+w-g)):h<=u?r+(" L "+(k+q-d)+","+(u-g)):r+(" L "+(k+q-d)+","+(u+n-g))}d=((v<=k?v:k)+(v>=k?v:k))/2+q-d;g=((h<=u?h:u)+(h>=u?h:u))/2+w-g;h=r;r=a.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d",h);typeof j.dependencyLineZoneClass!=="undefined"&&r.setAttribute("class",j.dependencyLineZoneClass);typeof j.dependencyLineZoneStyle!=="undefined"&&r.setAttribute("style",j.dependencyLineZoneStyle);m.appendChild(r);r=a.createElementNS("http://www.w3.org/2000/svg",
"path");r.setAttribute("d",h);if(typeof f.isEffortVirtual!=="undefined"?!f.isEffortVirtual:typeof f.effort!=="undefined"&&f.effort>0){h=j.dependencyLineClass;if(typeof f.dependencyLineClass!=="undefined")h=f.dependencyLineClass;typeof h!=="undefined"&&r.setAttribute("class",h);h=j.dependencyLineStyle;if(typeof f.dependencyLineStyle!=="undefined")h=f.dependencyLineStyle}else{h=j.virtualEffortDependencyLineClass;if(typeof f.virtualEffortDependencyLineClass!=="undefined")h=f.virtualEffortDependencyLineClass;
typeof h!=="undefined"&&r.setAttribute("class",h);h=j.virtualEffortDependencyLineStyle;if(typeof f.virtualEffortDependencyLineStyle!=="undefined")h=f.virtualEffortDependencyLineStyle}typeof h!=="undefined"&&r.setAttribute("style",h);m.appendChild(r);r=a.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("x",d);r.setAttribute("y",g-6);g=j.dependencyTextClass;if(typeof f.dependencyTextClass!=="undefined")g=f.dependencyTextClass;typeof g!=="undefined"&&r.setAttribute("class",g);j=j.dependencyTextStyle;
if(typeof f.dependencyTextStyle!=="undefined")j=f.dependencyTextStyle;r.setAttribute("style",j);j=f.displayedText;typeof j==="undefined"&&(j="");r.appendChild(a.createTextNode(j));m.appendChild(r);return m}},la=function(){return function(b,e){var c=b.pertChartView.ownerDocument,f=c.createElementNS("http://www.w3.org/2000/svg","title");f.appendChild(y(c,typeof e.content!=="undefined"?e.content:""));return f}},Q=function(b,e,c,f){typeof b.pertChartView!=="undefined"&&b.pertChartView.settings.itemPropertyChangeHandler(b,
e,c,f)},ca=function(b,e,c,f,a,j,m){function d(d){j.draggingItem=e;j.dragType="Position";j.style.cursor=b.style.cursor;j.draggingInitialX=d.clientX;j.draggingInitialY=d.clientY;j.draggingInitialThumbXPosition=f;j.draggingInitialThumbYPosition=a}b.addEventListener("mousedown",l(j,b,"mousedown",function(a){if(a.button==0){d(a);a.preventDefault()}},true),true);b.addEventListener("touchstart",l(j,b,"touchstart",function(a){d(a.touches[0]);a.preventDefault()},true),true);if(typeof j.draggableItems==="undefined")j.draggableItems=
[];for(var g=false,h=0;h<j.draggableItems.length;h++)if(j.draggableItems[h]==e){g=true;break}if(!g){var r=function(a){if(!(typeof j.draggingItem==="undefined"||j.draggingItem!=e||j.dragType!="Position")){var d=a.clientX-j.draggingInitialX,b=a.clientY-j.draggingInitialY;var g=a.clientX,h=j;if(typeof h.draggingItem!=="undefined"){var f=new Date;if(!h.lastXDraggingTime||!(f>h.lastXDraggingTime&&f-h.lastXDraggingTime<200)){h.lastXDraggingTime=f;var f=h,r=0;if(f.offsetParent){do{r=r+f.offsetLeft;f=f.offsetParent}while(f)
}g=g-r;if(g<24){g=h.chartContentContainer.scrollLeft;h.chartContentContainer.scrollLeft=h.chartContentContainer.scrollLeft-48;g=g-h.chartContentContainer.scrollLeft;if(typeof h.draggingInitialThumbXPosition!=="undefined")h.draggingInitialThumbXPosition=h.draggingInitialThumbXPosition-g}else if(g>=h.chartContentContainer.clientWidth-24){g=h.chartContentContainer.scrollLeft;h.chartContentContainer.scrollLeft=h.chartContentContainer.scrollLeft+48;g=h.chartContentContainer.scrollLeft-g;if(typeof h.draggingInitialThumbXPosition!==
"undefined")h.draggingInitialThumbXPosition=h.draggingInitialThumbXPosition+g}}}h=a.clientY;a=j;if(typeof a.draggingItem!=="undefined"){g=new Date;if(!a.lastYDraggingTime||!(g>a.lastYDraggingTime&&g-a.lastYDraggingTime<200)){a.lastYDraggingTime=g;g=a;f=0;if(g.offsetParent){do{f=f+g.offsetTop;g=g.offsetParent}while(g)}h=h-f;if(h<24){h=a.chartContentContainer.scrollTop;a.chartContentContainer.scrollTop=a.chartContentContainer.scrollTop-48;h=h-a.chartContentContainer.scrollTop;if(typeof a.draggingInitialThumbYPosition!==
"undefined")a.draggingInitialThumbYPosition=a.draggingInitialThumbYPosition-h}else if(h>=a.chartContentContainer.clientHeight-24){h=a.chartContentContainer.scrollTop;a.chartContentContainer.scrollTop=a.chartContentContainer.scrollTop+48;h=a.chartContentContainer.scrollTop-h;if(typeof a.draggingInitialThumbYPosition!=="undefined")a.draggingInitialThumbYPosition=a.draggingInitialThumbYPosition+h}}}delete j.draggingItem;j.draggingInitialThumbXPosition+d<0&&(d=-j.draggingInitialThumbXPosition);j.draggingInitialThumbYPosition+
b<0&&(b=-j.draggingInitialThumbYPosition);a=e;b=(j.draggingInitialThumbYPosition+b-m.chartMargin)/(m.itemHeight+m.dependencyTextBlockWidth/m.aspectRatio);m.snapRearrangedItemsToGuidelines&&(b=Math.round(b));a.actualRowIndex=b;b=e;d=(j.draggingInitialThumbXPosition+d-m.chartMargin)/(m.itemWidth+m.dependencyTextBlockWidth);m.snapRearrangedItemsToGuidelines&&(d=Math.round(d));b.actualColumnIndex=d;Q(e,"actualRowIndex",true,false);Q(e,"actualColumnIndex",true,false);typeof e.displayedColumnIndex!=="undefined"&&
delete e.displayedColumnIndex;typeof e.displayedRowIndex!=="undefined"&&delete e.displayedRowIndex;da(e,c,j.chartContent,m,false);j.draggingItem=e;j.draggingPerformed=true}};j.addEventListener("mousemove",l(j,j,"mousemove",function(a){r(a)},true),true);j.addEventListener("touchmove",l(j,j,"touchmove",function(a){r(a.touches[0])},true),true);var v=function(){if(!(typeof j.draggingItem==="undefined"||j.draggingItem!=e||j.dragType!="Position")){da(e,c,j.chartContent,m,true);var a=j.draggingItem;delete j.draggingItem;
j.style.cursor="default";if(j.draggingPerformed){Q(a,"actualColumnIndex",true,true);Q(a,"actualRowIndex",true,true);delete j.draggingPerformed}}};document.addEventListener("mouseup",l(j,document,"mouseup",function(a){a.button==0&&v()},true),true);document.addEventListener("touchend",l(j,document,"touchend",function(){v()},true),true);j.draggableItems.push(e)}},da=function(b,e,c,f,a){var j=b.pertChartView.ownerDocument;if(a){if(typeof c.temporaryRectangle!=="undefined"){a=c.chartArea;a.removeChild(c.temporaryRectangle);
delete c.temporaryRectangle}setTimeout(function(){O(b.chartItem,b,f);m=B(b,f);d=G(b,f);b.chartItem.setAttribute("transform","translate("+m+", "+d+")");D(e,b);setTimeout(function(){N(c,e,f,true)},0)})}else{if(typeof c.temporaryRectangle!=="undefined")j=c.temporaryRectangle;else{j=j.createElementNS("http://www.w3.org/2000/svg","rect");j.setAttribute("x",0);j.setAttribute("y",0);j.setAttribute("width",f.shapeWidth);j.setAttribute("height",f.shapeHeight);j.setAttribute("rx",f.shapeWidth/10);j.setAttribute("ry",
f.shapeHeight/10);typeof f.temporaryThumbClass!=="undefined"&&j.setAttribute("class",f.temporaryThumbClass);j.setAttribute("style",f.temporaryThumbStyle);c.temporaryRectangle=j;a=c.chartArea;a.appendChild(j)}var m=B(b,f)+(f.itemWidth-f.shapeWidth)/2,d=G(b,f)+(f.itemHeight-f.shapeHeight)/2;j.setAttribute("transform","translate("+m+", "+d+")");setTimeout(function(){N(c,e,f,false)},0)}},N=function(b,e,c,f){var a=x(e,c),e=J(e,c);if(f||a>b.clientWidth)b.style.width=a+"px";if(f||e>b.clientHeight)b.style.height=
e+"px";b=b.chartArea;f?b.setAttribute("style","width: "+a+"px; height: "+e+"px"):b.setAttribute("style","width: "+Math.max(b.clientWidth,a)+"px; height: "+Math.max(b.clientHeight,e)+"px")},ka=function(b,e){for(var c=b.childNodes.length;c-- >0;)b.removeChild(b.childNodes[c]);b.appendChild(e)},ma=function(b,e){for(var c in e)c.indexOf("custom")!=0&&c.indexOf("description")!=0||typeof b[c]==="undefined"&&(b[c]=e[c])},ea=function(b,e,c,f,a,j,m,d){var d={isExport:true,canUserRearrangeItems:false,isTaskEventToolTipVisible:false,
isDependencyToolTipVisible:false,containerClass:d.containerClass,containerStyle:d.containerStyle,border:d.border,theme:d.theme,itemWidth:d.itemWidth,itemHeight:d.itemHeight,aspectRatio:d.aspectRatio,shapeWidth:d.shapeWidth,shapeHeight:d.shapeHeight,shapeClass:d.shapeClass,shapeStyle:d.shapeStyle,shapeCornerRadius:d.shapeCornerRadius,dependencyTextStyle:d.dependencyTextStyle,dependencyLineClass:d.dependencyLineClass,dependencyLineStyle:d.dependencyLineStyle,virtualEffortDependencyLineClass:d.virtualEffortDependencyLineClass,
virtualEffortDependencyLineStyle:d.virtualEffortDependencyLineStyle,dependencyTextBlockWidth:d.dependencyTextBlockWidth,chartMargin:0,target:d.target,timeSpanFormatter:d.timeSpanFormatter,taskEventTemplate:d.taskEventTemplate,dependencyLineTemplate:d.dependencyLineTemplate,classic:d.classic},g=x(m,d),h=J(m,d);d.chartWidth=g+"px";d.chartHeight=h+"px";var r=g+2,g=h+2,v,k,u=false;if(c!=null&&typeof c.createElement!=="undefined")v=c;else{if(c!=null&&typeof c.focus!=="undefined")k=c;else{k=window.open("",
c!=null?c:"_blank",typeof f!=="undefined"&&f&&(typeof j==="undefined"||j)?"width=800,height=480,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":"");u=true}v=k.document;try{for(var o=document.head.getElementsByTagName("link"),c=0;c<o.length;c++){var s=o[c],t=v.adoptNode(s.cloneNode(true));t.href=s.href;v.head.appendChild(t)}}catch(n){}}v.title=typeof b!=="undefined"?b:"Exported chart"+(typeof f!=="undefined"&&f?" (printable)":"");b=[];for(c=0;c<m.length;c++){o=m[c];s={content:o.content,
displayedText:o.displayedText,isShapeVisible:o.isShapeVisible,shapeClass:o.shapeClass,shapeStyle:o.shapeStyle,dependencyTextStyle:o.dependencyTextStyle,displayedRowIndex:o.actualRowIndex,displayedColumnIndex:o.actualColumnIndex,isExported:true};ma(s,o);b.push(s);o.exportItem=s}for(c=0;c<m.length;c++){o=m[c];s=o.exportItem;if(typeof o.predecessors!=="undefined"){s.predecessors=[];for(t=0;t<o.predecessors.length;t++){h=o.predecessors[t];s.predecessors.push({item:h.item.exportItem,content:h.content,
displayedText:h.displayedText,effort:h.effort,isEffortVirtual:h.isEffortVirtual,dependencyLineClass:h.dependencyLineClass,dependencyLineStyle:h.dependencyLineStyle,virtualEffortDependencyLineClass:h.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:h.virtualEffortDependencyLineStyle,dependencyTextStyle:h.dependencyTextStyle})}}}var q=v.createElement("p");q.innerHTML=typeof e!=="undefined"?e:"";v.body.appendChild(q);var w=v.createElement("div");w.setAttribute("style","width: "+r+"px; height: "+
g+"px");try{DlhSoft.Controls.Pert.PertChartView.initialize(w,b,d,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch(p){}setTimeout(function(){u&&v.body.setAttribute("style","margin: 0px");var d=v.createElement("div");d.appendChild(w);v.body.replaceChild(d,q);if(a){d.setAttribute("style","width: "+w.offsetHeight+"px; height: "+r+"px; overflow: hidden");d=Math.round((w.offsetWidth-w.offsetHeight)/2);w.setAttribute("style",
"width: "+r+"px; transform: rotate(90deg) translateX("+d+"px) translateY("+d+"px); -webkit-transform: rotate(90deg) translateX("+d+"px) translateY("+d+"px)")}v.close();if(typeof k!==void 0){k.focus();typeof f!=="undefined"&&f&&setTimeout(function(){k.print();(typeof j==="undefined"||j)&&setTimeout(function(){k.close()})})}},0)},na=function(b,e){for(var c=0;c<e.length;c++){var f=e[c];delete f.successorInfo;delete f.effortInfo}typeof b==="undefined"&&(b=0);c=X(e);if(c==null)return[];for(var c=[c],f=
fa(b,e),a=0;a<f.length;a++)c.push(f[a].dependentItem);return c},fa=function(b,e){for(var c=0;c<e.length;c++){var f=e[c];delete f.successorInfo;delete f.effortInfo}var a=X(e);if(a==null)return[];a:{for(c=e.length;c-- >0;){f=e[c];if(ga(f).length==0){c=f;break a}}c=null}if(c==null)return[];c=ha(a,c);a=[];for(f=0;f<c.length;f++)a.push(c[f]);for(c=0;c<e.length;c++){f=e[c];delete f.successorInfo;delete f.effortInfo}return a},ha=function(b,e){if(b==null||e==null||b==e||typeof e.predecessors==="undefined")return[];
var c=[],f=[],a,j=null;for(a=0;a<e.predecessors.length;a++){predecessorItem=e.predecessors[a];predecessorItem.dependentItem=e;if(typeof predecessorItem.item!=="undefined"){var m=ia(b,predecessorItem.item);if(m!=null){if((typeof predecessorItem.isEffortVirtual==="undefined"||!predecessorItem.isEffortVirtual)&&predecessorItem.effort>0)m=m+predecessorItem.effort;if(j==null||m>=j){if(j==null||m>j){j=m;f=[]}f.push(predecessorItem)}}}}for(a=0;a<f.length;a++){for(var j=f[a],m=ha(b,j.item),d=0;d<m.length;d++)c.push(m[d]);
c.push(j)}return c},X=function(b){for(var e=0;e<b.length;e++){var c=b[e];if(typeof c.predecessors==="undefined"||c.predecessors.length==0)return c}return null},ia=function(b,e){if(b==null||e==null)return null;if(b==e)return 0;if(!b.effortInfo)b.effortInfo={};var c=e.index.toString();if(typeof b.effortInfo[c]!=="undefined")return b.effortInfo[c];for(var f=null,a=ga(b),j=0;j<a.length;j++){var m=a[j],d=ia(m.dependentItem,e);if(d!=null){d=d+((typeof predecessorItem.isEffortVirtual==="undefined"||!predecessorItem.isEffortVirtual)&&
m.predecessorItem.effort>0?m.predecessorItem.effort:0);d<0&&(d=0);if(f==null||d>f)f=d}}f!=null&&(b.effortInfo[c]=f);return f},ga=function(b){if(b.successorInfo)return b.successorInfo;for(var e=[],c=b.pertChartView.items,f=0;f<c.length;f++){var a=c[f];if(typeof a.predecessors!=="undefined")for(var j=0;j<a.predecessors.length;j++){var m=a.predecessors[j];typeof m.item!=="undefined"&&m.item==b&&e.push({dependentItem:a,predecessorItem:m})}}return b.successorInfo=e},P=function(b){for(var e=null,c=0;c<
b.length;c++)if(e==null||b[c]>e)e=b[c];return e},ja=function(b,e,c){for(var f=0;f<e.length;f++){e[f].pertChartView=b;e[f].index=f}b.items=e;b.settings=c;b.refresh=function(){L(b)};b.refreshItems=function(){for(var a=0;a<e.length;a++){var j=e[a];T(j);E(j)}};b.refreshChartItems=function(){for(var a=0;a<e.length;a++)T(e[a])};b.refreshItem=z;b.refreshChartItem=T;b.refreshPredecessorItems=E;b.refreshItemGraph=ba;b.scrollToItem=function(a){var j=B(a,c),b=j-a.pertChartView.chartContentContainer.scrollLeft;
if(b<0)a.pertChartView.chartContentContainer.scrollLeft=j;else if(b>a.pertChartView.chartContentContainer.clientWidth-a.pertChartView.settings.itemWidth)a.pertChartView.chartContentContainer.scrollLeft=j-(a.pertChartView.chartContentContainer.clientWidth-a.pertChartView.settings.itemWidth);j=G(a,c);b=j-a.pertChartView.chartContentContainer.scrollTop;if(b<0)a.pertChartView.chartContentContainer.scrollTop=j;else if(b>a.pertChartView.chartContentContainer.clientHeight-a.pertChartView.settings.itemHeight)a.pertChartView.chartContentContainer.scrollTop=
j-(a.pertChartView.chartContentContainer.clientHeight-a.pertChartView.settings.itemHeight)};b.scrollToLeft=function(){b.chartContentContainer.scrollLeft=0};b.scrollToRight=function(){b.chartContentContainer.scrollLeft=b.chartContent.clientWidth};b.scrollToTop=function(){b.chartContentContainer.scrollTop=0};b.scrollToBottom=function(){b.chartContentContainer.scrollTop=b.chartContent.clientHeight};b.getChartWidth=function(){return x(e,c)};b.getChartHeight=function(){return J(e,c)};b.getItemTop=function(a){return G(a,
c)};b.getItemLeft=function(a){return B(a,c)};b.onItemPropertyChanged=Q;b.initializeTasEventkDraggingThumbs=function(a,j,m,d){ca(a,j,b.items,m,d,b,b.settings)};b.exportContent=function(a,j){typeof a==="undefined"&&(a={});ea(a.title,a.preparingMessage,j,false,a.rotate,false,e,c)};b.print=function(a){typeof a==="undefined"&&(a={});ea(a.title,a.preparingMessage,null,true,a.rotate,a.autoClose,e,c)};b.isItemCritical=function(a,j){return na(j,e).indexOf(a)>=0};b.isDependencyCritical=function(a,j){return fa(j,
e).indexOf(a)>=0};b.getCriticalItems=function(a){return na(a,e)};b.getCriticalDependencies=function(a){return fa(a,e)};b.repositionEnds=function(){if(e.length!=0){for(var a=false,j=0;j<e.length;j++){for(var b=e[j],d=0,g=0;g<e.length;g++){var h=e[g];if(typeof h.predecessors!=="undefined"){for(var c=0;c<h.predecessors.length;c++)if(typeof h.predecessors[c].item!=="undefined"&&h.predecessors[c].item==b){d++;if(d>1)break}if(d>1)break}}d>1&&(a=true)}j=e[0];j.displayedRowIndex=a?0.5:0;b=e[e.length-1];b.displayedRowIndex=
a?0.5:0;ba(j);ba(b)}}};return{initialize:I,initializeItems:S,refresh:L,getDefaultStyleDefinitionTemplate:V,getDefaultTaskEventTemplate:$,getDefaultItemTemplate:W,getDefaultDependencyLineTemplate:aa,getDefaultPredecessorItemTemplate:la,initializeTaskEventDraggingThumbs:function(b,e,c,f){e.pertChartView.initializeTaskEventDraggingThumbs(b,e,c,f)},defaultTimeSpanFormatter:C}}());
void 0==DlhSoft.Controls.Pert.NetworkDiagramView&&(DlhSoft.Controls.Pert.NetworkDiagramView=function(){var l=function(a,j,b,d,g){a.internalEventListeners&&a.internalEventListeners.push({object:j,event:b,handler:d,useCapture:g});return d},I=function(a,j,b,d){var g=["DlhSoft.Controls.Pert","NetworkDiagramView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];DlhSoft[g[5]][g[4]](a,g[0],g[1],g[2],g[3],d,b);a.isInitializing=true;if(typeof a.initializedItems!=="undefined"){a.initializedItems.forEach(function(a){a.chartItemArea&&
a.chartItemArea.parentNode&&a.chartItemArea.parentNode.removeChild(a.chartItemArea);delete a.networkDiagramView;delete a.chartItem;delete a.chartItemArea});typeof a.draggableItems!=="undefined"&&delete a.draggableItems}a.initializedItems=j.slice();a.internalEventListeners&&a.internalEventListeners.forEach(function(a){a.object.removeEventListener(a.event,a.handler,a.useCapture)});a.internalEventListeners=[];if(typeof a.items!=="undefined")for(d=0;d<a.items.length;d++)delete a.items[d].successors;typeof b!==
"object"&&(b={});S(j,b);Y(b,j,a);f(a,j,b);J(j,b);Z(j);var h=F(a,j,b),c=a.ownerDocument,d=c.createElement("div");d.setAttribute("style","font-family: "+(b.classic?"Arial":"system-ui, Arial")+"; font-size: "+(b.classic?"small":"12px")+"; overflow: auto");g=c.createElement("div");typeof b.containerClass!=="undefined"&&g.setAttribute("class",b.containerClass);typeof b.containerStyle!=="undefined"&&g.setAttribute("style",b.containerStyle);d.appendChild(g);var e=c.createElement("div");e.setAttribute("style",
"border: solid 1px "+b.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden");g.appendChild(e);g=c.createElement("div");g.setAttribute("style","overflow: auto");e.appendChild(g);var k=c.createElement("div");k.setAttribute("style","overflow: "+(typeof b.isExport==="undefined"||!b.isExport?"auto":"hidden")+"; height: "+h);g.appendChild(k);var e=U(j,
b),u=B(j,b),o=c.createElement("div");o.setAttribute("style","float: left; overflow: hidden; width: "+e+"px; height: "+u+"px");k.appendChild(o);h=c.createElementNS("http://www.w3.org/2000/svg","svg");h.setAttribute("style","width: "+e+"px; height: "+u+"px");e=b.styleDefinitionTemplate();h.appendChild(e);h.chartAreaDefinitions=e;e=function(){setTimeout(function(){try{var a=o.chartArea,j=a.chartAreaDefinitions;a.removeChild(j);a.childNodes.length>0?a.insertBefore(j,a.childNodes[0]):a.appendChild(j)}catch(b){}},
0)};h.addEventListener("mousedown",l(a,h,"mousedown",e,true),true);c.addEventListener("mouseup",l(a,c,"mouseup",e,true),true);o.appendChild(h);o.chartArea=h;var s;setTimeout(function(){s=a.clientHeight},0);typeof a.heightUpdateTimer!=="undefined"&&clearInterval(a.heightUpdateTimer);a.heightUpdateTimer=setInterval(function(){try{if(!(a.clientHeight<=0)){var d=a.clientHeight;if(d!=s){var g=F(a,j,b);k.style.height=g;s=d}}}catch(h){try{clearInterval(a.heightUpdateTimer)}catch(c){}}},100);var t=function(a,
d,g,h){var f;if(b.mouseHandler||b.mouseMoveHandler&&h=="mousemove"||b.mouseDownHandler&&h=="mousedown"||b.clickHandler&&h=="click"||b.doubleClickHandler&&h=="dblclick"){var e=a.which;!e&&a.button&&(a.button&1?e=1:a.button&4?e=2:a.button&2&&(e=3));f=g.getBoundingClientRect();var v=c.body,k=c.documentElement,g=f.left+(window.pageXOffset||k.scrollLeft||v.scrollLeft)-(k.clientLeft||v.clientLeft||0);f=Math.round(f.top+(window.pageYOffset||k.scrollTop||v.scrollTop)-(k.clientTop||v.clientTop||0));g=Math.round(g);
g=a.pageX-g;f=a.pageY-f;for(v=0;v<j.length;v++){var k=j[v],t=D(k,b),o=K(k,b);if(g>=t&&g<t+b.itemWidth&&f>=o&&f<o+b.itemHeight){b.mouseHandler&&b.mouseHandler(h,k,e,d,a);b.mouseMoveHandler&&h=="mousemove"&&b.mouseMoveHandler(k);b.mouseDownHandler&&h=="mousedown"&&b.mouseDownHandler(k,e);b.itemClickHandler&&h=="click"&&b.itemClickHandler(k);b.itemDoubleClickHandler&&h=="dblclick"&&b.itemDoubleClickHandler(k)}}}};o.addEventListener("mousemove",l(a,o,"mousemove",function(a){t(a,0,o,"mousemove")}));o.addEventListener("mousedown",
l(a,o,"mousedown",function(a){t(a,1,o,"mousedown")}));o.addEventListener("click",l(a,o,"click",function(a){t(a,1,o,"click")}));o.addEventListener("dblclick",l(a,o,"dblclick",function(a){t(a,2,o,"dblclick")}));o.addEventListener("click",l(a,o,"click",function(a){a.srcElement&&a.srcElement.nodeName!="rect"&&a.stopPropagation()},true),true);o.addEventListener("touchmove",l(a,o,"touchmove",function(j){a.draggingItem&&j.preventDefault()},true),true);o.container=k;a.chartContainer=g;a.chartContent=o;a.chartContentContainer=
k;k.isInitializing=true;na(a,d);G(o,h,j,b);k.isInitializing=false;a.isInitializing=false;a.isInitialized=true;return a},L=function(a){I(a,a.items,a.settings,a.license)},R=function(a){if(typeof a.dateTimeFormatter==="undefined")a.dateTimeFormatter=C;if(typeof a.timeSpanFormatter==="undefined")a.timeSpanFormatter=x;if(typeof a.itemPropertyChangeHandler==="undefined")a.itemPropertyChangeHandler=function(){};if(typeof a.target==="undefined")a.target="Standard";if(typeof a.theme==="undefined")a.theme=
"Modern"},Y=function(a,j,b){R(a);if(typeof a.border==="undefined")switch(a.theme){default:a.border="#e0e0e0";break;case "ModernBordered":case "Aero":a.border="#9a9a9a"}if(typeof a.canUserRearrangeItems==="undefined")a.canUserRearrangeItems=true;if(typeof a.snapRearrangedItemsToGuidelines==="undefined")a.snapRearrangedItemsToGuidelines=true;if(typeof a.itemWidth==="undefined")a.itemWidth=220;if(typeof a.itemHeight==="undefined")a.itemHeight=100;if(typeof a.aspectRatio==="undefined")a.aspectRatio=1;
if(typeof a.shapeWidth==="undefined")a.shapeWidth=212;if(typeof a.shapeHeight==="undefined")a.shapeHeight=92;if(typeof a.styleDefinitionTemplate==="undefined")a.styleDefinitionTemplate=$(b,a);if(typeof a.shapeStyle==="undefined"&&a.shapeClass==null)a.shapeStyle="fill: White; stroke: "+(a.classic?"#0000ff":"#3b87d9")+"; stroke-width: 1px";if(typeof a.milestoneStyle==="undefined"&&a.milestoneClass==null)a.milestoneStyle="fill: White; stroke: "+(a.classic?"#000000":"#3b87d9")+"; stroke-width: 1px";if(typeof a.temporaryThumbStyle===
"undefined"&&a.temporaryThumbClass==null)a.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; ";if(typeof a.dependencyLineStyle==="undefined"&&a.dependencyLineClass==null)a.dependencyLineStyle="stroke: "+(a.classic?"#8080FF":"#3b87d9")+"; stroke-width: 0.65px; fill: none; marker-end: url(#PertArrowMarker)";if(typeof a.dependencyLineZoneStyle==="undefined"&&a.dependencyLineZoneClass==null)a.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none";
if(typeof a.taskTemplate==="undefined")a.taskTemplate=Q();if(typeof a.minDependencyLineLength==="undefined")a.minDependencyLineLength=48;if(typeof a.diagramMargin==="undefined")a.diagramMargin=16;if(typeof a.isTaskToolTipVisible==="undefined")switch(a.target){default:a.isTaskToolTipVisible=true;break;case "Phone":a.isTaskToolTipVisible=false}if(typeof a.itemTemplate==="undefined")a.itemTemplate=aa(a);if(typeof a.dependencyLineTemplate==="undefined")a.dependencyLineTemplate=ca();if(typeof a.isDependencyToolTipVisible===
"undefined")a.isDependencyToolTipVisible=a.isTaskToolTipVisible;if(typeof a.predecessorItemTemplate==="undefined")a.predecessorItemTemplate=da(a)},S=function(a,j){for(var b=new Date,d=0;d<a.length;d++){var g=a[d];if(typeof g==="string"){g={content:g};a[d]=g}if(typeof g.earlyStart==="string"){try{g.earlyStart=Date.parse(g.earlyStart)}catch(h){g.earlyStart=new Date(parseInt(g.earlyStart))}if(typeof j.isRelativeToTimezone==="undefined"||j.isRelativeToTimezone)g.earlyStart=new Date(g.earlyStart.valueOf()+
b.getTimezoneOffset()*60000)}if(typeof g.earlyFinish==="string"){try{g.earlyFinish=Date.parse(g.earlyFinish)}catch(c){g.earlyFinish=new Date(parseInt(g.earlyFinish))}if(typeof j.isRelativeToTimezone==="undefined"||j.isRelativeToTimezone)g.earlyFinish=new Date(g.earlyFinish.valueOf()+b.getTimezoneOffset()*60000)}if(typeof g.lateStart==="string"){try{g.lateStart=Date.parse(g.lateStart)}catch(f){g.lateStart=new Date(parseInt(g.lateStart))}if(typeof j.isRelativeToTimezone==="undefined"||j.isRelativeToTimezone)g.lateStart=
new Date(g.lateStart.valueOf()+b.getTimezoneOffset()*60000)}if(typeof g.lateFinish==="string"){try{g.lateFinish=Date.parse(g.lateFinish)}catch(e){g.lateFinish=new Date(parseInt(g.lateFinish))}if(typeof j.isRelativeToTimezone==="undefined"||j.isRelativeToTimezone)g.earlyFinish=new Date(g.earlyFinish.valueOf()+b.getTimezoneOffset()*60000)}if(typeof g.effort==="string")try{g.effort=parseInt(g.effort)}catch(u){}if(typeof g.isMilestone==="string")g.isMilestone=g.isMilestone.toLowerCase()==trueStringValue;
if(typeof g.slack==="string")try{g.slack=parseInt(g.slack)}catch(o){}if(typeof g.predecessors!=="undefined"){if(typeof g.predecessors==="string")g.predecessors=g.predecessors.split(",");for(var s=0;s<g.predecessors.length;s++){var t=g.predecessors[s];if(typeof t==="string"){t={item:t};g.predecessors[s]=t}if(typeof t.item==="string"){var n=parseInt(t.item)-1;t.item=n>=0&&n<a.length?a[n]:null}if(typeof t.lag==="string")t.lag=parseFloat(t.lag)}}if(typeof g.displayedRowIndex!=="undefined")g.actualRowIndex=
g.displayedRowIndex;if(typeof g.displayedColumnIndex!=="undefined")g.actualColumnIndex=g.displayedColumnIndex;if(typeof g.actualRowIndex==="undefined")g.actualRowIndex=0;if(typeof g.actualColumnIndex==="undefined")g.actualColumnIndex=0}},Z=function(a){a.positionedItems=[];a.maxRowIndex=null;for(var j=0;j<a.length;j++){var m=a[j],d=a;if(typeof m.displayedRowIndex==="undefined"){var g;if(typeof m.predecessors!=="undefined"){g=d.positionedItems;for(var h=[],c=m.predecessors,f=0;f<g.length;f++)for(var e=
g[f],u=0;u<c.length;u++)if(c[u].item==e){h.push(e);break}g=h}else g=null;if(g!=null){h=g;c=[];for(f=0;f<h.length;f++){e=h[f].actualRowIndex;c.indexOf(e)<0&&c.push(e)}h=c}else h=null;h=h!=null&&h.length>0?b(h):d.maxRowIndex!=null?d.maxRowIndex+1:0;c=c=void 0;if(typeof m.displayedColumnIndex==="undefined"){c=H(d.positionedItems,h);c=c.length>0?b(c)+1:0;f=g!=null?H(g,h):null;if(f!=null&&f.length>0){e=null;for(u=0;u<f.length;u++)if(e==null||f[u]<e)e=f[u];f=e+1}else f=null;if(f!=null&&f!=c){h++;g=g!=null?
A(g):null;c=g!=null&&g.length>0?b(g)+1:0}for(m.actualColumnIndex=c;M(d.positionedItems,h,c);)h++}else for(;;h++){c=H(d.positionedItems,h);c=c.length>0?b(c)+1:0;if(c<=m.actualColumnIndex)break}m.actualRowIndex=h}else if(typeof m.displayedColumnIndex==="undefined"){g=A(d.positionedItems);m.actualColumnIndex=g.length>0?b(g)+1:0}d.positionedItems.push(m);if(d.maxRowIndex==null||m.actualRowIndex>d.maxRowIndex)d.maxRowIndex=m.actualRowIndex}},H=function(a,j){for(var b=[],d=0;d<a.length;d++){var g=a[d];
if(g.actualRowIndex==j){g=g.actualColumnIndex;b.indexOf(g)<0&&b.push(g)}}return b},A=function(a){for(var j=[],b=0;b<a.length;b++){var d=a[b].actualColumnIndex;j.indexOf(d)<0&&j.push(d)}return j},M=function(a,j,b){for(var d=0;d<a.length;d++){var g=a[d];if(g.actualRowIndex==j&&g.actualColumnIndex==b)return true}return false},F=function(a,j,b){var d;if(a.isContentHeightInitialized&&a.isContentHeightAuto)d=j.length>0?"auto":b.itemHeight+"px";else{var g=a.clientHeight-2;g<0&&(g=0);d=g+"px";if(g<b.itemHeight){if(!a.isContentHeightInitialized)a.isContentHeightAuto=
true;d=j.length>0?"auto":b.itemHeight+"px"}a.isContentHeightInitialized=true}return d},y=function(a,b){var c=a.createElement("span");c.innerHTML=b;return c},C=function(a){var b;b=a.getFullYear();var c=a.getMonth()+1;c<10&&(c="0"+c);var d=a.getDate();d<10&&(d="0"+d);b=c+"/"+d+"/"+b;c=a.getHours();c<10&&(c="0"+c.toString());a=a.getMinutes();a<10&&(a="0"+a.toString());return b+" "+c+":"+a},x=function(a){return Math.ceil(a/3600000*10000/100)/100+"h"},J=function(a){var b=new Date(Math.floor((new Date).valueOf()/
86400000)*86400000),c=new Date,d,g;for(g=0;g<a.length;g++){d=a[g];var h=d.earlyStart,f=d.earlyFinish,e=d.lateStart,k=d.lateFinish;if(typeof d.earlyStart==="undefined")d.earlyStart=b;if(typeof d.earlyFinish==="undefined")d.earlyFinish=typeof d.isMilestone==="undefined"||!d.isMilestone?new Date(b.valueOf()+86400000):d.earlyStart;if(typeof d.lateStart==="undefined")d.lateStart=b;if(typeof d.lateFinish==="undefined")d.lateFinish=typeof d.isMilestone==="undefined"||!d.isMilestone?new Date(b.valueOf()+
86400000):d.lateStart;if(typeof d.isRelativeToTimezone==="undefined"||d.isRelativeToTimezone){d.earlyStart=new Date(d.earlyStart.valueOf()-c.getTimezoneOffset()*60000);d.earlyFinish=new Date(d.earlyFinish.valueOf()-c.getTimezoneOffset()*60000);d.lateStart=new Date(d.lateStart.valueOf()-c.getTimezoneOffset()*60000);d.lateFinish=new Date(d.lateFinish.valueOf()-c.getTimezoneOffset()*60000);d.isRelativeToTimezone=false}if(typeof d.effort==="undefined")d.effort=0;if(typeof d.slack==="undefined")d.slack=
0;if(typeof d.isMilestone==="undefined")d.isMilestone=false;(typeof h==="undefined"||d.earlyStart.valueOf()!=h.valueOf())&&N(d,"earlyStart",false,true);(typeof f==="undefined"||d.earlyFinish.valueOf()!=f.valueOf())&&N(d,"earlyFinish",false,true);(typeof e==="undefined"||d.lateStart.valueOf()!=e.valueOf())&&N(d,"lateStart",false,true);(typeof k==="undefined"||d.lateFinish.valueOf()!=k.valueOf())&&N(d,"lateFinish",false,true)}},U=function(a,b){for(var c=0,d=0;d<a.length;d++)c=Math.max(c,a[d].actualColumnIndex);
return b.itemWidth+c*(b.itemWidth+b.minDependencyLineLength)+b.diagramMargin*2},B=function(a,b){for(var c=0,d=0;d<a.length;d++)c=Math.max(c,a[d].actualRowIndex);return b.itemHeight+c*(b.itemHeight+b.minDependencyLineLength/b.aspectRatio)+b.diagramMargin*2},G=function(a,b,c,d){for(a=0;a<c.length;a++){var g=c[a],h=D(g,d),f=K(g,d);b.appendChild(T(g,h,f,d))}},D=function(a,b){if(typeof a.displayedColumnIndex!=="undefined")a.actualColumnIndex=a.displayedColumnIndex;return Math.max(0,b.diagramMargin+a.actualColumnIndex*
(b.itemWidth+b.minDependencyLineLength))},K=function(a,b){if(typeof a.displayedRowIndex!=="undefined")a.actualRowIndex=a.displayedRowIndex;return Math.max(0,b.diagramMargin+a.actualRowIndex*(b.itemHeight+b.minDependencyLineLength/b.aspectRatio))},O=function(a){for(var b=[],c,d,g=0;g<a.length;g++){var h=a[g];if(typeof h.predecessors!=="undefined"&&h.predecessors.length>0)for(var f=0;f<h.predecessors.length;f++){var e=h.predecessors[f].item;if(typeof e!=="undefined"){c=true;for(d=0;d<b;d++)if(e==b[d]){c=
false;break}if(c){z(e.chartItem,e,e.networkDiagramView.settings);c=D(e,e.networkDiagramView.settings);d=K(e,e.networkDiagramView.settings);e.chartItem.setAttribute("transform","translate("+c+", "+d+")");b.push(e)}}}if(typeof h.predecessors!=="undefined"&&h.predecessors.length>0){c=true;for(d=0;d<b;d++)if(typeof h!=="undefined"&&h==b[d]){c=false;break}if(c){z(h.chartItem,h,h.networkDiagramView.settings);c=D(h,h.networkDiagramView.settings);d=K(h,h.networkDiagramView.settings);h.chartItem.setAttribute("transform",
"translate("+c+", "+d+")");b.push(h)}}}},T=function(a,b,c,d){var g=a.networkDiagramView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");a.chartItem=g;g.setAttribute("style","-ms-touch-action: pinch-zoom; touch-action: pinch-zoom");g.setAttribute("transform","translate("+b+", "+c+")");z(g,a,d);return g},z=function(a,b,c){for(var d=a.childNodes.length;d-- >0;)a.removeChild(a.childNodes[d]);if(typeof b.isShapeVisible==="undefined"||b.isShapeVisible){d=c.taskTemplate;if(typeof b.taskTemplate!==
"undefined")d=b.taskTemplate;d=d(b);a.appendChild(d);if(typeof c.internalExtraTaskTemplate!=="undefined"){var g=c.internalExtraTaskTemplate(b);g!=null&&a.appendChild(g)}if(typeof c.extraTaskTemplate!=="undefined"){g=c.extraTaskTemplate(b);g!=null&&a.appendChild(g)}if(c.isTaskToolTipVisible){g=c.itemTemplate;if(typeof b.template!=="undefined")g=b.template;d.appendChild(g(b))}if(typeof b.predecessors!=="undefined")for(d=0;d<b.predecessors.length;d++){g=b.predecessors[d];if(!((typeof b.networkDiagramView===
"undefined"||b.networkDiagramView.items.indexOf(g.item))<0||typeof g.item.isShapeVisible!=="undefined"&&!g.item.isShapeVisible)){var h=c.dependencyLineTemplate(b,g);h.predecessorIndex=d;(function(a){h.addEventListener("click",l(b.networkDiagramView,h,"click",function(d){c.dependencyLineClickHandler&&c.dependencyLineClickHandler(a,b,d)}));h.addEventListener("dblclick",l(b.networkDiagramView,h,"dblclick",function(d){c.dependencyLineDoubleClickHandler&&c.dependencyLineDoubleClickHandler(a,b,d)}))})(g);
a.appendChild(h);if(c.isDependencyToolTipVisible){var f=c.predecessorItemTemplate;if(typeof g.template!=="undefined")f=g.template;h.appendChild(f(b,g))}}}}},E=function(a){if(typeof a.isWaitingToRefreshChartItem==="undefined"){a.isWaitingToRefreshChartItem=true;setTimeout(function(){z(a.chartItem,a,a.networkDiagramView.settings);var b=D(a,a.networkDiagramView.settings),c=K(a,a.networkDiagramView.settings);a.chartItem.setAttribute("transform","translate("+b+", "+c+")");delete a.isWaitingToRefreshChartItem},
0)}},ba=function(a){E(a)},V=function(a){if(typeof a.isWaitingToRefreshPredecessorItems==="undefined"){a.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){O(a.networkDiagramView.items,a);delete a.isWaitingToRefreshPredecessorItems},0)}},W=function(a){if(typeof a.isWaitingToRefreshChartItem!=="undefined"||typeof a.isWaitingToRefreshPredecessorItems!=="undefined"){typeof a.isWaitingToRefreshChartItem==="undefined"&&E(a);typeof a.isWaitingToRefreshPredecessorItems==="undefined"&&V(a)}else{a.isWaitingToRefreshChartItem=
true;a.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){z(a.chartItem,a,a.networkDiagramView.settings);var b=D(a,a.networkDiagramView.settings),c=K(a,a.networkDiagramView.settings);a.chartItem.setAttribute("transform","translate("+b+", "+c+")");O(a.networkDiagramView.items,a);delete a.isWaitingToRefreshChartItem;delete a.isWaitingToRefreshPredecessorItems},0)}},$=function(a,b){return function(){var c=a.ownerDocument,d=c.createElementNS("http://www.w3.org/2000/svg","defs"),g=c.createElementNS("http://www.w3.org/2000/svg",
"marker");g.setAttribute("id","PertArrowMarker");g.setAttribute("viewBox","0 0 10 10");g.setAttribute("refX","0");g.setAttribute("refY","5");g.setAttribute("markerUnits","strokeWidth");g.setAttribute("markerWidth",(4.5*(b.arrowSize?b.arrowSize:1)).toString());g.setAttribute("markerHeight",(3.5*(b.arrowSize?b.arrowSize:1)).toString());g.setAttribute("orient","auto");c=c.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d","M 0 0 L 10 5 L 0 10 z");c.setAttribute("fill",b.arrowFill?
b.arrowFill:b.theme=="Aero"?"Blue":"#8080ff");g.appendChild(c);d.appendChild(g);return d}},aa=function(){return function(a){var b=a.networkDiagramView.ownerDocument,c=b.createElementNS("http://www.w3.org/2000/svg","title");c.appendChild(y(b,a.content));return c}},la=function(a){var b=a.networkDiagramView.ownerDocument;if(typeof a.chartItemArea==="undefined")a.chartItemArea=b.createElementNS("http://www.w3.org/2000/svg","g");for(b=a.chartItemArea.childNodes.length;b-- >0;)a.chartItemArea.removeChild(a.chartItemArea.childNodes[b]);
return a.chartItemArea},Q=function(a,b,c){return function(d){var g=typeof b!=="undefined"?b:d.networkDiagramView,h=typeof c!=="undefined"?c:g.settings,f=typeof a!=="undefined"?a:g.items,e=g.ownerDocument,k=la(d),u=(h.itemWidth-h.shapeWidth)/2,o=u+h.shapeWidth,s=(h.itemHeight-h.shapeHeight)/2,t=s+h.shapeHeight,n=0,q=h.shapeHeight,w=h.shapeWidth;if(d.isMilestone){n=w/16;u=u+n;o=o-n;w=w-2*n}if(d.isMilestone){var p=e.createElementNS("http://www.w3.org/2000/svg","polygon");p.setAttribute("points",u+","+
s+" "+(u-n)+","+(s+t)/2+" "+u+","+t+" "+o+","+t+" "+(o+n)+","+(s+t)/2+" "+o+","+s);n=h.milestoneClass;if(typeof d.milestoneClass!=="undefined")n=d.milestoneClass;if(typeof n!=="undefined")p.setAttribute("class",n);else{n=h.milestoneStyle;if(typeof d.milestoneStyle!=="undefined")n=d.milestoneStyle;typeof n!=="undefined"&&p.setAttribute("style",n)}k.appendChild(p)}p=e.createElementNS("http://www.w3.org/2000/svg","rect");p.setAttribute("x",u);p.setAttribute("y",s);p.setAttribute("width",Math.max(0,o-
u-1));p.setAttribute("height",Math.max(0,t-s-1));n=h.shapeClass;if(typeof d.shapeClass!=="undefined")n=d.shapeClass;if(typeof n!=="undefined")p.setAttribute("class",n);else{n=h.shapeStyle;if(typeof d.shapeStyle!=="undefined")n=d.shapeStyle;typeof n!=="undefined"&&p.setAttribute("style",n)}k.appendChild(p);n=e.createElementNS("http://www.w3.org/2000/svg","line");n.setAttribute("x1",u);n.setAttribute("y1",s+q*3/8);n.setAttribute("x2",o-1);n.setAttribute("y2",s+q*3/8);p=h.shapeClass;if(typeof d.shapeClass!==
"undefined")p=d.shapeClass;typeof p!=="undefined"&&n.setAttribute("class",p);p=h.shapeStyle;if(typeof d.shapeStyle!=="undefined")p=d.shapeStyle;typeof p!=="undefined"&&n.setAttribute("style",p);k.appendChild(n);n=e.createElementNS("http://www.w3.org/2000/svg","line");n.setAttribute("x1",u);n.setAttribute("y1",t-q*3/8);n.setAttribute("x2",o-1);n.setAttribute("y2",t-q*3/8);p=h.shapeClass;if(typeof d.shapeClass!=="undefined")p=d.shapeClass;typeof p!=="undefined"&&n.setAttribute("class",p);p=h.shapeStyle;
if(typeof d.shapeStyle!=="undefined")p=d.shapeStyle;typeof p!=="undefined"&&n.setAttribute("style",p);k.appendChild(n);n=e.createElementNS("http://www.w3.org/2000/svg","line");n.setAttribute("x1",u+w*3/8);n.setAttribute("y1",s);n.setAttribute("x2",u+w*3/8);n.setAttribute("y2",s+q*3/8);p=h.shapeClass;if(typeof d.shapeClass!=="undefined")p=d.shapeClass;typeof p!=="undefined"&&n.setAttribute("class",p);p=h.shapeStyle;if(typeof d.shapeStyle!=="undefined")p=d.shapeStyle;typeof p!=="undefined"&&n.setAttribute("style",
p);k.appendChild(n);n=e.createElementNS("http://www.w3.org/2000/svg","line");n.setAttribute("x1",o-w*3/8);n.setAttribute("y1",s);n.setAttribute("x2",o-w*3/8);n.setAttribute("y2",s+q*3/8);p=h.shapeClass;if(typeof d.shapeClass!=="undefined")p=d.shapeClass;typeof p!=="undefined"&&n.setAttribute("class",p);p=h.shapeStyle;if(typeof d.shapeStyle!=="undefined")p=d.shapeStyle;typeof p!=="undefined"&&n.setAttribute("style",p);k.appendChild(n);n=e.createElementNS("http://www.w3.org/2000/svg","line");n.setAttribute("x1",
u+w*3/8);n.setAttribute("y1",t);n.setAttribute("x2",u+w*3/8);n.setAttribute("y2",t-q*3/8);p=h.shapeClass;if(typeof d.shapeClass!=="undefined")p=d.shapeClass;typeof p!=="undefined"&&n.setAttribute("class",p);p=h.shapeStyle;if(typeof d.shapeStyle!=="undefined")p=d.shapeStyle;typeof p!=="undefined"&&n.setAttribute("style",p);k.appendChild(n);n=e.createElementNS("http://www.w3.org/2000/svg","line");n.setAttribute("x1",o-w*3/8);n.setAttribute("y1",t);n.setAttribute("x2",o-w*3/8);n.setAttribute("y2",t-
q*3/8);p=h.shapeClass;if(typeof d.shapeClass!=="undefined")p=d.shapeClass;typeof p!=="undefined"&&n.setAttribute("class",p);p=h.shapeStyle;if(typeof d.shapeStyle!=="undefined")p=d.shapeStyle;typeof p!=="undefined"&&n.setAttribute("style",p);k.appendChild(n);p=e.createElementNS("http://www.w3.org/2000/svg","text");p.setAttribute("x",(u+o)/2);p.setAttribute("y",t-q*3/8-6);p.setAttribute("style","font-weight: bold; text-anchor: middle");n=d.displayedText;typeof n==="undefined"&&(n="");p.appendChild(e.createTextNode(n));
k.appendChild(p);var n=function(a){var a=h.dateTimeFormatter(new Date(a.valueOf()+(new Date).getTimezoneOffset()*60000)),b;b=a.indexOf(" ");if(b>=0){value1=a.substr(0,b);value2=a.substr(b+1)}else{value1=a;value2=""}return[value1,value2]},p=n(d.earlyStart),l=e.createElementNS("http://www.w3.org/2000/svg","text");l.setAttribute("x",u+w*3/8/2);l.setAttribute("y",t-q*5/8-20);l.setAttribute("style","text-anchor: middle");l.appendChild(e.createTextNode(p[0]));k.appendChild(l);l=e.createElementNS("http://www.w3.org/2000/svg",
"text");l.setAttribute("x",u+w*3/8/2);l.setAttribute("y",t-q*5/8-4);l.setAttribute("style","text-anchor: middle");l.appendChild(e.createTextNode(p[1]));k.appendChild(l);p=h.timeSpanFormatter(d.effort);l=e.createElementNS("http://www.w3.org/2000/svg","text");l.setAttribute("x",(u+o)/2);l.setAttribute("y",t-q*5/8-12);l.setAttribute("style","text-anchor: middle");l.appendChild(e.createTextNode(p));k.appendChild(l);p=n(d.earlyFinish);l=e.createElementNS("http://www.w3.org/2000/svg","text");l.setAttribute("x",
o-w*3/8/2);l.setAttribute("y",t-q*5/8-20);l.setAttribute("style","text-anchor: middle");l.appendChild(e.createTextNode(p[0]));k.appendChild(l);l=e.createElementNS("http://www.w3.org/2000/svg","text");l.setAttribute("x",o-w*3/8/2);l.setAttribute("y",t-q*5/8-4);l.setAttribute("style","text-anchor: middle");l.appendChild(e.createTextNode(p[1]));k.appendChild(l);p=n(d.lateStart);q=e.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",u+w*3/8/2);q.setAttribute("y",t-20);q.setAttribute("style",
"text-anchor: middle");q.appendChild(e.createTextNode(p[0]));k.appendChild(q);q=e.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",u+w*3/8/2);q.setAttribute("y",t-4);q.setAttribute("style","text-anchor: middle");q.appendChild(e.createTextNode(p[1]));k.appendChild(q);p=h.timeSpanFormatter(d.slack);q=e.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",(u+o)/2);q.setAttribute("y",t-12);q.setAttribute("style","text-anchor: middle");q.appendChild(e.createTextNode(p));
k.appendChild(q);p=n(d.lateFinish);q=e.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",o-w*3/8/2);q.setAttribute("y",t-20);q.setAttribute("style","text-anchor: middle");q.appendChild(e.createTextNode(p[0]));k.appendChild(q);q=e.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",o-w*3/8/2);q.setAttribute("y",t-4);q.setAttribute("style","text-anchor: middle");q.appendChild(e.createTextNode(p[1]));k.appendChild(q);if(h.canUserRearrangeItems){e=e.createElementNS("http://www.w3.org/2000/svg",
"rect");e.setAttribute("x",u);e.setAttribute("y",s);e.setAttribute("width",Math.max(0,o-u-1));e.setAttribute("height",Math.max(0,t-s-1));e.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer");k.appendChild(e);ka(e,d,f,D(d,h),K(d,h),g,h)}return k}},ca=function(a,b){return function(a,d){var c=a.networkDiagramView,h=typeof b!=="undefined"?b:c.settings,e=c.ownerDocument,c=e.createElementNS("http://www.w3.org/2000/svg","g"),f;f="M ";var k=D(a,h)-2,l=K(a,h)-2,o=D(d.item,h),s=K(d.item,h),
t=D(a,h),n=K(a,h),q=Math.abs(t-o),w=Math.abs(n-s),p=h.shapeWidth+2,y=h.shapeHeight+2,x=p/2,z=y/2,A=Math.max(p,y),w=w<A*4;if(q<A)f=s<=n?f+(o+x-k+","+(s+y-l))+(" L "+(t+x-k)+","+(n-l)):f+(o+x-k+","+(s-l))+(" L "+(t+x-k)+","+(n+y-l));else{f=o<=t?f+(o+p-k+","+(s+z-l)):f+(o-k+","+(s+z-l));f=w?o<=t?f+(" L "+(t-k)+","+(n+z-l)):f+(" L "+(t+p-k)+","+(n+z-l)):s<=n?f+(" L "+(t+x-k)+","+(n-l)):f+(" L "+(t+x-k)+","+(n+y-l))}k=e.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",f);typeof h.dependencyLineZoneClass!==
"undefined"&&k.setAttribute("class",h.dependencyLineZoneClass);typeof h.dependencyLineZoneStyle!=="undefined"&&k.setAttribute("style",h.dependencyLineZoneStyle);c.appendChild(k);e=e.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",f);f=h.dependencyLineClass;if(typeof d.dependencyLineClass!=="undefined")f=d.dependencyLineClass;typeof f!=="undefined"&&e.setAttribute("class",f);h=h.dependencyLineStyle;if(typeof d.dependencyLineStyle!=="undefined")h=d.dependencyLineStyle;typeof h!==
"undefined"&&e.setAttribute("style",h);c.appendChild(e);return c}},da=function(){return function(a,b){var c=a.networkDiagramView.ownerDocument,d=c.createElementNS("http://www.w3.org/2000/svg","title");d.appendChild(y(c,b.item.displayedText+" - "+a.displayedText));return d}},N=function(a,b,c,d){typeof a.networkDiagramView!=="undefined"&&a.networkDiagramView.settings.itemPropertyChangeHandler(a,b,c,d)},ka=function(a,b,c,d,g,h,e){function f(c){h.draggingItem=b;h.dragType="Position";h.style.cursor=a.style.cursor;
h.draggingInitialX=c.clientX;h.draggingInitialY=c.clientY;h.draggingInitialThumbXPosition=d;h.draggingInitialThumbYPosition=g}a.addEventListener("mousedown",l(h,a,"mousedown",function(a){if(a.button==0){f(a);a.preventDefault()}},true),true);a.addEventListener("touchstart",l(h,a,"touchstart",function(a){f(a.touches[0]);a.preventDefault()},true),true);if(typeof h.draggableItems==="undefined")h.draggableItems=[];for(var k=false,u=0;u<h.draggableItems.length;u++)if(h.draggableItems[u]==b){k=true;break}if(!k){var o=
function(a){if(!(typeof h.draggingItem==="undefined"||h.draggingItem!=b||h.dragType!="Position")){var d=a.clientX-h.draggingInitialX,g=a.clientY-h.draggingInitialY;var f=a.clientX,k=h;if(typeof k.draggingItem!=="undefined"){var l=new Date;if(!k.lastXDraggingTime||!(l>k.lastXDraggingTime&&l-k.lastXDraggingTime<200)){k.lastXDraggingTime=l;var l=k,o=0;if(l.offsetParent){do{o=o+l.offsetLeft;l=l.offsetParent}while(l)}f=f-o;if(f<24){f=k.chartContentContainer.scrollLeft;k.chartContentContainer.scrollLeft=
k.chartContentContainer.scrollLeft-48;f=f-k.chartContentContainer.scrollLeft;if(typeof k.draggingInitialThumbXPosition!=="undefined")k.draggingInitialThumbXPosition=k.draggingInitialThumbXPosition-f}else if(f>=k.chartContentContainer.clientWidth-24){f=k.chartContentContainer.scrollLeft;k.chartContentContainer.scrollLeft=k.chartContentContainer.scrollLeft+48;f=k.chartContentContainer.scrollLeft-f;if(typeof k.draggingInitialThumbXPosition!=="undefined")k.draggingInitialThumbXPosition=k.draggingInitialThumbXPosition+
f}}}k=a.clientY;a=h;if(typeof a.draggingItem!=="undefined"){f=new Date;if(!a.lastYDraggingTime||!(f>a.lastYDraggingTime&&f-a.lastYDraggingTime<200)){a.lastYDraggingTime=f;f=a;l=0;if(f.offsetParent){do{l=l+f.offsetTop;f=f.offsetParent}while(f)}k=k-l;if(k<24){k=a.chartContentContainer.scrollTop;a.chartContentContainer.scrollTop=a.chartContentContainer.scrollTop-48;k=k-a.chartContentContainer.scrollTop;if(typeof a.draggingInitialThumbYPosition!=="undefined")a.draggingInitialThumbYPosition=a.draggingInitialThumbYPosition-
k}else if(k>=a.chartContentContainer.clientHeight-24){k=a.chartContentContainer.scrollTop;a.chartContentContainer.scrollTop=a.chartContentContainer.scrollTop+48;k=a.chartContentContainer.scrollTop-k;if(typeof a.draggingInitialThumbYPosition!=="undefined")a.draggingInitialThumbYPosition=a.draggingInitialThumbYPosition+k}}}delete h.draggingItem;h.draggingInitialThumbXPosition+d<0&&(d=-h.draggingInitialThumbXPosition);h.draggingInitialThumbYPosition+g<0&&(g=-h.draggingInitialThumbYPosition);a=b;g=(h.draggingInitialThumbYPosition+
g-e.diagramMargin)/(e.itemHeight+e.minDependencyLineLength/e.aspectRatio);e.snapRearrangedItemsToGuidelines&&(g=Math.round(g));a.actualRowIndex=g;g=b;d=(h.draggingInitialThumbXPosition+d-e.diagramMargin)/(e.itemWidth+e.minDependencyLineLength);e.snapRearrangedItemsToGuidelines&&(d=Math.round(d));g.actualColumnIndex=d;N(b,"actualRowIndex",true,false);N(b,"actualColumnIndex",true,false);typeof b.displayedColumnIndex!=="undefined"&&delete b.displayedColumnIndex;typeof b.displayedRowIndex!=="undefined"&&
delete b.displayedRowIndex;ma(b,c,h.chartContent,e,false);h.draggingItem=b;h.draggingPerformed=true}};h.addEventListener("mousemove",l(h,h,"mousemove",function(a){o(a)},true),true);h.addEventListener("touchmove",l(h,h,"touchmove",function(a){o(a.touches[0])},true),true);var s=function(){if(!(typeof h.draggingItem==="undefined"||h.draggingItem!=b||h.dragType!="Position")){ma(b,c,h.chartContent,e,true);var a=h.draggingItem;delete h.draggingItem;h.style.cursor="default";if(h.draggingPerformed){N(a,"actualColumnIndex",
true,true);N(a,"actualRowIndex",true,true);delete h.draggingPerformed}}};document.addEventListener("mouseup",l(h,document,"mouseup",function(a){a.button==0&&s()},true),true);document.addEventListener("touchend",l(h,document,"touchend",function(){s()},true),true);h.draggableItems.push(b)}},ma=function(a,b,c,d,g){var h=a.networkDiagramView.ownerDocument;if(g){if(typeof c.temporaryRectangle!=="undefined"){g=c.chartArea;g.removeChild(c.temporaryRectangle);delete c.temporaryRectangle}setTimeout(function(){z(a.chartItem,
a,d);e=D(a,d);f=K(a,d);a.chartItem.setAttribute("transform","translate("+e+", "+f+")");O(b,a);setTimeout(function(){ea(c,b,d,true)},0)})}else{if(typeof c.temporaryRectangle!=="undefined")h=c.temporaryRectangle;else{h=h.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("x",0);h.setAttribute("y",0);h.setAttribute("width",d.shapeWidth);h.setAttribute("height",d.shapeHeight);typeof d.temporaryThumbClass!=="undefined"&&h.setAttribute("class",d.temporaryThumbClass);h.setAttribute("style",
d.temporaryThumbStyle);c.temporaryRectangle=h;g=c.chartArea;g.appendChild(h)}var e=D(a,d)+(d.itemWidth-d.shapeWidth)/2,f=K(a,d)+(d.itemHeight-d.shapeHeight)/2;h.setAttribute("transform","translate("+e+", "+f+")");setTimeout(function(){ea(c,b,d,false)},0)}},ea=function(a,b,c,d){var g=U(b,c),b=B(b,c);if(d||g>a.clientWidth)a.style.width=g+"px";if(d||b>a.clientHeight)a.style.height=b+"px";a=a.chartArea;d?a.setAttribute("style","width: "+g+"px; height: "+b+"px"):a.setAttribute("style","width: "+Math.max(a.clientWidth,
g)+"px; height: "+Math.max(a.clientHeight,b)+"px")},na=function(a,b){for(var c=a.childNodes.length;c-- >0;)a.removeChild(a.childNodes[c]);a.appendChild(b)},fa=function(a,b){for(var c in b)c.indexOf("custom")!=0&&c.indexOf("description")!=0||typeof a[c]==="undefined"&&(a[c]=b[c])},ha=function(a,b,c,d,g,h,e,f,k){var c={isExport:true,canUserRearrangeItems:false,isTaskToolTipVisible:false,isDependencyToolTipVisible:false,containerClass:k.containerClass,containerStyle:k.containerStyle,border:k.border,
theme:k.theme,itemWidth:k.itemWidth,itemHeight:k.itemHeight,aspectRatio:k.aspectRatio,shapeWidth:k.shapeWidth,shapeHeight:k.shapeHeight,shapeClass:k.shapeClass,milestoneClass:k.milestoneClass,shapeStyle:k.shapeStyle,milestoneStyle:k.milestoneStyle,dependencyLineClass:k.dependencyLineClass,dependencyLineStyle:k.dependencyLineStyle,minDependencyLineLength:k.minDependencyLineLength,diagramMargin:0,target:k.target,dateTimeFormatter:k.dateTimeFormatter,timeSpanFormatter:k.timeSpanFormatter,isRelativeToTimezone:k.isRelativeToTimezone,
arrowSize:k.arrowSize,arrowFill:k.arrowFill,taskTemplate:k.taskTemplate,dependencyLineTemplate:k.dependencyLineTemplate,classic:k.classic},k=U(f,c),l=B(f,c);c.chartWidth=k+"px";c.chartHeight=l+"px";var o=k+2,k=l+2,s,t,n=false;if(d!=null&&typeof d.createElement!=="undefined")s=d;else{if(d!=null&&typeof d.focus!=="undefined")t=d;else{t=window.open("",d!=null?d:"_blank",typeof g!=="undefined"&&g&&(typeof e==="undefined"||e)?"width=800,height=480,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":
"");n=true}s=t.document;try{for(var q=document.head.getElementsByTagName("link"),d=0;d<q.length;d++){var w=q[d],p=s.adoptNode(w.cloneNode(true));p.href=w.href;s.head.appendChild(p)}}catch(y){}}s.title=typeof a!=="undefined"?a:"Exported diagram"+(typeof g!=="undefined"&&g?" (printable)":"");a=[];for(d=0;d<f.length;d++){q=f[d];w={content:q.content,earlyStart:q.earlyStart,earlyFinish:q.earlyFinish,lateStart:q.lateStart,lateFinish:q.lateFinish,isMilestone:q.isMilestone,effort:q.effort,slack:q.slack,isShapeVisible:q.isShapeVisible,
isRelativeToTimezone:q.isRelativeToTimezone,shapeClass:q.shapeClass,milestoneClass:q.milestoneClass,shapeStyle:q.shapeStyle,milestoneStyle:q.milestoneStyle,displayedRowIndex:q.actualRowIndex,displayedColumnIndex:q.actualColumnIndex,isExported:true};fa(w,q);a.push(w);q.exportItem=w}for(d=0;d<f.length;d++){q=f[d];w=q.exportItem;if(typeof q.predecessors!=="undefined"){w.predecessors=[];for(p=0;p<q.predecessors.length;p++){l=q.predecessors[p];w.predecessors.push({item:l.item.exportItem,dependencyLineClass:l.dependencyLineClass,
dependencyLineStyle:l.dependencyLineStyle})}}}var x=s.createElement("p");x.innerHTML=typeof b!=="undefined"?b:"";s.body.appendChild(x);var z=s.createElement("div");z.setAttribute("style","width: "+o+"px; height: "+k+"px");try{DlhSoft.Controls.Pert.NetworkDiagramView.initialize(z,a,c,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch(A){}setTimeout(function(){n&&s.body.setAttribute("style","margin: 0px");
var a=s.createElement("div");a.appendChild(z);s.body.replaceChild(a,x);if(h){a.setAttribute("style","width: "+z.offsetHeight+"px; height: "+o+"px; overflow: hidden");a=Math.round((z.offsetWidth-z.offsetHeight)/2);z.setAttribute("style","width: "+o+"px; transform: rotate(90deg) translateX("+a+"px) translateY("+a+"px); -webkit-transform: rotate(90deg) translateX("+a+"px) translateY("+a+"px)")}s.close();if(typeof t!==void 0){t.focus();if(typeof g!=="undefined"&&g){t.print();(typeof e==="undefined"||
e)&&setTimeout(function(){t.close()})}}},0)},X=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];delete d.successorInfo;delete d.effortInfo}a:{for(var g=0;g<b.length;g++){c=b[g];if(typeof c.predecessors==="undefined"||c.predecessors.length==0)break a}c=null}if(c==null)return[];a:{for(g=b.length;g-- >0;){d=b[g];if(ja(d).length==0)break a}d=null}if(d==null)return[];g=[c];c=ga(c,d);for(d=0;d<c.length;d++)g.push(c[d]);for(c=0;c<b.length;c++){d=b[c];delete d.successorInfo;delete d.effortInfo}return g},
ia=function(a,b){for(var c=X(a,b),d=[],g=0;g<c.length;g++){var h=c[g];if(typeof h.predecessors!=="undefined")for(var e=0;e<h.predecessors.length;e++){var f=h.predecessors[e];typeof f.item!=="undefined"&&c.indexOf(f.item)>=0&&d.push(f)}}return d},ga=function(a,b){if(a==null||b==null||a==b||typeof b.predecessors==="undefined")return[];var c=[],d=[],g,h=null;for(g=0;g<b.predecessors.length;g++){predecessorItem=b.predecessors[g];if(typeof predecessorItem.item!=="undefined"){var e=P(a,predecessorItem.item);
if(e!=null){predecessorItem.item.effort>0&&(e=e+predecessorItem.item.effort);if(h==null||e>=h){if(h==null||e>h){h=e;d=[]}d.push(predecessorItem)}}}}for(g=0;g<d.length;g++){nextPredecessorItem=d[g];h=ga(a,nextPredecessorItem.item);for(e=0;e<h.length;e++)c.push(h[e]);c.push(b)}return c},P=function(a,b){if(a==null||b==null)return null;if(a==b)return 0;if(!a.effortInfo)a.effortInfo={};var c=b.index.toString();if(typeof a.effortInfo[c]!=="undefined")return a.effortInfo[c];for(var d=null,g=ja(a),e=0;e<
g.length;e++){var f=g[e],l=P(f.dependentItem,b);if(l!=null){l=l+(typeof f.predecessorItem.item!=="undefined"&&f.predecessorItem.item.effort>0?f.predecessorItem.item.effort:0);l<0&&(l=0);if(d==null||l>d)d=l}}return a.effortInfo[c]=d},ja=function(a){if(a.successorInfo)return a.successorInfo;for(var b=[],c=a.networkDiagramView.items,d=0;d<c.length;d++){var g=c[d];if(typeof g.predecessors!=="undefined")for(var e=0;e<g.predecessors.length;e++){var f=g.predecessors[e];typeof f.item!=="undefined"&&f.item==
a&&b.push({dependentItem:g,predecessorItem:f})}}return a.successorInfo=b},b=function(a){for(var b=null,c=0;c<a.length;c++)if(b==null||a[c]>b)b=a[c];return b},e=function(a){return typeof a!=="undefined"?new Date(a.valueOf()+a.getTimezoneOffset()*60000):a},c=function(a){return typeof a!=="undefined"?new Date(a.valueOf()-a.getTimezoneOffset()*60000):a},f=function(a,b,f){for(var d=0;d<b.length;d++){b[d].networkDiagramView=a;b[d].index=d}a.items=b;a.settings=f;a.refresh=function(){L(a)};a.refreshItems=
function(){for(var a=0;a<b.length;a++){var c=b[a];E(c);V(c)}};a.refreshChartItems=function(){for(var a=0;a<b.length;a++)E(b[a])};a.refreshItem=ba;a.refreshChartItem=E;a.refreshPredecessorItems=V;a.refreshItemGraph=W;a.scrollToItem=function(a){var b=D(a,f),c=b-a.networkDiagramView.chartContentContainer.scrollLeft;if(c<0)a.networkDiagramView.chartContentContainer.scrollLeft=b;else if(c>a.networkDiagramView.chartContentContainer.clientWidth-a.networkDiagramView.settings.itemWidth)a.networkDiagramView.chartContentContainer.scrollLeft=
b-(a.networkDiagramView.chartContentContainer.clientWidth-a.networkDiagramView.settings.itemWidth);b=K(a,f);c=b-a.networkDiagramView.chartContentContainer.scrollTop;if(c<0)a.networkDiagramView.chartContentContainer.scrollTop=b;else if(c>a.networkDiagramView.chartContentContainer.clientHeight-a.networkDiagramView.settings.itemHeight)a.networkDiagramView.chartContentContainer.scrollTop=b-(a.networkDiagramView.chartContentContainer.clientHeight-a.networkDiagramView.settings.itemHeight)};a.scrollToLeft=
function(){a.chartContentContainer.scrollLeft=0};a.scrollToRight=function(){a.chartContentContainer.scrollLeft=a.chartContent.clientWidth};a.scrollToTop=function(){a.chartContentContainer.scrollTop=0};a.scrollToBottom=function(){a.chartContentContainer.scrollTop=a.chartContent.clientHeight};a.getChartWidth=function(){return U(b,f)};a.getChartHeight=function(){return B(b,f)};a.getItemTop=function(a){return K(a,f)};a.getItemLeft=function(a){return D(a,f)};a.onItemPropertyChanged=N;a.initializeTaskDraggingThumbs=
function(b,c,d,e){ka(b,c,a.items,d,e,a,a.settings)};a.exportContent=function(a,c){typeof a==="undefined"&&(a={});ha(a.title,a.preparingMessage,a.isRelativeToTimezone,c,false,a.rotate,false,b,f)};a.print=function(a){typeof a==="undefined"&&(a={});ha(a.title,a.preparingMessage,a.isRelativeToTimezone,null,true,a.rotate,a.autoClose,b,f)};a.isItemCritical=function(a,c){return X(c,b).indexOf(a)>=0};a.isDependencyCritical=function(a,c){return ia(c,b).indexOf(a)>=0};a.getCriticalItems=function(a){return X(a,
b)};a.getCriticalDependencies=function(a){return ia(a,b)};a.repositionEnds=function(){if(b.length!=0){for(var a=false,c=0;c<b.length;c++){for(var d=b[c],e=0,f=0;f<b.length;f++){var l=b[f];if(typeof l.predecessors!=="undefined"){for(var m=0;m<l.predecessors.length;m++)if(typeof l.predecessors[m].item!=="undefined"&&l.predecessors[m].item==d){e++;if(e>1)break}if(e>1)break}}e>1&&(a=true)}c=b[0];c.displayedRowIndex=a?0.5:0;d=b[b.length-1];d.displayedRowIndex=a?0.5:0;W(c);W(d)}};a.getOutputDate=e;a.getInputDate=
c};return{initialize:I,initializeItems:S,refresh:L,getDefaultStyleDefinitionTemplate:$,getDefaultTaskTemplate:Q,getDefaultItemTemplate:aa,getDefaultDependencyLineTemplate:ca,getDefaultPredecessorItemTemplate:da,initializeTaskDraggingThumbs:function(a,b,c,d){b.networkDiagramView.initializeTaskDraggingThumbs(a,b,c,d)},defaultDateTimeFormatter:function(a){return C(new Date(a.valueOf()+(new Date).getTimezoneOffset()*60000))},defaultTimeSpanFormatter:x,getOutputDate:e,getInputDate:c}}());
