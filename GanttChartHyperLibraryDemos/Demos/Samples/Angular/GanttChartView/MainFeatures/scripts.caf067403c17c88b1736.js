void 0===DlhSoft&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)}),DlhSoft.assemblies.push({assembly:"DlhSoft.ProjectData.GanttChart.HTML.Controls",company:"DlhSoft",product:"Project Data Modern Library",version:"5.3.14.3",copyright:"Copyright © 2012-2019 DlhSoft",title:"Project Data Gantt Chart HTML Controls",description:"Project Data Gantt Chart related HTML client components"}),DlhSoft.buildReleaseDate=function(e,t,i){return(e=new Date(e,7,17))>DlhSoft.buildReleaseDate?e:DlhSoft.buildReleaseDate}(2019);var _0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{");null==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var e=_0x5c25[1],t=_0x5c25[2],n=[],s=[],r=_0x5c25[3];return{setLicense:function(e,t){n[_0x5c25[7]]({type:e,content:t})},validate:function(a,o,l,d,h,c,u){o=o+_0x5c25[4]+l;for(var p=0;p<s[_0x5c25[5]];p++)if(s[p]==o)return;e:if(typeof c!==t&&typeof u!==e&&(u[_0x5c25[6]]!==e&&(c=u[_0x5c25[6]]),typeof u===t&&(c=u)),typeof c!==t)for(u=0;u<n[_0x5c25[5]];u++)if(p=n[u],p[_0x5c25[8]]==o&&typeof p[_0x5c25[9]]===t){c=p[_0x5c25[9]];break e}!function(n,s){if(typeof n!==t||typeof s!==t)return!1;if(s==r)return!0;var a=s[_0x5c25[11]](_0x5c25[10]);if(0<=a){var o,l=s[_0x5c25[12]](0,a),d=l[_0x5c25[11]](_0x5c25[10]);if(0<=d)try{o=new Date(parseInt(l[_0x5c25[12]](d+1)))}catch(u){}if(typeof o===e&&(o=new Date(2013,11,31)),DlhSoft[_0x5c25[13]]>o)return!1;for(l=l+_0x5c25[10]+n,i=o=0;i<l[_0x5c25[5]];i++)o=(o<<5)-o+(d=l[_0x5c25[14]](i)),o&=o;if(0>o&&(o=Math[_0x5c25[15]](2,32)-o),(l=o.toString(16)[_0x5c25[16]]())==(a=s[_0x5c25[12]](a+1)))return!0}return!1}(o,c)?function(t,i,n,r,a){var o=_0x5c25[17],l=typeof ComponentSource!==e&&ComponentSource?_0x5c25[21]:_0x5c25[18]+_0x5c25[19]+r+_0x5c25[20]+a,d=r+_0x5c25[22]+a+_0x5c25[23],h=_0x5c25[24],c=_0x5c25[25],u=_0x5c25[26];setTimeout((function(){var e=t[_0x5c25[27]],r=e[_0x5c25[29]](_0x5c25[28]);r[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var a=e[_0x5c25[29]](_0x5c25[28]);a[_0x5c25[32]](_0x5c25[30],_0x5c25[33]);var p=e[_0x5c25[29]](_0x5c25[28]);p[_0x5c25[32]](_0x5c25[30],_0x5c25[34]),a[_0x5c25[35]](p),p[_0x5c25[35]](e[_0x5c25[36]](o)),a[_0x5c25[35]](e[_0x5c25[36]](h+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),p[_0x5c25[35]](e[_0x5c25[36]](i)),a[_0x5c25[35]](p),a[_0x5c25[35]](e[_0x5c25[36]](c+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),p[_0x5c25[35]](e[_0x5c25[36]](d)),a[_0x5c25[35]](p),a[_0x5c25[35]](e[_0x5c25[36]](u+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var m=e[_0x5c25[29]](_0x5c25[39]);m[_0x5c25[32]](_0x5c25[30],_0x5c25[40]),m[_0x5c25[32]](_0x5c25[41],l),m[_0x5c25[32]](_0x5c25[42],_0x5c25[43]),m[_0x5c25[35]](e[_0x5c25[36]](_0x5c25[44])),p[_0x5c25[35]](m),(m=e[_0x5c25[29]](_0x5c25[39]))[_0x5c25[32]](_0x5c25[30],_0x5c25[45]),m[_0x5c25[32]](_0x5c25[41],_0x5c25[46]),m[_0x5c25[35]](e[_0x5c25[36]](_0x5c25[47])),m[_0x5c25[50]](_0x5c25[48],(function(){t[_0x5c25[49]](r),s[_0x5c25[7]](n)}),!1),p[_0x5c25[35]](m),a[_0x5c25[35]](p),r[_0x5c25[35]](a),t[_0x5c25[35]](r)}),0),setTimeout((function(){alert(o+_0x5c25[51]+h+_0x5c25[52]+i+_0x5c25[51]+c+_0x5c25[53]+d+_0x5c25[51]+u+_0x5c25[4])}),6e5)}(a,l,o,d,h):a[_0x5c25[6]]=c}}}()),null==DlhSoft.Controls&&(DlhSoft.Controls={}),null==DlhSoft.Controls.GanttChartView&&(DlhSoft.Controls.GanttChartView=function(){var e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t=["January","February","March","April","May","June","July","August","September","October","November","December"],i=[31,28,31,30,31,30,31,31,30,31,30,31],n=new Date(2592e5),s=new Date(3155762592e5),r=function(e,t,i,n){if(void 0!==e.ownerDocument.createElementNS&&void 0!==e.ownerDocument.addEventListener){var s=["DlhSoft.Controls","GanttChartView","DlhSoft.ProjectData.GanttChart.HTML.Controls","5","validate","Licensing"];if(DlhSoft[s[5]][s[4]](e,s[0],s[1],s[2],s[3],n,i),e.isInitializing=!0,void 0!==e.settings&&void 0!==e.settings.toggleButtonAreaWidth&&delete e.settings.toggleButtonAreaWidth,void 0!==e.items)for(n=0;n<e.items.length;n++)delete e.items[n].successors;if("object"!=typeof i&&(i={}),d(t,i),l(i,t,e),Si(e,t,i),s=i.scales,_(n=i.columns,e,i),X(t,e),U(t,i,e),void 0!==i.visibilityFilter){pt(t,i.visibilityFilter);for(var r=0,a=0;a<t.length;a++){var o=t[a];if(void 0!==o.ganttChartItems){o.isHidden||(o.scheduleChartVisibilityIndex=r++);for(var u=0;u<o.ganttChartItems.length;u++){var p=o.ganttChartItems[u];o.isHidden&&(p.isHidden=!0),p.displayRowIndex=o.scheduleChartVisibilityIndex}}}}var m=h(e,t,i),g=e.ownerDocument;(r=g.createElement("div")).setAttribute("style","font-family: Arial; font-size: small; overflow: auto"),a=g.createElement("div"),void 0!==i.containerClass&&a.setAttribute("class",i.containerClass),void 0!==i.containerStyle&&a.setAttribute("style",i.containerStyle),r.appendChild(a),(o=g.createElement("div")).setAttribute("style","border: solid 1px "+i.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto"),a.appendChild(o);var f=g.createElement("div");f.setAttribute("style","overflow: auto; float: left; border-right: solid 1px "+i.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+i.gridWidth),i.isGridVisible&&o.appendChild(f);var v=g.createElement("div");v.setAttribute("style","overflow: auto; float: right; width: "+i.chartWidth),o.appendChild(v);var y=g.createElement("div");y.setAttribute("style","position: relative; opacity: 0; left: 0px; width: "+i.splitterWidth+"px; height: 0px; background: "+i.splitterBackground+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: e-resize; -ms-touch-action: pinch-zoom; touch-action: auto"),y.addEventListener("mouseover",(function(){y.style.opacity=1,"undefined"!==y.isWaiting&&delete y.isWaiting}),!0),y.addEventListener("mouseout",(function(){void 0===y.isWaiting&&(y.isWaiting=!0,setTimeout((function(){void 0!==y.isWaiting&&(delete y.isWaiting,void 0===y.x&&(y.style.opacity=0))}),1e3))}),!0),y.addEventListener("mousedown",(function(e){0==e.button&&(y.style.opacity=1,y.x=e.clientX,y.gridWidth=f.offsetWidth)}),!0),g.addEventListener("mousemove",(function(t){if(void 0!==y.x&&!(e.offsetWidth<=0)){var n=e.offsetWidth-(t=y.gridWidth+(t.clientX-y.x))-3,s=Math.max(1,i.minGridWidth),r=Math.max(1,i.minChartWidth);t<s?(n-=s-t,t=s):n<r&&(t-=r-n,n=r),t<1&&(t=1),n<1&&(n=1),void 0!==f.percent&&delete f.percent,t=Math.floor(1e6*t/e.offsetWidth)/1e4,f.style.width=t+"%",v.style.width=100-t+"%",i.gridWidth=f.offsetWidth+"px",i.chartWidth=v.offsetWidth+"px",Ot(y,f,i),void 0!==i.splitterPositionChangeHandler&&setTimeout((function(){i.splitterPositionChangeHandler(f.offsetWidth,v.offsetWidth)}),0)}}),!0),g.addEventListener("mouseup",(function(){void 0!==y.x&&(delete y.x,y.style.opacity=0),DlhSoft.Controls.ToolTip&&i.useUpdatingToolTips&&(toolTip=e.toolTip)&&toolTip.hide()}),!0),i.isGridVisible&&i.isSplitterEnabled&&o.appendChild(y),(a=g.createElement("div")).setAttribute("style","float: right; background: "+i.headerBackground+"; width: 0px; height: "+i.headerHeight+"px"),f.appendChild(a),(o=g.createElement("div")).setAttribute("style","overflow: hidden; background: "+i.headerBackground+"; border-bottom: solid 1px "+i.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: "+i.headerHeight+"px"),f.appendChild(o),(u=g.createElement("div")).setAttribute("style","float: right; background: "+i.headerBackground+"; width: 0px; height: "+i.headerHeight+"px"),v.appendChild(u),(p=g.createElement("div")).setAttribute("style","overflow: hidden; background: "+i.headerBackground+"; border-bottom: solid 1px "+i.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: "+i.headerHeight+"px"),v.appendChild(p);var C=g.createElement("div");C.setAttribute("style","overflow-x: "+(void 0!==i.isExport&&i.isExport?"hidden":"scroll")+"; overflow-y: "+(void 0!==i.isExport&&i.isExport?"hidden":"auto")+"; height: "+m),f.appendChild(C);var b=g.createElement("div");b.setAttribute("style","overflow-x: "+(void 0!==i.isExport&&i.isExport?"hidden":"scroll")+"; overflow-y: "+(void 0!==i.isExport&&i.isExport?"hidden":"auto")+"; height: "+m),v.appendChild(b),m=N(n);var S=g.createElement("div");S.setAttribute("style","background: "+i.headerBackground+"; border-bottom: solid 1px "+i.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+m+"px; overflow: hidden; height: "+i.headerHeight+"px"),o.appendChild(S);var w=g.createElement("div");if(w.setAttribute("style","float: left; width: "+m+"px; overflow: auto"+(i.horizontalGridLines?"; border-bottom: 1px solid "+i.horizontalGridLines+"; margin-bottom: -1px; ; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box":"")),C.appendChild(w),void 0!==i.extraSpaceHeight){var T=g.createElement("div");T.setAttribute("style","overflow: hidden; width: "+m+"px; height: "+i.extraSpaceHeight+"px"),C.appendChild(T)}var x=ne(i.timelineFinish,i),D=g.createElement("div");D.setAttribute("style","background: "+i.headerBackground+"; border-bottom: solid 1px "+i.border+"; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+x+"px; height: "+i.headerHeight+"px"),p.appendChild(D);var k=g.createElement("div");k.setAttribute("style","float: left; overflow: hidden; width: "+x+"px; height: 0px"),b.appendChild(k);var E,I,A,V=g.createElementNS("http://www.w3.org/2000/svg","svg");V.setAttribute("style","width: "+x+"px; height: 0px"),m=i.styleDefinitionTemplate(e),V.appendChild(m),V.chartAreaDefinitions=m,m=g.createElementNS("http://www.w3.org/2000/svg","g"),V.appendChild(m),k.chartAreaAlternativeRows=m,V.addEventListener("mousedown",m=function(){setTimeout((function(){try{var e=k.chartArea,t=e.chartAreaDefinitions;e.removeChild(t),e.childNodes.length>0?e.insertBefore(t,e.childNodes[0]):e.appendChild(t)}catch(i){}}),0)},!0),g.addEventListener("mouseup",m,!0),e.resetChartAreaDefinitions=m,k.appendChild(V),k.chartArea=V,void 0!==i.extraSpaceHeight&&((m=g.createElement("div")).setAttribute("style","overflow: hidden; width: "+x+"px; height: "+i.extraSpaceHeight+"px"),b.appendChild(m),b.chartExtraSpace=m),setTimeout((function(){E=e.offsetWidth,I=e.offsetHeight,A=v.offsetHeight}),0),void 0!==e.splitterUpdateTimer&&clearInterval(e.splitterUpdateTimer),e.splitterUpdateTimer=setInterval((function(){try{if(void 0===y.x&&!(e.offsetWidth<=0)){var t=e.offsetWidth,n=v.offsetHeight,s=screen.deviceXDPI;if(t!=E||s!=screen.deviceXDPI){var r=void 0!==f.percent?f.percent*t:f.offsetWidth,a=v.offsetWidth,o=Math.max(1,i.minGridWidth),l=Math.max(1,i.minChartWidth);r<o?(a-=o-r,r=o):a<l&&(r-=l-a,a=l),r<1&&(r=1),a<1&&(a=1);var d=Math.floor(1e6*r/t)/1e4;if(f.percent=d/100,f.style.width=d+"%",v.style.width=100-d+"%",i.gridWidth=f.offsetWidth+"px",i.chartWidth=v.offsetWidth+"px",Ot(y,f,i),void 0!==i.splitterPositionChangeHandler){var h=f.offsetWidth,c=v.offsetWidth;h>0&&c>0&&setTimeout((function(){i.splitterPositionChangeHandler(h,c)}),0)}E=t,I=n}else n!=A&&(Ot(y,f,i),A=n)}}catch(C){try{clearInterval(e.splitterUpdateTimer)}catch(b){}}}),100),void 0!==e.heightUpdateTimer&&clearInterval(e.heightUpdateTimer),e.heightUpdateTimer=setInterval((function(){try{if(!(e.clientHeight<=0)){var n=e.clientHeight;if(n!=I){var r=h(e,t,i);C.style.height=r,b.style.height=r,Ot(y,f,i),"auto"!=b.style.height&&(k.availableHeight=b.clientHeight),Me(k,be(t,i)),Pt(t,b,i),I=n}}}catch(s){try{clearInterval(e.heightUpdateTimer)}catch(u){}}}),100);var H=function(e,n,s,r,a,o){var l;if(i.mouseHandler||i.mouseMoveHandler&&"mousemove"==o||i.mouseDownHandler&&"mousedown"==o||(i.clickHandler||i.itemClickHandler||i.chartClickHandler||i.chartItemClickHandler)&&"click"==o||(i.doubleClickHandler||i.itemDoubleClickHandler||i.chartDoubleClickHandler||i.chartItemDoubleClickHandler)&&"dblclick"==o){var d=e.which;!d&&e.button&&(1&e.button?d=1:4&e.button?d=2:2&e.button&&(d=3)),l=a.getBoundingClientRect();var h=g.body,c=g.documentElement;a=l.left+(window.pageXOffset||c.scrollLeft||h.scrollLeft)-(c.clientLeft||h.clientLeft||0),l=Math.round(l.top+(window.pageYOffset||c.scrollTop||h.scrollTop)-(c.clientTop||h.clientTop||0)),a=Math.round(a),a=e.pageX-a,c=e.pageY-l;var u,p,m=l=0;if(s){for(h=0;h<t.length;h++)if((m=t[h]).isVisible&&(void 0===m.isHidden||!m.isHidden)&&c<=(m=m.itemTop+i.itemHeight)){u=t[h];break}}else if(n){var f,v=i.scales,y=0;for(h=0;h<v.length;h++)(void 0===(f=v[h]).isHeaderVisible||f.isHeaderVisible)&&y++;var C=i.headerHeight;for(y>0&&(C=i.headerHeight/y),h=0;h<v.length;h++)if((void 0===(f=v[h]).isHeaderVisible||f.isHeaderVisible)&&(y=C,void 0!==f.headerHeight&&(y=f.headerHeight),c<=(m+=y))){u=f;break}}if(n)p=se(a,i);else for(c=i.columns,h=0;h<c.length;h++)if(a<=(l+=(m=c[h]).width?m.width:0)){p=m;break}i.mouseHandler&&i.mouseHandler(o,s,n,u,p,d,r,e),i.mouseMoveHandler&&"mousemove"==o&&i.mouseMoveHandler(s,n,u,p),i.mouseDownHandler&&"mousedown"==o&&i.mouseDownHandler(s,n,u,p,d),i.clickHandler&&"click"==o&&i.clickHandler(s,n,u,p),i.doubleClickHandler&&"dblclick"==o&&i.doubleClickHandler(s,n,u,p),i.itemClickHandler&&"click"==o&&s&&u&&i.itemClickHandler(n,u,p),i.itemDoubleClickHandler&&"dblclick"==o&&s&&u&&i.itemDoubleClickHandler(n,u,p),i.chartClickHandler&&"click"==o&&n&&i.chartClickHandler(s,u,p),i.chartDoubleClickHandler&&"dblclick"==o&&n&&i.chartDoubleClickHandler(s,u,p),i.chartItemClickHandler&&"click"==o&&s&&n&&i.chartItemClickHandler(u,p),i.chartItemDoubleClickHandler&&"dblclick"==o&&s&&n&&i.chartItemDoubleClickHandler(u,p)}};S.addEventListener("mousemove",(function(e){H(e,!1,!1,0,S,"mousemove")})),S.addEventListener("mousedown",(function(e){H(e,!1,!1,1,S,"mousedown")})),S.addEventListener("click",(function(e){H(e,!1,!1,1,S,"click")})),S.addEventListener("dblclick",(function(e){H(e,!1,!1,2,S,"dblclick")})),w.addEventListener("mousemove",(function(e){H(e,!1,!0,0,w,"mousemove")})),w.addEventListener("mousedown",(function(e){H(e,!1,!0,1,w,"mousedown")})),w.addEventListener("click",(function(e){H(e,!1,!0,1,w,"click")})),w.addEventListener("dblclick",(function(e){H(e,!1,!0,2,w,"dblclick")})),D.addEventListener("mousemove",(function(e){H(e,!0,!1,0,D,"mousemove")})),D.addEventListener("mousedown",(function(e){H(e,!0,!1,1,D,"mousedown")})),D.addEventListener("click",(function(e){H(e,!0,!1,1,D,"click")})),D.addEventListener("dblclick",(function(e){H(e,!0,!1,2,D,"dblclick")})),k.addEventListener("mousemove",(function(e){H(e,!0,!0,0,k,"mousemove")})),k.addEventListener("mousedown",(function(e){H(e,!0,!0,1,k,"mousedown")})),k.addEventListener("click",(function(e){H(e,!0,!0,1,k,"click")})),k.addEventListener("dblclick",(function(e){H(e,!0,!0,2,k,"dblclick")})),w.container=C,k.container=b,S.container=o,D.container=p,e.gridContainer=f,e.chartContainer=v,e.gridContent=w,e.chartContent=k,e.gridContentContainer=C,e.chartContentContainer=b,e.gridHeader=S,e.chartHeader=D,e.gridHeaderContainer=o,e.chartHeaderContainer=p,e.splitter=y,b.isInitializing=!0,m=c(t,i),Bt(e,r),"auto"!=b.style.height&&(k.availableHeight=b.clientHeight),G(S,n,i),oe(D,V,s,i),Ce(w,k,V,t,n,m,i),Ot(y,f,i),b.isInitializing=!1,Pt(t,b,i),b.scrollLeft=ne(i.displayedTime,i),p.scrollLeft!=b.scrollLeft&&(p.scrollLeft=b.scrollLeft),Lt(e,C,f,o,a,w,b,p,v,u,k,y,t,i);var L=!1,F=function(e,n){if(void 0===n&&(n=0),i.hourWidth!=e){L=!0;var s,r=b.scrollLeft,a=n,o=i.hourWidth;for(i.hourWidth=e,void 0!==i.hourWidthChangeHandler&&setTimeout((function(){i.hourWidthChangeHandler(i.hourWidth)}),0),x=ne(i.timelineFinish,i),D.style.width=x+"px",k.style.width=x+"px",V.style.width=x+"px",void 0!==b.chartExtraSpace&&(b.chartExtraSpace.style.width=x+"px"),s=D.childNodes.length;s-- >0;)D.removeChild(D.childNodes[s]);var l=[];for(s=V.childNodes.length;s-- >1;){var d=V.childNodes[s];d!=k.chartAreaAlternativeRows&&("Scale-Highlighting"!=d.tag&&"Scale-Highlighting-CurrentTime"!=d.tag&&"Scale-Separator"!=d.tag&&"Scale-Separator-CurrentTime"!=d.tag&&l.push(d),V.removeChild(d))}for(oe(D,V,i.scales,i),s=0;s<t.length;s++)d=t[s],(!i.isVirtualizing||void 0!==d.isVirtuallyVisible&&d.isVirtuallyVisible)&&ze(d.chartItem,d,i);for(s=l.length;s-- >0;)V.appendChild(l[s]);Me(k,be(t,i)),b.scrollLeft=a*(e/o)-(a-r),setTimeout((function(){L=!1}),200)}};return e.setHourWidth=F,(void 0===i.isMouseWheelZoomEnabled||i.isMouseWheelZoomEnabled)&&(V.addEventListener("mousewheel",n=function(t){if(t.preventDefault(),t.stopPropagation(),!L){var i=void 0!==t.wheelDelta?t.wheelDelta>=0?1:-1:void 0!==t.detail?-t.detail>=0?1:-1:0,n=e.settings,s=n.hourWidth,r=void 0!==n.isMouseWheelZoomEnabledMinHourWidth?n.isMouseWheelZoomEnabledMinHourWidth:1;i<0?s/=1.2*-i:i>0&&(s=1.2*s*i)>(i=void 0!==n.isMouseWheelZoomEnabledMaxHourWidth?n.isMouseWheelZoomEnabledMaxHourWidth:20)&&(s=i),s<r&&(s=r),F(s,t.offsetX)}},!1),V.addEventListener("DOMMouseScroll",n,!1)),e.isInitializing=!1,e.isInitialized=!0,e}alert("The required HTML5 features are not supported by the application host. Some features will be unavailable. Consider upgrading.")},a=function(e){r(e,e.items,e.settings,e.license)},o=function(e){if(void 0===e.dateTimePickerType&&(e.dateTimePickerType="text"),void 0===e.useDatePicker&&(e.useDatePicker=!0),void 0===e.useTimePicker&&(e.useTimePicker=!0),void 0===e.useResourceSelector&&(e.useResourceSelector=!0),void 0===e.useUpdatingToolTips&&(e.useUpdatingToolTips=!0),void 0===e.dateFormatter&&(e.dateFormatter=m),void 0===e.dateTimeFormatter&&(e.dateTimeFormatter=g),void 0===e.dateTimeParser&&(e.dateTimeParser=v),void 0===e.itemPropertyChangeHandler&&(e.itemPropertyChangeHandler=function(){}),void 0===e.target&&(e.target="Standard"),void 0===e.theme&&(e.theme="Modern"),void 0===e.isGridVisible)switch(e.target){default:e.isGridVisible=!0;break;case"Phone":e.isGridVisible=!1}void 0===e.interaction&&(e.interaction="Phone"!=e.target?"Standard":"TouchEnabled"),void 0===e.isSplitterEnabled&&(e.isSplitterEnabled=!0),void 0===e.isReadOnly&&(e.isReadOnly=!1),void 0===e.isGridReadOnly&&(e.isGridReadOnly=!1),void 0===e.isChartReadOnly&&(e.isChartReadOnly=!1),void 0===e.isContentReadOnly&&(e.isContentReadOnly=!1),void 0===e.isAssignmentsContentReadOnly&&(e.isAssignmentsContentReadOnly=!1),void 0===e.isIndividualItemNonworkingTimeHighlighted&&(e.isIndividualItemNonworkingTimeHighlighted=!1),void 0===e.areTaskInterruptionsHighlighted&&(e.areTaskInterruptionsHighlighted=!1),void 0===e.areTaskDependencyConstraintsEnabled&&(e.areTaskDependencyConstraintsEnabled=!1),void 0===e.selectionMode&&(e.selectionMode="Focus"),void 0===e.isVirtualizing&&(e.isVirtualizing=!0)},l=function(i,n,s){if(o(i),void 0===i.gridWidth&&(i.gridWidth="35%"),void 0===i.chartWidth&&(i.chartWidth=i.isGridVisible?"65%":"100%"),void 0===i.minGridWidth&&(i.minGridWidth=32),void 0===i.minColumnWidth&&(i.minColumnWidth=32),void 0===i.minChartWidth&&(i.minChartWidth=36),void 0===i.border)switch(i.theme){default:i.border="#e0e0e0";break;case"ModernBordered":case"Aero":i.border="#9a9a9a"}if(void 0===i.splitterWidth&&(i.splitterWidth=4),void 0===i.splitterBackground&&(i.splitterBackground=i.border),void 0===i.indentationLevelWidth&&(i.indentationLevelWidth=16),void 0===i.itemHeight&&(i.itemHeight=21),void 0===i.headerBackground&&(i.headerBackground="#f4f4f4"),void 0===i.headerHeight&&(i.headerHeight=42),void 0===i.columns&&(i.columns=b(n,i)),void 0===i.toggleButtonStyle&&null==i.toggleButtonClass&&(i.toggleButtonStyle="fill: Gray"),void 0===i.toggleButtonHoveringStyle&&null==i.toggleButtonHoveringClass&&(i.toggleButtonHoveringStyle="fill: Black"),void 0===i.collapsedToggleButtonTemplate&&(i.collapsedToggleButtonTemplate=Ie(s,i)),void 0===i.expandedToggleButtonTemplate&&(i.expandedToggleButtonTemplate=Ae(s,i)),void 0!==i.gridLines&&(void 0===i.horizontalGridLines&&(i.horizontalGridLines=i.gridLines),void 0===i.verticalGridLines&&(i.verticalGridLines=i.gridLines),void 0===i.horizontalChartLines&&(i.horizontalChartLines=i.gridLines)),void 0===i.itemStyle&&void 0!==i.horizontalGridLines&&(i.itemStyle="border-top: solid 1px "+i.horizontalGridLines+"; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box",void 0===i.cellStyle&&(i.cellStyle=void 0!==i.verticalGridLines?"border-right: solid 1px "+i.verticalGridLines+"; height: "+i.itemHeight+"px; padding-top: 2px; padding-left: 2px":"height: "+i.itemHeight+"px; padding-top: 2px")),void 0===i.cellStyle&&void 0!==i.verticalGridLines&&(i.cellStyle="border-right: solid 1px "+i.verticalGridLines+"; height: "+i.itemHeight+"px; padding-top: 3px; padding-left: 2px"),void 0===i.selectedItemStyle&&null==i.selectedItemClass)switch(i.theme){default:i.selectedItemStyle=void 0!==i.horizontalGridLines||void 0===i.verticalGridLines?"background-color: #f4f4f4; border-top: solid 1px "+(void 0!==i.horizontalGridLines?i.horizontalGridLines:"White")+"; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box":"background-color: #f4f4f4";break;case"Aero":i.selectedItemStyle=void 0!==i.horizontalGridLines||void 0===i.verticalGridLines?"background-color: LightBlue; border-top: solid 1px "+(void 0!==i.horizontalGridLines?i.horizontalGridLines:"White")+"; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box":"background-color: LightBlue"}if(void 0===i.summaryItemStyle&&null==i.summaryItemClass&&(i.summaryItemStyle="font-weight: bold"),void 0===i.daysOfWeek&&(i.daysOfWeek=e),void 0===i.months&&(i.months=t),void 0===i.weekStartDay&&(i.weekStartDay=0),void 0===i.currentTime)i.currentTime=new Date;else if("string"==typeof i.currentTime)try{i.currentTime=new Date(i.currentTime)}catch(p){i.currentTime=new Date(parseInt(i.currentTime))}if("string"==typeof i.displayedTime)try{i.displayedTime=new Date(i.displayedTime)}catch(m){i.displayedTime=new Date(parseInt(i.displayedTime))}if("string"==typeof i.timelineStart)try{i.timelineStart=new Date(i.timelineStart)}catch(g){i.timelineStart=new Date(parseInt(i.timelineStart))}if("string"==typeof i.timelineFinish)try{i.timelineFinish=new Date(i.timelineFinish)}catch(f){i.timelineFinish=new Date(parseInt(i.timelineFinish))}if(void 0===i.isRelativeToTimezone||i.isRelativeToTimezone){if(i.currentTime=new Date(i.currentTime.valueOf()-6e4*i.currentTime.getTimezoneOffset()),void 0!==i.displayedTime&&(i.displayedTime=new Date(i.displayedTime.valueOf()-6e4*i.displayedTime.getTimezoneOffset())),void 0!==i.timelineStart&&(i.timelineStart=new Date(i.timelineStart.valueOf()-6e4*i.timelineStart.getTimezoneOffset())),void 0!==i.timelineFinish&&(i.timelineFinish=new Date(i.timelineFinish.valueOf()-6e4*i.timelineFinish.getTimezoneOffset())),void 0!==i.scales)for(n=0;n<i.scales.length;n++){var r=i.scales[n];if(void 0!==r.intervals)for(var a=0;a<r.intervals.length;a++){var l=r.intervals[a];void 0!==l.start&&(l.start=new Date(l.start.valueOf()-6e4*l.start.getTimezoneOffset())),void 0!==l.finish&&(l.finish=new Date(l.finish.valueOf()-6e4*l.finish.getTimezoneOffset()))}}i.isRelativeToTimezone=!1}if(void 0!==i.schedule&&null!=i.schedule&&(i.schedule==i.previousSchedule&&i.schedule.workingWeekStart==i.previousSchedule.workingWeekStart||(i.workingWeekStart=i.schedule.workingWeekStart),i.schedule==i.previousSchedule&&i.schedule.workingWeekFinish==i.previousSchedule.workingWeekFinish||(i.workingWeekFinish=i.schedule.workingWeekFinish),i.schedule==i.previousSchedule&&i.schedule.workingDayStart==i.previousSchedule.workingDayStart||(i.visibleDayStart=i.schedule.workingDayStart),i.schedule==i.previousSchedule&&i.schedule.workingDayFinish==i.previousSchedule.workingDayFinish||(i.visibleDayFinish=i.schedule.workingDayFinish),i.schedule==i.previousSchedule&&i.schedule.specialNonworkingDays==i.previousSchedule.specialNonworkingDays||(i.specialNonworkingDays=i.schedule.specialNonworkingDays)),i.timelineStart=void 0===i.timelineStart?new Date(ee(i.currentTime,i.weekStartDay).valueOf()-6048e5):ee(i.timelineStart,i.weekStartDay),i.timelineFinish=void 0===i.timelineFinish?new Date(ee(i.currentTime,i.weekStartDay).valueOf()+320544e5):te(i.timelineFinish,i.weekStartDay),!i.isExport&&void 0!==i.specialNonworkingDays)for(n=0;n<i.specialNonworkingDays.length;n++)i.specialNonworkingDays[n]=q(new Date(i.specialNonworkingDays[n].valueOf()-6e4*(i.specialNonworkingDays[n].getTimezoneOffset()<0?i.specialNonworkingDays[n].getTimezoneOffset():0)));if(!i.isExport&&void 0!==i.resourceSchedules)for(r=0;r<i.resourceSchedules.length;r++)if(void 0!==(a=i.resourceSchedules[r].value).specialNonworkingDays)for(n=0;n<a.specialNonworkingDays.length;n++)a.specialNonworkingDays[n]=q(new Date(a.specialNonworkingDays[n].valueOf()-6e4*(a.specialNonworkingDays[n].getTimezoneOffset()<0?a.specialNonworkingDays[n].getTimezoneOffset():0)));if(void 0===i.scales&&(i.scales=re(i)),void 0===i.updateScale&&(i.updateScale=9e5),void 0===i.hourWidth&&(i.hourWidth=2.5),void 0===i.displayedTime&&(i.displayedTime=i.currentTime,setTimeout((function(){var e=s.chartContentContainer.scrollLeft-12*i.hourWidth;s.chartContentContainer.scrollLeft-e<s.chartContentContainer.clientWidth/3&&(s.chartContentContainer.scrollLeft=Math.max(0,e))}),0)),i.previousSchedule=i.schedule,void 0===i.visibleDayStart&&(i.visibleDayStart=288e5),void 0===i.visibleDayFinish&&(i.visibleDayFinish=576e5),i.visibleDayStart>=i.visibleDayFinish&&(i.visibleWeekStart=0,i.visibleWeekFinish=864e5),void 0===i.visibleWeekStart&&(i.visibleWeekStart=0),void 0===i.visibleWeekFinish&&(i.visibleWeekFinish=6),i.visibleWeekStart>i.visibleWeekFinish&&(i.visibleWeekStart==i.visibleWeekFinish+1?(i.visibleWeekStart=0,i.visibleWeekFinish=6):i.visibleWeekFinish=i.visibleWeekStart),void 0===i.workingWeekStart&&(i.workingWeekStart=1),void 0===i.workingWeekFinish&&(i.workingWeekFinish=5),i.workingWeekStart>i.workingWeekFinish&&(i.workingWeekStart==i.workingWeekFinish+1?(i.workingWeekStart=0,i.workingWeekFinish=6):i.workingWeekFinish=i.workingWeekStart),i.workingDayStart=i.visibleDayStart,i.workingDayFinish=i.visibleDayFinish,void 0===i.barMargin&&(i.barMargin=i.itemHeight/4),void 0===i.barHeight&&(i.barHeight=i.itemHeight-2*i.barMargin),void 0===i.barCornerRadius)switch(i.theme){default:i.barCornerRadius=0;break;case"Aero":i.barCornerRadius=3}if(void 0===i.completedBarMargin&&(i.completedBarMargin=i.barHeight/2.5),void 0===i.completedBarHeight&&(i.completedBarHeight=i.barHeight-2*i.completedBarMargin),"undefined"==typeof completedBarCornerRadius&&(i.completedBarCornerRadius=0),void 0===i.styleDefinitionTemplate&&(i.styleDefinitionTemplate=Je(s,i)),void 0===i.standardBarStyle&&null==i.standardBarClass)switch(i.theme){default:i.standardBarStyle="fill: #8abbed; fill-opacity: 0.8; stroke: #8abbed; stroke-width: 0.65px";break;case"ModernBordered":i.standardBarStyle="fill: #8abbed; fill-opacity: 0.8; stroke: Blue; stroke-width: 0.65px";break;case"Aero":i.standardBarStyle="fill: url(#BlueGradient); fill-opacity: 0.8; stroke: Blue"}if(void 0===i.standardCompletedBarStyle&&null==i.standardCompletedBarClass)switch(i.theme){default:i.standardCompletedBarStyle="fill: #3b87d9; stroke: #3b87d9; stroke-width: 0.65px";break;case"Aero":i.standardCompletedBarStyle="fill: #808080; stroke: #202020; stroke-width: 0.65px"}if(void 0===i.summaryBarStyle&&null==i.summaryBarClass)switch(i.theme){default:i.summaryBarStyle="fill: #607080; stroke: #607080; stroke-width: 0.65px";break;case"ModernBordered":i.summaryBarStyle="fill: #607080; stroke: #202020; stroke-width: 0.65px";break;case"Aero":i.summaryBarStyle="fill: url(#BlackGradient); stroke: Black"}if(void 0===i.collapsedSummaryLineStyle&&null==i.collapsedSummaryLineClass&&(i.collapsedSummaryLineStyle="stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2 2"),void 0===i.milestoneBarStyle&&null==i.milestoneBarClass)switch(i.theme){default:i.milestoneBarStyle="fill: #607080; stroke: #607080; stroke-width: 0.65px";break;case"ModernBordered":i.milestoneBarStyle="fill: #607080; stroke: #202020; stroke-width: 0.65px";break;case"Aero":i.milestoneBarStyle="fill: url(#BlackGradient); stroke: Black"}if(void 0===i.baselineBarStyle&&null==i.baselineBarClass)switch(i.theme){default:i.baselineBarStyle="fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2";break;case"Aero":i.baselineBarStyle="fill: none; stroke: Blue; stroke-dasharray: 2, 2"}if(void 0===i.dependencyPointerStyle&&null==i.dependencyPointerClass)switch(i.theme){default:i.dependencyPointerStyle="fill: #3b87d9; stroke: #3b87d9; stroke-width: 0.65px";break;case"Aero":i.dependencyPointerStyle="fill: Blue; stroke: Blue"}if(void 0===i.dependencyLineStyle&&null==i.dependencyLineClass)switch(i.theme){default:i.dependencyLineStyle="stroke: #3b87d9; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)";break;case"Aero":i.dependencyLineStyle="stroke: Blue; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)"}if(void 0===i.dependencyLineZoneStyle&&null==i.dependencyLineZoneClass&&(i.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none"),void 0===i.temporaryDependencyLineStyle&&null==i.temporaryDependencyLineClass)switch(i.theme){default:i.temporaryDependencyLineStyle="stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)";break;case"Aero":i.temporaryDependencyLineStyle="stroke: Blue; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)"}if(void 0===i.assignmentsStyle&&null==i.assignmentsClass&&(i.assignmentsStyle="stroke-width: 0.25px; font-size: x-small"),void 0===i.standardTaskTemplate&&(i.standardTaskTemplate=et()),void 0===i.summaryTaskTemplate&&(i.summaryTaskTemplate=tt()),void 0===i.milestoneTaskTemplate&&(i.milestoneTaskTemplate=it()),void 0!==i.horizontalChartLines){var d=i.internalPreTaskTemplate;i.internalPreTaskTemplate=function(e){if(void 0!==e.scheduleChartItem)return void 0!==d?d(e):null;var t=e.ganttChartView.ownerDocument,n=t.createElementNS("http://www.w3.org/2000/svg","g");void 0!==d&&n.appendChild(d(e));var s=t.createElementNS("http://www.w3.org/2000/svg","line");return s.setAttribute("x1",0),s.setAttribute("y1",-.5),s.setAttribute("x2",ne(i.timelineFinish,i)),s.setAttribute("y2",-.5),s.setAttribute("style","stroke: "+i.horizontalChartLines+"; stroke-width: 0.5px"),n.appendChild(s),e.index==e.ganttChartView.items.length-1&&((s=t.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",0),s.setAttribute("y1",i.itemHeight+.5),s.setAttribute("x2",ne(i.timelineFinish,i)),s.setAttribute("y2",i.itemHeight+.5),s.setAttribute("style","stroke: "+i.horizontalChartLines+"; stroke-width: 0.5px"),n.appendChild(s)),n}}if(void 0===i.isTaskToolTipVisible)switch(i.target){default:i.isTaskToolTipVisible=!0;break;case"Phone":i.isTaskToolTipVisible=!1}void 0===i.itemTemplate&&(i.itemTemplate=qe(i)),void 0===i.areTaskAssignmentsVisible&&(i.areTaskAssignmentsVisible=!0),void 0===i.assignmentsTemplate&&(i.assignmentsTemplate=$e()),void 0===i.isTaskCompletedEffortVisible&&(i.isTaskCompletedEffortVisible=!0),void 0===i.areTaskDependenciesVisible&&(i.areTaskDependenciesVisible=!0),void 0===i.dependencyLineTemplate&&(i.dependencyLineTemplate=nt()),void 0===i.isDependencyToolTipVisible&&(i.isDependencyToolTipVisible=i.isTaskToolTipVisible),void 0===i.predecessorItemTemplate&&(i.predecessorItemTemplate=st(i)),void 0===i.isDraggingTaskStartEndsEnabled&&(i.isDraggingTaskStartEndsEnabled=!0),void 0===i.areTaskDependencyConstraintsEnabledWhileDragging&&(i.areTaskDependencyConstraintsEnabledWhileDragging=!1),void 0===i.isTaskStartReadOnly&&(i.isTaskStartReadOnly=!1),void 0===i.isTaskEffortReadOnly&&(i.isTaskEffortReadOnly=!1),void 0===i.isTaskCompletionReadOnly&&(i.isTaskCompletionReadOnly=!1),void 0===i.areTaskPredecessorsReadOnly&&(i.areTaskPredecessorsReadOnly=!1),void 0===i.isBaselineVisible&&(i.isBaselineVisible=!0);var h=null;if(i.isIndividualItemNonworkingTimeHighlighted||i.areTaskInterruptionsHighlighted)for(n=0;n<i.scales.length;n++)if("NonworkingTime"==i.scales[n].scaleType){h=i.scales[n];break}if(null!=h&&i.isIndividualItemNonworkingTimeHighlighted){var c=i.internalPreTaskTemplate;i.internalPreTaskTemplate=function(e){if(void 0!==e.scheduleChartItem)return void 0!==c?c(e):null;var t;if(void 0===(t=Dt(e)))t=null;else{var n,s,r=[];for(n=fe(i.timelineStart,void 0!==t.workingWeekStart?t.workingWeekFinish:i.workingWeekFinish),s=ve(n,void 0!==t.workingWeekFinish?t.workingWeekStart:i.workingWeekStart);n<i.timelineFinish;n=ue(n),s=ue(s))r.push({start:n,finish:s});if(void 0!==t.specialNonworkingDays)for(var a=0;a<t.specialNonworkingDays.length;a++)s=he(n=t.specialNonworkingDays[a]),r.push({start:n,finish:s});t=r}if(null==t||0==t.length)return void 0!==c?c(e):null;for(n=(r=e.ganttChartView.ownerDocument).createElementNS("http://www.w3.org/2000/svg","g"),s=0;s<t.length;s++){var o=(a=t[s]).finish;if(a=ne(a.start,i),!((o=ne(o,i)-a)<=0)){var l=r.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("x",a-1),l.setAttribute("y",0),l.setAttribute("width",o),l.setAttribute("height",i.itemHeight),l.setAttribute("class",h.highlightingClass),l.setAttribute("style",h.highlightingStyle),n.appendChild(l)}}return void 0!==c&&n.appendChild(c(e)),n}}if(null!=h&&i.areTaskInterruptionsHighlighted){var u=i.internalExtraTaskTemplate;i.internalExtraTaskTemplate=function(e){if(void 0!==e.scheduleChartItem)return void 0!==u?u(e):null;var t;if(e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)||e.isMilestone)t=null;else{var n,s,r=Dt(e);for(t=[],n=fe(q(e.start),void 0!==r&&void 0!==r.workingWeekStart?r.workingWeekFinish:i.workingWeekFinish),s=ve(n,void 0!==r&&void 0!==r.workingWeekFinish?r.workingWeekStart:i.workingWeekStart);n<e.finish;n=ue(n),s=ue(s))t.push({start:n>=e.start?n:e.start,finish:s<=e.finish?s:e.finish});if(void 0!==(r=void 0!==r&&void 0!==r.specialNonworkingDays?r.specialNonworkingDays:i.specialNonworkingDays))for(var a=0;a<r.length;a++)s=he(n=r[a]),n>=e.start&&s<=e.finish&&t.push({start:n,finish:s})}if(null==t||0==t.length)return void 0!==u?u(e):null;for(s=(n=e.ganttChartView.ownerDocument).createElementNS("http://www.w3.org/2000/svg","g"),r=0;r<t.length;r++){var o=(a=t[r]).finish;if(a=ne(a.start,i),!((o=ne(o,i)-a)<=0)){var l=n.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("x",a-1),l.setAttribute("y",i.barMargin),l.setAttribute("width",o),l.setAttribute("height",i.barHeight),l.setAttribute("class",h.highlightingClass),l.setAttribute("style",h.highlightingStyle),s.appendChild(l)}}return void 0!==u&&s.appendChild(u(e)),s}}},d=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if("string"==typeof n&&(e[i]=n={content:n}),"string"==typeof n.indentation&&(n.indentation=parseInt(n.indentation)),"string"==typeof n.isExpanded&&(n.isExpanded="true"==n.isExpanded.toLowerCase()),"string"==typeof n.start){try{n.start=new Date(n.start)}catch(o){n.start=new Date(parseInt(n.start))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(n.start=new Date(n.start.valueOf()+6e4*n.start.getTimezoneOffset())),n.preferredStart=n.start}if("string"==typeof n.finish){try{n.finish=new Date(n.finish)}catch(l){n.finish=new Date(parseInt(n.finish))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(n.finish=new Date(n.finish.valueOf()+6e4*n.finish.getTimezoneOffset()))}if("string"==typeof n.completedFinish){try{n.completedFinish=new Date(n.completedFinish)}catch(d){n.completedFinish=new Date(parseInt(n.completedFinish))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(n.completedFinish=new Date(n.completedFinish.valueOf()+6e4*n.completedFinish.getTimezoneOffset()))}if("string"==typeof n.isMilestone&&(n.isMilestone="true"==n.isMilestone.toLowerCase()),"string"==typeof n.baselineStart){try{n.baselineStart=new Date(n.baselineStart)}catch(h){n.baselineStart=new Date(parseInt(n.baselineStart))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(n.baselineStart=new Date(n.baselineStart.valueOf()+6e4*n.baselineStart.getTimezoneOffset()))}if("string"==typeof n.baselineFinish){try{n.baselineFinish=new Date(n.baselineFinish)}catch(c){n.baselineFinish=new Date(parseInt(n.baselineFinish))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(n.baselineFinish=new Date(n.baselineFinish.valueOf()+6e4*n.baselineFinish.getTimezoneOffset()))}if("string"==typeof n.minStart){try{n.minStart=new Date(n.minStart)}catch(u){n.minStart=new Date(parseInt(n.minStart))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(n.minStart=new Date(n.minStart.valueOf()+6e4*n.minStart.getTimezoneOffset()))}if("string"==typeof n.maxStart){try{n.maxStart=new Date(n.maxStart)}catch(p){n.maxStart=new Date(parseInt(n.maxStart))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(n.maxStart=new Date(n.maxStart.valueOf()+6e4*n.maxStart.getTimezoneOffset()))}if("string"==typeof n.minFinish){try{n.minFinish=new Date(n.minFinish)}catch(m){n.minFinish=new Date(parseInt(n.minFinish))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(n.minFinish=new Date(n.minFinish.valueOf()+6e4*n.minFinish.getTimezoneOffset()))}if("string"==typeof n.maxFinish){try{n.maxFinish=new Date(n.maxFinish)}catch(g){n.maxFinish=new Date(parseInt(n.maxFinish))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(n.maxFinish=new Date(n.maxFinish.valueOf()+6e4*n.maxFinish.getTimezoneOffset()))}if(void 0!==n.predecessors){"string"==typeof n.predecessors&&(n.predecessors=n.predecessors.split(","));for(var s=0;s<n.predecessors.length;s++){var r=n.predecessors[s];if("string"==typeof r&&(n.predecessors[s]=r={item:r}),"string"==typeof r.item){var a=parseInt(r.item)-1;r.item=a>=0&&a<e.length?e[a]:null}"string"==typeof r.lag&&(r.lag=parseFloat(r.lag))}}if(void 0!==n.schedule&&void 0!==n.schedule.specialNonworkingDays)for(s=0;s<n.schedule.specialNonworkingDays.length;s++)n.schedule.specialNonworkingDays[s]=q(new Date(n.schedule.specialNonworkingDays[s].valueOf()-6e4*n.schedule.specialNonworkingDays[s].getTimezoneOffset()));void 0!==n.wasGridItemContentLoaded&&delete n.wasGridItemContentLoaded}},h=function(e,t,i){var n;if(e.isContentHeightInitialized&&e.isContentHeightAuto)n=t.length>0?"auto":i.itemHeight+"px";else{var s=e.clientHeight-i.headerHeight-2;s<0&&(s=0),n=s+"px",s<i.itemHeight&&(e.isContentHeightInitialized||(e.isContentHeightAuto=!0),n=t.length>0?"auto":i.itemHeight+"px"),e.isContentHeightInitialized=!0}return n},c=function(e,t){if(void 0!==t.toggleButtonAreaWidth)return t.toggleButtonAreaWidth;var i=0;if(t.isGridVisible)for(var n=0;n<e.length;n++)if(e[n].indentation>0){i=16;break}return t.toggleButtonAreaWidth=i},u=function(e,t){var i=e.createElement("span");return i.innerHTML=t,i},p=function(e,t){return e.createTextNode(1==t?"✓":"")},m=function(e){var t=e.getFullYear(),i=e.getMonth()+1;return i<10&&(i="0"+i),(e=e.getDate())<10&&(e="0"+e),i+"/"+e+"/"+t},g=function(e){var t=m(e),i=e.getHours();return i<10&&(i="0"+i.toString()),(e=e.getMinutes())<10&&(e="0"+e.toString()),t+" "+i+":"+e},f=function(e){return new Date(e.valueOf()+6e4*e.getTimezoneOffset())},v=function(e){var t,n,s,r,a,o=new Date;if(null==e||""==e)return o;if((s=e.indexOf(" "))>=0?(t=e.substr(0,s),r=e.substr(s+1)):(t=e,r="0"),(s=t.indexOf("/"))>=0){for(e=t.substr(0,s);e.length>0&&"0"==e.substr(0,1);)e=e.substr(1);if(e=parseInt(e)-1,(s=(t=t.substr(s+1)).indexOf("/"))>=0){for(n=t.substr(0,s),s=t.substr(s+1);s.length>0&&"0"==s.substr(0,1);)s=s.substr(1);t=parseInt(s)}else n=t,t=o.getFullYear();for(;n.length>0&&"0"==n.substr(0,1);)n=n.substr(1);n=parseInt(n)}else{for(;t.length>0&&"0"==t.substr(0,1);)t=t.substr(1);n=parseInt(t),e=o.getMonth(),t=o.getFullYear()}for((s=r.indexOf(":"))>=0?(a=r.substr(0,s),r=r.substr(s+1)):(a=r,r="0");a.length>1&&"0"==a.substr(0,1);)a=a.substr(1);for(s=parseInt(a);r.length>1&&"0"==r.substr(0,1);)r=r.substr(1);return r=parseInt(r),isNaN(t)||isNaN(e)||isNaN(n)||t<=0||e<0||e>=12||n<1||n>i[e]+(1!=e||t%400!=0&&(t%100==0||t%4!=0)?0:1)?isNaN(s)||isNaN(r)||s<0||s>=24||r<0||r>=60?o:new Date(o.getFullYear(),o.getMonth(),o.getDate(),s,r,0,0):isNaN(s)||isNaN(r)||s<0||s>=24||r<0||r>=60?new Date(t,e,n,0,0,0,0):new Date(t,e,n,s,r,0,0)},y=function(e){return new Date(e.valueOf()-6e4*e.getTimezoneOffset())},C=function(e,t){var i=e.ownerDocument,n=i.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("style","width: 12px; height: 12px"),n.setAttribute("focusable","false"),(i=i.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("id","PART_Border"),i.setAttribute("width","12"),i.setAttribute("height","12"),i.setAttribute("style","fill: White; fill-opacity: 0"),n.appendChild(i),e.setAttribute("id","PART_Button"),void 0!==t.toggleButtonClass&&e.setAttribute("class",t.toggleButtonClass),void 0!==t.toggleButtonStyle&&e.setAttribute("style",t.toggleButtonStyle),n.appendChild(e),n},b=function(e,t){"object"!=typeof t&&(t={}),o(t);var i=[{header:"",width:32,isSelection:!0},{header:"Task",width:140,isTreeView:!0},{header:"Start",width:140},{header:"Finish",width:140},{header:"Milestone",width:80},{header:"Completed",width:80},{header:"Assignments",width:200}];return i[0].cellTemplate=S(t,i[0],e),i[1].cellTemplate=D(t,i[1],e),i[1].exportCellTemplate=D(t,i[1],e,!1),i[2].cellTemplate=E(t,i[2]),i[2].exportCellTemplate=E(t,i[2],!1),i[3].cellTemplate=A(t,i[3]),i[3].exportCellTemplate=A(t,i[3],!1),i[4].cellTemplate=P(t,i[4]),i[4].exportCellTemplate=P(t,i[4],!1),i[5].cellTemplate=W(t,i[5]),i[5].exportCellTemplate=W(t,i[5],!1),i[6].cellTemplate=M(t,i[6]),i[6].exportCellTemplate=M(t,i[6],!1),"Single"!=t.selectionMode&&"Extended"!=t.selectionMode&&"ExtendedFocus"!=t.selectionMode&&i.splice(0,1),i},S=function(e,t,i){return function(n){return t.isReadOnly?p(n.ganttChartView.ownerDocument,n.isSelected):w(n,e,i)}},w=function(e,t){var i,n=e.ganttChartView.ownerDocument;void 0===e.selectionInput?(i=n.createElement("input"),e.selectionInput=i,i.type="checkbox",i.setAttribute("style","margin: 0px")):i=e.selectionInput,e.isSelected?(i.setAttribute("checked","checked"),i.checked||(i.checked=!0)):i.checked&&(i.checked=!1);var s=function(){T(e,!!i.checked,t.selectionMode)};return void 0!==i.changeEventListener&&i.removeEventListener("change",i.changeEventListener,!0),i.addEventListener("change",s,!0),i.changeEventListener=s,n=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),s())},void 0!==i.keyPressEventListener&&i.removeEventListener("keypress",i.keyPressEventListener,!0),i.addEventListener("keypress",n,!0),i.keyPressEventListener=n,i},T=function(e,t,i){var n;if(e.isSelected=t,at(e,"isSelected",!0,!0),ke(e),void 0!==e.ganttChartView&&(e.ganttChartView.selectedItem=e,"Extended"!=i&&"ExtendedFocus"!=i&&(e.ganttChartView.selectedItems=[e]),"Extended"!=i&&"ExtendedFocus"!=i))for(n=0;n<e.ganttChartView.items.length;n++)(t=e.ganttChartView.items[n])!=e&&t.isSelected&&(t.isSelected=!1,at(t,"isSelected",!1,!0),ke(t));if(void 0!==e.ganttChartView&&("Extended"==i||"ExtendedFocus"==i)){for(i=[],n=0;n<e.ganttChartView.items.length;n++)(t=e.ganttChartView.items[n]).isSelected&&i.push(t);e.ganttChartView.selectedItems=i}},x=function(e,t){void 0!==e.ganttChartView&&(e.ganttChartView.currentItem=e),"Focus"!=t.selectionMode&&"ExtendedFocus"!=t.selectionMode||(void 0!==e.scheduleChartItem&&(e=e.scheduleChartItem),e.isSelected||T(e,!0,t.selectionMode))},D=function(e,t,i,n){var s=function(e){return u(e.ganttChartView.ownerDocument,e.content)};return void 0!==n&&!n||e.isReadOnly||e.isGridReadOnly||e.isContentReadOnly?s:function(i){return t.isReadOnly||void 0!==i.isReadOnly&&i.isReadOnly?s(i):k(i,Math.max(0,t.width-i.indentation*i.ganttChartView.settings.indentationLevelWidth-i.ganttChartView.settings.toggleButtonAreaWidth-16),e)}},k=function(e,t,i){var n,s=e.ganttChartView.ownerDocument;if(void 0===e.contentInput){n=s.createElement("input"),e.contentInput=n,n.type="text",n.addEventListener("focus",(function(){x(e,i)}),!1);var r=function(){e.content=n.value,at(e,"content",!0,!0),Ge(e)};void 0!==n.changeEventListener&&n.removeEventListener("change",n.changeEventListener,!0),n.addEventListener("change",r,!0),n.changeEventListener=r,s=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),r())},void 0!==n.keyPressEventListener&&n.removeEventListener("keypress",n.keyPressEventListener,!0),n.addEventListener("keypress",s,!0),n.keyPressEventListener=s,n.addEventListener("focus",(function(){n.style.backgroundColor="White"}),!1),n.addEventListener("blur",(function(){n.style.backgroundColor="Transparent"}),!1)}else n=e.contentInput;return n.value=e.content,s="",e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)&&(s="; font-weight: bold"),n.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"+s),n},E=function(e,t,i){var n=function(t){return t.ganttChartView.ownerDocument.createTextNode(void 0===t.start||void 0!==t.isSummaryEnabled&&!t.isSummaryEnabled&&void 0!==t.isBarVisible&&!t.isBarVisible?"":e.dateTimeFormatter(f(t.start)))};return void 0!==i&&!i||e.isReadOnly||e.isGridReadOnly?n:function(i){return t.isReadOnly||void 0!==i.isReadOnly&&i.isReadOnly||void 0!==i.isSummaryEnabled&&!i.isSummaryEnabled&&void 0!==i.isBarVisible&&!i.isBarVisible?n(i):I(i,Math.max(0,t.width-16),e)}},I=function(e,t,i){var n,s=e.ganttChartView.ownerDocument;if(void 0===e.startInput){n=s.createElement("input"),e.startInput=n;try{n.type=i.dateTimePickerType}catch(o){n.type="text"}n.addEventListener("focus",(function(){x(e,i)}),!1),n.addEventListener("focus",(function(){n.style.backgroundColor="White"}),!1),n.addEventListener("blur",(function(){n.style.backgroundColor="Transparent"}),!1)}else n=e.startInput;void 0!==e.start&&(n.value=i.dateTimeFormatter(f(e.start))),DlhSoft.Controls.DatePicker&&"text"==i.dateTimePickerType&&i.useDatePicker&&n.addEventListener("focus",(function(){if(!e.isWaitingToRefreshGridItem){var t=(i.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).get(n);if(!t||!t.isOpen){var a=0,o=0;try{a=n.selectionStart,o=n.selectionEnd}catch(r){}(t=(i.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).initialize(n,void 0,{inputStyle:null,isDropDownButtonVisible:!1,defaultTimeOfDay:i.workingDayStart,dateTimeFormatter:i.dateTimeFormatter,dateTimeParser:i.dateTimeParser,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid "+i.border,disabledDateSelector:H(i),disabledTimeSelector:L(i),calendarSelectorLevels:i.calendarSelectorLevels,months:i.months,daysOfWeek:O(i.daysOfWeek)},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout((function(){try{n.selectionStart=a,n.selectionEnd=o}catch(e){}}),100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout((function(){try{n.focus()}catch(e){}}),100):s.createEvent&&setTimeout((function(){var e=s.createEvent("MouseEvents");e.initEvent("blur",!0,!1),n.dispatchEvent(e)}))}}}),!0);var r="";e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)&&(r="; font-weight: bold"),n.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"+r),e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)?n.setAttribute("disabled","true"):n.removeAttribute("disabled");var a=function(){if(!e.hasChildren||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled){var t,s,r=e.completedFinish>e.start;i.isTaskEffortPreservedWhenStartChangesInGrid&&(t=ni(e,i),s=si(e,i)),e.start=ft(y(i.dateTimeParser(n.value)),i,!0,e.isMilestone,Dt(e)),e.preferredStart=e.start,at(e,"start",!0,!0),e.finish<e.start&&(e.finish=e.start,at(e,"finish",!1,!0)),e.completedFinish<e.start||!r?(e.completedFinish=e.start,at(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,at(e,"completedFinish",!1,!0)),void 0!==e.completedInput&&(void 0!==(r=e.completedInput).changeEventListener&&r.removeEventListener("change",r.changeEventListener,!0),delete e.completedInput),i.isTaskEffortPreservedWhenStartChangesInGrid&&(ri(e,t,i),ai(e,s,i))}Ue(e)};return void 0!==n.changeEventListener&&n.removeEventListener("change",n.changeEventListener,!0),n.addEventListener("change",a,!0),n.changeEventListener=a,t=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),a())},void 0!==n.keyPressEventListener&&n.removeEventListener("keypress",n.keyPressEventListener,!0),n.addEventListener("keypress",t,!0),n.keyPressEventListener=t,n},A=function(e,t,i){var n=function(t){return void 0===t.finish||void 0!==t.isMilestone&&1==t.isMilestone&&void 0!==t.start&&t.finish.valueOf()==t.start.valueOf()||void 0!==t.isSummaryEnabled&&!t.isSummaryEnabled&&void 0!==t.isBarVisible&&!t.isBarVisible?t.ganttChartView.ownerDocument.createTextNode(""):t.ganttChartView.ownerDocument.createTextNode(e.dateTimeFormatter(f(t.finish)))};return void 0!==i&&!i||e.isReadOnly||e.isGridReadOnly?n:function(i){return t.isReadOnly||void 0!==i.isReadOnly&&i.isReadOnly||void 0!==i.isSummaryEnabled&&!i.isSummaryEnabled&&void 0!==i.isBarVisible&&!i.isBarVisible?n(i):V(i,Math.max(0,t.width-16),e)}},V=function(e,t,i){var n,s=e.ganttChartView.ownerDocument;if(void 0===e.finishInput){n=s.createElement("input"),e.finishInput=n;try{n.type=i.dateTimePickerType}catch(l){n.type="text"}n.addEventListener("focus",(function(){x(e,i)}),!1),n.addEventListener("focus",(function(){n.style.backgroundColor="White"}),!1),n.addEventListener("blur",(function(){n.style.backgroundColor="Transparent"}),!1)}else n=e.finishInput;void 0!==e.finish&&(n.value=i.dateTimeFormatter(f(e.finish))),DlhSoft.Controls.DatePicker&&"text"==i.dateTimePickerType&&i.useDatePicker&&n.addEventListener("focus",(function(){if(!e.isWaitingToRefreshGridItem){var t=(i.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).get(n);if(!t||!t.isOpen){var r=0,a=0;try{r=n.selectionStart,a=n.selectionEnd}catch(o){}(t=(i.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).initialize(n,void 0,{inputStyle:null,isDropDownButtonVisible:!1,defaultTimeOfDay:i.workingDayFinish,dateTimeFormatter:i.dateTimeFormatter,dateTimeParser:i.dateTimeParser,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid "+i.border,disabledDateSelector:H(i),disabledTimeSelector:F(i,e),calendarSelectorLevels:i.calendarSelectorLevels,months:i.months,daysOfWeek:O(i.daysOfWeek)},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout((function(){try{n.selectionStart=r,n.selectionEnd=a}catch(e){}}),100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout((function(){try{n.focus()}catch(e){}}),100):s.createEvent&&setTimeout((function(){var e=s.createEvent("MouseEvents");e.initEvent("blur",!0,!1),n.dispatchEvent(e)}))}}}),!0);var r="";void 0!==e.isMilestone&&1==e.isMilestone&&(r="; visibility: hidden");var a="";e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)&&(a="; font-weight: bold"),n.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"+r+a),e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)?n.setAttribute("disabled","true"):n.removeAttribute("disabled");var o=function(){if(!e.hasChildren||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled){var t=y(i.dateTimeParser(n.value));n.value.length>0&&n.value.indexOf(" ")<0&&0==$(t)&&(t=he(t)),e.finish=ft(t,i,e.isMilestone,!0,Dt(e)),e.finish<e.start&&(e.finish=e.start),at(e,"finish",!0,!0),e.completedFinish<e.start?(e.completedFinish=e.start,at(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,at(e,"completedFinish",!1,!0)),void 0!==e.completedInput&&(void 0!==(t=e.completedInput).changeEventListener&&t.removeEventListener("change",t.changeEventListener,!0),delete e.completedInput)}Ue(e)};return void 0!==n.changeEventListener&&n.removeEventListener("change",n.changeEventListener,!0),n.addEventListener("change",o,!0),n.changeEventListener=o,t=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),o())},void 0!==n.keyPressEventListener&&n.removeEventListener("keypress",n.keyPressEventListener,!0),n.addEventListener("keypress",t,!0),n.keyPressEventListener=t,n},H=function(e){return function(t){if(t.getDay()<e.workingWeekStart||t.getDay()>e.workingWeekFinish)return!0;if(t=y(t).valueOf(),e.specialNonworkingDays)for(var i=0;i<e.specialNonworkingDays.length;i++)if(t==e.specialNonworkingDays[i].valueOf())return!0;return!1}},L=function(e){return function(t){return t<e.visibleDayStart||t>=e.visibleDayFinish}},F=function(e,t){return function(i){return(q(t.start)<q(t.finish)?i<=e.visibleDayStart:i<e.visibleDayStart)||i>e.visibleDayFinish}},O=function(e){if(e){for(var t=[],i=0;i<e.length;i++){var n=(n=e[i]).length>0?n[0].toUpperCase()+(n.length>1?n[1]:""):"";t.push(n)}return t}},P=function(e,t,i){var n=function(e){return void 0===e.isMilestone||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled&&void 0!==e.isBarVisible&&!e.isBarVisible?e.ganttChartView.ownerDocument.createTextNode(""):p(e.ganttChartView.ownerDocument,e.isMilestone)};return void 0!==i&&!i||e.isReadOnly||e.isGridReadOnly?n:function(i){return t.isReadOnly||void 0!==i.isReadOnly&&i.isReadOnly||void 0!==i.isSummaryEnabled&&!i.isSummaryEnabled&&void 0!==i.isBarVisible&&!i.isBarVisible?n(i):B(i,e)}},B=function(e,t){var i,n=e.ganttChartView.ownerDocument;if(void 0===e.milestoneInput?(i=n.createElement("input"),e.milestoneInput=i,i.type="checkbox",i.setAttribute("style","margin: 0px; margin-left: 2px; margin-right: 2px"),i.addEventListener("focus",(function(){x(e,t)}),!1)):i=e.milestoneInput,e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)||void 0===e.isMilestone||!e.isMilestone?i.removeAttribute("checked"):i.setAttribute("checked",!0),!e.hasChildren||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled){var s=function(){i.checked?(e.isMilestone=!0,at(e,"isMilestone",!0,!0),e.finish>e.start&&(e.finish=e.start,at(e,"finish",!1,!0)),e.completedFinish>e.start&&(e.completedFinish=e.start,at(e,"completedFinish",!1,!0))):(e.isMilestone=!1,at(e,"isMilestone",!0,!0)),Ue(e)};void 0!==i.changeEventListener&&i.removeEventListener("change",i.changeEventListener,!0),i.addEventListener("change",s,!0),i.changeEventListener=s,n=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),s())},void 0!==i.keyPressEventListener&&i.removeEventListener("keypress",i.keyPressEventListener,!0),i.addEventListener("keypress",n,!0),i.keyPressEventListener=n}else i.setAttribute("style","visibility: hidden");return i},M=function(e,t,i){var n=function(e){return void 0===e.assignmentsContent||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled&&void 0!==e.isBarVisible&&!e.isBarVisible?e.ganttChartView.ownerDocument.createTextNode(""):u(e.ganttChartView.ownerDocument,e.assignmentsContent)};return void 0!==i&&!i||e.isReadOnly||e.isGridReadOnly||e.isAssignmentsContentReadOnly?n:function(i){return t.isReadOnly||void 0!==i.isReadOnly&&i.isReadOnly||void 0!==i.isSummaryEnabled&&!i.isSummaryEnabled&&void 0!==i.isBarVisible&&!i.isBarVisible?n(i):R(i,Math.max(0,t.width-16),e)}},R=function(e,t,i){var n,s=e.ganttChartView,r=s.ownerDocument;if(void 0===e.assignmentsContentInput){n=r.createElement("input"),e.assignmentsContentInput=n,n.type="text",n.addEventListener("focus",(function(){x(e,i)}),!1);var a=function(){e.assignmentsContent=n.value,at(e,"assignmentsContent",!0,!0),!e.hasChildren&&e.hasFixedEffort&&(e.fixedEffort=ni(e,i),e.fixedEffortAssignments=hi(e)),_e(e);var t=null;if(DlhSoft.Controls.MultiSelectorComboBox&&(t=DlhSoft.Controls.MultiSelectorComboBox.get(n)),null!=t&&t.availableChoices.length>0)var s=setInterval((function(){t.isOpen||r.activeElement==e.assignmentsContentInput||(clearInterval(s),Ue(e))}),100);else Ue(e)};void 0!==n.changeEventListener&&n.removeEventListener("change",n.changeEventListener,!0),n.addEventListener("change",(function(e){n.dontAutoFocus=!0,a()}),!0),n.changeEventListener=a;var o=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),void 0!==n.dontAutoFocus&&delete n.dontAutoFocus,a())};void 0!==n.keyPressEventListener&&n.removeEventListener("keypress",n.keyPressEventListener,!0),n.addEventListener("keypress",o,!0),n.keyPressEventListener=o,n.addEventListener("focus",(function(){n.style.backgroundColor="White"}),!1),n.addEventListener("blur",(function(){n.style.backgroundColor="Transparent"}),!1)}else n=e.assignmentsContentInput;return void 0!==e.assignmentsContent&&(n.value=e.assignmentsContent),DlhSoft.Controls.MultiSelectorComboBox&&i.useResourceSelector&&n.addEventListener("focus",(function(){if(!e.isWaitingToRefreshGridItem){var t=DlhSoft.Controls.MultiSelectorComboBox.get(n);if(!t||!t.isOpen&&t.availableChoices.length>0){void 0===(t=i.assignableResources)&&(t=pi(s.items),i.assignableResources=t);var o=0,l=0;try{o=n.selectionStart,l=n.selectionEnd}catch(a){}(t=DlhSoft.Controls.MultiSelectorComboBox.initialize(n,t,void 0,{inputStyle:null,autoAppendAvailableChoices:i.autoAppendAssignableResources,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; color: Black; border: 1px solid "+i.border+"; font-size: small; max-height: 188px; overflow-y: auto"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout((function(){try{n.selectionStart=o,n.selectionEnd=l}catch(e){}}),100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout((function(){try{n.focus()}catch(e){}}),100):r.createEvent&&setTimeout((function(){var e=r.createEvent("MouseEvents");e.initEvent("blur",!0,!1),n.dispatchEvent(e)}))}}}),!0),o="",e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)&&(o="; font-weight: bold"),n.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"+o),n},W=function(e,t,i){var n=function(e){return void 0===e.start||void 0===e.finish||e.finish.valueOf()==e.start.valueOf()||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled&&void 0!==e.isBarVisible&&!e.isBarVisible?e.ganttChartView.ownerDocument.createTextNode(""):p(e.ganttChartView.ownerDocument,e.ganttChartView.isItemCompleted(e))};return void 0!==i&&!i||e.isReadOnly||e.isGridReadOnly?n:function(i){return t.isReadOnly||void 0!==i.isReadOnly&&i.isReadOnly||i.hasChildren&&(void 0===i.isSummaryEnabled||i.isSummaryEnabled)||void 0!==i.isSummaryEnabled&&!i.isSummaryEnabled&&void 0!==i.isBarVisible&&!i.isBarVisible?n(i):z(i,e)}},z=function(e,t){var i,n=e.ganttChartView.ownerDocument;void 0===e.completedInput?(i=n.createElement("input"),e.completedInput=i,i.type="checkbox",i.setAttribute("style","margin: 0px; margin-left: 2px; margin-right: 2px"),i.addEventListener("focus",(function(){x(e,t)}),!1)):i=e.completedInput,e.isSetAsCompleted||(!e.hasChildren||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled)&&e.completedFinish>=e.finish&&e.finish>e.start&&(void 0===e.isMilestone||!e.isMilestone)?i.setAttribute("checked",!0):i.removeAttribute("checked"),e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)&&i.setAttribute("style","visibility: hidden");var s=function(){i.checked?(e.completedFinish<e.finish&&(e.completedFinish=e.finish,at(e,"completedFinish",!0,!0)),(e.isMilestone||e.finish.valueOf()<=e.start.valueOf())&&(e.isSetAsCompleted=!0)):(e.completedFinish>e.start&&(e.completedFinish=e.start,at(e,"completedFinish",!0,!0)),(e.isMilestone||e.finish.valueOf()<=e.start.valueOf())&&(e.isSetAsCompleted=!1)),Ue(e)};return void 0!==i.changeEventListener&&i.removeEventListener("change",i.changeEventListener,!0),i.addEventListener("change",s,!0),i.changeEventListener=s,n=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),s())},void 0!==i.keyPressEventListener&&i.removeEventListener("keypress",i.keyPressEventListener,!0),i.addEventListener("keypress",n,!0),i.keyPressEventListener=n,i},N=function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i].width;return t},_=function(e,t,i){for(var n=c(t.items,i),s=0;s<e.length;s++){var r=e[s];r.ganttChartView=t,void 0===r.width&&(r.width=100),void 0===r.minWidth&&(r.minWidth=Math.min(r.width,i.minColumnWidth+(r.isTreeView?n:0))),void 0===r.maxWidth&&(r.maxWidth=i.maxColumnWidth),void 0===r.cellTemplate&&(r.cellTemplate=function(e){return u(e.ganttChartView.ownerDocument,e.content)}),i.verticalGridLines&&(r.minWidth<4&&(r.minWidth=4),r.width<r.minWidth&&(r.width=r.minWidth))}},G=function(e,t,i){var n=e.ownerDocument,s=n.createElement("div");void 0!==i.columnHeaderClass&&s.setAttribute("class",i.columnHeaderClass),void 0!==i.columnHeaderStyle&&s.setAttribute("style",i.columnHeaderStyle);for(var r=0;r<t.length;r++)s.appendChild(Y(n,t[r],i));e.appendChild(s)},Y=function(e,t,i){var n=e.createElement("div");n.setAttribute("style","overflow-y: hidden; vertical-align: middle; display: table-cell; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: "+i.headerHeight+"px");var s=e.createElement("div"),r=t.width>=4?2:t.width/2;if(s.setAttribute("style","padding-left: "+r+"px; padding-right: "+r+"px; overflow-x: hidden; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+t.width+"px"),r=e.createElement("div"),void 0!==t.headerClass&&r.setAttribute("class",t.headerClass),void 0!==t.headerStyle&&r.setAttribute("style",t.headerStyle),r.appendChild(u(e,t.header)),s.appendChild(r),n.appendChild(s),t.width>=1&&(void 0===i.allowUserToResizeColumns||i.allowUserToResizeColumns)&&(void 0===t.allowUserToResize||t.allowUserToResize)){n.isGripperVisible=!1;var a=t.ganttChartView,o=function(e){n.isGripperVisible=e,n.style.cursor=e?"e-resize":"default",n.style.borderRight=e?"solid 1px "+i.border:i.verticalGridLines?"solid 1px "+i.verticalGridLines:"",s.style.width=t.width-(n.style.borderRight?1:0)+"px"};i.verticalGridLines&&o();var l=i.splitterWidth;n.addEventListener("mouseover",(function(e){DlhSoft.Controls.GanttChartView.isGripperDragging||n.isGripperDragging||void 0===e.offsetX&&e.currentTarget!=n||o((void 0!==e.offsetX?e.offsetX:e.layerX-e.currentTarget.offsetLeft)>=t.width-l)}),!0),n.addEventListener("mousemove",(function(e){DlhSoft.Controls.GanttChartView.isGripperDragging||n.isGripperDragging||void 0===e.offsetX&&e.currentTarget!=n||o((void 0!==e.offsetX?e.offsetX:e.layerX-e.currentTarget.offsetLeft)>=t.width-l)}),!0),s.addEventListener("mouseover",(function(e){!DlhSoft.Controls.GanttChartView.isGripperDragging&&!n.isGripperDragging&&void 0===e.offsetX&&e.currentTarget==s&&o(e.layerX-e.currentTarget.offsetLeft>=t.width-l)}),!1),s.addEventListener("mousemove",(function(e){!DlhSoft.Controls.GanttChartView.isGripperDragging&&!n.isGripperDragging&&void 0===e.offsetX&&e.currentTarget==s&&o(e.layerX-e.currentTarget.offsetLeft>=t.width-l)}),!1),n.addEventListener("mousedown",(function(e){0==e.button&&n.isGripperVisible&&!DlhSoft.Controls.GanttChartView.isGripperDragging&&(DlhSoft.Controls.GanttChartView.isGripperDragging=!0,n.isGripperDragging=!0,n.initialGripperDraggingX=e.clientX,n.initialColumnWidth=t.width)}),!0),e.addEventListener("mousemove",(function(e){n.isGripperDragging&&(t.width=Math.max(t.minWidth,n.initialColumnWidth+(e.clientX-n.initialGripperDraggingX)),void 0!==t.maxWidth&&t.width>t.maxWidth&&(t.width=t.maxWidth),s.style.width=t.width-1+"px",void 0!==i.columnWidthChangeHandler&&setTimeout((function(){i.columnWidthChangeHandler(t,t.width)}),0),a.isWaitingToRefreshColumns||(a.isWaitingToRefreshColumns=!0,setTimeout((function(){var e=N(i.columns);a.gridHeader.style.width=e+"px",a.gridContent.style.width=e+"px",delete a.isWaitingToRefreshColumns,a.refreshGridItems()}),0)))}),!0),e.addEventListener("mouseup",(function(){n.isGripperDragging&&(delete n.isGripperDragging,delete n.initialGripperDraggingX,delete n.initialColumnWidth,o(!1),delete DlhSoft.Controls.GanttChartView.isGripperDragging)}),!0),n.addEventListener("mouseout",(function(){n.isGripperDragging||o(!1)}),!1)}return n},X=function(e,t){for(var i=-1,n=null,s=null,r=[],a=0;a<e.length;a++){var o=e[a];if(void 0===o.scheduleChartItem&&(void 0===o.isSelected&&(o.isSelected=!1),o.isSelected&&(null==s&&(s=o),r.push(o)),void 0===o.indentation&&(o.indentation=0),0==a&&0!=o.indentation&&(o.indentation=0,at(o,"indentation",!1,!0)),void 0===o.isExpanded&&(o.isExpanded=!0),null!=n)){var l=n.indentation+1;o.indentation>l&&(o.indentation=l,at(o,"indentation",!1,!0)),n.hasChildren=o.indentation>n.indentation,n.hasChildren&&void 0!==n.isMilestone&&n.isMilestone&&(n.isMilestone=!1,at(n,"isMilestone",!1,!0))}o.isVisible=i<0||o.indentation<=i,void 0===o.scheduleChartItem&&(o.isVisible&&!o.isExpanded&&(i=o.indentation),o.isExpanded&&o.indentation==i&&(i=-1),n=o)}null!=n&&(n.hasChildren=!1),t.selectedItem=s,t.selectedItems=r},U=function(e,t,i){i.isTimingInformationInitialized=!1,i.isBasicTimingInformationInitialized=!1;var n,s,r,a=q(t.currentTime),o=[];for(s=0;s<e.length;s++){(n=e[s]).index=s;var l=null;for(o.length>0&&(l=o[o.length-1]);null!=l&&n.indentation<=l.indentation;)o.pop(),l=o[o.length-1];if(n.parent=l,n.children=[],null!=l&&l.children.push(n),!n.hasChildren||void 0!==n.isSummaryEnabled&&!n.isSummaryEnabled){r=n.start;var d=n.finish,h=n.completedFinish;void 0===n.start&&(n.start=a,n.preferredStart=n.start),void 0===n.finish&&(n.finish=void 0!==n.isMilestone&&n.isMilestone?n.start:he(a)),void 0===n.isSetAsCompleted&&(n.isSetAsCompleted=void 0!==n.completedFinish&&n.completedFinish.valueOf()==n.finish.valueOf()),void 0===n.completedFinish&&(n.completedFinish=n.start),void 0===n.isRelativeToTimezone||n.isRelativeToTimezone?(n.start=new Date(n.start.valueOf()-6e4*n.start.getTimezoneOffset()),n.preferredStart=n.start,n.finish=new Date(n.finish.valueOf()-6e4*n.finish.getTimezoneOffset()),n.completedFinish="number"==typeof n.completedFinish?yt(n.start,n.completedFinish*vt(n.start,n.finish,t,Dt(n)),t,Dt(n)):new Date(n.completedFinish.valueOf()-6e4*n.completedFinish.getTimezoneOffset()),void 0!==n.baselineStart&&(n.baselineStart=new Date(n.baselineStart.valueOf()-6e4*n.baselineStart.getTimezoneOffset())),void 0!==n.baselineFinish&&(n.baselineFinish=new Date(n.baselineFinish.valueOf()-6e4*n.baselineFinish.getTimezoneOffset())),void 0!==n.minStart&&(n.minStart=new Date(n.minStart.valueOf()-6e4*n.minStart.getTimezoneOffset())),void 0!==n.maxStart&&(n.maxStart=new Date(n.maxStart.valueOf()-6e4*n.maxStart.getTimezoneOffset())),void 0!==n.minFinish&&(n.minFinish=new Date(n.minFinish.valueOf()-6e4*n.minFinish.getTimezoneOffset())),void 0!==n.maxFinish&&(n.maxFinish=new Date(n.maxFinish.valueOf()-6e4*n.maxFinish.getTimezoneOffset())),n.isRelativeToTimezone=!1):"number"==typeof n.completedFinish&&(n.completedFinish=yt(n.start,n.completedFinish*vt(n.start,n.finish,t,Dt(n)),t,Dt(n))),void 0!==n.minStart&&n.start<n.minStart?n.start=n.minStart:void 0!==n.maxStart&&n.start>n.maxStart&&(n.start=n.maxStart),void 0!==n.maxFinish&&n.finish>n.maxFinish?n.finish=n.maxFinish:void 0!==n.minFinish&&n.finish<n.minFinish&&(n.finish=n.minFinish),n.finish<n.start&&(n.finish=n.start),n.completedFinish<n.start?n.completedFinish=n.start:n.completedFinish>n.finish&&(n.completedFinish=n.finish),void 0===n.loadChartItem&&(n.start=ft(n.start,t,!0,void 0!==n.isMilestone&&n.isMilestone,Dt(n))),void 0!==n.dependsOf&&delete n.dependsOf,n.preferredStart=n.start,void 0===n.loadChartItem&&(n.finish=ft(n.finish,t,void 0!==n.isMilestone&&n.isMilestone,!0,Dt(n)),n.completedFinish=ft(n.completedFinish,t,void 0!==n.isMilestone&&n.isMilestone,!0,Dt(n))),n.finish<n.start&&(n.finish=n.start),void 0===n.isMilestone&&(n.isMilestone=!(n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled))&&n.finish.valueOf()==n.start.valueOf()),n.completedFinish<n.start&&(n.completedFinish=n.start),n.completedFinish>n.finish&&(n.completedFinish=n.finish),void 0!==n.isSetAsCompleted&&(!n.isMilestone||n.completedFinish.valueOf()<n.finish.valueOf())&&(n.isSetAsCompleted=!1),(void 0===r||n.start.valueOf()!=r.valueOf())&&at(n,"start",!1,!0),(void 0===d||n.finish.valueOf()!=d.valueOf())&&at(n,"finish",!1,!0),(void 0===h||n.completedFinish.valueOf()!=h.valueOf())&&at(n,"completedFinish",!1,!0)}for(r=0;r<o.length;r++)(void 0===(d=o[r]).isSummaryEnabled||d.isSummaryEnabled)&&((void 0===d.start||d.start>n.start)&&(d.start=n.start,at(d,"start",!1,!0)),(void 0===d.finish||d.finish<n.finish)&&(d.finish=n.finish,at(d,"finish",!1,!0)),void 0!==d.completedFinish&&d.completedFinish.valueOf()==d.start.valueOf()||(d.completedFinish=d.start,at(d,"completedFinish",!1,!0)));(null==l||n.indentation>l.indentation)&&o.push(n)}for(i.isBasicTimingInformationInitialized=!0,s=e.length;s-- >0;)(n=e[s]).hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled)&&j(n);if(t.areTaskDependencyConstraintsEnabled)for(s=0;s<e.length;s++)void 0!==(n=e[s]).predecessors&&null!=n.predecessors&&n.predecessors.length>0&&lt(n,e,t,i);for(s=0;s<e.length;s++)!(n=e[s]).hasChildren&&n.hasFixedEffort&&(n.fixedEffort=ni(n,t),n.fixedEffortAssignments=hi(n));i.isTimingInformationInitialized=!0},j=function(e,t){if(!(e.children.length<=0||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled)){void 0===t&&(t=!0);var i=e.start,n=e.finish,s=e.completedFinish;delete e.start,delete e.finish,delete e.completedFinish;for(var r=0;r<=1;r++){for(var a=0;a<e.children.length;a++){var o=e.children[a];void 0!==o.isParentSummarizationEnabled&&!o.isParentSummarizationEnabled&&r<1||((void 0===e.start||e.start>o.start)&&(e.start=o.start),(void 0===e.finish||e.finish<o.finish)&&(e.finish=o.finish))}if(void 0!==e.start&&void 0!==e.finish)break}e.completedFinish=e.start,(void 0===i||e.start.valueOf()!=i.valueOf())&&at(e,"start",!1,t),(void 0===n||e.finish.valueOf()!=n.valueOf())&&at(e,"finish",!1,t),(void 0===s||e.completedFinish.valueOf()!=s.valueOf())&&at(e,"completedFinish",!1,t)}},Z=function(e,t){return e==t||Q(e,t)||Q(t,e)},Q=function(e,t){var i=e.parent;return null!=i&&(!(void 0!==i.isSummaryEnabled&&!i.isSummaryEnabled||i!=t)||Q(i,t))},J=function(e,t){if(void 0===e.predecessors)return!1;for(var i=0;i<e.predecessors.length;i++)if(e.predecessors[i].item==t)return!0;return!1},q=function(e){return new Date(864e5*Math.floor(e.valueOf()/864e5))},$=function(e){return e.valueOf()-q(e).valueOf()},K=function(e){return(e=Math.floor((e.valueOf()-2592e5)/864e5)%7)<0&&(e+=7),e},ee=function(e,t){return q(e),new Date(6048e5*Math.floor((e.valueOf()-2592e5)/6048e5)+2592e5+864e5*t)},te=function(e,t){var i=ee(e,t);return Math.abs(i.valueOf()-e.valueOf())<=36e5?i:new Date(i.valueOf()+6048e5)},ie=function(e){return e.hourWidth*(e.visibleDayFinish-e.visibleDayStart)/36e5},ne=function(e,t){var i=ie(t),n=ie(t)*(t.visibleWeekFinish-t.visibleWeekStart+1),s=ee(e,t.weekStartDay);return s=Math.floor((s-t.timelineStart)/6048e5)*n-Math.max(0,t.weekStartDay-t.visibleWeekStart)*i,s=(n=K(e))<=t.visibleWeekStart?s+0:n>t.visibleWeekFinish?s+(t.visibleWeekFinish-t.visibleWeekStart+1)*i:s+(n-t.visibleWeekStart)*i,i=$(e),n>=t.visibleWeekStart&&n<=t.visibleWeekFinish&&(s=i<=t.visibleDayStart?s+0:i>=t.visibleDayFinish?s+(t.visibleDayFinish-t.visibleDayStart)/36e5*t.hourWidth:s+(i-t.visibleDayStart)/36e5*t.hourWidth),s},se=function(e,t){for(var i=t.timelineStart.valueOf(),n=ie(t),s=ie(t)*(t.visibleWeekFinish-t.visibleWeekStart+1);e>s;)i+=6048e5,e-=s;for(i+=864e5*Math.max(0,t.visibleWeekStart-t.weekStartDay);e>n;)i+=864e5,e-=n;return i+=t.visibleDayStart,i+=e/t.hourWidth*36e5,new Date(i)},re=function(e){switch(e.theme){default:return[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 2.25px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 2.25px"},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: #8bbf8a; stroke-width: 0.5px"}];case"ModernBordered":return[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 2.25px; border-right: solid 1px White; border-bottom: solid 1px White",isSeparatorVisible:!0,separatorStyle:"stroke: #c8bfe7; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 2.25px; border-right: solid 1px White"},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: #8bbf8a; stroke-width: 1px"}];case"Aero":return[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 2.25px; border-right: solid 1px #c8bfe7; border-bottom: solid 1px #c8bfe7",isSeparatorVisible:!0,separatorStyle:"stroke: #c8bfe7; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 2.25px; border-right: solid 1px #c8bfe7"},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: Black; stroke-width: 1px"}]}},ae=function(e,t){return new Date(Math.floor((e-2592e5).valueOf()/t.updateScale)*t.updateScale+2592e5)},oe=function(e,t,i,n,s){void 0===s&&(s=!1);var r,a,o=e.ownerDocument,l=0;for(r=0;r<i.length;r++)(void 0===(a=i[r]).isHeaderVisible||a.isHeaderVisible)&&l++;var d=n.headerHeight;for(l>0&&(d=n.headerHeight/l),r=0;r<i.length;r++)if(a=i[r],(!s||"CurrentTime"==a.scaleType||"FutureTime"==a.scaleType)&&void 0!==(l=le(a,n))){0==l.length&&l.push({start:n.timelineStart,finish:n.timelineFinish});var h=d;void 0!==a.headerHeight&&(h=a.headerHeight);for(var c=n.timelineStart,p=0;p<l.length;p++){var m=l[p],g=m.start,f=m.finish;"CurrentTime"!=a.scaleType&&"FutureTime"!=a.scaleType&&"NonworkingTime"!=a.scaleType&&(g>c&&(void 0===a.isHeaderVisible||a.isHeaderVisible)&&(g=c),g<c&&(g=c),g<n.timelineStart&&(g=n.timelineStart),f>n.timelineFinish&&(f=n.timelineFinish),f<g&&(f=g),p==l.length-1&&f<n.timelineFinish&&(void 0===a.isHeaderVisible||a.isHeaderVisible)&&(f=n.timelineFinish),c=f);var v=ne(g,n),y=ne(f,n),C=y-v;if(!(C<=0)){if(void 0===a.isHeaderVisible||a.isHeaderVisible){var b=ye(a,m,n),S=o.createElement("div");S.setAttribute("style","float: left; overflow: hidden; width: "+C+"px; height: "+h+"px");var w=o.createElement("div");w.setAttribute("class",a.headerClass),w.setAttribute("style",a.headerStyle),w.appendChild(u(o,b)),S.appendChild(w),e.appendChild(S)}m.start=g,m.finish=f,m=!1,void 0!==a.isHighlightingVisible&&(m=a.isHighlightingVisible),m&&((m=o.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",v-1),m.setAttribute("y",0),m.setAttribute("width",C),m.setAttribute("height",0),m.setAttribute("class",a.highlightingClass),m.setAttribute("style",a.highlightingStyle),m.tag="Scale-Highlighting"+("CurrentTime"!=a.scaleType&&"FutureTime"!=a.scaleType?"":"-CurrentTime"),t.appendChild(m)),v=!1,void 0!==a.isSeparatorVisible&&(v=a.isSeparatorVisible),v&&((v=o.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",y-.75),v.setAttribute("y1",0),v.setAttribute("x2",y-.75),v.setAttribute("y2",0),v.setAttribute("class",a.separatorClass),v.setAttribute("style",a.separatorStyle),v.tag="Scale-Separator"+("CurrentTime"!=a.scaleType&&"FutureTime"!=a.scaleType?"":"-CurrentTime"),t.appendChild(v))}}}},le=function(e,t){var i,n,s="Custom";switch(void 0!==e.scaleType&&(s=e.scaleType),s){case"CurrentTime":return[{start:t.timelineStart,finish:t.currentTime}];case"FutureTime":return[{start:t.currentTime,finish:t.timelineFinish}];case"Years":s=[],n=(i=new Date(t.timelineStart.valueOf())).getTimezoneOffset(),i.setMonth(0,1);var r=i.getTimezoneOffset();for(i=new Date(i.valueOf()-6e4*(r-n)-(r>0?864e5:0));n=me(i),i<t.timelineFinish;i=n)s.push({start:i,finish:n});return s;case"Months":for(s=[],n=(i=new Date(t.timelineStart.valueOf())).getTimezoneOffset(),i.setDate(1),r=i.getTimezoneOffset(),i=new Date(i.valueOf()-6e4*(r-n)-(r>0?864e5:0));n=pe(i),i<t.timelineFinish;i=n)s.push({start:i,finish:n});return s;case"Weeks":for(s=[],i=t.timelineStart,n=t.weekStartDay,r=t.visibleWeekStart;K(i)!=n;)i=ce(i);for(;K(i)<r;)i=he(i);for(i=new Date(i.valueOf());n=ue(i),i<t.timelineFinish;i=n)s.push({start:i,finish:n});return s;case"Days":for(s=[],i=t.timelineStart;n=he(i),i<t.timelineFinish;i=n)s.push({start:i,finish:n});return s;case"Hours":for(s=[],i=new Date(q(t.timelineStart).valueOf()+t.visibleDayStart);n=de(new Date(i.valueOf()+36e5),t.visibleDayFinish,t.visibleDayStart),i<t.timelineFinish;i=n)s.push({start:i,finish:n});return s;case"NonworkingTime":for(s=[],i=fe(t.timelineStart,t.workingWeekFinish),n=ve(i,t.workingWeekStart);i<t.timelineFinish;i=ue(i),n=ue(n))s.push({start:i,finish:n});if(void 0!==t.specialNonworkingDays)for(r=0;r<t.specialNonworkingDays.length;r++)n=he(i=t.specialNonworkingDays[r]),s.push({start:i,finish:n});return s;default:return e.intervals}},de=function(e,t,i){return $(e)>t?(e=he(e),new Date(q(e).valueOf()+i)):new Date(e.valueOf())},he=function(e){return new Date(e.valueOf()+864e5)},ce=function(e){return new Date(e.valueOf()-864e5)},ue=function(e){return new Date(e.valueOf()+6048e5)},pe=function(e){var t=e.getTimezoneOffset(),i=(e=new Date(e.valueOf()+(t>0?864e5:0))).getMonth()+1;return i>=12&&(i=0,e.setFullYear(e.getFullYear()+1)),e.setMonth(i,1),i=e.getTimezoneOffset(),new Date(e.valueOf()-6e4*(i-t)-(i>0?864e5:0))},me=function(e){var t=e.getTimezoneOffset();(e=new Date(e.valueOf()+(t>0?864e5:0))).setFullYear(e.getFullYear()+1),e.setMonth(0,1);var i=e.getTimezoneOffset();return new Date(e.valueOf()-6e4*(i-t)-(i>0?864e5:0))},ge=function(e,t){if(void 0===t)return!1;for(var i=e.valueOf(),n=0;n<t.length;n++)if(t[n].valueOf()==i)return!0;return!1},fe=function(e,t){for(;K(e)!=t;)e=ce(e);return he(e)},ve=function(e,t){for(;K(e)!=t;)e=he(e);return new Date(e.valueOf())},ye=function(e,t,i){var n="Date";if(void 0!==e.headerTextFormat&&(n=e.headerTextFormat),(e=t.start)<i.timelineStart&&(e=i.timelineStart),"function"==typeof n)return n(e);switch(n){case"Localized":return e.toLocaleString();case"DateTime":return i.dateTimeFormatter(f(e));case"Date":return i.dateFormatter(f(e));case"Hour":return((e=new Date(e.valueOf()+6e4*e.getTimezoneOffset())).getHours()<10?"0":"")+e.getHours();case"DayOfWeek":return i.daysOfWeek[K(e)];case"DayOfWeekAbbreviation":return(t=i.daysOfWeek[K(e)]).length>0?t[0].toUpperCase():"";case"Day":return((e=new Date(e.valueOf()+6e4*e.getTimezoneOffset())).getDate()<10?"0":"")+e.getDate();case"Month":return i.months[new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getMonth()];case"MonthAbbreviation":return(t=i.months[new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getMonth()]).length<=0?"":t[0].toUpperCase()+(t.length>1?t.substr(1,Math.min(3,t.length)-1):"");case"Year":return new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getFullYear();case"MonthYear":return i.months[new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getMonth()]+" "+new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getFullYear();default:return t.headerText?t.headerText:e.toString()}},Ce=function(e,t,i,n,s,r,a){for(var o=0,l=0;l<n.length;l++){var d=n[l];a.isGridVisible&&void 0===d.displayRowIndex&&e.appendChild(Te(d,n,s,t,r,a));var h=o;void 0!==d.displayRowIndex&&(h=d.displayRowIndex*a.itemHeight),i.appendChild(We(d,h,a)),d.isVisible&&(void 0===d.isHidden||!d.isHidden)&&(o=Math.max(o,h+a.itemHeight)),d.itemTop=h}Me(t,o),setTimeout((function(){we(n,t,a)}),0)},be=function(e,t){for(var i=0,n=0,s=-1,r=0;r<e.length;r++){var a=e[r];void 0!==a.scheduleChartItem&&a.scheduleChartItem!=a||!a.isVisible||void 0!==a.isHidden&&a.isHidden||(void 0===a.displayRowIndex&&n>s?(i+=t.itemHeight,s=n++):(i=Math.max(i,a.itemTop+t.itemHeight),s=a.displayRowIndex))}return i},Se=function(e,t,i){if(e.isPart)return Se(e.ganttChartItem,t,i);var n;if(void 0!==e.displayRowIndex)return e.itemTop=e.displayRowIndex*i.itemHeight;for(var s=n=0;s<t.length;s++){var r=t[s];if(r==e)break;r.isVisible&&(void 0===r.isHidden||!r.isHidden)&&void 0===r.displayRowIndex&&(n+=i.itemHeight)}return e.itemTop=n},we=function(e,t,i){if(void 0!==i.alternativeItemClass||void 0!==i.alternativeItemStyle||void 0!==i.alternativeChartItemClass||void 0!==i.alternativeChartItemStyle){var n,s=t.chartAreaAlternativeRows,r=0,a=!1;for(s.count=r,n=0;n<e.length;n++){var o=e[n];if(o.isVisible&&void 0!==o.alternativeContentContainer){var l=o.alternativeContentContainer;r%2==1?(void 0!==i.alternativeItemClass&&l.setAttribute("class",i.alternativeItemClass),void 0!==i.alternativeItemStyle&&l.setAttribute("style",i.alternativeItemStyle),void 0===i.alternativeChartItemClass&&void 0===i.alternativeChartItemStyle||i.isVirtualizing&&!o.isVirtuallyVisible&&a||(a=!0,(void 0===s.count||r>s.count)&&((o=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",0),o.setAttribute("y",r*i.itemHeight),o.setAttribute("width",t.clientWidth),o.setAttribute("height",i.itemHeight),void 0!==i.alternativeChartItemClass&&o.setAttribute("class",i.alternativeChartItemClass),void 0!==i.alternativeChartItemStyle&&o.setAttribute("style",i.alternativeChartItemStyle),o.index=r,s.appendChild(o))),s.count=r):(l.setAttribute("class",""),l.setAttribute("style","")),r++}}for(n=s.childNodes.length;n-- >0;)(e=s.childNodes[n]).index>s.count&&s.removeChild(e)}},Te=function(e,t,i,n,s,r){var a=e.ganttChartView.ownerDocument,o=a.createElement("div");void 0!==r.itemClass&&o.setAttribute("class",r.itemClass),void 0!==r.itemStyle&&o.setAttribute("style",r.itemStyle);var l=a.createElement("div");e.alternativeContentContainer=l;var d=a.createElement("div");try{d.addEventListener("mousedown",(function(t){t.target!=e.selectionInput&&x(e,r)}),!1),d.addEventListener("mouseup",(function(t){t.target!=e.selectionInput&&x(e,r)}),!1)}catch(p){}e.isSelected&&(void 0!==r.selectedItemClass&&d.setAttribute("class",r.selectedItemClass),void 0!==r.selectedItemStyle&&d.setAttribute("style",r.selectedItemStyle));var h=a.createElement("div");void 0!==e.class&&h.setAttribute("class",e.class),void 0!==e.style&&h.setAttribute("style",e.style);var c=a.createElement("div");e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)?(void 0!==r.summaryItemClass&&c.setAttribute("class",r.summaryItemClass),void 0!==r.summaryItemStyle&&c.setAttribute("style",r.summaryItemStyle)):e.isMilestone?(void 0!==r.milestoneItemClass&&c.setAttribute("class",r.milestoneItemClass),void 0!==r.milestoneItemStyle&&c.setAttribute("style",r.milestoneItemStyle)):(void 0!==r.standardItemClass&&c.setAttribute("class",r.standardItemClass),void 0!==r.standardItemStyle&&c.setAttribute("style",r.standardItemStyle)),a=a.createElement("div"),e.gridItem=a,e.gridItemContent=c,e.gridItemSelectionContainer=d;var u=r.itemHeight;return(!e.isVisible||void 0!==e.isHidden&&e.isHidden)&&(u=0),a.setAttribute("style","overflow: hidden; height: "+u+"px"),xe(a,e,t,i,n,s,r),c.appendChild(a),h.appendChild(c),d.appendChild(h),l.appendChild(d),o.appendChild(l),e.gridItemContainer=o,(void 0===r.isGridRowClickTimeScrollingEnabled||r.isGridRowClickTimeScrollingEnabled)&&o.addEventListener("mouseup",(function(){var t;if(void 0===e.ganttChartItems)t=e.start;else{t=null;for(var i=0;i<e.ganttChartItems.length;i++)(null==t||e.ganttChartItems[i].start<t)&&(t=e.ganttChartItems[i].start);t=null==t?e.start:t}(t=ne(t,r))-(i=t-8*r.hourWidth)>=n.container.clientWidth/2.5&&(i=t),n.container.scrollLeft=Math.max(0,i)}),!0),o},xe=function(e,t,i,n,s,r,a){var o=t.ganttChartView.ownerDocument;if(!a.isVirtualizing||void 0!==t.isVirtuallyVisible&&t.isVirtuallyVisible){var l=function(){if(void 0!==t.gridItemSelectionContainer){var l=t.gridItemSelectionContainer;void 0!==a.selectedItemClass&&l.setAttribute("class",t.isSelected?a.selectedItemClass:null),void 0!==a.selectedItemStyle&&l.setAttribute("style",t.isSelected?a.selectedItemStyle:null)}void 0!==t.gridItemContent&&((l=t.gridItemContent).setAttribute("class",""),l.setAttribute("style",""),t.hasChildren&&(void 0===t.isSummaryEnabled||t.isSummaryEnabled)?(void 0!==a.summaryItemClass&&l.setAttribute("class",a.summaryItemClass),void 0!==a.summaryItemStyle&&l.setAttribute("style",a.summaryItemStyle)):t.isMilestone?(void 0!==a.milestoneItemClass&&l.setAttribute("class",a.milestoneItemClass),void 0!==a.milestoneItemStyle&&l.setAttribute("style",a.milestoneItemStyle)):(void 0!==a.standardItemClass&&l.setAttribute("class",a.standardItemClass),void 0!==a.standardItemStyle&&l.setAttribute("style",a.standardItemStyle))),l=[];var d=null;try{d=o.activeElement}catch(c){}for(;null!=d&&d!=t.gridItem;)l.push(d),d=d.parentNode;var h=-1;for(d=e.childNodes.length;d-- >0;)if(l.indexOf(e.childNodes[d])>=0){h=d;break}for(d=e.childNodes.length;d-- >0;)e.removeChild(e.childNodes[d]);for(d=0;d<n.length;d++)e.appendChild(Ee(t,i,n[d],s,r,a));void 0===t.ganttChartView.draggingItem&&h>=0&&setTimeout((function(){try{for(var t=e.childNodes[h];"input"!=t.nodeName&&"textarea"!=t.nodeName&&"label"!=t.nodeName&&"select"!=t.nodeName&&"button"!=t.nodeName&&t.childNodes.length>0;)t=t.childNodes[0];t&&t.dontAutoFocus?delete t.dontAutoFocus:setTimeout((function(){try{t.focus()}catch(e){}}),0)}catch(i){}}),0)};t.wasGridItemContentLoaded?setTimeout(l,0):(l(),t.wasGridItemContentLoaded=!0)}},De=function(e){void 0===e.isWaitingToRefreshGridItem&&(e.isWaitingToRefreshGridItem=!0,setTimeout((function(){void 0!==e.gridItem&&xe(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings),delete e.isWaitingToRefreshGridItem}),0))},ke=function(e){void 0!==e.gridItem&&function(e,t,i,n,s,r,a){var o=t.ganttChartView.ownerDocument;(!a.isVirtualizing||void 0!==t.isVirtuallyVisible&&t.isVirtuallyVisible)&&setTimeout((function(){if(void 0!==t.gridItemSelectionContainer){var l=t.gridItemSelectionContainer;void 0!==a.selectedItemClass&&l.setAttribute("class",t.isSelected?a.selectedItemClass:null),void 0!==a.selectedItemStyle&&l.setAttribute("style",t.isSelected?a.selectedItemStyle:null)}l=[];var d=null;try{d=o.activeElement}catch(c){}for(;null!=d&&d!=t.gridItem;)l.push(d),d=d.parentNode;var h=-1;for(d=e.childNodes.length;d-- >0;)if(e.childNodes[d].isSelection&&l.indexOf(e.childNodes[d])>=0){h=d;break}for(d=e.childNodes.length;d-- >0;)e.childNodes[d].isSelection&&e.removeChild(e.childNodes[d]);for(d=0;d<n.length;d++)n[d].isSelection&&d<e.childNodes.length&&e.insertBefore(Ee(t,i,n[d],s,r,a),e.childNodes[d]);void 0===t.ganttChartView.draggingItem&&h>=0&&setTimeout((function(){try{for(var t=e.childNodes[h];"input"!=t.nodeName&&"textarea"!=t.nodeName&&"label"!=t.nodeName&&"select"!=t.nodeName&&"button"!=t.nodeName&&t.childNodes.length>0;)t=t.childNodes[0];t&&t.dontAutoFocus?delete t.dontAutoFocus:setTimeout((function(){try{t.focus()}catch(e){}}),0)}catch(i){}}),0)}),0)}(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings)},Ee=function(e,t,i,n,s,r){var a=e.ganttChartView.ownerDocument,o=a.createElement("div"),l=0;1==i.isTreeView&&(l=r.indentationLevelWidth*e.indentation),o.setAttribute("style","overflow: hidden; vertical-align: middle; display: table-cell; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 0px; padding: 0px; width: "+i.width+"px; height: "+r.itemHeight+"px; padding-left: "+l+"px");var d=a.createElement("div");void 0!==i.cellClass?d.setAttribute("class",i.cellClass):void 0!==r.cellClass&&d.setAttribute("class",r.cellClass),void 0!==i.cellStyle?d.setAttribute("style",i.cellStyle):void 0!==r.cellStyle&&d.setAttribute("style",r.cellStyle);var h=a.createElement("div");return h.setAttribute("style","white-space: nowrap; overflow: hidden; margin: 0px; padding: 0px; width: "+(i.width-l-16)+"px"),1==i.isTreeView&&((l=a.createElement("div")).setAttribute("style","display: inline-block; width: "+s+"px"),e.hasChildren&&((s=a.createElement("div")).setAttribute("style","cursor: default; padding-left: 1px; font-size: 12px; display: inline-block"),a=r.collapsedToggleButtonTemplate,e.isExpanded&&(a=r.expandedToggleButtonTemplate),a=a(),s.appendChild(a),Ve(s,e,t,a,n,null,null,r),l.appendChild(s)),h.appendChild(l)),e=i.cellTemplate(e),h.appendChild(e),d.appendChild(h),o.appendChild(d),o.isSelection=i.isSelection,o},Ie=function(e,t){return function(){var i=e.ownerDocument.createElementNS("http://www.w3.org/2000/svg","polygon");return i.setAttribute("points","3.5,2.5 3.5,11.5 10.5,6.5"),C(i,t)}},Ae=function(e,t){return function(){var i=e.ownerDocument.createElementNS("http://www.w3.org/2000/svg","polygon");return i.setAttribute("points","2.5,3.5 11.5,3.5 6.5,10.5"),C(i,t)}},Ve=function(e,t,i,n,s,r,a,o){void 0!==r&&null!=r||(r=n.querySelector("#PART_Button")),null!=r&&He(r,r,o),void 0!==a&&null!=a||(a=n.querySelector("#PART_Border")),null!=a&&He(a,r,o),i={toggleButton:e,item:t,items:i,content:n,chartContent:s,settings:o},null!=r&&(r.tag=i,(void 0===o.isExport||!o.isExport)&&r.addEventListener("mouseup",Le,!0)),null!=a&&(a.tag=i,(void 0===o.isExport||!o.isExport)&&a.addEventListener("mouseup",Le,!0)),e.tag=i,null==r&&null==a&&(void 0===o.isExport||!o.isExport)&&e.addEventListener("mouseup",Le,!0),n.addEventListener("keypress",(function(e){32==e.keyCode&&(e.preventDefault(),e.stopPropagation(),Fe(t,!t.isExpanded,!0))}),!0),t.toggleButton=e},He=function(e,t,i){void 0!==i.isExport&&i.isExport||(e.addEventListener("mouseover",(function(){void 0!==i.toggleButtonHoveringClass&&t.setAttribute("class",i.toggleButtonHoveringClass),void 0!==i.toggleButtonHoveringStyle&&t.setAttribute("style",i.toggleButtonHoveringStyle)}),!0),e.addEventListener("mouseout",(function(){t.setAttribute("class",i.toggleButtonClass),t.setAttribute("style",i.toggleButtonStyle)}),!0))},Le=function(e){e.stopPropagation(),Fe(e=e.target.tag.item,!e.isExpanded,!0)},Fe=function(e,t,i,n){e.isExpanded!=t&&(e.isExpanded=t,(void 0===n||n)&&at(e,"isExpanded",i,!0),Oe(e))},Oe=function(e,t){if(void 0===e.toggleButton)(void 0===t||t)&&setTimeout((function(){Oe(e,!1)}),0);else{var i=e.toggleButton,n=(o=i.tag).settings,s=n.expandedToggleButtonTemplate,r=n.collapsedToggleButtonTemplate;e.isExpanded&&(r=s),r=(s=r()).querySelector("#PART_Button");var a=s.querySelector("#PART_Border");i.replaceChild(s,o.content),o.content=s;var o,l=o.items;if(Ve(i,e,l,s,o=o.chartContent,r,a,n),e.isVisible&&(void 0===e.isHidden||!e.isHidden)&&Pe(l,e,o,n),_e(e),we(l,o,n),void 0!==(i=e.scheduleChartView))for(n=e.scheduleChartIndex;n<i.scheduleChartItems.length;n++)if(void 0!==(o=i.scheduleChartItems[n]).ganttChartItems)for(s=0;s<o.ganttChartItems.length;s++)(r=o.ganttChartItems[s]).displayRowIndex=o.itemTop/i.settings.itemHeight,i.refreshChartItem(r)}},Pe=function(e,t,i,n){var s,r,a,o=-1,l=!1,d=!1,h=!1,c=0,u=[];for(r=0;r<e.length;r++){(a=e[r])==t?(l=a.isExpanded,o=a.indentation):a.indentation<=o&&(h=!0);var p=a.chartItem;if(d&&!h){if(l){s=!0;for(var m=a.parent;null!=m;){if(!m.isVisible||!m.isExpanded){s=!1;break}m=m.parent}}else s=!1;a.isVisible!=s&&(a.isVisible=l,at(a,"isVisible",!1,!0),s=n.itemHeight,(!a.isVisible||void 0!==a.isHidden&&a.isHidden)&&(s=0),void 0!==a.gridItem&&(a.gridItem.style.height=s+"px"),s="visible",(!a.isVisible||void 0!==a.isHidden&&a.isHidden)&&(s="hidden"),p.setAttribute("style","visibility: "+s))}if(void 0===a.displayRowIndex&&(p.setAttribute("transform","translate(0, "+c+")"),Be(a,c)),a==t&&(d=!0),s=n.itemHeight,(!a.isVisible||void 0!==a.isHidden&&a.isHidden)&&(s=0),a.itemTop!=c&&(a.itemTop=c),void 0===a.displayRowIndex&&(c+=s),a.predecessors&&a.predecessors.length>0&&u.indexOf(a)<0)for(u.push(a),p=0;p<a.predecessors.length;p++)u.indexOf(s=a.predecessors[p].item)<0&&u.push(s)}if(Me(i,c),Re(e,t),n.areTaskDependenciesVisible)for(r=0;r<u.length;r++)Re(e,u[r]);Pt(e,i.container,n)},Be=function(e,t){void 0===e.parts||e.parts.length<=0||setTimeout((function(){for(var i=0;i<e.parts.length;i++){var n=e.parts[i];n.itemTop=t,void 0!==n.chartItem&&(n.chartItem.setAttribute("transform","translate(0, "+t+")"),n.chartItem.style.visibility=e.chartItem.style.visibility,void 0!==n.isInternallyHidden&&(delete n.isInternallyHidden,n.chartItem.style.display="inline"))}}),0)},Me=function(e,t){t<e.availableHeight&&(t=e.availableHeight),e.style.height=t+"px";var i=e.chartArea;i.style.height=t+"px";for(var n=0;n<i.childNodes.length;n++){var s=i.childNodes[n];if(void 0!==s.tag)switch(s.tag){case"Scale-Highlighting":case"Scale-Highlighting-CurrentTime":s.setAttribute("height",t);break;case"Scale-Separator":case"Scale-Separator-CurrentTime":s.setAttribute("y2",t)}}},Re=function(e,t){var i,n,s,r,a=[];if(void 0===t.successors)for(t.successors=[],n=0;n<e.length;n++)if((i=e[n])!=t&&void 0!==i.predecessors&&0!=i.predecessors.length)for(s=0;s<i.predecessors.length;s++)if(i.predecessors[s].item==t){t.successors.push(i);break}for(n=0;n<t.successors.length;n++){var o=t.successors[n];if(void 0!==o.predecessors&&o.predecessors.length>0)for(s=0;s<o.predecessors.length;s++){var l=o.predecessors[s].item;if(void 0!==l){for(i=!0,r=0;r<a;r++)if(l==a[r]){i=!1;break}i&&(ze(l.chartItem,l,l.ganttChartView.settings),a.push(l))}}if(void 0!==o.predecessors&&o.predecessors.length>0){for(i=!0,r=0;r<a;r++)if(void 0!==o&&o==a[r]){i=!1;break}i&&(ze(o.chartItem,o,o.ganttChartView.settings),a.push(o))}}},We=function(e,t,i){var n=e.ganttChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");e.chartItem=n;var s="visible";(!e.isVisible||void 0!==e.isHidden&&e.isHidden)&&(s="hidden"),n.setAttribute("style","visibility: "+s+"; -ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),n.setAttribute("transform","translate(0, "+t+")"),void 0!==e.isInternallyHidden&&e.isInternallyHidden&&(n.style.display="none"),Be(e,t),ze(n,e,i);try{n.addEventListener("mousedown",(function(){x(e,i)}),!1),n.addEventListener("mouseup",(function(){x(e,i)}),!1)}catch(r){}return n},ze=function(e,t,i){for(var n=e.childNodes.length;n-- >0;)e.removeChild(e.childNodes[n]);if((!i.isVirtualizing||void 0!==t.isVirtuallyVisible&&t.isVirtuallyVisible)&&(void 0===t.isBarVisible||t.isBarVisible)){if(n=i.standardTaskTemplate,void 0!==t.standardTaskTemplate&&(n=t.standardTaskTemplate),t.hasChildren&&(void 0===t.isSummaryEnabled||t.isSummaryEnabled)?(n=i.summaryTaskTemplate,void 0!==t.summaryTaskTemplate&&(n=t.summaryTaskTemplate)):t.isMilestone&&(n=i.milestoneTaskTemplate,void 0!==t.milestoneTaskTemplate&&(n=t.milestoneTaskTemplate)),void 0!==t.taskTemplate&&(n=t.taskTemplate),void 0!==i.internalPreTaskTemplate){var s=i.internalPreTaskTemplate(t);null!=s&&e.appendChild(s)}if((n=n(t)).addEventListener("contextmenu",(function(e){void 0!==i.itemContextMenuHandler?i.itemContextMenuHandler(e,t):e.preventDefault()}),!1),e.appendChild(n),void 0!==i.internalExtraTaskTemplate&&null!=(s=i.internalExtraTaskTemplate(t))&&e.appendChild(s),void 0!==i.extraTaskTemplate&&null!=(s=i.extraTaskTemplate(t))&&e.appendChild(s),i.areTaskAssignmentsVisible&&(s=i.assignmentsTemplate(t),n.appendChild(s)),i.isTaskToolTipVisible&&(s=i.itemTemplate,void 0!==t.template&&(s=t.template),n.appendChild(s(t))),i.areTaskDependenciesVisible&&void 0!==t.predecessors)for(n=0;n<t.predecessors.length;n++)if(s=t.predecessors[n],!((void 0===t.ganttChartView||t.ganttChartView.items.indexOf(s.item))<0||!s.item.isVisible||void 0!==s.item.isHidden&&s.item.isHidden||void 0!==s.item.isBarVisible&&!s.item.isBarVisible)){var r=i.dependencyLineTemplate(t,s);if(r.predecessorIndex=n,r.addEventListener("click",(function(e){i.dependencyLineClickHandler&&i.dependencyLineClickHandler(t.predecessors[this.predecessorIndex],t,e)})),r.addEventListener("dblclick",(function(e){i.dependencyLineDoubleClickHandler&&i.dependencyLineDoubleClickHandler(t.predecessors[this.predecessorIndex],t,e)})),void 0!==i.predecessorItemContextMenuHandler?r.addEventListener("contextmenu",(function(e){i.predecessorItemContextMenuHandler(e,t.predecessors[this.predecessorIndex],t)})):!i.isReadOnly&&!i.isChartReadOnly&&!i.areTaskPredecessorsReadOnly&&(void 0===t.isReadOnly||!t.isReadOnly)&&r.addEventListener("contextmenu",(function(e){if(confirm("Are you sure you want to remove the predecessor?")){for(var n=[],s=0;s<t.predecessors.length;s++)if(s!=this.predecessorIndex){var r=t.predecessors[s];delete r.item.successors,n.push(r)}t.predecessors=n,at(t,"predecessors",!0,!0),ze(t.chartItem,t,i),Re(t.ganttChartView.items,t)}e.preventDefault()}),!1),e.appendChild(r),i.isDependencyToolTipVisible){var a=i.predecessorItemTemplate;void 0!==s.template&&(a=s.template),r.appendChild(a(t,s))}}}},Ne=function(e){for(var t=0;t<e.length;t++)Xe(e[t])},_e=function(e){(!e.ganttChartView.settings.isVirtualizing||void 0!==e.isVirtuallyVisible&&e.isVirtuallyVisible)&&void 0===e.isWaitingToRefreshChartItem&&(e.isWaitingToRefreshChartItem=!0,setTimeout((function(){ze(e.chartItem,e,e.ganttChartView.settings);var t=Se(e,e.ganttChartView.items,e.ganttChartView.settings);e.chartItem.setAttribute("transform","translate(0, "+t+")"),Be(e,t),delete e.isWaitingToRefreshChartItem}),0))},Ge=function(e){(!e.ganttChartView.settings.isVirtualizing||void 0!==e.isVirtuallyVisible&&e.isVirtuallyVisible)&&(void 0!==e.isWaitingToRefreshGridItem||void 0!==e.isWaitingToRefreshChartItem?(void 0===e.isWaitingToRefreshGridItem&&De(e),void 0===e.isWaitingToRefreshChartItem&&_e(e)):(e.isWaitingToRefreshGridItem=!0,e.isWaitingToRefreshChartItem=!0,setTimeout((function(){void 0!==e.gridItem&&xe(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings),ze(e.chartItem,e,e.ganttChartView.settings);var t=Se(e,e.ganttChartView.items,e.ganttChartView.settings);e.chartItem.setAttribute("transform","translate(0, "+t+")"),Be(e,t),delete e.isWaitingToRefreshGridItem,delete e.isWaitingToRefreshChartItem}),0)))},Ye=function(e){(!e.ganttChartView.settings.isVirtualizing||void 0!==e.isVirtuallyVisible&&e.isVirtuallyVisible)&&void 0===e.isWaitingToRefreshPredecessorItems&&(e.isWaitingToRefreshPredecessorItems=!0,setTimeout((function(){Re(e.ganttChartView.items,e),delete e.isWaitingToRefreshPredecessorItems}),0))},Xe=function(e){(!e.ganttChartView.settings.isVirtualizing||void 0!==e.isVirtuallyVisible&&e.isVirtuallyVisible)&&(void 0!==e.isWaitingToRefreshGridItem||void 0!==e.isWaitingToRefreshChartItem||void 0!==e.isWaitingToRefreshPredecessorItems?(void 0===e.isWaitingToRefreshGridItem&&De(e),void 0===e.isWaitingToRefreshChartItem&&_e(e),void 0===e.isWaitingToRefreshPredecessorItems&&Ye(e)):(e.isWaitingToRefreshGridItem=!0,e.isWaitingToRefreshChartItem=!0,e.isWaitingToRefreshPredecessorItems=!0,setTimeout((function(){void 0!==e.gridItem&&xe(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings),ze(e.chartItem,e,e.ganttChartView.settings);var t=Se(e,e.ganttChartView.items,e.ganttChartView.settings);e.chartItem.setAttribute("transform","translate(0, "+t+")"),Be(e,t),Re(e.ganttChartView.items,e),delete e.isWaitingToRefreshGridItem,delete e.isWaitingToRefreshChartItem,delete e.isWaitingToRefreshPredecessorItems}),0)))},Ue=function(e){for(Xe(e),e=e.parent;null!=e;)j(e),Xe(e),e=e.parent},je=function(e,t,i,n){d(t,n),X(t,i),U(t,n,i),(i=e.index-1)>=0&&Ue(t[i]),Ue(e),(i=e.index+1)<t.length&&Ue(t[i])},Ze=function(e,t){var i=t.toggleButtonAreaWidth;return delete t.toggleButtonAreaWidth,c(e,t),t.toggleButtonAreaWidth!=i},Qe=function(e,t,i,n,s){for(t.ganttChartView=i,t.isVirtuallyVisible=!0;e>0&&n[e-1].isPart;)e--;var r,a=e<n.length?n[e]:null;if(null==a||a.isPart?t.indentation>(a=null!=(a=e>0?n[e-1]:null)?a.indentation+1:0)&&(t.indentation=a):(void 0===t.indentation||t.indentation<a.indentation-1||t.indentation>a.indentation)&&(t.indentation=a.indentation),d([t],s),n.splice(e,0,t),X(n,i),U(n,s,i),s.isGridVisible&&void 0===t.displayRowIndex){var o=null;e<n.length-1&&((a=n[e+1]).isPart||(r=a.itemTop,void 0!==a.gridItemContainer&&(o=a.gridItemContainer))),i.gridContent.insertBefore(Te(t,n,s.columns,i.chartContent,s.toggleButtonAreaWidth,s),o)}if(void 0===r&&(r=be(n,s)-s.itemHeight),o=r,void 0!==t.displayRowIndex&&(o=t.displayRowIndex*s.itemHeight),i.chartContent.chartArea.appendChild(We(t,o,s)),t.isVisible&&(void 0===t.isHidden||!t.isHidden)&&(r=Math.max(r,o+s.itemHeight)),t.itemTop=o,void 0===t.displayRowIndex)for(a=e+1;a<n.length;a++){var l=n[a];o=r,void 0!==l.displayRowIndex&&(o=l.displayRowIndex*s.itemHeight),l.isVisible&&(void 0===l.isHidden||!l.isHidden)&&(r=Math.max(r,o+s.itemHeight)),l.itemTop=o,_e(l),Re(n,l)}for(a=e+1;a<n.length;a++)De(n[a]);i.isContentHeightInitialized&&i.isContentHeightAuto&&(e=h(i,n,s),i.gridContentContainer.style.height=e,i.chartContentContainer.style.height=e),Me(i.chartContent,be(n,s)),we(n,i.chartContent,s),Ze(n,s)&&Ne(n),je(t,n,i,s),Pt(n,i.chartContentContainer,s)},Je=function(e,t){return function(i){void 0===i&&(i=e);var n=i.ownerDocument,s=(i=n.createElementNS("http://www.w3.org/2000/svg","defs"),n.createElementNS("http://www.w3.org/2000/svg","linearGradient"));s.setAttribute("id","BlueGradient"),s.setAttribute("x1","0%"),s.setAttribute("y1","0%"),s.setAttribute("x2","0%"),s.setAttribute("y2","100%");var r=n.createElementNS("http://www.w3.org/2000/svg","stop");r.setAttribute("offset","0%"),r.setAttribute("style","stop-color: White");var a=n.createElementNS("http://www.w3.org/2000/svg","stop");a.setAttribute("offset","25%"),a.setAttribute("style","stop-color: LightBlue");var o=n.createElementNS("http://www.w3.org/2000/svg","stop");o.setAttribute("offset","100%"),o.setAttribute("style","stop-color: Blue"),s.appendChild(r),s.appendChild(a),s.appendChild(o),i.appendChild(s),(s=n.createElementNS("http://www.w3.org/2000/svg","linearGradient")).setAttribute("id","BlackGradient"),s.setAttribute("x1","0%"),s.setAttribute("y1","0%"),s.setAttribute("x2","0%"),s.setAttribute("y2","100%"),(r=n.createElementNS("http://www.w3.org/2000/svg","stop")).setAttribute("offset","0%"),r.setAttribute("style","stop-color: Black"),(a=n.createElementNS("http://www.w3.org/2000/svg","stop")).setAttribute("offset","10%"),a.setAttribute("style","stop-color: White"),(o=n.createElementNS("http://www.w3.org/2000/svg","stop")).setAttribute("offset","20%"),o.setAttribute("style","stop-color: Gray");var l=n.createElementNS("http://www.w3.org/2000/svg","stop");switch(l.setAttribute("offset","60%"),l.setAttribute("style","stop-color: Black"),s.appendChild(r),s.appendChild(a),s.appendChild(o),s.appendChild(l),i.appendChild(s),(s=n.createElementNS("http://www.w3.org/2000/svg","marker")).setAttribute("id","ArrowMarker"),s.setAttribute("viewBox","0 0 10 10"),s.setAttribute("refX","0"),s.setAttribute("refY","5"),s.setAttribute("markerUnits","strokeWidth"),s.setAttribute("markerWidth","5"),s.setAttribute("markerHeight","4"),s.setAttribute("orient","auto"),n=n.createElementNS("http://www.w3.org/2000/svg","path"),t.theme){default:n.setAttribute("fill","#3b87d9");break;case"Aero":n.setAttribute("fill","Blue")}return n.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),s.appendChild(n),i.appendChild(s),i}},qe=function(e){return function(t){var i=t.ganttChartView,n=t.ganttChartView.ownerDocument,s=n.createElementNS("http://www.w3.org/2000/svg","title");if(s.appendChild(u(n,t.content)),void 0===e.areToolTipsSimplified||!e.areToolTipsSimplified)if(void 0===t.loadChartView){if(void 0===t.scheduleChartView&&t.parent&&(s.appendChild(n.createTextNode("\n")),s.appendChild(n.createTextNode("Parent: "+t.parent.content))),void 0!==t.scheduleChartView&&t.scheduleChartItem&&(s.appendChild(n.createTextNode("\n")),s.appendChild(n.createTextNode("Row: "+t.scheduleChartItem.content))),t.hasChildren&&(s.appendChild(n.createTextNode("\n")),s.appendChild(n.createTextNode("Children: "+t.children.length))),s.appendChild(n.createTextNode("\n")),s.appendChild(n.createTextNode((t.isMilestone?"":"Start: ")+e.dateTimeFormatter(f(t.start)))),t.isMilestone||(s.appendChild(n.createTextNode("\n")),s.appendChild(n.createTextNode("Finish: "+e.dateTimeFormatter(f(t.finish))))),e.areTaskAssignmentsVisible&&t.assignmentsContent&&(s.appendChild(n.createTextNode("\n")),s.appendChild(n.createTextNode("Assignments: "+t.assignmentsContent))),t.isMilestone||(s.appendChild(n.createTextNode("\n")),s.appendChild(n.createTextNode("Effort: "+i.getItemTotalEffort(t)/36e5+"h")),e.isTaskCompletedEffortVisible&&(i=i.getItemCompletion(t),isNaN(i)||(s.appendChild(n.createTextNode("\n")),s.appendChild(n.createTextNode("Completed: "+Math.round(1e4*i)/100+"%"))))),e.areTaskDependenciesVisible&&t.predecessors&&t.predecessors.length>0){s.appendChild(n.createTextNode("\n")),i="";for(var r=0;r<t.predecessors.length;r++){var a=t.predecessors[r];a.item&&(i.length>0&&(i+=", "),i+=a.item.content,a.dependencyType&&(i=i+" ("+rt(a.dependencyType)+")"))}s.appendChild(n.createTextNode("Predecessors: "+i))}}else isNaN(t.units)||(s.appendChild(n.createTextNode("\n")),s.appendChild(n.createTextNode("Allocation: "+Math.round(1e4*t.units)/100+"%")));return s}},$e=function(e){return function(t){var i=t.ganttChartView,n=void 0!==e?e:i.settings,s=(i=i.ownerDocument).createElementNS("http://www.w3.org/2000/svg","text"),r=ne(t.finish,n);return(t.isMilestone||t.hasChildren&&(void 0===t.isSummaryEnabled||t.isSummaryEnabled))&&(r+=n.barHeight/2),s.setAttribute("x",r+7),s.setAttribute("y",n.barMargin+n.barHeight-1),void 0===(t="Phone"!=n.target?t.assignmentsContent:t.content)&&(t=""),s.appendChild(i.createTextNode(t)),void 0!==n.assignmentsClass?s.setAttribute("class",n.assignmentsClass):void 0!==n.assignmentsStyle&&s.setAttribute("style",n.assignmentsStyle),s}},Ke=function(e){var t=e.ganttChartView.ownerDocument;for(void 0===e.chartItemArea&&(e.chartItemArea=t.createElementNS("http://www.w3.org/2000/svg","g")),t=e.chartItemArea.childNodes.length;t-- >0;)e.chartItemArea.removeChild(e.chartItemArea.childNodes[t]);return e.chartItemArea},et=function(e,t,i){return function(n){var s=void 0!==t?t:n.ganttChartView,r=void 0!==i?i:s.settings,a=void 0!==e?e:s.items,o=s.ownerDocument,l=Ke(n);if(r.isBaselineVisible&&void 0!==n.baselineStart&&void 0!==n.baselineFinish){var d=ne(n.baselineStart,r),h=Math.max(ne(n.baselineFinish,r),d+4);(c=o.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",d),c.setAttribute("y",r.barMargin/2),c.setAttribute("width",Math.max(0,h-d-1)),c.setAttribute("height",r.barHeight),c.setAttribute("rx",r.barCornerRadius),c.setAttribute("ry",r.barCornerRadius),d=r.baselineBarClass,void 0!==n.baselineBarClass&&(d=n.baselineBarClass),void 0!==d?c.setAttribute("class",d):(d=r.baselineBarStyle,void 0!==n.baselineBarStyle&&(d=n.baselineBarStyle),void 0!==d&&c.setAttribute("style",d)),l.appendChild(c)}var c=ne(n.start,r),p=(d=Math.max(ne(n.finish,r),c+4),h=ne(n.completedFinish,r),o.createElementNS("http://www.w3.org/2000/svg","rect"));p.setAttribute("x",c),p.setAttribute("y",r.barMargin),p.setAttribute("width",Math.max(0,d-c-1)),p.setAttribute("height",r.barHeight),p.setAttribute("rx",r.barCornerRadius),p.setAttribute("ry",r.barCornerRadius);var m=r.standardBarClass;if(void 0!==n.standardBarClass&&(m=n.standardBarClass),void 0!==n.barClass&&(m=n.barClass),void 0!==m?p.setAttribute("class",m):(m=r.standardBarStyle,void 0!==n.standardBarStyle&&(m=n.standardBarStyle),void 0!==n.barStyle&&(m=n.barStyle),void 0!==m&&p.setAttribute("style",m)),l.appendChild(p),r.isTaskCompletedEffortVisible&&((p=o.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",c),p.setAttribute("y",r.barMargin+r.completedBarMargin),p.setAttribute("width",Math.max(0,h-c-1)),p.setAttribute("height",r.completedBarHeight),p.setAttribute("rx",r.completedBarCornerRadius),p.setAttribute("ry",r.completedBarCornerRadius),m=r.standardCompletedBarClass,void 0!==n.standardCompletedBarClass&&(m=n.standardCompletedBarClass),void 0!==n.completedBarClass&&(m=n.completedBarClass),void 0!==m?p.setAttribute("class",m):(m=r.standardCompletedBarStyle,void 0!==n.standardCompletedBarStyle&&(m=n.standardCompletedBarStyle),void 0!==n.completedBarStyle&&(m=n.completedBarStyle),void 0!==m&&p.setAttribute("style",m)),l.appendChild(p)),!(r.isReadOnly||r.isChartReadOnly||void 0!==n.isReadOnly&&n.isReadOnly||void 0!==n.isBarReadOnly&&n.isBarReadOnly)){(p=o.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",c),p.setAttribute("y",r.barMargin),p.setAttribute("width",Math.max(0,d-c-1)),p.setAttribute("height",r.barHeight),p.setAttribute("style","fill: White; fill-opacity: 0; cursor: move"),r.isTaskStartReadOnly||l.appendChild(p),(m=o.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",c-4),m.setAttribute("y",r.barMargin),m.setAttribute("width",4),m.setAttribute("height",r.barHeight),m.setAttribute("style","fill: White; fill-opacity: 0; cursor: e-resize"),r.isDraggingTaskStartEndsEnabled&&!r.isTaskStartReadOnly&&"TouchEnabled"!=r.interaction&&l.appendChild(m);var g=o.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x",d-4),g.setAttribute("y",r.barMargin),g.setAttribute("width",8),g.setAttribute("height",r.barHeight),g.setAttribute("style","fill: White; fill-opacity: 0; cursor: e-resize"),!r.isTaskEffortReadOnly&&"TouchEnabled"!=r.interaction&&l.appendChild(g);var f=o.createElementNS("http://www.w3.org/2000/svg","rect");if(f.setAttribute("x",h-2),f.setAttribute("y",r.barMargin),f.setAttribute("width",6),f.setAttribute("height",r.barHeight),f.setAttribute("style","fill: White; fill-opacity: 0; cursor: e-resize"),!r.isTaskCompletionReadOnly&&r.isTaskCompletedEffortVisible&&"TouchEnabled"!=r.interaction){l.appendChild(f);var v=o.createElementNS("http://www.w3.org/2000/svg","title"),y=void 0!==r.areToolTipsSimplified&&r.areToolTipsSimplified?NaN:s.getItemCompletion(n);v.appendChild(u(o,isNaN(y)?"":Math.round(1e4*y)/100+"%")),f.appendChild(v)}kt(p,m,g,f,n,c,d,h,a,s,r),!r.areTaskDependenciesVisible||r.areTaskPredecessorsReadOnly||n.isPart||(h=null,(void 0===r.allowCreatingStartDependencies||r.allowCreatingStartDependencies)&&((h=o.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",c),h.setAttribute("cy",r.barMargin+r.barHeight/2),h.setAttribute("r",r.barHeight/4),h.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),l.appendChild(h)),(o=o.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",d-2),o.setAttribute("cy",r.barMargin+r.barHeight/2),o.setAttribute("r",r.barHeight/4),o.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),l.appendChild(o),Et(o,h,l,n,r.barMargin+r.barHeight/2,d-2,c,a,s,r))}return l}},tt=function(e,t,i){return function(n){var s=void 0!==t?t:n.ganttChartView,r=void 0!==i?i:s.settings,a=void 0!==e?e:s.items,o=s.ownerDocument,l=Ke(n),d=ne(n.start,r),h=ne(n.finish,r),c=2.15*r.barHeight/3;(g=o.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",d),g.setAttribute("y",r.barMargin),g.setAttribute("width",Math.max(0,h-d-1)),g.setAttribute("height",c);var u=r.summaryBarClass;if(void 0!==n.summaryBarClass&&(u=n.summaryBarClass),void 0!==n.barClass&&(u=n.barClass),void 0!==u)g.setAttribute("class",u);else{var p=r.summaryBarStyle;void 0!==n.summaryBarStyle&&(p=n.summaryBarStyle),void 0!==n.barStyle&&(p=n.barStyle),void 0!==p&&g.setAttribute("style",p)}if(l.appendChild(g),!n.isExpanded){(g=o.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",d),g.setAttribute("y1",r.barMargin+c+2.5),g.setAttribute("x2",h-1),g.setAttribute("y2",r.barMargin+c+2.5);var m=r.collapsedSummaryLineClass;void 0!==n.collapsedSummaryLineClass&&(m=n.collapsedSummaryLineClass),void 0!==m?g.setAttribute("class",m):(m=r.collapsedSummaryLineStyle,void 0!==n.collapsedSummaryLineStyle&&(m=n.collapsedSummaryLineStyle),void 0!==m&&g.setAttribute("style",m)),l.appendChild(g)}m=o.createElementNS("http://www.w3.org/2000/svg","polygon");var g,f=c+1.5,v=3*r.barHeight/4,y=r.barHeight/4;return m.setAttribute("points",(c=d-1-r.barHeight/3)+","+(g=r.barMargin-.25)+" "+c+","+(g+f)+" "+(c+v/2)+","+(g+f+y)+" "+(c+v)+","+(g+f)+" "+(c+v)+","+g),void 0!==u&&m.setAttribute("class",u),void 0!==p&&m.setAttribute("style",p),l.appendChild(m),(m=o.createElementNS("http://www.w3.org/2000/svg","polygon")).setAttribute("points",(c=h+r.barHeight/3)+","+g+" "+c+","+(g+f)+" "+(c-v/2)+","+(g+f+y)+" "+(c-v)+","+(g+f)+" "+(c-v)+","+g),void 0!==u&&m.setAttribute("class",u),void 0!==p&&m.setAttribute("style",p),l.appendChild(m),r.isReadOnly||r.isChartReadOnly||void 0!==n.isReadOnly&&n.isReadOnly||void 0!==n.isBarReadOnly&&n.isBarReadOnly||!r.areTaskDependenciesVisible||r.areTaskPredecessorsReadOnly||n.isPart||(u=null,(void 0===r.allowCreatingStartDependencies||r.allowCreatingStartDependencies)&&((u=o.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",d-.5),u.setAttribute("cy",r.barMargin+r.barHeight/2),u.setAttribute("r",r.barHeight/4),u.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),l.appendChild(u)),(o=o.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",h-.5),o.setAttribute("cy",r.barMargin+r.barHeight/2),o.setAttribute("r",2.5),o.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),l.appendChild(o),Et(o,u,l,n,r.barMargin+r.barHeight/2,h-1.5,d,a,s,r)),l}},it=function(e,t,i){return function(n){var s=void 0!==t?t:n.ganttChartView,r=void 0!==i?i:s.settings,a=void 0!==e?e:s.items,o=s.ownerDocument,l=Ke(n);if(r.isBaselineVisible&&void 0!==n.baselineStart){var d=ne(n.baselineStart,r),h=o.createElementNS("http://www.w3.org/2000/svg","polygon"),c=r.barMargin-1,u=r.barHeight+1;if(h.setAttribute("points",d+","+c+" "+(d-u/2)+","+(c+u/2)+" "+d+","+(c+u)+" "+(d+u/2)+","+(c+u/2)),d=r.baselineBarClass,void 0!==n.baselineBarClass&&(d=n.baselineBarClass),void 0!==d)h.setAttribute("class",d);else{var p=r.baselineBarStyle;void 0!==n.baselineBarStyle&&(p=n.baselineBarStyle)}h.setAttribute("style",p),l.appendChild(h)}return h=ne(n.start,r),(p=o.createElementNS("http://www.w3.org/2000/svg","polygon")).setAttribute("points",(h-=1)+","+(c=r.barMargin)+" "+(h-(d=r.barHeight+1)/2)+","+(c+d/2)+" "+h+","+(c+d)+" "+(h+d/2)+","+(c+d/2)),c=r.milestoneBarClass,void 0!==n.milestoneBarClass&&(c=n.milestoneBarClass),void 0!==n.barClass&&(c=n.barClass),void 0!==c?p.setAttribute("class",c):(c=r.milestoneBarStyle,void 0!==n.milestoneBarStyle&&(c=n.milestoneBarStyle),void 0!==n.barStyle&&(c=n.barStyle),void 0!==c&&p.setAttribute("style",c)),l.appendChild(p),r.isReadOnly||r.isChartReadOnly||void 0!==n.isReadOnly&&n.isReadOnly||void 0!==n.isBarReadOnly&&n.isBarReadOnly||((p=o.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",h-d/2),p.setAttribute("y",r.barMargin),p.setAttribute("width",d),p.setAttribute("height",d),p.setAttribute("style","fill: White; fill-opacity: 0; cursor: move"),l.appendChild(p),kt(p,null,null,null,n,h,h,h,a,s,r),!r.areTaskDependenciesVisible||r.areTaskPredecessorsReadOnly||n.isPart||((o=o.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",h),o.setAttribute("cy",r.barMargin+r.barHeight/2),o.setAttribute("r",r.barHeight/4),o.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),l.appendChild(o),Et(o,null,l,n,r.barMargin+r.barHeight/2,h,h,a,s,r))),l}},nt=function(e,t){return function(i,n){var s,r=i.ganttChartView,a=void 0!==t?t:r.settings,o=void 0!==e?e:r.items,l=r.ownerDocument;r=l.createElementNS("http://www.w3.org/2000/svg","g"),s=Se(n.item,o,a);var d,h,c,u=Se(i,o,a),p=(o="M ",a.itemHeight),m=p/2,g=p/3.5,f=2,v=!1;return s!=u||void 0!==n.dependencyType&&"FinishStart"!=n.dependencyType&&"FS"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?(void 0===n.dependencyType||"StartStart"!=n.dependencyType&&"SS"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?(d=ne(n.item.finish,a)-1,n.item.hasChildren&&(void 0===n.item.isSummaryEnabled||n.item.isSummaryEnabled)?d+=a.barHeight/3+.25:n.item.isMilestone?d+=p/4:d<(c=ne(n.item.start,a)+4-1)&&(d=c),h=d+g):(d=ne(n.item.start,a),n.item.hasChildren&&(void 0===n.item.isSummaryEnabled||n.item.isSummaryEnabled)?d-=a.barHeight/3+.25:n.item.isMilestone&&(d-=p/4),h=d-g),o=o+(d+" ")+((s=s-u+.5)+m)+" L "+h+" "+(s+m),void 0===n.dependencyType||"FinishFinish"!=n.dependencyType&&"FF"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?(d=ne(i.start,a),void 0===n.dependencyType||"StartStart"!=n.dependencyType&&"SS"!=n.dependencyType?i.isMilestone?u=d-1:(u=d+1.5,c=ne(i.finish,a),u<h&&c-h>2*g&&i.start>=n.item.finish&&(u=h)):(v=!0,i.hasChildren&&(void 0===i.isSummaryEnabled||i.isSummaryEnabled)?d-=a.barHeight/3+1:i.isMilestone&&(d-=p/4+1),u=d-g)):(d=ne(i.finish,a)-1,void 0===n.dependencyType||"FinishFinish"!=n.dependencyType&&"FF"!=n.dependencyType?i.isMilestone?u=d:(d<(c=ne(i.start,a)+4)&&(d=c),u=d-2.5):(v=!0,i.hasChildren&&(void 0===i.isSummaryEnabled||i.isSummaryEnabled)?d+=a.barHeight/3+1:i.isMilestone?d+=p/4+1:d<(c=ne(i.start,a)+4-1)&&(d=c),u=d+g)),void 0===n.dependencyType||"StartStart"!=n.dependencyType&&"SS"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?u<h&&(o=o+" "+h+" "+((s=(s-=g/6)<=0?s+m:s-m)+m)):u>h&&(o=o+" "+h+" "+((s=(s-=g/6)<=0?s+m:s-m)+m)),o=o+" "+u+" "+(s+m),s=v?m+.5:s<=0?a.barMargin-1-f:p-a.barMargin+1+f,v&&(u>d-f&&(f=-f),d-=f),o=o+" "+u+" "+s,v&&(o=o+" "+d+" "+s)):(void 0===n.dependencyType||"FinishStart"==n.dependencyType||"FS"==n.dependencyType?(d=ne(n.item.finish,a),h=ne(i.start,a)):(d=ne(n.item.start,a),h=ne(i.finish,a)),o=o+(d+" ")+((s=s-u+.5)+m)+" L "+(h+(h>d?-1:1)*(p/5-1))+" "+(s+m)),s=o,(o=l.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",s),void 0!==a.dependencyLineZoneClass&&o.setAttribute("class",a.dependencyLineZoneClass),void 0!==a.dependencyLineZoneStyle&&o.setAttribute("style",a.dependencyLineZoneStyle),r.appendChild(o),(l=l.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",s),s=a.dependencyLineClass,void 0!==n.dependencyLineClass&&(s=n.dependencyLineClass),void 0!==s?l.setAttribute("class",s):(a=a.dependencyLineStyle,void 0!==n.dependencyLineStyle&&(a=n.dependencyLineStyle),void 0!==a&&l.setAttribute("style",a)),r.appendChild(l),r}},st=function(e){return function(t,i){var n=t.ganttChartView.ownerDocument,s=n.createElementNS("http://www.w3.org/2000/svg","title");return s.appendChild(u(n,i.item.content+" - "+t.content)),void 0!==e.areToolTipsSimplified&&e.areToolTipsSimplified||(i.dependencyType&&(s.appendChild(n.createTextNode("\n")),s.appendChild(u(n,"Type: "+rt(i.dependencyType)))),i.lag&&(s.appendChild(n.createTextNode("\n")),s.appendChild(u(n,"Lag: "+i.lag/36e5+"h")))),s}},rt=function(e){switch(e){case"StartStart":case"SS":return"SS";case"FinishFinish":case"FF":return"FF";case"StartFinish":case"SF":return"SF";default:return"FS"}},at=function(e,t,i,n){if(void 0!==e.ganttChartView){var s=e.ganttChartView,r=s.settings;if("start"==t||"minStart"==t||"maxStart"==t?(void 0!==e.minStart&&e.start<e.minStart?(e.start=e.minStart,void 0===e.loadChartItem&&(e.start=ft(e.start,r,!0,void 0!==e.isMilestone&&e.isMilestone,Dt(e))),i&&(e.preferredStart=e.start)):void 0!==e.maxStart&&e.start>e.maxStart&&(e.start=e.maxStart,void 0===e.loadChartItem&&(e.start=ft(e.start,r,!0,void 0!==e.isMilestone&&e.isMilestone,Dt(e))),i&&(e.preferredStart=e.start)),e.finish<e.start&&(e.finish=e.start,at(e,"finish",!1,!0)),e.completedFinish<e.start?(e.completedFinish=e.start,at(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,at(e,"completedFinish",!1,!0))):"finish"!=t&&"minFinish"!=t&&"maxFinish"!=t||(void 0!==e.maxFinish&&e.finish>e.maxFinish?(e.finish=e.maxFinish,void 0===e.loadChartItem&&(e.finish=ft(e.finish,r,void 0!==e.isMilestone&&e.isMilestone,!0,Dt(e)))):void 0!==e.minFinish&&e.finish<e.minFinish&&(e.finish=e.minFinish,void 0===e.loadChartItem&&(e.finish=ft(e.finish,r,void 0!==e.isMilestone&&e.isMilestone,!0,Dt(e)))),e.finish<e.start&&(e.finish=e.start,at(e,"finish",!1,!0)),e.completedFinish<e.start?(e.completedFinish=e.start,at(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,at(e,"completedFinish",!1,!0))),s.isTimingInformationInitialized){var a,o,l=s.items;if("indentation"==t||"predecessors"==t)for(a=0;a<l.length;a++)void 0!==(o=l[a]).dependsOf&&delete o.dependsOf;if(("predecessors"==t||"start"==t||"finish"==t)&&void 0===e.isDuringPropertyChangeTaskDependencyConstraintsEnsuring&&r.areTaskDependencyConstraintsEnabled&&(r.areTaskDependencyConstraintsEnabledWhileDragging||void 0===s.isDuringTimeDragOperation)){for(e.isDuringPropertyChangeTaskDependencyConstraintsEnsuring=!0,o=e.parent;null!=o;)void 0!==o.predecessors&&o.predecessors.length>0&&lt(o,l,r,s),o=o.parent;for(void 0!==(o=e).predecessors&&o.predecessors.length>0?lt(o,l,r,s):ot(o,r);null!=o;){if(void 0===o.successors)for(o.successors=[],a=0;a<l.length;a++){var d=l[a];if(d!=o&&void 0!==d.predecessors&&0!=d.predecessors.length)for(var h=0;h<d.predecessors.length;h++)if(d.predecessors[h].item==o){o.successors.push(d);break}}for(a=0;a<o.successors.length;a++)lt(o.successors[a],l,r,s);o=o.parent}delete e.isDuringPropertyChangeTaskDependencyConstraintsEnsuring}e.isPart&&e.ganttChartItem&&at(e.ganttChartItem,"parts",!1,!0)}if(!e.isSetAsCompleted||"start"!=t&&"finish"!=t&&"completedFinish"!=t||(e.isSetAsCompleted=!1),("start"==t||"finish"==t)&&!e.hasChildren&&e.hasFixedEffort&&void 0!==e.fixedEffort){for(l=s.getItemEffort(e)/e.fixedEffort,o="",a=0;a<e.fixedEffortAssignments.length;a++)d=e.fixedEffortAssignments[a],o.length>0&&(o+=", "),h=Math.floor(d.value/l*1e6)/1e6,o+=d.key+(1!=h?" ["+100*h+"%]":"");s.setItemAssignmentsContent(e,o)}r.itemPropertyChangeHandler(e,t,i,n),"isExpanded"==t?void 0!==e.ganttChartView&&void 0!==e.ganttChartView.settings.itemExpansionChangeHandler&&e.ganttChartView.settings.itemExpansionChangeHandler(e,e.isExpanded):"isSelected"==t&&void 0!==e.ganttChartView&&void 0!==e.ganttChartView.settings.itemSelectionChangeHandler&&e.ganttChartView.settings.itemSelectionChangeHandler(e,e.isSelected,i),void 0!==e.scheduleChartView&&"content"==t&&e.scheduleChartView.refreshScheduleChartItem(e)}},ot=function(e,t){if(void 0===e.isAwaitingPreferredStartUpdates)if(e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled))for(var i=0;i<e.children.length;i++)ot(e.children[i],t);else void 0!==e.preferredStart&&e.preferredStart<e.start&&(e.isAwaitingPreferredStartUpdates=!0,effort=vt(e.start,e.finish,t,Dt(e)),completedEffort=vt(e.start,e.completedFinish,t,Dt(e)),e.start=e.preferredStart,e.finish=yt(e.start,effort,t,Dt(e)),e.completedFinish=yt(e.start,completedEffort,t,Dt(e)),at(e,"start",!1,!0),at(e,"finish",!1,!0),at(e,"completedFinish",!1,!0),setTimeout((function(){Ue(e),delete e.isAwaitingPreferredStartUpdates}),1))},lt=function(e,t,i,n){if(n.isBasicTimingInformationInitialized&&(void 0===e.areDependencyConstraintsEnabled||e.areDependencyConstraintsEnabled)){ot(e,i);var s,r=[],a=!1;for(n=0;n<e.predecessors.length;n++)void 0===(s=e.predecessors[n]).item||t.indexOf(s.item)<0||ht(s.item,e)?(i.invalidPredecessorDetectionHandler&&i.invalidPredecessorDetectionHandler(s,e,s.item),a=!0):r.push(s);for(e.predecessors=r,a&&(at(e,"predecessors",!1,!0),void 0!==e.ganttChartView&&Xe(e)),n=0;n<e.predecessors.length;n++)dt(e,s=e.predecessors[n],t,i)}},dt=function(e,t,i,n){if(e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled))for(var s=0;s<e.children.length;s++)dt(e.children[s],t,i,n);else if(!(void 0!==n.areDependencyConstraintsAppliedOnMilestones&&!n.areDependencyConstraintsAppliedOnMilestones&&e.isMilestone||void 0!==n.areDependencyConstraintsAppliedOnStartedTasks&&!n.areDependencyConstraintsAppliedOnStartedTasks&&ii(e))){var r,a=t.item;i=!1,void 0===t.dependencyType||""==t.dependencyType||"FinishStart"==t.dependencyType||"FS"==t.dependencyType?(a=a.finish,void 0!==t.lag&&0!=t.lag&&(a=yt(a,t.lag,n,Dt(e))),e.start<a&&(e.isMilestone||e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)||(s=vt(e.start,e.finish,n,Dt(e)),r=vt(e.start,e.completedFinish,n,Dt(e))),e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)||(e.start=ft(ae(a,n),n,!0,e.isMilestone,Dt(e)),at(e,"start",!1,!0),e.isMilestone?(e.finish=e.start,at(e,"finish",!1,!0),e.completedFinish=e.start):(e.finish=yt(e.start,s,n,Dt(e)),at(e,"finish",!1,!0),e.completedFinish=yt(e.start,r,n,Dt(e))),at(e,"completedFinish",!1,!0),i=!0))):"StartStart"==t.dependencyType||"SS"==t.dependencyType?(a=a.start,void 0!==t.lag&&0!=t.lag&&(a=yt(a,t.lag,n,Dt(e))),e.start<a&&(e.isMilestone||e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)||(s=vt(e.start,e.finish,n,Dt(e)),r=vt(e.start,e.completedFinish,n,Dt(e))),e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)||(e.start=ft(ae(a,n),n,!0,e.isMilestone,Dt(e)),at(e,"start",!1,!0),e.isMilestone?(e.finish=e.start,at(e,"finish",!1,!0),e.completedFinish=e.start):(e.finish=yt(e.start,s,n,Dt(e)),at(e,"finish",!1,!0),e.completedFinish=yt(e.start,r,n,Dt(e))),at(e,"completedFinish",!1,!0),i=!0))):"FinishFinish"==t.dependencyType||"FF"==t.dependencyType?(a=a.finish,void 0!==t.lag&&0!=t.lag&&(a=yt(a,t.lag,n,Dt(e))),e.finish>a&&(!e.hasChildren||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled)&&(e.finish=ft(ae(a,n),n,e.isMilestone,!0,Dt(e)),e.finish<e.start&&(e.finish=e.start),at(e,"finish",!1,!0),e.isMilestone?e.completedFinish!=e.start&&(e.completedFinish=e.start,at(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,at(e,"completedFinish",!1,!0)),i=!0)):"StartFinish"!=t.dependencyType&&"SF"!=t.dependencyType||(a=a.start,void 0!==t.lag&&0!=t.lag&&(a=yt(a,t.lag,n,Dt(e))),e.finish>a&&(!e.hasChildren||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled)&&(e.finish=ft(ae(a,n),n,e.isMilestone,!0,Dt(e)),e.finish<e.start&&(e.finish=e.start),at(e,"finish",!1,!0),e.isMilestone?e.completedFinish!=e.start&&(e.completedFinish=e.start,at(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,at(e,"completedFinish",!1,!0)),i=!0)),i&&void 0!==e.ganttChartView&&void 0===e.isAwaitingEnsureItemDependencyConstraintsUpdates&&(void 0===e.ganttChartView||e.ganttChartView.isTimingInformationInitialized?(e.isAwaitingEnsureItemDependencyConstraintsUpdates=!0,setTimeout((function(){Ue(e),delete e.isAwaitingEnsureItemDependencyConstraintsUpdates}),0)):Ue(e))}},ht=function(e,t){if(void 0!==e.dependsOf&&void 0!==e.dependsOf[e])return e.dependsOf[t];try{if(e==t)return!0;var i=ct(e);if(i.indexOf(t)>=0)return!0;var n=ct(t);if(n.indexOf(e)>=0)return!0;var s,r,a=ut(e);for(s=0;s<a.length;s++)if((r=a[s])==t||r==e||i.indexOf(r)>=0||n.indexOf(r)>=0||ht(r,t))return!0;for(a=0;a<i.length;a++){var o=ut(i[a]);for(s=0;s<o.length;s++)if((r=o[s])==t||r==e||i.indexOf(r)>=0||n.indexOf(r)>=0||ht(r,t))return!0}var l=e.children;for(s=0;s<l.length;s++){var d=l[s];if(void 0!==d.predecessors&&d.predecessors.length>0&&ht(d,t))return!0}}finally{void 0===e.dependsOf&&(e.dependsOf={}),e.dependsOf[t]=!0}return e.dependsOf[t]=!1},ct=function(e){for(var t=[];void 0!==e.parent&&null!=e.parent;)(void 0===e.isSummaryEnabled||e.isSummaryEnabled)&&t.push(e.parent),e=e.parent;return t},ut=function(e){var t=[];if(void 0!==e.predecessors&&null!=e.predecessors)for(var i=0;i<e.predecessors.length;i++)void 0!==e.predecessors[i].item&&t.push(e.predecessors[i].item);return t},pt=function(e,t){for(var i=0;i<e.length;i++){var n=e[i],s=null==t||t(n);if(n.isHidden=!s,s)for(n=n.parent;null!=n;)n.isHidden=!1,n=n.parent}},mt=function(e,t,i){return ft(e,t,!0,!0,i)},gt=function(e,t,i){return ft(e,t,!0,!1,i)},ft=function(e,t,i,n,s){var r=void 0!==s&&void 0!==s.workingDayStart?s.workingDayStart:t.visibleDayStart,a=void 0!==s&&void 0!==s.workingDayFinish?s.workingDayFinish:t.visibleDayFinish,o=void 0!==s&&void 0!==s.workingWeekStart?s.workingWeekStart:t.workingWeekStart,l=void 0!==s&&void 0!==s.workingWeekFinish?s.workingWeekFinish:t.workingWeekFinish;for(t=void 0!==s&&void 0!==s.specialNonworkingDays?s.specialNonworkingDays:t.specialNonworkingDays,s=q(e),((e=$(e))<r||!i&&e==r)&&(i?e=r:(s=ce(s),e=a)),(e>a||!n&&e==a)&&(n?e=a:(s=he(s),e=r)),n=K(s);n<o||n>l||ge(s,t);){for(i?(n++,s=he(s),e=r):(n--,s=ce(s),e=a);n<0;)n+=7;for(;n>=7;)n-=7}return new Date(s.valueOf()+e)},vt=function(e,t,i,n){if(t.valueOf()<e.valueOf())return-vt(t,e,i,n);if(t.valueOf()==e.valueOf())return 0;var s=void 0!==n&&void 0!==n.workingDayStart?n.workingDayStart:i.visibleDayStart,r=void 0!==n&&void 0!==n.workingDayFinish?n.workingDayFinish:i.visibleDayFinish,a=void 0!==n&&void 0!==n.workingWeekStart?n.workingWeekStart:i.workingWeekStart,o=void 0!==n&&void 0!==n.workingWeekFinish?n.workingWeekFinish:i.workingWeekFinish,l=(n=void 0!==n&&void 0!==n.specialNonworkingDays?n.specialNonworkingDays:i.specialNonworkingDays,i=0,q(e));(e=$(e))<s?e=s:e>=r&&(l=he(l),e=s);for(var d=q(t);l<d;){var h=K(l);h>=a&&h<=o&&!ge(l,n)&&(i+=r-e),l=he(l),e=s}return(t=$(t))<s?t=s:t>r&&(t=r),t>e&&(i+=t-e),i},yt=function(e,t,i,n){if(t<0)return Ct(-t,e,i,n);if(e=ft(e,i,!0,!1,n),0==t)return e;var s=void 0!==n&&void 0!==n.workingDayStart?n.workingDayStart:i.visibleDayStart,r=void 0!==n&&void 0!==n.workingDayFinish?n.workingDayFinish:i.visibleDayFinish,a=$(e);if(a+t<r)return new Date(e.valueOf()+t);for(a=r-a,e=new Date(e.valueOf()+a),t-=a;t>0;){if(e=$(e)>0?ft(he(q(e)),i,!0,!1,n):ft(q(e),i,!0,!1,n),s+t<r)return new Date(e.valueOf()+t);a=r-s,e=new Date(e.valueOf()+a),t-=a}return new Date(e.valueOf())},Ct=function(e,t,i,n){if(e<0)return yt(t,-e,i,n);if(t=ft(t,i,!1,!0,n),0==e)return t;var s=void 0!==n&&void 0!==n.workingDayStart?n.workingDayStart:i.visibleDayStart,r=void 0!==n&&void 0!==n.workingDayFinish?n.workingDayFinish:i.visibleDayFinish,a=$(t);if(a-e>s)return new Date(t.valueOf()-e);for(a-=s,t=new Date(t.valueOf()-a),e-=a;e>0;){if(t=$(t)<864e5?ft(q(t),i,!1,!0,n):ft(ce(q(t)),i,!1,!0,n),r-e>s)return new Date(t.valueOf()-e);a=r-s,t=new Date(t.valueOf()-a),e-=a}return new Date(t.valueOf())},bt=function(e,t,i,n,s){return vt(e,t,n,s)/vt(e,i,n,s)},St=function(e,t,i,n,s){return yt(e,t*vt(e,i,n,s),n,s)},wt=function(e){for(var t=0,i=(e=hi(e),0);i<e.length;i++)t+=e[i].value;return 0==t&&(t=1),t},Tt=function(e){if(e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)){for(var t=0,i=(e=e.children,0);i<e.length;i++)t+=Tt(e[i]);return t}return e.ganttChartView.getItemEffort(e)*wt(e)},xt=function(e){if(e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)){for(var t=0,i=(e=e.children,0);i<e.length;i++)t+=xt(e[i]);return t}return e.ganttChartView.getItemCompletedEffort(e)*wt(e)},Dt=function(e){if(e.schedule)return e.schedule;if(e.scheduleChartItem)return e.scheduleChartItem.schedule;var t=hi(e);if(t){for(var i,n=-1/0,s=0;s<t.length;s++){var r=t[s];r.value>n&&(i=r.key,n=r.value)}if((e=e.ganttChartView)&&e.settings&&e.settings.resourceSchedules)return(i=yi(e.settings.resourceSchedules,i))<0||!e.settings.resourceSchedules[i]?void 0:e.settings.resourceSchedules[i].value}},kt=function(e,t,i,n,s,r,a,o,l,d,h){var c;e.addEventListener("mousedown",(function(t){0==t.button&&(d.isDuringTimeDragOperation=!0,d.draggingItem=s,d.dragType="Start",d.style.cursor=e.style.cursor,d.draggingInitialX=t.clientX,d.draggingInitialStartPosition=r,d.draggingInitialFinishPosition=a,d.draggingInitialCompletedFinishPosition=o,t.preventDefault(),DlhSoft.Controls.ToolTip&&h.useUpdatingToolTips&&((c=DlhSoft.Controls.ToolTip.get(e))||(c=DlhSoft.Controls.ToolTip.initialize(void 0,e,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+h.border+"; background-color: White; color: Black; font-family: Arial; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),c.setContent(h.dateTimeFormatter(f(s.start))+" – "+h.dateTimeFormatter(f(s.finish))),c.show(),c.originalX=c.x,d.toolTip=c))}),!0),null!=t&&t.addEventListener("mousedown",(function(i){0==i.button&&(d.isDuringTimeDragOperation=!0,d.draggingItem=s,d.dragType="StartOnly",d.style.cursor=e.style.cursor,d.draggingInitialX=i.clientX,d.draggingInitialStartPosition=r,i.preventDefault(),DlhSoft.Controls.ToolTip&&h.useUpdatingToolTips&&((c=DlhSoft.Controls.ToolTip.get(t))||(c=DlhSoft.Controls.ToolTip.initialize(void 0,t,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+h.border+"; background-color: White; color: Black; font-family: Arial; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),c.setContent(h.dateTimeFormatter(f(s.start))+" –"),c.show(),c.setHorizontalPosition(c.x+4),c.originalX=c.x,d.toolTip=c))}),!0),null!=i&&i.addEventListener("mousedown",(function(e){0==e.button&&(d.isDuringTimeDragOperation=!0,d.draggingItem=s,d.dragType="Finish",d.style.cursor=i.style.cursor,d.draggingInitialX=e.clientX,d.draggingInitialFinishPosition=a,e.preventDefault(),DlhSoft.Controls.ToolTip&&h.useUpdatingToolTips&&((c=DlhSoft.Controls.ToolTip.get(i))||(c=DlhSoft.Controls.ToolTip.initialize(void 0,i,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+h.border+"; background-color: White; color: Black; font-family: Arial; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),c.setContent("– "+h.dateTimeFormatter(f(s.finish))),c.show(),c.setHorizontalPosition(c.x-c.contentContainer.clientWidth),c.originalX=c.x,d.toolTip=c))}),!0),null!=n&&n.addEventListener("mousedown",(function(e){0==e.button&&(d.isDuringTimeDragOperation=!0,d.draggingItem=s,d.dragType="CompletedFinish",d.style.cursor=n.style.cursor,d.draggingInitialX=e.clientX,d.draggingInitialCompletedFinishPosition=o,e.preventDefault(),DlhSoft.Controls.ToolTip&&h.useUpdatingToolTips&&((c=DlhSoft.Controls.ToolTip.get(n))||(c=DlhSoft.Controls.ToolTip.initialize(void 0,n,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+h.border+"; background-color: White; color: Black; font-family: Arial; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),e=bt(s.start,s.completedFinish,s.finish,h,Dt(s)),isNaN(e)||(c.setContent(Math.round(1e4*e)/100+"%"),c.show(),c.setHorizontalPosition(c.x+2),c.originalX=c.x,d.toolTip=c)))}),!0),void 0===d.draggableItems&&(d.draggableItems=[]);for(var u=!1,p=0;p<d.draggableItems.length;p++)if(d.draggableItems[p]==s){u=!0;break}u||(d.addEventListener("mousemove",(function(e){if(void 0!==d.draggingItem&&d.draggingItem==s&&("Start"==d.dragType||"StartOnly"==d.dragType||"Finish"==d.dragType||"CompletedFinish"==d.dragType)){var t,i=e.clientX-d.draggingInitialX;It(e.clientX,d),delete d.draggingItem,d.draggingInitialStartPosition+i<0&&(i=-d.draggingInitialStartPosition),"Start"==d.dragType||"StartOnly"==d.dragType?("StartOnly"!=d.dragType&&(t=vt(s.start,s.finish,h,Dt(s))),e=vt(s.start,s.completedFinish,h,Dt(s)),i=ft(ae(se(d.draggingInitialStartPosition+i,h),h),h,!0,s.isMilestone,Dt(s)),"StartOnly"==d.dragType&&i>s.finish&&(i=s.finish),s.start=i,s.preferredStart=s.start,at(s,"start",!0,!1),"StartOnly"!=d.dragType?(s.isMilestone?(s.finish=s.start,at(s,"finish",!1,!1),s.completedFinish=s.start):(s.finish=yt(s.start,t,h,Dt(s)),at(s,"finish",!1,!1),s.completedFinish=yt(s.start,e,h,Dt(s))),at(s,"completedFinish",!1,!1),DlhSoft.Controls.ToolTip&&h.useUpdatingToolTips&&((c=d.toolTip).setContent(h.dateTimeFormatter(f(s.start))+" – "+h.dateTimeFormatter(f(s.finish))),c.setHorizontalPosition(c.originalX+(ne(s.start,h)-d.draggingInitialStartPosition)))):(s.finish<s.start&&(s.finish=s.start,at(s,"finish",!1,!1)),(s.completedFinish<s.start||e<=0)&&(s.completedFinish=s.start,at(s,"completedFinish",!1,!1)),DlhSoft.Controls.ToolTip&&h.useUpdatingToolTips&&((c=d.toolTip).setContent(h.dateTimeFormatter(f(s.start))+" –"),c.setHorizontalPosition(c.originalX+(ne(s.start,h)-d.draggingInitialStartPosition)))),Vt(s,l,d.chartContent,h)):"Finish"==d.dragType?((t=ft(ae(se(d.draggingInitialFinishPosition+i,h),h),h,s.isMilestone,!0,Dt(s)))<s.start&&(t=s.start),t.valueOf()!=s.finish.valueOf()&&(s.finish=t,at(s,"finish",!0,!1)),s.completedFinish>t&&(s.completedFinish=t,at(s,"completedFinish",!1,!1)),DlhSoft.Controls.ToolTip&&h.useUpdatingToolTips&&((c=d.toolTip).setContent("– "+h.dateTimeFormatter(f(s.finish))),c.setHorizontalPosition(c.originalX+(ne(s.finish,h)-d.draggingInitialFinishPosition))),Vt(s,l,d.chartContent,h)):"CompletedFinish"==d.dragType&&((t=ft(ae(se(d.draggingInitialCompletedFinishPosition+i,h),h),h,s.isMilestone,!0,Dt(s)))<s.start&&(t=s.start),t>s.finish&&(t=s.finish),t.valueOf()!=s.completedFinish.valueOf()&&(s.completedFinish=t,at(s,"completedFinish",!0,!1)),DlhSoft.Controls.ToolTip&&h.useUpdatingToolTips&&(c=d.toolTip,t=bt(s.start,s.completedFinish,s.finish,h,Dt(s)),isNaN(t)||(c.setContent(Math.round(1e4*t)/100+"%"),c.setHorizontalPosition(c.originalX+(ne(s.completedFinish,h)-d.draggingInitialCompletedFinishPosition)))),Vt(s,l,d.chartContent,h)),d.draggingItem=s,d.draggingPerformed=!0}}),!0),document.addEventListener("mouseup",(function(e){0!=e.button||void 0===d.draggingItem||d.draggingItem!=s||"Start"!=d.dragType&&"StartOnly"!=d.dragType&&"Finish"!=d.dragType&&"CompletedFinish"!=d.dragType||(delete d.isDuringTimeDragOperation,e=d.draggingItem,d.style.cursor="default",d.draggingPerformed&&("Start"==d.dragType||"StartOnly"==d.dragType?(at(e,"start",!0,!0),at(e,"finish",!1,!0),at(e,"completedFinish",!1,!0)):"Finish"==d.dragType?(at(e,"finish",!0,!0),at(e,"completedFinish",!1,!0)):"CompletedFinish"==d.dragType&&at(e,"completedFinish",!0,!0),delete d.draggingPerformed),delete d.draggingItem)}),!0),d.draggableItems.push(s))},Et=function(e,t,i,n,s,r,a,o,l,d){var h=n.ganttChartView.ownerDocument;e.addEventListener("mousedown",(function(t){0==t.button&&(delete l.cancelDrag,l.draggingItem=n,l.dragType="Dependency",l.dragDependencyType="Finish",l.style.cursor=e.style.cursor,l.draggingInitialX=t.clientX,l.draggingInitialY=t.clientY,l.draggingInitialRightPosition=r,l.draggingInitialTopPosition=s,l.draggingInitialFinishPosition=r,l.draggingInitialThumbPosition=s,t.preventDefault(),DlhSoft.Controls.ToolTip&&d.useUpdatingToolTips&&((toolTip=DlhSoft.Controls.ToolTip.get(e))||(toolTip=DlhSoft.Controls.ToolTip.initialize(void 0,e,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+d.border+"; background-color: White; color: Black; font-family: Arial; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),toolTip.setContent(n.content+" –"),toolTip.show(),toolTip.setPosition(toolTip.x+16,toolTip.y-8),toolTip.originalX=toolTip.x,toolTip.originalY=toolTip.y,l.toolTip=toolTip))}),!0),null!=t&&t.addEventListener("mousedown",(function(i){0==i.button&&(delete l.cancelDrag,l.draggingItem=n,l.dragType="Dependency",l.dragDependencyType="Start",l.style.cursor=e.style.cursor,l.draggingInitialX=i.clientX,l.draggingInitialY=i.clientY,l.draggingInitialRightPosition=a,l.draggingInitialTopPosition=s,l.draggingInitialFinishPosition=a,l.draggingInitialThumbPosition=s,i.preventDefault(),DlhSoft.Controls.ToolTip&&d.useUpdatingToolTips&&((toolTip=DlhSoft.Controls.ToolTip.get(t))||(toolTip=DlhSoft.Controls.ToolTip.initialize(void 0,t,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+d.border+"; background-color: White; color: Black; font-family: Arial; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),toolTip.setContent(n.content+" –"),toolTip.show(),toolTip.setPosition(toolTip.x+16,toolTip.y-8),toolTip.originalX=toolTip.x,toolTip.originalY=toolTip.y,l.toolTip=toolTip))}),!0),e.addEventListener("mouseover",(function(){if(void 0!==l.temporaryHoveringThumb){var t=l.temporaryHoveringThumb;if(delete l.temporaryHoveringThumb,void 0===t.originalStyle)return;t.setAttribute("style",t.originalStyle),delete t.originalStyle}void 0===l.temporaryDependencyLine&&(e.mouseOver=!0,l.temporaryHoveringThumb=e,e.originalStyle=e.getAttribute("style"),void 0!==d.dependencyPointerClass&&e.setAttribute("class",d.dependencyPointerClass),void 0!==d.dependencyPointerStyle&&e.setAttribute("style",d.dependencyPointerStyle),e.style.cursor="pointer")}),!0),null!=t&&t.addEventListener("mouseover",(function(){if(void 0!==l.temporaryHoveringThumb){var e=l.temporaryHoveringThumb;if(delete l.temporaryHoveringThumb,void 0===e.originalStyle)return;e.setAttribute("style",e.originalStyle),delete e.originalStyle}void 0===l.temporaryDependencyLine&&(t.mouseOver=!0,l.temporaryHoveringThumb=t,t.originalStyle=t.getAttribute("style"),void 0!==d.dependencyPointerClass&&t.setAttribute("class",d.dependencyPointerClass),void 0!==d.dependencyPointerStyle&&t.setAttribute("style",d.dependencyPointerStyle),t.style.cursor="pointer")}),!0),e.addEventListener("mouseout",(function(){delete e.mouseOver,setTimeout((function(){void 0===e.originalStyle||e.mouseOver||(e.setAttribute("style",e.originalStyle),delete e.originalStyle)}),2e3)}),!0),null!=t&&(delete t.mouseOver,t.addEventListener("mouseout",(function(){setTimeout((function(){void 0===t.originalStyle||t.mouseOver||(t.setAttribute("style",t.originalStyle),delete t.originalStyle)}),2e3)}),!0)),void 0===l.draggableDependencyItems&&(l.draggableDependencyItems=[]);for(var c=!1,u=0;u<l.draggableDependencyItems.length;u++)if(l.draggableDependencyItems[u]==n){c=!0;break}c||(l.addEventListener("mousemove",(function(e){if(void 0!==l.draggingItem&&l.draggingItem==n&&"Dependency"==l.dragType){var t=e.clientX-l.draggingInitialX,r=e.clientY-l.draggingInitialY;if(It(e.clientX,l),At(e.clientY,l),delete l.draggingItem,l.draggingInitialFinishPosition+t<0&&(t=-l.draggingInitialFinishPosition),void 0!==l.temporaryDependencyLine){try{i.removeChild(l.temporaryDependencyLine)}catch(s){}delete l.temporaryDependencyLine}if(l.cancelDrag)delete l.cancelDrag,delete l.draggingItem,l.style.cursor="default";else if((e=h.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",l.draggingInitialRightPosition),e.setAttribute("y1",l.draggingInitialTopPosition),e.setAttribute("x2",l.draggingInitialFinishPosition+t),e.setAttribute("y2",l.draggingInitialThumbPosition+r),void 0!==d.temporaryDependencyLineClass&&e.setAttribute("class",d.temporaryDependencyLineClass),void 0!==d.temporaryDependencyLineStyle&&e.setAttribute("style",d.temporaryDependencyLineStyle),l.temporaryDependencyLine=e,i.appendChild(e),l.draggingItem=n,DlhSoft.Controls.ToolTip&&d.useUpdatingToolTips){toolTip=l.toolTip;for(var a=Math.floor((n.itemTop+l.draggingInitialThumbPosition+r)/d.itemHeight),c=(e=null,0),u=0;u<o.length;u++){var p=o[u];if(p.isVisible&&(void 0===p.isHidden||!p.isHidden)&&void 0===p.displayRowIndex){if(c==a){e=p;break}c++}}a="Start",null!=e&&(c=l.draggingInitialFinishPosition+t,u=ne(e.start,d),p=ne(e.finish,d),(e.isMilestone||e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled))&&(u-=d.itemHeight/2,p+=d.itemHeight/2),p<u+4&&(p=u+4),(c<u||c>p||Z(e,n)||J(e,n)||J(n,e))&&(e=null),null!=e&&(void 0===d.allowCreatingToFinishDependencies||d.allowCreatingToFinishDependencies)&&!e.isMilestone&&c>u+3*(p-u)/4&&(a="Finish")),toolTip.setContent(n.content+" –"+(null!=e?" "+e.content+("Finish"!=a?"":" •"):"")),toolTip.setPosition(toolTip.originalX+t,toolTip.originalY+r)}}}),!0),h.addEventListener("mouseup",(function(e){if(0==e.button&&void 0!==l.draggingItem&&l.draggingItem==n&&"Dependency"==l.dragType){if(void 0!==l.temporaryDependencyLine){try{i.removeChild(l.temporaryDependencyLine)}catch(t){}delete l.temporaryDependencyLine}for(var s=Math.floor((n.itemTop+l.draggingInitialThumbPosition+(e.clientY-l.draggingInitialY))/d.itemHeight),r=null,a=0,h=0;h<o.length;h++){var c=o[h];if(c.isVisible&&(void 0===c.isHidden||!c.isHidden)&&void 0===c.displayRowIndex){if(a==s){r=c;break}a++}}var u,p;null!=r&&(e=l.draggingInitialFinishPosition+(e.clientX-l.draggingInitialX),s=ne(r.start,d),a=ne(r.finish,d),(r.isMilestone||r.hasChildren&&(void 0===r.isSummaryEnabled||r.isSummaryEnabled))&&(s-=d.itemHeight/2,a+=d.itemHeight/2),a<s+4&&(a=s+4),e>=s&&e<=a&&!Z(r,n)&&!J(r,n)&&!J(n,r))&&(e=null==r||void 0!==d.allowCreatingToFinishDependencies&&!d.allowCreatingToFinishDependencies||r.isMilestone||e<=s+3*(a-s)/4?"Start":"Finish",delete n.successors,void 0===r.predecessors&&(r.predecessors=[]),s={item:n},"Start"!=l.dragDependencyType?"Finish"==e&&(s.dependencyType="FF"):s.dependencyType="Finish"!=e?"SS":"SF",r.predecessors.push(s),at(r,"predecessors",!0,!0),r.start<n.finish&&!d.areTaskDependencyConstraintsEnabled&&!d.areTaskDependencyConstraintsDisabledWhenDropping&&(r.isMilestone||r.hasChildren&&(void 0===r.isSummaryEnabled||r.isSummaryEnabled)||(u=vt(r.start,r.finish,d,Dt(r)),p=vt(r.start,r.completedFinish,d,Dt(r))),r.hasChildren&&(void 0===r.isSummaryEnabled||r.isSummaryEnabled)||"Start"!=e||(r.start=ft(ae("Start"!=l.dragDependencyType?n.finish:n.start,d),d,!0,r.isMilestone,Dt(n)),at(r,"start",!1,!0),r.isMilestone?(r.finish=r.start,at(r,"finish",!1,!0),r.completedFinish=r.start):(r.finish=yt(r.start,u,d,Dt(r)),at(r,"finish",!1,!0),r.completedFinish=yt(r.start,p,d,Dt(r))),at(r,"completedFinish",!1,!0))),Vt(r,o,l.chartContent,d),Vt(n,o,l.chartContent,d)),delete l.draggingItem,l.style.cursor="default"}}),!0),l.draggableDependencyItems.push(n))},It=function(e,t){if(void 0!==t.draggingItem){var i=t,n=0;if(i.offsetParent)do{n+=i.offsetLeft,i=i.offsetParent}while(i);(e-=n)<t.gridContentContainer.offsetWidth+24?(i=t.chartContentContainer.scrollLeft,t.chartContentContainer.scrollLeft=t.chartContentContainer.scrollLeft-20,i-=t.chartContentContainer.scrollLeft,void 0!==t.draggingInitialStartPosition&&(t.draggingInitialStartPosition=t.draggingInitialStartPosition-i),void 0!==t.draggingInitialFinishPosition&&(t.draggingInitialFinishPosition=t.draggingInitialFinishPosition-i),void 0!==t.draggingInitialCompletedFinishPosition&&(t.draggingInitialCompletedFinishPosition=t.draggingInitialCompletedFinishPosition-i)):e>=t.gridContentContainer.offsetWidth+t.chartContentContainer.clientWidth-24&&(i=t.chartContentContainer.scrollLeft,t.chartContentContainer.scrollLeft=t.chartContentContainer.scrollLeft+20,i=t.chartContentContainer.scrollLeft-i,void 0!==t.draggingInitialStartPosition&&(t.draggingInitialStartPosition=t.draggingInitialStartPosition+i),void 0!==t.draggingInitialFinishPosition&&(t.draggingInitialFinishPosition=t.draggingInitialFinishPosition+i),void 0!==t.draggingInitialCompletedFinishPosition&&(t.draggingInitialCompletedFinishPosition=t.draggingInitialCompletedFinishPosition+i))}},At=function(e,t){var i;void 0!==t.draggingItem&&((e-=function(e){var t=0;if(e.offsetParent)do{t+=e.offsetTop,e=e.offsetParent}while(e);return t}(t))<t.chartHeaderContainer.clientHeight+24?(i=t.chartContentContainer.scrollTop,t.chartContentContainer.scrollTop=t.chartContentContainer.scrollTop-20,void 0===t.isDuringVerticalScrolling&&(t.isDuringVerticalScrolling=!0,setTimeout((function(){t.draggingInitialThumbPosition=t.draggingInitialThumbPosition-(i-t.chartContentContainer.scrollTop),delete t.isDuringVerticalScrolling}),0))):e>=t.chartHeaderContainer.clientHeight+t.chartContentContainer.clientHeight-24&&(i=t.chartContentContainer.scrollTop,t.chartContentContainer.scrollTop=t.chartContentContainer.scrollTop+20,void 0===t.isDuringVerticalScrolling&&(t.isDuringVerticalScrolling=!0,setTimeout((function(){t.draggingInitialThumbPosition=t.draggingInitialThumbPosition+(t.chartContentContainer.scrollTop-i),delete t.isDuringVerticalScrolling}),0))))},Vt=function(e,t,i,n){ze(e.chartItem,e,n),Re(t,e),setTimeout((function(){if(void 0!==e.gridItem){if(void 0!==e.completedInput){var s=e.completedInput;void 0!==s.changeEventListener&&s.removeEventListener("change",s.changeEventListener,!0),delete e.completedInput}xe(e.gridItem,e,t,n.columns,i,n.toggleButtonAreaWidth,n)}for(s=e.parent;null!=s;)j(s,!1),ze((e=s).chartItem,e,n),Re(t,e),void 0!==e.gridItem&&xe(e.gridItem,e,t,n.columns,i,n.toggleButtonAreaWidth,n),s=e.parent}),0)},Ht=function(e){var t=e.itemTop-e.ganttChartView.chartContentContainer.scrollTop;t<0?e.ganttChartView.chartContentContainer.scrollTop=e.itemTop:t>e.ganttChartView.chartContentContainer.clientHeight-e.ganttChartView.settings.itemHeight&&(e.ganttChartView.chartContentContainer.scrollTop=e.itemTop-(e.ganttChartView.chartContentContainer.clientHeight-e.ganttChartView.settings.itemHeight))},Lt=function(e,t,i,n,s,r,a,o,l,d,h,c,u,p){var m,g;t.addEventListener("scroll",(function(){a.scrollTop==t.scrollTop||g||(m=!0,setTimeout((function(){a.scrollTop=t.scrollTop,setTimeout((function(){m=!1}),100)}),200)),n.scrollLeft!=t.scrollLeft&&(n.scrollLeft=t.scrollLeft)}),!0),Ft(t,i,s,p),void 0!==e.updateGridHeaderTimer&&clearInterval(e.updateGridHeaderTimer),e.updateGridHeaderTimer=setInterval((function(){try{Ft(t,i,s,p)}catch(n){try{clearInterval(e.updateGridHeaderTimer)}catch(o){}}}),100),a.addEventListener("scroll",(function(){t.scrollTop==a.scrollTop||m||(g=!0,setTimeout((function(){t.scrollTop=a.scrollTop,setTimeout((function(){g=!1}),100)}),200)),o.scrollLeft!=a.scrollLeft&&(o.scrollLeft=a.scrollLeft),Pt(u,a,p),we(u,h,p),p.displayedTime=se(a.scrollLeft,p),(void 0===e.isDuringScrollToDateTime||!e.isDuringScrollToDateTime)&&void 0!==p.displayedTimeChangeHandler&&setTimeout((function(){p.displayedTimeChangeHandler(p.displayedTime)}),0),void 0!==e.isDuringScrollToDateTime&&delete e.isDuringScrollToDateTime}),!0),setTimeout((function(){o.scrollLeft!=a.scrollLeft&&(o.scrollLeft=a.scrollLeft),Pt(u,a,p)}),1),Ft(a,l,d,p),void 0!==e.updateChartHeaderTimer&&clearInterval(e.updateChartHeaderTimer),e.updateChartHeaderTimer=setInterval((function(){try{Ft(a,l,d,p)}catch(n){try{clearInterval(e.updateChartHeaderTimer)}catch(i){}}}),100),window.addEventListener("mousewheel",(function(){try{e.cancelDrag=!0}catch(n){}}),!0)},Ft=function(e,t,i,n){setTimeout((function(){try{var s=t.clientWidth-e.clientWidth;s<0&&(s=0);var r=s+"px";i.style.width!=r&&(i.style.width=r,s>0?(i.style.boxSizing="border-box",i.style.MozBoxSizing="border-box",i.style.border="solid 1px "+n.border,i.style.borderTop="none",i.style.borderRight="none"):(i.style.border="",i.style.borderTop="",i.style.borderRight="",i.style.boxSizing="",i.style.MozBoxSizing=""))}catch(a){}}),0)},Ot=function(e,t,i){i.isSplitterEnabled&&(e.style.height=t.clientHeight+"px",e.style.left=Math.max(0,t.offsetWidth-1)+"px")},Pt=function(e,t,i){if((void 0===t.isInitializing||!t.isInitializing)&&i.isVirtualizing)for(var n=t.scrollTop-i.itemHeight,s=(t=n+t.clientHeight+2*i.itemHeight,0);s<e.length;s++){var r=e[s];r.isPart||(void 0===r.isVirtuallyVisible&&(void 0===r.isVisible||r.isVisible)&&(void 0===r.isHidden||!r.isHidden)&&void 0!==r.itemTop&&r.itemTop>=n&&r.itemTop<t?(r.isVirtuallyVisible=!0,at(r,"isVirtuallyVisible",!1,!0),void 0!==r.gridItem&&xe(r.gridItem,r,e,i.columns,r.ganttChartView.chartContent,i.toggleButtonAreaWidth,i),ze(r.chartItem,r,i),r.chartItem.setAttribute("transform","translate(0, "+r.itemTop+")"),Be(r,r.itemTop)):void 0!==r.isVirtuallyVisible&&(void 0===r.isVisible||r.isVisible)&&(void 0===r.isHidden||!r.isHidden)&&void 0!==r.itemTop&&(r.itemTop<n||r.itemTop>=t)&&delete r.isVirtuallyVisible)}},Bt=function(e,t){for(var i=e.childNodes.length;i-- >0;)e.removeChild(e.childNodes[i]);e.appendChild(t)},Mt=function(e,t,i,n){var s=n.indexOf(e);s<0||t<0||t==s||t>=n.length||(n.splice(s,1),n.splice(t,0,e),Wt(n),a(i),void 0!==i.settings.itemMoveHandler&&i.settings.itemMoveHandler(e,s,t))},Rt=function(e,t,i,n,s){if(!(e<0||i<0||i==e||i>s.length-t)){var r,o=[];for(r=e;r<e+t;r++)o.push(s[r]);for(s.splice(e,t),r=0;r<o.length;r++)s.splice(i+r,0,o[r]);if(Wt(s),a(n),void 0!==n.settings.itemMoveHandler)for(r=0;r<o.length;r++)n.settings.itemMoveHandler(o[r],e+r,i+r)}},Wt=function(e){for(var t=0,i=0;i<e.length;i++){var n=e[i];n.indentation>t&&(n.indentation=t,at(n,"indentation",!1,!0)),t=n.indentation+1}},zt=function(e,t){for(var i in t)0!=i.indexOf("custom")&&0!=i.indexOf("description")||void 0===e[i]&&(e[i]=t[i])},Nt=function(e,t,i,n,s,r,a,o,l,d,h,c,p,m,g,f){var v,y,C=[];if(void 0!==n)for(v=0;v<n.length;v++)C.push({isTreeView:(y=f.columns[n[v]]).isTreeView,header:y.header,width:y.width,headerClass:y.headerClass,headerStyle:y.headerStyle,cellClass:y.cellClass,cellStyle:y.cellStyle,cellTemplate:void 0!==y.exportCellTemplate?y.exportCellTemplate:y.cellTemplate});else for(v=0;v<f.columns.length;v++)(y=f.columns[v]).isSelection||C.push({isTreeView:y.isTreeView,header:y.header,width:y.width,headerClass:y.headerClass,headerStyle:y.headerStyle,cellClass:y.cellClass,cellStyle:y.cellStyle,cellTemplate:void 0!==y.exportCellTemplate?y.exportCellTemplate:y.cellTemplate});void 0===i&&(i=f.isGridVisible),v=i?N(C)+1:0,void 0!==s?void 0!==a&&a||(s=new Date(s.valueOf()-6e4*s.getTimezoneOffset())):s=f.timelineStart,void 0!==r?void 0!==a&&a||(r=new Date(r.valueOf()-6e4*r.getTimezoneOffset())):r=f.timelineFinish,(s={isExport:!0,isReadOnly:!0,selectionMode:"None",isVirtualizing:!1,isGridVisible:i,isSplitterEnabled:!1,gridWidth:v+"px",columns:C,allowUserToResizeColumns:!1,isGridRowClickTimeScrollingEnabled:!1,isMouseWheelZoomEnabled:!1,timelineStart:s,timelineFinish:r,hourWidth:void 0!==o?o:f.hourWidth,displayedTime:void 0!==s?s:f.timelineStart,currentTime:f.currentTime,isTaskToolTipVisible:!1,isDependencyToolTipVisible:!1,containerClass:f.containerClass,containerStyle:f.containerStyle,border:f.border,theme:f.theme,headerBackground:f.headerBackground,headerHeight:f.headerHeight,itemHeight:f.itemHeight,itemClass:f.itemClass,itemStyle:f.itemStyle,standardItemClass:f.standardItemClass,summaryItemClass:f.summaryItemClass,milestoneItemClass:f.milestoneItemClass,standardItemStyle:f.standardItemStyle,summaryItemStyle:f.summaryItemStyle,milestoneItemStyle:f.milestoneItemStyle,indentationLevelWidth:f.indentationLevelWidth,toggleButtonClass:f.toggleButtonClass,toggleButtonStyle:f.toggleButtonStyle,scales:[],visibleWeekStart:f.visibleWeekStart,visibleWeekFinish:f.visibleWeekFinish,workingWeekStart:f.workingWeekStart,workingWeekFinish:f.workingWeekFinish,visibleDayStart:f.visibleDayStart,visibleDayFinish:f.visibleDayFinish,specialNonworkingDays:f.specialNonworkingDays,barMargin:f.barMargin,barHeight:f.barHeight,barCornerRadius:f.barCornerRadius,completedBarMargin:f.completedBarMargin,completedBarHeight:f.completedBarHeight,completedBarCornerRadius:f.completedBarCornerRadius,standardBarClass:f.standardBarClass,summaryBarClass:f.summaryBarClass,milestoneBarClass:f.milestoneBarClass,standardBarStyle:f.standardBarStyle,summaryBarStyle:f.summaryBarStyle,milestoneBarStyle:f.milestoneBarStyle,standardCompletedBarClass:f.standardCompletedBarClass,standardCompletedBarStyle:f.standardCompletedBarStyle,dependencyLineClass:f.dependencyLineClass,dependencyLineStyle:f.dependencyLineStyle,assignmentsClass:f.assignmentsClass,assignmentsStyle:f.assignmentsStyle,areTaskAssignmentsVisible:f.areTaskAssignmentsVisible,isTaskCompletedEffortVisible:f.isTaskCompletedEffortVisible,areTaskDependenciesVisible:f.areTaskDependenciesVisible,areDependencyConstraintsAppliedOnStartedTasks:f.areDependencyConstraintsAppliedOnMilestones,areDependencyConstraintsAppliedOnMilestones:f.areDependencyConstraintsAppliedOnMilestones,isBaselineVisible:f.isBaselineVisible,alternativeItemClass:f.alternativeItemClass,alternativeChartItemClass:f.alternativeChartItemClass,alternativeItemStyle:f.alternativeItemStyle,alternativeChartItemStyle:f.alternativeChartItemStyle,gridLines:f.gridLines,horizontalGridLines:f.horizontalGridLines,verticalGridLines:f.verticalGridLines,horizontalChartLines:f.horizontalChartLines,isIndividualItemNonworkingTimeHighlighted:f.isIndividualItemNonworkingTimeHighlighted,areTaskInterruptionsHighlighted:f.areTaskInterruptionsHighlighted,isBaselineVisible:f.isBaselineVisible,taskInitiationCost:f.taskInitiationCost,defaultResourceUsageCost:f.defaultResourceUsageCost,specificResourceUsageCosts:f.specificResourceUsageCosts,defaultResourceHourCost:f.defaultResourceHourCost,specificResourceHourCosts:f.specificResourceHourCosts,target:f.target,months:f.months,daysOfWeek:f.daysOfWeek,weekStartDay:f.weekStartDay,dateFormatter:f.dateFormatter,dateTimeFormatter:f.dateTimeFormatter,isRelativeToTimezone:f.isRelativeToTimezone,standardTaskTemplate:f.standardTaskTemplate,summaryTaskTemplate:f.summaryTaskTemplate,milestoneTaskTemplate:f.milestoneTaskTemplate,assignmentsTemplate:f.assignmentsTemplate,dependencyLineTemplate:f.dependencyLineTemplate,styleDefinitionTemplate:f.styleDefinitionTemplate}).timelineStart=ee(s.timelineStart,s.weekStartDay),s.timelineFinish=te(s.timelineFinish,s.weekStartDay),r=ne(s.timelineFinish,s),s.chartWidth=r+"px";var b=v+r+2+(i?1:0);for(v=0;v<f.scales.length;v++)s.scales.push({scaleType:(i=f.scales[v]).scaleType,isHeaderVisible:i.isHeaderVisible,headerHeight:i.headerHeight,headerTextFormat:i.headerTextFormat,headerClass:i.headerClass,headerStyle:i.headerStyle,isHighlightingVisible:i.isHighlightingVisible,highlightingClass:i.highlightingClass,highlightingStyle:i.highlightingStyle,isSeparatorVisible:i.isSeparatorVisible,separatorClass:i.separatorClass,separatorStyle:i.separatorStyle});var S,w,T=!1;if(null!=h&&void 0!==h.createElement)S=h;else{null!=h&&void 0!==h.focus?w=h:(w=window.open("",null!=h?h:"_blank",void 0!==c&&c&&(void 0===m||m)?"width=320,height=100,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),T=!0),S=w.document;try{var x=document.head.getElementsByTagName("link");for(v=0;v<x.length;v++){var D=x[v],k=S.adoptNode(D.cloneNode(!0));k.href=D.href,S.head.appendChild(k)}}catch(E){}}for(S.title=void 0!==e?e:"Exported chart"+(void 0!==c&&c?" (printable)":""),void 0===l&&(l=0),void 0===d&&(d=g.length-1),e=[],v=x=0;v<g.length;v++)void 0!==(h=g[v]).displayRowIndex&&(h.displayRowIndex<l||h.displayRowIndex>d)||void 0===h.displayRowIndex&&(x++<l||x>d+1)||(f={content:h.content,indentation:h.indentation,start:h.start,finish:h.finish,completedFinish:h.completedFinish,isMilestone:h.isMilestone,schedule:Dt(h),assignmentsContent:h.assignmentsContent,baselineStart:h.baselineStart,baselineFinish:h.baselineFinish,isBarVisible:h.isBarVisible,isRelativeToTimezone:h.isRelativeToTimezone,class:h.class,style:h.style,barClass:h.barClass,standardBarClass:h.standardBarClass,completedStandardBarClass:h.completedStandardBarClass,summaryBarClass:h.summaryBarClass,milestoneBarClass:h.milestoneBarClass,baselineBarClass:h.baselineBarClass,barStyle:h.barStyle,standardBarStyle:h.standardBarStyle,completedStandardBarStyle:h.completedStandardBarStyle,summaryBarStyle:h.summaryBarStyle,milestoneBarStyle:h.milestoneBarStyle,baselineBarStyle:h.baselineBarStyle,isSummaryEnabled:h.isSummaryEnabled,isParentSummarizationEnabled:h.isParentSummarizationEnabled,isHidden:h.isHidden,isExported:!0,tag:h},void 0!==h.displayRowIndex&&(f.displayRowIndex=h.displayRowIndex-l),zt(f,h),e.push(f),h.exportItem=f);for(v=0;v<g.length;v++)if((void 0===(h=g[v]).displayRowIndex||!(h.displayRowIndex<l||h.displayRowIndex>d))&&(f=h.exportItem,void 0!==h.predecessors))for(f.predecessors=[],x=0;x<h.predecessors.length;x++)void 0!==(D=h.predecessors[x]).item.displayRowIndex&&(D.item.displayRowIndex<l||D.item.displayRowIndex>d)||f.predecessors.push({item:D.item.exportItem,dependencyType:D.dependencyType,lag:D.lag,dependencyLineClass:D.dependencyLineClass,dependencyLineStyle:D.dependencyLineStyle});var I=S.createElement("p");I.innerHTML=void 0!==t?t:"",S.body.appendChild(I);var A=S.createElement("div");A.setAttribute("style","width: "+b+"px");try{DlhSoft.Controls.GanttChartView.initialize(A,e,s,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch(u){}setTimeout((function(){T&&S.body.setAttribute("style","margin: 0px");var e=S.createElement("div");e.appendChild(A),S.body.replaceChild(e,I),p&&(e.setAttribute("style","width: "+A.offsetHeight+"px; height: "+b+"px; overflow: hidden"),e=Math.round((A.offsetWidth-A.offsetHeight)/2),A.setAttribute("style","width: "+b+"px; transform: rotate(90deg) translateX("+e+"px) translateY("+e+"px); -webkit-transform: rotate(90deg) translateX("+e+"px) translateY("+e+"px)")),S.close(),void 0!==typeof w&&(w.focus(),void 0!==c&&c&&(w.print(),(void 0===m||m)&&w.close()))}),0)},_t=function(e){var t=s;if(void 0===e)return t;for(var i=0;i<e.length;i++){var n=e[i];(!n.hasChildren||void 0!==n.isSummaryEnabled&&!n.isSummaryEnabled)&&n.start<t&&(t=n.start)}return new Date(t.valueOf())},Gt=function(e){var t=n;if(void 0===e)return t;for(var i=0;i<e.length;i++){var s=e[i];s.hasChildren&&(void 0===s.isSummaryEnabled||s.isSummaryEnabled)||(void 0!==s.isMilestone&&s.isMilestone?s.start>t&&(t=s.start):s.finish>t&&(t=s.finish))}return new Date(t.valueOf())},Yt=function(e,t){for(var i=0,n=0;n<e.length;n++){var s=e[n];null==s.parent&&(i+=ni(s,t))}return i},Xt=function(e,t){for(var i=0,n=0;n<e.length;n++){var s=e[n];null==s.parent&&(i+=si(s,t))}return i},Ut=function(e,t){for(var i=[],n=0;n<t.length;n++){var s=t[n];if(s!=e&&void 0!==s.predecessors&&0!=s.predecessors.length)for(var r=0;r<s.predecessors.length;r++)if(s.predecessors[r].item==e){i.push(s);break}}return i},jt=function(e,t){for(var i=[],n=Ut(e,t),s=0;s<n.length;s++){var r=n[s];if(void 0!==r.predecessors&&0!=r.predecessors.length)for(var a=0;a<r.predecessors.length;a++)r.predecessors[a].item==e&&i.push({successor:r,predecessor:r.predecessors[a]})}return i},Zt=function(e,t,i,n){void 0===t&&(t=0);var s=Gt(i);if(e.finish>=s)return!0;if(!e.hasChildren||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled){var r=jt(e,i);for(s=0;s<r.length;s++){var a=r[s].successor,o=r[s].predecessor;if(((void 0===o.dependencyType||""==o.dependencyType||"FinishStart"==o.dependencyType||"FS"==o.dependencyType)&&vt(e.finish,a.start,n,Dt(e))<=t||("StartStart"==o.dependencyType||"SS"==o.dependencyType)&&vt(e.start,a.start,n,Dt(e))<=t)&&Zt(a,t,i,n))return!0}}else for(e=e.children,s=0;s<e.length;s++)if(Zt(e[s],t,i,n))return!0;return!1},Qt=function(e,t,i){for(var n=0;n<e.length;n++){var s=e[n];(!s.hasChildren||void 0!==s.isSummaryEnabled&&!s.isSummaryEnabled)&&void 0!==s.predecessors&&null!=s.predecessors&&s.predecessors.length>0&&lt(s,e,t,i)}},Jt=function(e,t,i,n){t=new Date(t.valueOf()-6e4*t.getTimezoneOffset()),t=gt(t,n,Dt(e)),i=ni(e,n);var s=si(e,n);oi(e,t),ri(e,i,n),ai(e,s,n),Ue(e)},qt=function(e,t){for(var i=0,n=hi(e),s=0;s<n.length;s++){var r,a=n[s],o=a.key;if(void 0!==t.specificResourceUsageCosts&&(r=yi(t.specificResourceUsageCosts,o))>=0?i+=t.specificResourceUsageCosts[r].value*a.value:void 0!==t.defaultResourceUsageCost&&(i+=t.defaultResourceUsageCost*a.value),!e.hasChildren||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled){var l=ni(e,t)/36e5;void 0!==t.specificResourceHourCosts&&(r=yi(t.specificResourceHourCosts,o))>=0?i+=t.specificResourceHourCosts[r].value*l*a.value:void 0!==t.defaultResourceHourCost&&(i+=t.defaultResourceHourCost*l*a.value)}}return i},$t=function(e,t){var i=(i=void 0!==t.taskInitiationCost?t.taskInitiationCost:0)+qt(e,t);if(e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled))for(var n=0;n<e.children.length;n++)i+=Kt(e.children[n],t);return i},Kt=function(e,t){return(void 0!==e.executionCost?e.executionCost:0)+$t(e,t)},ei=function(e){for(var t=[],i=(e=ut(e),0);i<e.length;i++)ti(e[i],t);return t},ti=function(e,t){if(!e.hasChildren||void 0!==e.isSummaryEnabled&&!e.isSummaryEnabled)t.indexOf(e)<0&&t.push(e);else for(var i=0;i<e.children.length;i++)ti(e.children[i],t)},ii=function(e){return!e.isMilestone&&e.completedFinish>e.start},ni=function(e,t){if(e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)){for(var i=0,n=e.children,s=0;s<n.length;s++)i+=ni(n[s],t);return i}return vt(e.start,e.finish,t,Dt(e))},si=function(e,t){if(e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)){for(var i=0,n=e.children,s=0;s<n.length;s++)i+=si(n[s],t);return i}return vt(e.start,e.completedFinish,t,Dt(e))},ri=function(e,t,i){t=yt(e.start,t,i,Dt(e)),e.finish=t,at(e,"finish",!1,!1),li(e,!1)},ai=function(e,t,i){e.completedFinish=yt(e.start,t,i,Dt(e)),at(e,"completedFinish",!1,!1)},oi=function(e,t){e.start=t,e.preferredStart=t,at(e,"start",!1,!1),li(e,!1)},li=function(e,t){for(var i=e.parent;null!=i;)j(i,t),i=(e=i).parent},di=function(e,t,i){void 0===i&&(i=!1);var n=e.parent,s=e.index;if(null==n){for(n=0;s-- >0;)0==(e=t[s]).indentation&&n++;return n+(i?0:1)}return di(n,t)+"."+(n.children.indexOf(e)+(i?0:1))},hi=function(e){var t;if(void 0===(e=e.assignmentsContent))t=[];else{e=e.split(",");for(var i=[],n=0;n<e.length;n++){var s=vi(e[n]),r=1,a=s.indexOf("["),o=s.lastIndexOf("]");if(a>=0&&o>=0){o=vi(s.substr(a+1,o-a-1)),s=vi(s.substr(0,a)),(a=o.indexOf("%"))>=0&&(o=vi(o.substr(0,a)));try{r=(t=parseFloat(o))/100}catch(l){r=1}}s.length<=0||((a=yi(i,s))<0?i.push({key:s,value:r}):i[a].value=i[a].value+r)}t=i}return t},ci=function(e){for(var t=[],i=(e=hi(e),0);i<e.length;i++)t.push(e[i].key);return t},ui=function(e,t){if(void 0===t)return[];for(var i=[],n=0;n<t.length;n++){var s=t[n];if(!s.hasChildren||void 0!==s.isSummaryEnabled&&!s.isSummaryEnabled)for(var r=hi(s),a=0;a<r.length;a++){var o=r[a];if(o.key==e){i.push({key:s,value:o.value});break}}}return i},pi=function(e){if(void 0===e)return[];for(var t=[],i=0;i<e.length;i++)if(!(n=e[i]).hasChildren||void 0!==n.isSummaryEnabled&&!n.isSummaryEnabled)for(var n=ci(n),s=0;s<n.length;s++){var r=n[s];t.indexOf(r)<0&&t.push(r)}return t},mi=function(e,t){for(var i=[],n=ui(e,t),s=0;s<n.length;s++){var r=n[s],a=r.key;if(!a.hasChildren||void 0!==a.isSummaryEnabled&&!a.isSummaryEnabled)for(a=[{start:a.start,finish:a.finish}];a.length>0;){var o;if(o=a[0],a.splice(0,1),!(o.finish<=o.start))if(0==i.length)i.push({key:o,value:r.value});else{_t(t);for(var l=!1,d=0;d<i.length;d++){var h=i[d].key,c=i[d].value;if(!(o.start>=h.finish)){if(o.finish<=h.start){for(l=0;l<=d;l++)if(i[l].key.start>=o.start){i.splice(l,0,{key:o,value:r.value});break}l=!0;break}if(o.start<=h.start&&o.finish>=h.finish){i[d].value=c+r.value,o.start<h.start&&a.push({start:o.start,finish:h.start}),o.finish>h.finish&&a.push({start:h.finish,finish:o.finish}),l=!0;break}if(o.start>=h.start&&o.finish<=h.finish){i.splice(d,1),o.start>h.start&&i.splice(d++,0,{key:{start:h.start,finish:o.start},value:c}),i.splice(d++,0,{key:o,value:c+r.value}),o.finish<h.finish&&i.splice(d++,0,{key:{start:o.finish,finish:h.finish},value:c}),l=!0;break}if(o.start>=h.start&&o.finish>=h.finish){i.splice(d,1),o.start>h.start&&i.splice(d++,0,{key:{start:h.start,finish:o.start},value:c}),i.splice(d++,0,{key:{start:o.start,finish:h.finish},value:c+r.value}),o.finish>h.finish&&a.push({start:h.finish,finish:o.finish}),l=!0;break}if(o.start<=h.start&&o.finish<=h.finish){i.splice(d,1),o.start<h.start&&a.push({start:o.start,finish:h.start}),i.splice(d++,0,{key:{start:h.start,finish:o.finish},value:c+r.value}),o.finish<h.finish&&i.splice(d++,0,{key:{start:o.finish,finish:h.finish},value:c}),l=!0;break}}}l||i.push({key:o,value:r.value})}}}return i},gi=function(e){var t=e.content;return null==e.parent?t:t+" ("+gi(e.parent)+")"},fi=function(e,t){return e==t||null!=e.parent&&fi(e.parent,t)},vi=function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},yi=function(e,t){for(var i=0;i<e.length;i++)if(e[i].key==t)return i;return-1},Ci=function(e){return void 0!==e?new Date(e.valueOf()+6e4*e.getTimezoneOffset()):e},bi=function(e){return void 0!==e?new Date(e.valueOf()-6e4*e.getTimezoneOffset()):e},Si=function(e,t,i){var n;for(n=0;n<t.length;n++)t[n].ganttChartView=e;for(n=0;n<t.length;n++){var s=t[n];if(void 0!==s.parts){void 0===s.isGroup&&(s.isGroup=!0,s.isSummaryEnabled=!1),d(s.parts,i),(s.isGroup||void 0===s.isBarVisible)&&(s.isBarVisible=!1);for(var r=0;r<s.parts.length;r++){var o=s.parts[r];o.ganttChartView=s.ganttChartView,o.ganttChartItem=s,o.isPart=!0,o.isVirtuallyVisible=!0,(s.isGroup||void 0===o.indentation)&&(o.indentation=0),(s.isGroup||void 0===o.displayRowIndex)&&(o.displayRowIndex=-1),o.isInternallyHidden=!0,t.indexOf(o)>=0||t.splice(t.length,0,o)}}}e.items=t,e.settings=i,e.refresh=function(){a(e)},e.refreshItems=function(){Ne(t)},e.refreshGridItems=function(){for(var e=0;e<t.length;e++)De(t[e])},e.refreshChartItems=function(){for(var e=0;e<t.length;e++)_e(t[e])},e.refreshGridItem=De,e.refreshChartItem=_e,e.refreshItem=Ge,e.refreshPredecessorItems=Ye,e.refreshItemGraph=Xe,e.refreshItemPath=Ue,e.refreshItemNeighbourhood=function(n){je(n,t,e,i)},e.refreshCurrentTimeLine=function(){var n,s=e.chartHeader,r=e.chartContent,a=r.chartArea,o=[];for(n=a.childNodes.length;n-- >1;){var l=a.childNodes[n];"Scale-Highlighting-CurrentTime"!=l.tag&&"Scale-Separator-CurrentTime"!=l.tag&&o.push(l),a.removeChild(l)}for(oe(s,a,i.scales,i,!0),n=o.length;n-- >0;)a.appendChild(o[n]);Me(r,be(t,i))},e.setCurrentTime=function(t){i.currentTime=t,e.refreshCurrentTimeLine()},e.updateCurrentTime=function(){var t=new Date;t=new Date(t.valueOf()-6e4*t.getTimezoneOffset()),e.setCurrentTime(t)},e.getCurrentItem=function(){return e.currentItem},e.getSelectedItem=function(){return e.selectedItem},e.getSelectedItems=function(){return e.selectedItems},e.selectItem=function(e){T(e,!0,i.selectionMode)},e.unselectItem=function(e){T(e,!1,i.selectionMode)},e.expandItem=function(e){Fe(e,!0,!0)},e.collapseItem=function(e){Fe(e,!1,!0)},e.scrollToItem=Ht,e.scrollToBottom=function(){e.chartContentContainer.scrollTop=e.chartContent.clientHeight},e.scrollToDateTime=function(t){e.isDuringScrollToDateTime=!0,e.chartContentContainer.scrollLeft=ne(t,e.settings)},e.increaseTimelinePage=function(t){i.timelineStart=new Date(i.timelineStart.valueOf()+t),i.timelineFinish=new Date(i.timelineFinish.valueOf()+t),a(e)},e.decreaseTimelinePage=function(t){i.timelineStart=new Date(i.timelineStart.valueOf()-t),i.timelineFinish=new Date(i.timelineFinish.valueOf()-t),a(e)},e.setSplitterPosition=function(t){var n=e.gridContainer,s=e.chartContainer,r=e.splitter;t=Math.floor(1e6*t/e.offsetWidth)/1e4,void 0!==n.percent&&delete n.percent,n.style.width=t+"%",s.style.width=100-t+"%",Ot(r,n,i)},e.getChartPosition=function(e){return ne(e,i)},e.getChartWidth=function(){return ne(i.timelineFinish,i)},e.getDateTime=function(e){return se(e,i)},e.getWorkingTime=function(e){return mt(e,i)},e.getStartWorkingTime=function(e){return gt(e,i)},e.getFinishWorkingTime=function(e){return ft(e,i,!1,!0,void 0)},e.getEffort=function(e,t){return vt(e,t,i)},e.getFinish=function(e,t){return yt(e,t,i)},e.getStart=function(e,t){return Ct(e,t,i)},e.getCompletion=function(e,t,n){return bt(e,t,n,i)},e.getCompletedFinish=function(e,t,n){return St(e,t,n,i)},e.getItemsHeight=function(){return be(t,i)},e.getItemTop=function(e){return Se(e,t,i)},e.onItemPropertyChanged=at,e.initializeTaskDraggingThumbs=function(t,i,n,s,r,a,o,l){kt(t,i,n,s,r,a,o,l,e.items,e,e.settings)},e.initializeDependencyDraggingThumbs=function(t,i,n,s,r,a,o){Et(t,i,n,s,r,a,o,e.items,e,e.settings)},e.insertItem=function(n,s){Qe(n,s,e,t,i)},e.addItem=function(i){e.insertItem(t.length,i)},e.insertItems=function(t,i){for(var n=0;n<i.length;n++)e.insertItem(t++,i[n])},e.addItems=function(t){for(var i=0;i<t.length;i++)e.addItem(t[i])},e.removeItem=function(n){var s=n.index,r=null,a=!1;if(s>0){for(r=t[s-1];null!=r.parent;)r=r.parent;a=r.isExpanded,n.hasChildren&&Fe(r,n.isExpanded,!1,!0),r.indentation>=n.indentation&&(r=null)}else t[0].isExpanded||Fe(t[0],!0,!1,!0);var o=s+1<t.length?t[s+1]:null;null!=o&&!o.isExpanded&&o.indentation>n.indentation&&Fe(o,!0,!1,!0);var l,d,h,c=null!=o?o.indentation:null;for(d=0;d<e.items.length;d++)if(null!=(l=e.items[d]).predecessors)for(h=l.predecessors.length;h-- >0;)l.predecessors[h].item==n&&(l.predecessors.splice(h,1),at(l,"predecessors",!1,!0),Ge(l),Ye(l));var u=n.itemTop;if(t.splice(s,1),X(t,e),U(t,i,e),i.isGridVisible&&void 0===n.displayRowIndex&&void 0!==n.gridItemContainer&&e.gridContent.removeChild(n.gridItemContainer),d=e.chartContent.chartArea,void 0!==n.chartItem&&d.removeChild(n.chartItem),null!=(o=s<t.length?t[s]:null)&&o.indentation<c)for(at(o,"indentation",!1,!0),o.predecessors=[],at(o,"predecessors",!1,!0),d=0;d<t.length;d++)if((l=t[d])!=o&&void 0!==l.predecessors&&0!=l.predecessors.length)for(h=0;h<l.predecessors.length;h++)l.predecessors[h].item==o&&(l.predecessors.splice(h--,1),at(l,"predecessors",!1,!0),Ge(l),Ye(l));for(null!=r&&Fe(r,a,!1,!0),d=s;d<t.length;d++)n=t[d],actualItemTop=u,void 0!==n.displayRowIndex&&(actualItemTop=n.displayRowIndex*i.itemHeight),n.isVisible&&(void 0===n.isHidden||!n.isHidden)&&(u=Math.max(u,actualItemTop+i.itemHeight)),n.itemTop=actualItemTop,Ge(n);if(Me(e.chartContent,be(t,i)),we(t,e.chartContent,i),Ze(t,i)&&Ne(t),s>=t.length&&(s=t.length-1),s>=0){for(d=0;d<s;d++)_e(t[d]);je(t[s],t,e,i)}Pt(t,e.chartContentContainer,i)},e.removeItems=function(t){for(var i=0;i<t.length;i++)e.removeItem(t[i])},e.increaseItemIndentation=function(n){var s=n.index>0?e.items[n.index-1]:null;if(!(null==s||n.indentation>s.indentation)){if(Fe(n,!0,!1,!0),n.indentation++,at(n,"indentation",!0,!0),n.predecessors&&n.predecessors.length>0){for(var r=!1,a=0;a<n.predecessors.length;a++)n.predecessors[a].item==s&&n.indentation>s.indentation&&(n.predecessors.splice(a--,1),r=!0);r&&at(n,"predecessors",!1,!0)}for(r=0;r<t.length;r++)if((a=t[r])==s&&void 0!==a.predecessors&&0!=a.predecessors.length)for(var o=0;o<a.predecessors.length;o++)a.predecessors[o].item==n&&s.indentation>a.predecessors[o].item.indentation&&(a.predecessors.splice(o--,1),at(a,"predecessors",!1,!0),Ge(a),Ye(a));for(Ze(t,i)&&Ne(t),je(n,t,e,i);null!=n;)n.isExpanded||Fe(n,!0,!1),n=n.parent}},e.decreaseItemIndentation=function(n){var s=n.index<e.items.length-1?e.items[n.index+1]:null;if(!(n.indentation<=0||null!=s&&n.indentation<s.indentation)){if(n.indentation--,at(n,"indentation",!0,!0),s&&n.predecessors&&n.predecessors.length>0){for(var r=!1,a=0;a<n.predecessors.length;a++)n.predecessors[a].item==s&&n.indentation==s.indentation&&(n.predecessors.splice(a--,1),r=!0);r&&at(n,"predecessors",!1,!0)}for(r=0;r<t.length;r++)if((a=t[r])==s&&void 0!==a.predecessors&&0!=a.predecessors.length)for(var o=0;o<a.predecessors.length;o++)a.predecessors[o].item==n&&s.indentation==a.predecessors[o].item.indentation&&(a.predecessors.splice(o--,1),at(a,"predecessors",!1,!0),Ge(a),Ye(a));for(Ze(t,i)&&Ne(t),je(n,t,e,i);null!=n;)n.isExpanded||Fe(n,!0,!1),n=n.parent}},e.setItemContent=function(e,t){e.content=t,at(e,"content",!0,!0)},e.setItemStart=function(e,t){e.start=gt(t,i,Dt(e)),e.preferredStart=e.start,at(e,"start",!0,!0),e.completedFinish<e.start&&(e.completedFinish=e.start,at(e,"completedFinish",!1,!0))},e.setItemFinish=function(e,t){var n;n=Dt(e),n=ft(t,i,!1,!0,n),e.finish=n,at(e,"finish",!0,!0),e.completedFinish>e.finish&&(e.completedFinish=e.finish,at(e,"completedFinish",!1,!0))},e.setItemIsMilestone=function(e,t){e.isMilestone=t,at(e,"isMilestone",!0,!0)},e.getItemEffort=function(e){return ni(e,i)},e.setItemEffort=function(e,t){e.finish=yt(e.start,t,i,Dt(e)),at(e,"finish",!0,!0),e.completedFinish>e.finish&&(e.completedFinish=e.finish,at(e,"completedFinish",!1,!0))},e.getItemTotalEffort=function(e){return Tt(e)},e.setItemTotalEffort=function(e,t){e.ganttChartView.setItemEffort(e,t/wt(e))},e.setItemHasFixedEffort=function(e,t){e.hasFixedEffort=t,!e.hasChildren&&e.hasFixedEffort&&(e.fixedEffort=ni(e,i),e.fixedEffortAssignments=hi(e))},e.getItemDuration=function(e){return vt(e.start,e.finish,i,Dt(e))},e.setItemDuration=e.setItemEffort,e.getItemCompletedEffort=function(e){return si(e,i)},e.setItemCompletedEffort=function(e,t){e.completedFinish=yt(e.start,t,i,Dt(e)),e.completedFinish>e.finish&&(e.completedFinish=e.finish),at(e,"completedFinish",!0,!0)},e.getItemTotalCompletedEffort=function(e){return xt(e)},e.setItemTotalCompletedEffort=function(e,t){e.ganttChartView.setItemCompletedEffort(e,t/wt(e))},e.getItemCompletion=function(t){return e.getItemCompletedEffort(t)/e.getItemEffort(t)},e.setItemCompletion=function(t,i){e.setItemCompletedEffort(t,i*e.getItemEffort(t))},e.isItemCompleted=function(t){return e.getItemCompletion(t)>=1||(t.isMilestone||t.finish.valueOf()<=t.start.valueOf())&&void 0!==t.isSetAsCompleted&&t.isSetAsCompleted},e.setItemAsCompleted=function(t){(t.isMilestone||t.finish.valueOf()<=t.start.valueOf())&&(t.isSetAsCompleted=!0),e.setItemCompletion(t,1)},e.hasItemStarted=function(e){return ii(e)},e.setItemAsNotStarted=function(t){(t.isMilestone||t.finish.valueOf()<=t.start.valueOf())&&(t.isSetAsCompleted=!1),e.setItemCompletion(t,0)},e.isItemOnSchedule=function(e){var t=new Date;return t=new Date(t.valueOf()-6e4*t.getTimezoneOffset()),e.completedFinish>=t},e.setItemAssignmentsContent=function(e,t){e.assignmentsContent=t,at(e,"assignmentsContent",!0,!0)},e.getItemPredecessorsString=function(e,i){var n=i;void 0===n&&(n=!1);var s="";if(void 0!==e.predecessors&&0!=e.predecessors.length)for(var r=0;r<e.predecessors.length;r++){var a=e.predecessors[r],o=t.indexOf(a.item);o<0||(s.length>0&&(s+=", "),s+=o+(n?0:1),void 0!==a.dependencyType&&""!=a.dependencyType&&"FinishStart"!=a.dependencyType&&"FS"!=a.dependencyType&&("StartStart"==a.dependencyType||"SS"==a.dependencyType?s+="SS":"FinishFinish"==a.dependencyType||"FF"==a.dependencyType?s+="FF":"StartFinish"!=a.dependencyType&&"SF"!=a.dependencyType||(s+="SF")),void 0!==a.lag&&0!=a.lag&&(a.lag>0&&(s+="+"),s+=a.lag/36e5))}return s},e.setItemPredecessorsString=function(e,i,n){void 0===n&&(n=!1);var s=[];e.predecessors=s,i=i.split(",");for(var r=0;r<i.length;r++)if(!((l=vi(i[r])).length<=0)){for(var a=0;a<l.length&&l.charCodeAt(a)>=48&&l.charCodeAt(a)<=57;)a++;var o=l.substr(0,a);if(o=parseInt(o)-(n?0:1),!(isNaN(o)||o<0||o>=t.length||Z(e,o=t[o])||J(e,o)||J(o,e))){a=(l=l.substr(a)).indexOf("+");var l,d=l.indexOf("-"),h=a>=0?a:d>=0?d:-1;if(d=0,h>=0){var c=parseFloat(l.substr(h+1));isNaN(c)||(d=c*(a>=0?1:-1)*36e5)}l=(h<0?l:l.substr(0,h)).toUpperCase(),s.push({item:o,dependencyType:l,lag:d})}}for(n=0;n<t.length;n++)delete t[n].successors;at(e,"predecessors",!0,!0)},e.getItemIndexString=function(e,t){return void 0===t&&(t=!1),void 0!==e.index?(e.index+(t?0:1)).toString():""},e.getItemWbsIndexString=function(e,i){return di(e,t,i).toString()},e.moveRange=function(i,n,s){Rt(i,n,s,e,t)},e.moveItem=function(i,n){Mt(i,n,e,t)},e.moveItemUp=function(i){var n=t.indexOf(i);n<=0||Mt(i,n-1,e,t)},e.moveItemDown=function(i){var n=t.indexOf(i);n<0||n>=t.length-1||Mt(i,n+1,e,t)},e.moveItemHierarchy=function(i,n){for(var s=t.indexOf(i),r=s+1;r<t.length&&!(t[r].indentation<=i.indentation);r++);Rt(s,r-s,n,e,t)},e.moveItemHierarchyUp=function(i){for(var n=t.indexOf(i),s=n+1;s<t.length&&!(t[s].indentation<=i.indentation);s++);for(var r=n;r-- >0;){if(t[r].indentation<i.indentation)return;if(t[r].indentation==i.indentation)break}Rt(n,s-n,r,e,t)},e.moveItemHierarchyDown=function(i){for(var n=t.indexOf(i),s=n+1;s<t.length&&!(t[s].indentation<=i.indentation);s++);for(var r=n+(s-=n);r++<t.length-1&&!(t[r].indentation<=i.indentation););t[r-1].indentation<i.indentation||Rt(n,s,r-s,e,t)},e.exportContent=function(e,n){void 0===e&&(e={}),Nt(e.title,e.preparingMessage,e.isGridVisible,e.columnIndexes,e.timelineStart,e.timelineFinish,e.isRelativeToTimezone,e.hourWidth,e.startRowIndex,e.endRowIndex,n,!1,e.rotate,!1,t,i)},e.print=function(e){void 0===e&&(e={}),Nt(e.title,e.preparingMessage,e.isGridVisible,e.columnIndexes,e.timelineStart,e.timelineFinish,e.isRelativeToTimezone,e.hourWidth,e.startRowIndex,e.endRowIndex,null,!0,e.rotate,e.autoClose,t,i)},e.getRootItems=function(){for(var e=[],i=0;i<t.length;i++){var n=t[i];null==n.parent&&e.push(n)}return e},e.getLeafItems=function(){for(var e=[],i=0;i<t.length;i++){var n=t[i];null!=n.parent&&e.push(n)}return e},e.getSummaryItems=function(){for(var e=[],i=0;i<t.length;i++){var n=t[i];n.hasChildren&&e.push(n)}return e},e.getProjectStart=function(){return _t(t)},e.getProjectFinish=function(){return Gt(t)},e.getProjectEffort=function(){return Yt(t,i)},e.getProjectTotalEffort=function(){for(var e=0,i=0;i<t.length;i++){var n=t[i];null==n.parent&&(e+=Tt(n))}return e},e.getProjectCompletedEffort=function(){return Xt(t,i)},e.getProjectTotalCompletedEffort=function(){for(var e=0,i=0;i<t.length;i++){var n=t[i];null==n.parent&&(e+=xt(n))}return e},e.getProjectCompletion=function(){return Xt(t,i)/Yt(t,i)},e.isItemCritical=function(e,n){return Zt(e,n,t,i)},e.getCriticalItems=function(e){if(void 0===e&&(e=0),void 0===t)e=void 0;else{for(var n=[],s=0;s<t.length;s++){var r=t[s];(!r.hasChildren||void 0!==r.isSummaryEnabled&&!r.isSummaryEnabled)&&Zt(r,e,t,i)&&n.push(r)}e=n}return e},e.ensureDependencyConstraints=function(){Qt(t,i,e)},e.setupBaseline=function(){for(var e=0;e<t.length;e++){var i=t[e];!i.hasChildren||void 0!==i.isSummaryEnabled&&!i.isSummaryEnabled?(i.baselineStart=i.start,i.isMilestone?delete i.baselineFinish:i.baselineFinish=i.finish):(delete i.baselineFinish,delete i.baselineStart),Ge(i)}},e.rescheduleItemToStart=function(e,n){Jt(e,n,t,i)},e.rescheduleItemToFinish=function(e,t){var n=t,s=(n=new Date(n.valueOf()-6e4*n.getTimezoneOffset()),ni(e,i)),r=si(e,i);n=Ct(s,n,i,Dt(e)),n=gt(n,i,Dt(e)),oi(e,n),ri(e,s,i),ai(e,r,i),Ue(e)},e.splitRemainingWork=function(n,s,r){if(void 0===t||n.hasChildren||n.isMilestone||!ii(n)||!n.isMilestone&&n.completedFinish>=n.finish)n=null;else{var a=t.indexOf(n);if(a<0)n=null;else{for(s={content:void 0===s?n.content:n.content+s,indentation:n.indentation,isExpanded:n.isExpanded,start:n.completedFinish,finish:n.finish,assignmentsContent:n.assignmentsContent,isReadOnly:n.isReadOnly,isHidden:n.isHidden,isBarVisible:n.isBarVisible,isBarReadOnly:n.isBarReadOnly,isSummaryEnabled:n.isSummaryEnabled,isParentSummarizationEnabled:n.isParentSummarizationEnabled,displayRowIndex:n.displayRowIndex,class:n.class,style:n.style,barClass:n.barClass,standardBarClass:n.standardBarClass,summaryBarClass:n.summaryBarClass,milestoneBarClass:n.milestoneBarClass,baselineBarClass:n.baselineBarClass,barStyle:n.barStyle,standardBarStyle:n.standardBarStyle,summaryBarStyle:n.summaryBarStyle,milestoneBarStyle:n.milestoneBarStyle,baselineBarStyle:n.baselineBarStyle,taskTemplate:n.taskTemplate,template:n.template,tag:n.tag},void 0!==r&&(n.content=n.content+r),n.finish=n.completedFinish,Qe(a+1,s,e,t,i),r=jt(n,t),a=0;a<r.length;a++){var o=r[a].predecessor;void 0!==o.dependencyType&&""!=o.dependencyType&&"FinishStart"!=o.dependencyType&&"FS"!=o.dependencyType&&"FinishFinish"!=o.dependencyType&&"FF"!=o.dependencyType||(o.item=s)}s.predecessors=[{item:n}],Ye(n),Ye(s),n=s}}return n},e.optimizeWork=function(n,s,r){void 0===n&&(n=!1),void 0===s&&(s=!1),void 0===(a=r)&&(a=new Date);var a=new Date(a.valueOf()+6e4*a.getTimezoneOffset()),o=[];for(r=0;r<t.length;r++){var l=t[r];if((!l.hasChildren||void 0!==l.isSummaryEnabled&&!l.isSummaryEnabled)&&!(l.start<=a||!s&&ii(l))){if(n){for(var d=!1,h=l;null!=h;){if(void 0!==h.predecessors&&h.predecessors.length>0){d=!0;break}h=h.parent}if(!d)continue}Jt(l,a,t,i),o.push(l)}}for(Qt(t,i,e),r=0;r<o.length;r++)at(n=o[r],"start",!0,!0),at(n,"finish",!0,!0),at(n,"completedFinish",!0,!0),Ue(n)},e.levelAllocations=function(t){t||(t=e.items),t.length||(t=[t]);for(var i=0;i<t.length;i++){var n,s=t[i],r="",a=hi(s);if(a&&a.length>0){var o=0;for(n=0;n<a.length;n++)o+=a[n].value;if(o>0){for(n=0;n<a.length;n++)r.length>0&&(r+=", "),r+=a[n].key+(a.length>1?" ["+Math.round(a[n].value/o*1e4)/100+"%]":"");s.assignmentsContent=r,at(s,"assignmentsContent",!1,!0),Ue(s)}}}},e.levelResources=function(n,s){var r,a=n,o=s;if(void 0===t)r=void 0;else{void 0===a&&(a=!1),void 0===o&&(o=new Date),Qt(t,i,e);var l,d,h,c=[],u=[],p=[];for(d=0;d<t.length;d++)if(!(l=t[d]).hasChildren||void 0!==l.isSummaryEnabled&&!l.isSummaryEnabled){c.push({key:l,value:ei(l)});var m=hi(l),g=[];for(h=0;h<m.length;h++){var f=m[h];f.value>0&&g.push(f)}u.push({key:l,value:g}),p.push(l)}for(m=[],g=c.length;g>0;){for(f=[],d=0;d<c.length;d++){l=c[d].key,h=!0;for(var v=c[d].value,y=0;y<v.length;y++){var C=v[y];if(yi(c,C)>=0&&f.indexOf(C)<0){h=!1;break}}if(h){if(h=o,v=i,void 0!==(y=l).minStart&&h<y.minStart&&(h=y.minStart),a||!ii(y))for(;null!=y;){if(void 0!==y.predecessors)for(C=0;C<y.predecessors.length;C++){var b=y.predecessors[C];if(void 0!==b)switch(void 0===(E=b.dependencyType)&&(E="FinishStart"),E){case"":case"FinishStart":case"FS":(b=yt(b.item.finish,void 0===b.lag?0:b.lag,v,Dt(b.item)))>h&&(h=b);break;case"StartStart":case"SS":(b=yt(b.item.start,void 0===b.lag?0:b.lag,v,Dt(b.item)))>h&&(h=b)}}for(y=y.parent;null!=y&&void 0!==y.isSummaryEnabled&&!y.isSummaryEnabled;)y=y.parent}var S;for(v=h,y=u[h=yi(u,l)].value,h=0;h<y.length;h++)if(C=y[h].value,(E=yi(m,S=y[h].key))>=0){if(b=1,void 0!==i.resourceQuantities){var w=yi(i.resourceQuantities,S);w>=0&&(b=i.resourceQuantities[w].value)}for(previousAllocations=m[E].value,E=0;E<previousAllocations.length;E++)(S=previousAllocations[E].key)+C<=b||(w=previousAllocations[E].value)>v&&(v=w)}for(!a&&ii(l)||(v=gt(v,i,Dt(l)))==l.start||(h=ni(l,i),C=si(l,i),oi(l,v),ri(l,h,i),ai(l,C,i)),b=l.finish,h=0;h<y.length;h++){C=y[h].value,(E=yi(m,S=y[h].key))<0?m.push({key:S,value:w=[]}):w=m[E].value;for(var T,x,D,k=[{key:C,value:b}],E=0;E<w.length;E++){S=w[E].key;var I=w[E].value;I>v&&(D=I<b?I:b,(T=yi(k,x=S+C))<0?k.push({key:x,value:D}):D>k[x]&&(k[T].value=D),k.push(I<b?{key:S+C,value:I}:{key:S+C,value:b}))}for(C=0;C<k.length;C++)D=k[C].value,(T=yi(w,x=k[C].key))<0?w.push({key:x,value:D}):D>w[T].value&&(w[T].value=D)}f.push(l)}}for(d=0;d<f.length;d++)c.splice(c.indexOf(f[d]),1);if(c.length==g)break;g=c.length}for(d=0;d<p.length;d++)at(l=p[d],"start",!0,!0),at(l,"finish",!0,!0),at(l,"completedFinish",!0,!0),Ue(l)}return r},e.getItemSuccessors=function(e){return Ut(e,t)},e.getItemSuccessorPredecessorItems=function(e){return jt(e,t)},e.getItemAllocationUnits=wt,e.getItemAssignments=hi,e.getItemAssignedResources=ci,e.getResourceAssignments=function(e){return ui(e,t)},e.getResourceAssignedItems=function(e){for(var i=[],n=(e=ui(e,t),0);n<e.length;n++)i.push(e[n].key);return i},e.getAssignedResources=function(){return pi(t)},e.getItemAssignmentsCost=function(e){return qt(e,i)},e.getItemExtraCost=function(e){return $t(e,i)},e.getItemCost=function(e){return Kt(e,i)},e.setItemCost=function(e,t){e.executionCost=t-$t(e,i),at(e,"executionCost",!0,!0)},e.getResourceCost=function(e){for(var n=0,s=(e=ui(e,t),0);s<e.length;s++){var r,a=e[s];void 0!==i.specificResourceUsageCosts&&(r=yi(i.specificResourceUsageCosts,resource))>=0?n+=i.specificResourceUsageCosts[r].value*a.value:void 0!==i.defaultResourceUsageCost&&(n+=i.defaultResourceUsageCost*a.value);var o=a.key;o.hasChildren&&(void 0===o.isSummaryEnabled||o.isSummaryEnabled)||(o=ni(o,i)/36e5,void 0!==i.specificResourceHourCosts&&(r=yi(i.specificResourceHourCosts,resource))>=0?n+=i.specificResourceHourCosts[r].value*o*a.value:void 0!==i.defaultResourceHourCost&&(n+=i.defaultResourceHourCost*o*a.value))}return n},e.getProjectCost=function(){for(var e=0,n=0;n<t.length;n++){var s=t[n];null==s.parent&&(e+=Kt(s,i))}return e},e.getScheduleChartItems=function(e){var n,s,r=[],a=(e=void 0!==e?"array"==typeof e?e:[e]:void 0!==i.assignableResources?i.assignableResources:[],pi(t));for(s=0;s<a.length;s++)e.indexOf(n=a[s])<0&&e.push(n);for(s=0;s<e.length;s++){a={tag:n=e[s],content:n,ganttChartItems:[]},n=ui(n,t);for(var o=0;o<n.length;o++){var l=(d=n[o]).key,d={tag:l,content:l.content,start:l.start,finish:l.finish,completedFinish:l.completedFinish,isMilestone:l.isMilestone,schedule:Dt(l),assignmentsContent:1!=d.value?Math.round(1e4*d.value)/100+"%":"",minStart:l.minStart,maxStart:l.maxStart,minFinish:l.minFinish,maxFinish:l.maxFinish,isHidden:l.isHidden,isBarVisible:l.isBarVisible,isBarReadOnly:l.isBarReadOnly,isReadOnly:l.isReadOnly,isRelativeToTimezone:l.isRelativeToTimezone};a.ganttChartItems.push(d)}r.push(a)}return r},e.getAllocations=function(e){return mi(e,t)},e.getLoadChartItems=function(e){var n=[];void 0===e?e=pi(t):"array"!=typeof e&&(e=[e]);for(var s=0;s<e.length;s++){for(var r=e[s],a={tag:r,content:r,ganttChartItems:[]},o=mi(r,t),l=0;l<o.length;l++){var d=o[l],h=1;if(void 0!==i.resourceQuantities){var c=yi(i.resourceQuantities,r);c>=0&&(h=i.resourceQuantities[c].value)}void 0===(c=i.maxLoadChartDisplayedResourceQuantity)&&(c=100),h>c&&(h=c),a.ganttChartItems.push({start:d.key.start,finish:d.key.finish,units:d.value/h,content:Math.round(1e4*d.value)/100+"%",isRelativeToTimezone:!1})}n.push(a)}return n},e.getFilteredGanttChartItems=function(e){e=[e];for(var i=[],n=0;n<e.length;n++){var s=e[n],r=[];if(void 0===e)e=pi(t);else if("array"!=typeof e)var a=ui(s,t);for(s=0;s<a.length;s++){var o=a[s].key;o.hasChildren&&(void 0===o.isSummaryEnabled||o.isSummaryEnabled)||i.indexOf(o)>=0||(r.push({tag:o,content:o.content,start:o.start,finish:o.finish,completedFinish:o.completedFinish,isMilestone:o.isMilestone,assignmentsContent:e.length>1?o.assignmentsContent:1!=a[s].value?Math.round(1e4*a[s].value)/100+"%":"",minStart:o.minStart,maxStart:o.maxStart,minFinish:o.minFinish,maxFinish:o.maxFinish,isHidden:o.isHidden,isBarVisible:o.isBarVisible,isBarReadOnly:o.isBarReadOnly,isReadOnly:!0,isRelativeToTimezone:o.isRelativeToTimezone}),i.push(o))}}return r},e.copyCommonSettings=function(e){void 0!==e&&(e.target=i.target,e.theme=i.theme,e.border=i.border,e.containerClass=i.containerClass,e.containerStyle=i.containerStyle,e.isGridVisible=i.isGridVisible,e.gridWidth=i.gridWidth,e.chartWidth=i.chartWidth,e.isSplitterEnabled=i.isSplitterEnabled,e.splitterWidth=i.splitterWidth,e.splitterBackground=i.splitterBackground,e.minGridWidth=i.minGridWidth,e.minChartWidth=i.minChartWidth,e.headerBackground=i.headerBackground,e.headerHeight=i.headerHeight,e.indentationLevelWidth=i.indentationLevelWidth,e.gridLines=i.gridLines,e.horizontalGridLines=i.horizontalGridLines,e.verticalGridLines=i.verticalGridLines,e.horizontalChartLines=i.horizontalChartLines,e.displayedTime=i.displayedTime,e.currentTime=i.currentTime,e.timelineStart=i.timelineStart,e.timelineFinish=i.timelineFinish,e.scales=i.scales,e.updateScale=i.updateScale,e.hourWidth=i.hourWidth,e.workingWeekStart=i.workingWeekStart,e.workingWeekFinish=i.workingWeekFinish,e.visibleDayStart=i.visibleDayStart,e.visibleDayFinish=i.visibleDayFinish,e.visibleWeekStart=i.visibleWeekStart,e.visibleWeekFinish=i.visibleWeekFinish,e.specialNonworkingDays=i.specialNonworkingDays,e.months=i.months,e.daysOfWeek=i.daysOfWeek,e.weekStartDay=i.weekStartDay,e.dateFormatter=i.dateFormatter,e.dateTimeFormatter=i.dateTimeFormatter,e.dateTimeParser=i.dateTimeParser,e.isRelativeToTimezone=i.isRelativeToTimezone)},e.getPertChartItems=function(e,n,s,r,a,o){var l=e,d=n,h=s,c=a;s=o,(void 0===l||l<0)&&(l=Number.MAX_VALUE),void 0===d&&(d="Start"),void 0===h&&(h="Finish"),void 0===c&&(c=" completed"),void 0===s&&(s=" starting");var u,p,m,g,f,v=new Date(new Date(1e4,0,1).valueOf()-1);for(o=[],a=[],e=0;e<t.length;e++)(n=t[e]).indentation<=l&&(!n.hasChildren||void 0!==n.isSummaryEnabled&&!n.isSummaryEnabled&&(void 0===n.isBarVisible||n.isBarVisible)||n.indentation==l)&&a.push({key:n,value:[]});for(e=0;e<a.length;e++){var y=[n=a[e].key];if(n.indentation==l&&n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled||void 0!==n.isBarVisible&&!n.isBarVisible))for(u=0;u<t.length;u++)fi(p=t[u],n)&&y.push(p);for(g=a[e].value,u=0;u<y.length;u++)for(var C=y[u];null!=C;){if(void 0!==C.predecessors)for(m=0;m<C.predecessors.length;m++)if(void 0!==C.predecessors[m].item&&(void 0===C.predecessors[m].dependencyType||""==C.predecessors[m].dependencyType||"FinishStart"==C.predecessors[m].dependencyType||"FS"==C.predecessors[m].dependencyType)){for(p=f=C.predecessors[m].item;null!=p&&yi(a,p)<0;)p=p.parent;if(p!=n){var b=[];if(null!=p)b.push(p);else for(var S=0;S<a.length;S++)fi(p=a[S].key,f)&&b.push(p);for(f=0;f<b.length;f++)g.indexOf(p=b[f])<0&&g.push(p)}}C=C.parent}}for(l=0,m=u=null,e=0;e<t.length;e++)n=t[e],(null==u||n.start<u)&&(u=n.start),(null==m||n.finish>m)&&(m=n.finish);for(null==u&&(u=v),d={content:d,displayedText:(l++).toString(),displayedRowIndex:0,displayedColumnIndex:0},o.push(d),y=[d],v=[],e=0;e<a.length;e++)0==a[e].value.length&&v.push(a[e].key);if(v.length>0){for(y=[],e=0;e<v.length;e++)n=v[e],m=d,g=(l++).toString(),n.start>u&&(m={content:null!=n.content?n.content.toString()+s:null,displayedText:g,predecessors:[]},o.push(m),m.predecessors.push({item:d,content:r,isEffortVirtual:!0})),y.push(g={content:n.content+c,displayedText:g+(m!=d?"'":""),predecessors:[],tag:n}),o.push(g),g.predecessors.push({item:m,content:gi(n),displayedText:null!=n.content?n.content.toString():null,effort:vt(n.start,n.finish,i,Dt(n)),tag:n});do{for(C=[],e=0;e<y.length;e++)C.push(y[e]);for(n=!1,e=0;e<y.length;e++){for(g=(v=y[e]).tag,b=[],u=0;u<a.length;u++)a[u].value.indexOf(g)>=0&&b.push(a[u].key);if(b.length>0){for(C.splice(C.indexOf(v),1),u=0;u<b.length;u++){for(n=b[u],g=null,m=0;m<o.length;m++)if(o[m].tag==n){g=o[m];break}null==g&&(g={content:n.content+c,displayedText:(l++).toString(),predecessors:[],tag:n},C.push(g),o.push(g)),g.predecessors.push({item:v,content:gi(n),displayedText:null!=n.content?n.content.toString():null,effort:vt(n.start,n.finish,i,Dt(n)),tag:n})}n=!0}}y=C}while(n)}for(n={content:h,displayedText:(l++).toString(),predecessors:[],displayedRowIndex:0},o.push(n),n=n.predecessors,e=0;e<y.length;e++)n.push({item:y[e]});for(u=0;u<a.length;u++){for(n=a[u].key,v=null,m=0;m<o.length;m++)if(o[m].tag==n){v=o[m];break}if(null!=v){if(e=[],void 0!==v.predecessors)for(m=0;m<v.predecessors.length;m++)v.predecessors[m].tag==n&&e.push(v.predecessors[m]);if(e.length>1){for(c={content:null!=n.content?n.content.toString()+s:null,displayedText:v.displayedText,predecessors:[]},o.splice(o.indexOf(v),0,c),l=c.predecessors,m=0;m<e.length;m++)v.predecessors.splice(v.predecessors.indexOf(h=e[m]),1),l.push({item:h.item,content:r,isEffortVirtual:!0});v.predecessors.push({item:c,content:gi(n),displayedText:null!=n.content?n.content.toString():null,effort:vt(n.start,n.finish,i,Dt(n)),tag:n}),v.displayedText=v.displayedText+"'"}else 1==e.length&&null!=(e=(h=e[0]).item.tag)&&n.start>gt(e.finish,i)&&(m={content:null!=n.content?n.content.toString()+s:null,displayedText:v.displayedText,predecessors:[]},o.splice(o.indexOf(v),0,m),m.predecessors.push({item:h.item,content:r,isEffortVirtual:!0}),v.predecessors.splice(0,v.predecessors.length),v.predecessors.push({item:m,content:gi(n),displayedText:null!=n.content?n.content.toString():null,effort:vt(n.start,n.finish,i,Dt(n)),tag:n}),v.displayedText=v.displayedText+"'")}}for(e=0;e<a.length;e++)if(a[e].key.isMilestone){for(n=a[e].key,v=null,m=0;m<o.length;m++)if(o[m].tag==n){v=o[m];break}if(null!=v&&void 0!==v.predecessors&&1==v.predecessors.length&&(h=v.predecessors[0]).item!=d&&h.tag==n){for(v.predecessors.splice(0,1),g=h.item,m=0;m<g.predecessors.length;m++)h.item.predecessors.splice(h.item.predecessors.indexOf(r=g.predecessors[m]),1),v.predecessors.push(r);v.content=null!=n.content?n.content.toString():null,v.displayedText=v.displayedText.replace("'",""),o.splice(o.indexOf(g),1)}}return o},e.getNetworkDiagramItems=function(e,n,s){var r=e,a=n,o=s;(void 0===r||r<0)&&(r=Number.MAX_VALUE),void 0===a&&(a="Start"),void 0===o&&(o="Finish"),s=new Date(1900,0,1),n=new Date(new Date(1e4,0,1).valueOf()-1),e=[];var l,d,h,c,u,p,m,g,f=[];for(l=0;l<t.length;l++)(d=t[l]).indentation<=r&&(!d.hasChildren||void 0!==d.isSummaryEnabled&&!d.isSummaryEnabled&&(void 0===d.isBarVisible||d.isBarVisible)||d.indentation==r)&&f.push({key:d,value:[]});for(l=0;l<f.length;l++){if(p=[d=f[l].key],d.indentation==r&&d.hasChildren&&(void 0===d.isSummaryEnabled||d.isSummaryEnabled||void 0!==d.isBarVisible&&!d.isBarVisible))for(h=0;h<t.length;h++)fi(c=t[h],d)&&p.push(c);for(m=f[l].value,h=0;h<p.length;h++)for(var v=p[h];null!=v;){if(void 0!==v.predecessors)for(u=0;u<v.predecessors.length;u++)if(void 0!==v.predecessors[u].item&&(void 0===v.predecessors[u].dependencyType||""==v.predecessors[u].dependencyType||"FinishStart"==v.predecessors[u].dependencyType||"FS"==v.predecessors[u].dependencyType)){for(c=g=v.predecessors[u].item;null!=c&&yi(f,c)<0;)c=c.parent;if(c!=d){var y=[];if(null!=c)y.push(c);else for(var C=0;C<f.length;C++)fi(c=f[C].key,g)&&y.push(c);for(g=0;g<y.length;g++)m.indexOf(c=y[g])<0&&m.push(c)}}v=v.parent}}for(g=h=null,l=0;l<t.length;l++)d=t[l],(null==h||d.start<h)&&(h=d.start),(null==g||d.finish>g)&&(g=d.finish);for(null==h&&(h=n),null==g&&(g=s),e.push(a={content:a,displayedText:a,earlyStart:h,earlyFinish:h,lateStart:n,lateFinish:n,isMilestone:!0,effort:0,displayedRowIndex:0,displayedColumnIndex:0}),r=[a],h=[],l=0;l<f.length;l++)0==f[l].value.length&&h.push(f[l].key);if(h.length>0){for(r=[],l=0;l<h.length;l++)u={content:gi(d=h[l]),displayedText:d.content,earlyStart:s,earlyFinish:s,lateStart:n,lateFinish:n,effort:vt(d.start,d.finish,i,Dt(d)),isMilestone:d.isMilestone,predecessors:[],tag:d},r.push(u),e.push(u),u.earlyStart=gt(a.earlyFinish,i),u.earlyFinish=yt(u.earlyStart,u.effort,i),u.predecessors.push({item:a,tag:d});do{for(v=[],l=0;l<r.length;l++)v.push(r[l]);for(u=!1,l=0;l<r.length;l++){for(d=(p=r[l]).tag,y=[],h=0;h<f.length;h++)f[h].value.indexOf(d)>=0&&y.push(f[h].key);if(y.length>0){for(v.splice(v.indexOf(p),1),h=0;h<y.length;h++){for(d=y[h],m=null,u=0;u<e.length;u++)if(e[u].tag==d){m=e[u];break}null==m&&(m={content:gi(d),displayedText:d.content,earlyStart:s,earlyFinish:s,lateStart:n,lateFinish:n,effort:vt(d.start,d.finish,i,Dt(d)),isMilestone:d.isMilestone,predecessors:[],tag:d},v.push(m),e.push(m)),(u=gt(p.earlyFinish,i))>m.earlyStart&&(m.earlyStart=u,m.earlyFinish=yt(m.earlyStart,m.effort,i)),m.predecessors.push({item:p,tag:d})}u=!0}}r=v}while(u)}for(e.push(o={content:o,displayedText:o,earlyStart:s,earlyFinish:s,lateStart:g,lateFinish:g,isMilestone:!0,effort:0,predecessors:[],displayedRowIndex:0}),h=o.predecessors,l=0;l<r.length;l++)(u=(f=r[l]).earlyFinish)>o.earlyStart&&(o.earlyStart=u,o.earlyFinish=o.earlyStart),h.push({item:f});for(r=[o];r.length>0;){for(f=[],l=0;l<r.length;l++)if(void 0!==(p=r[l]).predecessors)for(h=0;h<p.predecessors.length;h++)f.push(m=(g=p.predecessors[h]).item),(d=p.lateStart)<m.lateFinish&&(m.lateFinish=m.effort>0?ft(d,i,!1,!0,void 0):d,m.lateStart=Ct(m.effort,m.lateFinish,i));r=f}if(e.length>2)for(l=0;l<e.length;l++)(d=e[l]).slack=vt(d.earlyStart,d.lateStart,i);else a.earlyStart=s,a.earlyFinish=s,a.lateStart=s,a.lateFinish=s,o.earlyStart=n,o.earlyFinish=n,o.lateStart=n,o.lateFinish=n;for(l=0;l<e.length;l++)e[l].isRelativeToTimezone=!1;return e},e.getOutputDate=Ci,e.getInputDate=bi,e.itemDependsOf=function(e,t){return ht(e,t)}};return{initialize:r,initializeItems:d,refresh:a,getDefaultColumns:b,getDefaultCollapsedToggleButtonTemplate:Ie,getDefaultExpandedToggleButtonTemplate:Ae,getDefaultScales:re,getDefaultStyleDefinitionTemplate:Je,getDefaultStandardTaskTemplate:et,getDefaultSummaryTaskTemplate:tt,getDefaultMilestoneTaskTemplate:it,getDefaultItemTemplate:qe,getDefaultAssignmentsTemplate:$e,getDefaultDependencyLineTemplate:nt,getDefaultPredecessorItemTemplate:st,initializeTaskDraggingThumbs:function(e,t,i,n,s,r,a,o){s.ganttChartView.initializeTaskDraggingThumbs(e,t,i,n,s,r,a,o)},initializeDependencyDraggingThumb:function(e,t,i,n,s){i.ganttChartView.initializeDependencyDraggingThumb(e,t,i,n,s)},getWorkingTime:mt,getEffort:vt,getFinish:yt,getStart:Ct,getCompletion:bt,getCompletedFinish:St,getWeekStart:function(e,t){return ee(e,t)},getWeekFinish:te,defaultDateTimeFormatter:function(e){return g(f(e))},defaultDateFormatter:function(e){return m(f(e))},defaultDateTimeParser:function(e){return y(v(e))},textColumnTemplateBase:function(e,t,i){return(void 0===(t=t())||void 0!==i&&!i())&&(t=""),e.createTextNode(t)},textInputColumnTemplateBase:function(e,t,i,n,s,r,a){var o=e.createElement("input");return o.setAttribute("type","text"),void 0===(e=i())&&(e=""),o.setAttribute("value",e),e="",void 0!==r&&!r()&&(e="; display: none"),r="",void 0!==a&&a()&&(r="; font-weight: bold"),o.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"+e+r),void 0!==s&&!s()&&o.setAttribute("disabled","true"),o.addEventListener("change",(function(){n(o.value)}),!0),o.addEventListener("keypress",(function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),n(o.value))}),!0),o.addEventListener("focus",(function(){o.style.backgroundColor="White"}),!0),o.addEventListener("blur",(function(){o.style.backgroundColor="Transparent"}),!0),o},optionSelectColumnTemplateBase:function(e,t,i,n,s,r,a,o){var l=e.createElement("select"),d=function(t,i){var n=e.createElement("option");n.appendChild(e.createTextNode(t)),t==i&&n.setAttribute("selected",!0),l.appendChild(n)};void 0===(n=n())&&(n=""),d("",n),i=i();for(var h=0;h<i.length;h++)d(i[h],n);return d="",void 0!==a&&!a()&&(d="; display: none"),a="",void 0!==o&&o()&&(a="; font-weight: bold"),l.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"+d+a),void 0!==r&&!r()&&l.setAttribute("disabled","true"),l.addEventListener("change",(function(){s(l.value)}),!0),l.addEventListener("keypress",(function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),s(l.value))}),!0),l.addEventListener("focus",(function(){l.style.backgroundColor="White"}),!0),l.addEventListener("blur",(function(){l.style.backgroundColor="Transparent"}),!0),l},numberInputColumnTemplateBase:function(e,t,i,n,s,r,a){return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(e,t,(function(){var e=i();return isNaN(e)?"":e}),(function(e){e=parseFloat(e),isNaN(e)&&(e=0),n(e)}),s,r,a)},percentInputColumnTemplateBase:function(e,t,i,n,s,r,a){return DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(e,t,i,(function(e){e<0&&(e=0),e>100&&(e=100),n(e)}),s,r,a)},timeSpanInputColumnTemplateBase:function(e,t,i,n,s,r,a,o){return void 0===s&&(s=1),DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(e,t,(function(){var e=i()/(36e5*s);return Math.round(100*e)/100}),(function(e){(e=parseFloat(e))<0&&(e=0),n(36e5*e*s)}),r,a,o)},datePickerInputColumnTemplateBase:function(e,t,i,n,s,r,a,o,l,d,h,c,u){h||(h=["Su","Mo","Tu","We","Th","Fr","Sa"]);var p=c,m=u;c||(c=DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter),u||(u=DlhSoft.Controls.GanttChartView.defaultDateTimeParser);var g=e.createElement("input");g.setAttribute("type","text"),void 0===(i=i())?i="":null!=i&&(i=c(i)),g.setAttribute("value",i),DlhSoft.Controls.DatePicker&&g.addEventListener("focus",(function(){var t=DlhSoft.Controls.DatePicker.get(g);if(!t||!t.isOpen){var i=0,n=0;try{i=g.selectionStart,n=g.selectionEnd}catch(s){}(t=DlhSoft.Controls.DatePicker.initialize(g,void 0,{inputStyle:null,defaultTimeOfDay:o,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid #e0e0e0",calendarSelectorLevels:l,months:d,daysOfWeek:O(h),dateTimeFormatter:p,dateTimeParser:m},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout((function(){try{g.selectionStart=i,g.selectionEnd=n}catch(e){}}),100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout((function(){try{g.focus()}catch(e){}}),100):e.createEvent&&setTimeout((function(){var t=e.createEvent("MouseEvents");t.initEvent("blur",!0,!1),g.dispatchEvent(t)}))}}),!0),c="",void 0!==r&&!r()&&(c="; display: none"),r="",void 0!==a&&a()&&(r="; font-weight: bold"),g.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"+c+r),void 0!==s&&!s()&&g.setAttribute("disabled","true");var f=function(){var e=""!=(e=g.value)?u(e):null;n(e)};return g.addEventListener("change",(function(){f()}),!0),g.addEventListener("keypress",(function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),f())}),!0),g.addEventListener("focus",(function(){g.style.backgroundColor="White"}),!0),g.addEventListener("blur",(function(){g.style.backgroundColor="Transparent"}),!0),g},dateTimePickerInputColumnTemplateBase:function(e,t,i,n,s,r,a,o,l,d,h,c,u){h||(h=["Su","Mo","Tu","We","Th","Fr","Sa"]);var p=c,m=u;c||(c=DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter),u||(u=DlhSoft.Controls.GanttChartView.defaultDateTimeParser);var g=e.createElement("input");g.setAttribute("type","text"),void 0===(i=i())?i="":null!=i&&(i=c(i)),g.setAttribute("value",i),(DlhSoft.Controls.DateTimePicker||DlhSoft.Controls.DatePicker)&&g.addEventListener("focus",(function(){var t=(DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).get(g);if(!t||!t.isOpen){var i=0,n=0;try{i=g.selectionStart,n=g.selectionEnd}catch(s){}(t=(DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).initialize(g,void 0,{inputStyle:null,defaultTimeOfDay:o,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid #e0e0e0",calendarSelectorLevels:l,months:d,daysOfWeek:O(h),dateTimeFormatter:p,dateTimeParser:m},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout((function(){try{g.selectionStart=i,g.selectionEnd=n}catch(e){}}),100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout((function(){try{g.focus()}catch(e){}}),100):e.createEvent&&setTimeout((function(){var t=e.createEvent("MouseEvents");t.initEvent("blur",!0,!1),g.dispatchEvent(t)}))}}),!0),c="",void 0!==r&&!r()&&(c="; display: none"),r="",void 0!==a&&a()&&(r="; font-weight: bold"),g.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"+c+r),void 0!==s&&!s()&&g.setAttribute("disabled","true");var f=function(){var e=""!=(e=g.value)?u(e):null;n(e)};return g.addEventListener("change",(function(){f()}),!0),g.addEventListener("keypress",(function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),f())}),!0),g.addEventListener("focus",(function(){g.style.backgroundColor="White"}),!0),g.addEventListener("blur",(function(){g.style.backgroundColor="Transparent"}),!0),g},multiSelectorComboBoxInputColumnTemplateBase:function(e,t,i,n,s,r,a,o){var l=e.createElement("input");return l.setAttribute("type","text"),void 0===(n=n())&&(n=""),l.setAttribute("value",n),DlhSoft.Controls.MultiSelectorComboBox&&l.addEventListener("focus",(function(){if(!(t=DlhSoft.Controls.MultiSelectorComboBox.get(l))||!t.isOpen&&t.availableChoices.length>0){var t=i(),n=0,s=0;try{n=l.selectionStart,s=l.selectionEnd}catch(r){}(t=DlhSoft.Controls.MultiSelectorComboBox.initialize(l,t,void 0,{inputStyle:null,autoAppendAvailableChoices:!1,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid #e0e0e0; color: Black; font-size: small; max-height: 188px; overflow-y: auto"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout((function(){try{l.selectionStart=n,l.selectionEnd=s}catch(e){}}),100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout((function(){try{l.focus()}catch(e){}}),100):e.createEvent&&setTimeout((function(){var t=e.createEvent("MouseEvents");t.initEvent("blur",!0,!1),l.dispatchEvent(t)}))}}),!0),n="",void 0!==a&&!a()&&(n="; display: none"),a="",void 0!==o&&o()&&(a="; font-weight: bold"),l.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"+n+a),void 0!==r&&!r()&&l.setAttribute("disabled","true"),l.addEventListener("change",(function(){s(l.value)}),!0),l.addEventListener("keypress",(function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),s(l.value))}),!0),l.addEventListener("focus",(function(){l.style.backgroundColor="White"}),!0),l.addEventListener("blur",(function(){l.style.backgroundColor="Transparent"}),!0),l},dateTimeInputColumnTemplateBase:function(e,t,i,n,s,r,a){return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(e,t,(function(){var e=i();return null!=e?DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter(e):""}),(function(e){e=""!=e?DlhSoft.Controls.GanttChartView.defaultDateTimeParser(e):null,n(e)}),s,r,a)},getIndexColumnTemplate:function(){return function(e){var t=e.ganttChartView;return DlhSoft.Controls.GanttChartView.textColumnTemplateBase(t.ownerDocument,(function(){return t.getItemIndexString(e)}))}},getWbsColumnTemplate:function(e){return function(t){var i=t.ganttChartView;return DlhSoft.Controls.GanttChartView.textColumnTemplateBase(i.ownerDocument,(function(){return i.getItemWbsIndexString(t,e)}))}},getEffortColumnTemplate:function(e,t,i){return void 0===t&&(t=1),function(n){var s=n.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(s.ownerDocument,e,(function(){return s.getItemEffort(n)}),(function(e){s.setItemEffort(n,e),s.refreshItemPath(n)}),t,(function(){return!(n.isReadOnly||i||void 0!==n.ganttChartView&&void 0!==n.ganttChartView.settings&&(n.ganttChartView.settings.isReadOnly||n.ganttChartView.settings.isGridReadOnly)||n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled))}),(function(){return!(n.isMilestone||void 0!==n.isBarVisible&&!n.isBarVisible)}),(function(){return n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled)}))}},getDurationColumnTemplate:function(e,t,i){return void 0===t&&(t=1),function(n){var s=n.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(s.ownerDocument,e,(function(){return s.getItemDuration(n)}),(function(e){s.setItemDuration(n,e),s.refreshItemPath(n)}),t,(function(){return!(n.isReadOnly||i||void 0!==n.ganttChartView&&void 0!==n.ganttChartView.settings&&(n.ganttChartView.settings.isReadOnly||n.ganttChartView.settings.isGridReadOnly)||n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled))}),(function(){return!(n.isMilestone||void 0!==n.isBarVisible&&!n.isBarVisible)}),(function(){return n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled)}))}},getTotalEffortColumnTemplate:function(e,t,i){return void 0===t&&(t=1),function(n){var s=n.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(s.ownerDocument,e,(function(){return s.getItemTotalEffort(n)}),(function(e){s.setItemTotalEffort(n,e),s.refreshItemPath(n)}),t,(function(){return!(n.isReadOnly||i||void 0!==n.ganttChartView&&void 0!==n.ganttChartView.settings&&(n.ganttChartView.settings.isReadOnly||n.ganttChartView.settings.isGridReadOnly)||n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled))}),(function(){return!(n.isMilestone||void 0!==n.isBarVisible&&!n.isBarVisible)}),(function(){return n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled)}))}},getCompletedEffortColumnTemplate:function(e,t,i){return void 0===t&&(t=1),function(n){var s=n.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(s.ownerDocument,e,(function(){return s.getItemCompletedEffort(n)}),(function(e){s.setItemCompletedEffort(n,e),s.refreshItemPath(n)}),t,(function(){return!(n.isReadOnly||i||void 0!==n.ganttChartView&&void 0!==n.ganttChartView.settings&&(n.ganttChartView.settings.isReadOnly||n.ganttChartView.settings.isGridReadOnly)||n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled))}),(function(){return!(n.isMilestone||void 0!==n.isBarVisible&&!n.isBarVisible)}),(function(){return n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled)}))}},getTotalCompletedEffortColumnTemplate:function(e,t,i){return void 0===t&&(t=1),function(n){var s=n.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(s.ownerDocument,e,(function(){return s.getItemTotalCompletedEffort(n)}),(function(e){s.setItemTotalCompletedEffort(n,e),s.refreshItemPath(n)}),t,(function(){return!(n.isReadOnly||i||void 0!==n.ganttChartView&&void 0!==n.ganttChartView.settings&&(n.ganttChartView.settings.isReadOnly||n.ganttChartView.settings.isGridReadOnly)||n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled))}),(function(){return!(n.isMilestone||void 0!==n.isBarVisible&&!n.isBarVisible)}),(function(){return n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled)}))}},getCompletionColumnTemplate:function(e,t){return function(i){var n=i.ganttChartView;return DlhSoft.Controls.GanttChartView.percentInputColumnTemplateBase(n.ownerDocument,e,(function(){var e=100*n.getItemCompletion(i);return Math.round(100*e)/100}),(function(e){if(void 0!==i.gridItem&&void 0!==i.completedInput){var t=i.completedInput;void 0!==t.changeEventListener&&t.removeEventListener("change",t.changeEventListener,!0),delete i.completedInput}e=parseFloat(e)/100,n.setItemCompletion(i,e),n.refreshItemPath(i)}),(function(){return!(i.isReadOnly||t||void 0!==i.ganttChartView&&void 0!==i.ganttChartView.settings&&(i.ganttChartView.settings.isReadOnly||i.ganttChartView.settings.isGridReadOnly)||i.hasChildren&&(void 0===i.isSummaryEnabled||i.isSummaryEnabled))}),(function(){return!(i.isMilestone||void 0!==i.isBarVisible&&!i.isBarVisible)}),(function(){return i.hasChildren&&(void 0===i.isSummaryEnabled||i.isSummaryEnabled)}))}},getCostColumnTemplate:function(e,t){return function(i){var n=i.ganttChartView;return DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(n.ownerDocument,e,(function(){return n.getItemCost(i)}),(function(e){n.setItemCost(i,e),n.refreshItemPath(i)}),(function(){return!(i.isReadOnly||t||void 0!==i.ganttChartView&&void 0!==i.ganttChartView.settings&&(i.ganttChartView.settings.isReadOnly||i.ganttChartView.settings.isGridReadOnly))}),void 0,(function(){return i.hasChildren&&(void 0===i.isSummaryEnabled||i.isSummaryEnabled)}))}},getPredecessorsColumnTemplate:function(e,t,i){return function(n){var s=n.ganttChartView;return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(s.ownerDocument,e,(function(){return s.getItemPredecessorsString(n,i)}),(function(e){s.setItemPredecessorsString(n,e,i),s.refreshItemGraph(n)}),(function(){return!(n.isReadOnly||t||void 0!==n.ganttChartView&&void 0!==n.ganttChartView.settings&&(n.ganttChartView.settings.isReadOnly||n.ganttChartView.settings.isGridReadOnly))}),(function(){return!(void 0!==n.isBarVisible&&!n.isBarVisible)}),(function(){return n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled)}))}},getAssignmentSelectorColumnTemplate:function(e,t,i){return function(n){var s=n.ganttChartView;return DlhSoft.Controls.GanttChartView.optionSelectColumnTemplateBase(s.ownerDocument,e,(function(){return"array"==typeof t?t:t(n)}),(function(){return n.assignmentsContent}),(function(e){n.assignmentsContent=e,s.onItemPropertyChanged(n,"assignmentsContent",!0,!0),s.refreshItem(n)}),(function(){return!(n.isReadOnly||i||void 0!==n.ganttChartView&&void 0!==n.ganttChartView.settings&&(n.ganttChartView.settings.isReadOnly||n.ganttChartView.settings.isGridReadOnly))}),(function(){return!(void 0!==n.isBarVisible&&!n.isBarVisible)}),(function(){return n.hasChildren&&(void 0===n.isSummaryEnabled||n.isSummaryEnabled)}))}},getBaselineStartColumnTemplate:function(e,t,i,n,s,r,a,o){return void 0===t&&(t=!0),void 0===i&&(i=!0),function(l){var d=l.ganttChartView;return(t?i?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(d.ownerDocument,e,(function(){return l.baselineStart}),(function(e){null!=e?l.baselineStart=e:delete l.baselineStart,d.onItemPropertyChanged(l,"baselineStart",!0,!0),d.refreshItem(l)}),(function(){return!(l.isReadOnly||o||void 0!==l.ganttChartView&&void 0!==l.ganttChartView.settings&&(l.ganttChartView.settings.isReadOnly||l.ganttChartView.settings.isGridReadOnly))}),(function(){return!(void 0!==l.isBarVisible&&!l.isBarVisible)}),(function(){return l.hasChildren&&(void 0===l.isSummaryEnabled||l.isSummaryEnabled)}),n,s,r,a)}},getBaselineFinishColumnTemplate:function(e,t,i,n,s,r,a,o){return void 0===t&&(t=!0),void 0===i&&(i=!0),function(l){var d=l.ganttChartView;return(t?i?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(d.ownerDocument,e,(function(){return l.baselineFinish}),(function(e){null!=e?l.baselineFinish=e:delete l.baselineFinish,d.onItemPropertyChanged(l,"baselineFinish",!0,!0),d.refreshItem(l)}),(function(){return!(l.isReadOnly||o||void 0!==l.ganttChartView&&void 0!==l.ganttChartView.settings&&(l.ganttChartView.settings.isReadOnly||l.ganttChartView.settings.isGridReadOnly))}),(function(){return!(l.isMilestone||void 0!==l.isBarVisible&&!l.isBarVisible)}),(function(){return l.hasChildren&&(void 0===l.isSummaryEnabled||l.isSummaryEnabled)}),n||864e5,s,r,a)}},getMinStartColumnTemplate:function(e,t,i,n,s,r,a,o){return void 0===t&&(t=!0),void 0===i&&(i=!0),function(l){var d=l.ganttChartView;return(t?i?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(d.ownerDocument,e,(function(){return l.minStart}),(function(e){null!=e?l.minStart=e:delete l.minStart,d.onItemPropertyChanged(l,"minStart",!0,!0),d.refreshItem(l)}),(function(){return!(l.isReadOnly||o||void 0!==l.ganttChartView&&void 0!==l.ganttChartView.settings&&(l.ganttChartView.settings.isReadOnly||l.ganttChartView.settings.isGridReadOnly)||l.hasChildren&&(void 0===l.isSummaryEnabled||l.isSummaryEnabled))}),(function(){return!(void 0!==l.isBarVisible&&!l.isBarVisible)}),(function(){return l.hasChildren&&(void 0===l.isSummaryEnabled||l.isSummaryEnabled)}),n,s,r,a)}},getMaxStartColumnTemplate:function(e,t,i,n,s,r,a,o){return void 0===t&&(t=!0),void 0===i&&(i=!0),function(l){var d=l.ganttChartView;return(t?i?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(d.ownerDocument,e,(function(){return l.maxStart}),(function(e){null!=e?l.maxStart=e:delete l.maxStart,d.onItemPropertyChanged(l,"maxStart",!0,!0),d.refreshItem(l)}),(function(){return!(l.isReadOnly||o||void 0!==l.ganttChartView&&void 0!==l.ganttChartView.settings&&(l.ganttChartView.settings.isReadOnly||l.ganttChartView.settings.isGridReadOnly)||l.hasChildren&&(void 0===l.isSummaryEnabled||l.isSummaryEnabled))}),(function(){return!(void 0!==l.isBarVisible&&!l.isBarVisible)}),(function(){return l.hasChildren&&(void 0===l.isSummaryEnabled||l.isSummaryEnabled)}),n||864e5,s,r,a)}},getMinFinishColumnTemplate:function(e,t,i,n,s,r,a,o){return void 0===t&&(t=!0),void 0===i&&(i=!0),function(l){var d=l.ganttChartView;return(t?i?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(d.ownerDocument,e,(function(){return l.minFinish}),(function(e){null!=e?l.minFinish=e:delete l.minFinish,d.onItemPropertyChanged(l,"minFinish",!0,!0),d.refreshItem(l)}),(function(){return!(l.isReadOnly||o||void 0!==l.ganttChartView&&void 0!==l.ganttChartView.settings&&(l.ganttChartView.settings.isReadOnly||l.ganttChartView.settings.isGridReadOnly)||l.hasChildren&&(void 0===l.isSummaryEnabled||l.isSummaryEnabled))}),(function(){return!(l.isMilestone||void 0!==l.isBarVisible&&!l.isBarVisible)}),(function(){return l.hasChildren&&(void 0===l.isSummaryEnabled||l.isSummaryEnabled)}),n,s,r,a)}},getMaxFinishColumnTemplate:function(e,t,i,n,s,r,a,o){return void 0===t&&(t=!0),void 0===i&&(i=!0),function(l){var d=l.ganttChartView;return(t?i?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(d.ownerDocument,e,(function(){return l.maxFinish}),(function(e){null!=e?l.maxFinish=e:delete l.maxFinish,d.onItemPropertyChanged(l,"maxFinish",!0,!0),d.refreshItem(l)}),(function(){return!(l.isReadOnly||o||void 0!==l.ganttChartView&&void 0!==l.ganttChartView.settings&&(l.ganttChartView.settings.isReadOnly||l.ganttChartView.settings.isGridReadOnly)||l.hasChildren&&(void 0===l.isSummaryEnabled||l.isSummaryEnabled))}),(function(){return!(l.isMilestone||void 0!==l.isBarVisible&&!l.isBarVisible)}),(function(){return l.hasChildren&&(void 0===l.isSummaryEnabled||l.isSummaryEnabled)}),n||864e5,s,r,a)}},getIconColumnTemplate:function(e,t,i,n,s,r,a,o,l){if("string"==typeof e){var d=e;e=function(){return d}}return void 0===n||0==n?n=function(){return!1}:1==n&&(n=function(){return!0}),function(d){var h=d.ganttChartView,c=h.ownerDocument.createElement("img");return c.setAttribute("src",e(d)),void 0!==t&&c.setAttribute("class",t),void 0!==i&&c.setAttribute("style",i),h.settings.isReadOnly||h.settings.isGridReadOnly||!n(d)||(c.style.cursor="move",function(e,t,i,n,s,r,a,o,l,d){e.addEventListener("mousedown",(function(i){0==i.button&&(delete n.cancelDrag,n.draggingItem=t,n.dragType="Ordering",n.style.cursor=e.style.cursor,n.draggingInitialY=i.clientY,n.draggingInitialThumbPosition=0,n.resetChartAreaDefinitions(),i.preventDefault())}),!0),void 0===n.draggableOrderingItems&&(n.draggableOrderingItems=[]);for(var h=!1,c=0;c<n.draggableOrderingItems.length;c++)if(n.draggableOrderingItems[c]==t){h=!0;break}h||(n.addEventListener("mousemove",(function(e){if(void 0!==n.draggingItem&&n.draggingItem==t&&"Ordering"==n.dragType){void 0!==n.temporaryHoveredGridItemSelectionContainer&&(n.temporaryHoveredGridItemSelectionContainer.setAttribute("class",n.temporaryHoveredGridItemClass),n.temporaryHoveredGridItemSelectionContainer.setAttribute("style",n.temporaryHoveredGridItemStyle),delete n.temporaryHoveredGridItemSelectionContainer,delete n.temporaryHoveredGridItemClass,delete n.temporaryHoveredGridItemStyle);var h=e.clientY-n.draggingInitialY;if(At(e.clientY,n),delete n.draggingItem,n.cancelDrag)x(t,s),delete n.cancelDrag,delete n.draggingItem,n.style.cursor="default";else{e=Math.floor((t.itemTop+n.draggingInitialThumbPosition+h)/s.itemHeight),h=null;for(var c=0,u=0;u<i.length;u++){var p=i[u];if(p.isVisible&&(void 0===p.isHidden||!p.isHidden)&&void 0===p.displayRowIndex){if(c==e){h=p;break}c++}}null!=h&&h!=t&&null!=h.gridItemSelectionContainer&&(n.temporaryHoveredGridItemSelectionContainer=h.gridItemSelectionContainer,n.temporaryHoveredGridItemClass=h.gridItemSelectionContainer.getAttribute("class"),n.temporaryHoveredGridItemStyle=h.gridItemSelectionContainer.getAttribute("style"),void 0===r||r(e,h)?void 0!==a?h.gridItemSelectionContainer.setAttribute("class",a):void 0!==o&&h.gridItemSelectionContainer.setAttribute("style",o):void 0!==l?h.gridItemSelectionContainer.setAttribute("class",l):void 0!==d&&h.gridItemSelectionContainer.setAttribute("style",d)),n.draggingItem=t}}}),!0),document.addEventListener("mouseup",(function(e){if(0==e.button&&void 0!==n.draggingItem&&n.draggingItem==t&&"Ordering"==n.dragType){void 0!==n.temporaryHoveredGridItemSelectionContainer&&(n.temporaryHoveredGridItemSelectionContainer.setAttribute("class",n.temporaryHoveredGridItemClass),n.temporaryHoveredGridItemSelectionContainer.setAttribute("style",n.temporaryHoveredGridItemStyle),delete n.temporaryHoveredGridItemSelectionContainer,delete n.temporaryHoveredGridItemClass,delete n.temporaryHoveredGridItemStyle),e=Math.floor((t.itemTop+n.draggingInitialThumbPosition+(e.clientY-n.draggingInitialY))/s.itemHeight);for(var a=null,o=0,l=0;l<i.length;l++){var d=i[l];if(d.isVisible&&(void 0===d.isHidden||!d.isHidden)&&void 0===d.displayRowIndex){if(o==e){a=d;break}o++}}null!=a&&(void 0===r||r(e,a))&&n.moveItemHierarchy(n.draggingItem,a.index),setTimeout((function(){x(t,s),Ht(t)}),0),n.resetChartAreaDefinitions(),delete n.draggingItem,n.style.cursor="default"}}),!0),n.draggableOrderingItems.push(t))}(c,d,h.items,h,h.settings,s,r,a,o,l)),c}},getOutputDate:Ci,getInputDate:bi}}()),null==DlhSoft.Controls.ScheduleChartView&&(DlhSoft.Controls.ScheduleChartView=function(){var e=function(e,t,s,r){var a=["DlhSoft.Controls","ScheduleChartView","DlhSoft.ProjectData.GanttChart.HTML.Controls","5","validate","Licensing"];DlhSoft[a[5]][a[4]](e,a[0],a[1],a[2],a[3],r,s),e.isScheduleChartInitializing=!0,r=t,t=[];for(var o=a=0,l=0;l<r.length;l++){var d=r[l];if((void 0===d.scheduleChartItem||d.scheduleChartItem==d)&&(d.scheduleChartIndex=a++,d.isHidden||(d.scheduleChartVisibilityIndex=o++),d.isBarVisible=!1,t.push(d),void 0!==d.ganttChartItems))for(var c=0;c<d.ganttChartItems.length;c++){var u=d.ganttChartItems[c];u.scheduleChartItem=d,d.isHidden&&(u.isHidden=!0),u.displayRowIndex=d.scheduleChartVisibilityIndex,u.indentation=d.indentation,t.push(u)}}if("object"!=typeof s&&(s={}),DlhSoft.Controls.GanttChartView.initializeItems(t,s),o=t,i(a=s),void 0===a.gridWidth&&(a.gridWidth="15%"),void 0===a.chartWidth&&(a.chartWidth=a.isGridVisible?"85%":"100%"),void 0===a.columns&&(a.columns=n(o,a)),void 0===a.areTaskDependenciesVisible&&(a.areTaskDependenciesVisible=!1),void 0===a.isBaselineVisible&&(a.isBaselineVisible=!1),void 0===a.areAssignmentsReadOnly&&(a.areAssignmentsReadOnly=!1),void 0===a.assignmentThumbStyle)switch(a.theme){default:a.assignmentThumbStyle="fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2";break;case"Aero":a.assignmentThumbStyle="fill: none; stroke: Blue; stroke-dasharray: 2, 2"}if(void 0===a.temporaryAssignmentThumbStyle)switch(a.theme){default:a.temporaryAssignmentThumbStyle="fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2";break;case"Aero":a.temporaryAssignmentThumbStyle="fill: none; stroke: Blue; stroke-width: 0.65px; stroke-dasharray: 2, 2"}return void 0===a.assignmentThumbTemplate&&(a.assignmentThumbTemplate=h(o,e,a)),a.internalExtraTaskTemplate=a.assignmentThumbTemplate,f(e,t,r,s),DlhSoft.Controls.GanttChartView.initialize(e,t,s,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),v(e,t),e.isScheduleChartInitializing=!1,e.isScheduleChartInitialized=!0,e},t=function(t){e(t,t.scheduleChartItems,t.settings,t.license)},i=function(e){if(void 0===e.useUpdatingToolTips&&(e.useUpdatingToolTips=!0),void 0===e.target&&(e.target="Standard"),void 0===e.theme&&(e.theme="Modern"),void 0===e.isGridVisible)switch(e.target){default:e.isGridVisible=!0;break;case"Phone":e.isGridVisible=!1}void 0===e.interaction&&(e.interaction="Phone"!=e.target?"Standard":"TouchEnabled"),void 0===e.isReadOnly&&(e.isReadOnly=!1),void 0===e.isGridReadOnly&&(e.isGridReadOnly=!1),void 0===e.isContentReadOnly&&(e.isContentReadOnly=!1),void 0===e.selectionMode&&(e.selectionMode="Focus"),void 0===e.isVirtualizing&&(e.isVirtualizing=!0),"Phone"==e.target&&void 0===e.areTaskAssignmentsVisible&&(e.areTaskAssignmentsVisible=!1)},n=function(e,t){"object"!=typeof t&&(t={}),i(t);var n=[{header:"",width:32,isSelection:!0},{header:"Resource",width:120,isTreeView:!0}];return n[0].cellTemplate=s(t,n[0],e),n[1].cellTemplate=l(t,n[1],e),n[1].exportCellTemplate=l(t,n[1],e,!1),"Single"!=t.selectionMode&&"Extended"!=t.selectionMode&&"ExtendedFocus"!=t.selectionMode&&n.splice(0,1),n},s=function(e,t){return function(e){return t.isReadOnly?getBooleanNode(e.ganttChartView.ownerDocument,e.isSelected):r(e)}},r=function(e){var t,i=e.ganttChartView.ownerDocument;void 0===e.selectionInput?(t=i.createElement("input"),e.selectionInput=t,t.type="checkbox",t.setAttribute("style","margin: 0px")):t=e.selectionInput,e.isSelected?(t.setAttribute("checked","checked"),t.checked||(t.checked=!0)):t.checked&&(t.checked=!1);var n=function(){t.checked?a(e):void 0!==e.scheduleChartView&&e.scheduleChartView.unselectItem(e)};return void 0!==t.changeEventListener&&t.removeEventListener("change",t.changeEventListener,!0),t.addEventListener("change",n,!0),t.changeEventListener=n,i=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),n())},void 0!==t.keyPressEventListener&&t.removeEventListener("keypress",t.keyPressEventListener,!0),t.addEventListener("keypress",i,!0),t.keyPressEventListener=i,t},a=function(e){void 0!==e.scheduleChartView&&e.scheduleChartView.selectItem(e)},o=function(e,t){void 0!==e.scheduleChartView&&(e.scheduleChartView.currentItem=e),("Focus"==t.selectionMode||"ExtendedFocus"==t.selectionMode)&&!e.isSelected&&a(e)},l=function(e,t,i,n){var s=function(e){var t=e.content;return(e=e.ganttChartView.ownerDocument.createElement("span")).innerHTML=t,e};return void 0!==n&&!n||e.isReadOnly||e.isGridReadOnly||e.isContentReadOnly?s:function(i){return t.isReadOnly||void 0!==i.isReadOnly&&i.isReadOnly?s(i):d(i,Math.max(0,t.width-i.indentation*i.ganttChartView.settings.indentationLevelWidth-i.ganttChartView.settings.toggleButtonAreaWidth-16),e)}},d=function(e,t,i){var n,s=e.ganttChartView.ownerDocument;if(void 0===e.contentInput){n=s.createElement("input"),e.contentInput=n,n.type="text",n.addEventListener("focus",(function(){o(e,i)}),!1);var r=function(){e.content=n.value,e.scheduleChartView.onItemPropertyChanged(e,"content",!0,!0),e.scheduleChartView.refreshItem(e)};void 0!==n.changeEventListener&&n.removeEventListener("change",n.changeEventListener,!0),n.addEventListener("change",r,!0),n.changeEventListener=r,s=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),r())},void 0!==n.keyPressEventListener&&n.removeEventListener("keypress",n.keyPressEventListener,!0),n.addEventListener("keypress",s,!0),n.keyPressEventListener=s,n.addEventListener("focus",(function(){n.style.backgroundColor="White"}),!1),n.addEventListener("blur",(function(){n.style.backgroundColor="Transparent"}),!1)}else n=e.contentInput;return n.value=e.content,s="",e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)&&(s="; font-weight: bold"),n.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"+s),n},h=function(e,t,i){return function(n){var s=n.ganttChartView.ownerDocument,r=s.createElementNS("http://www.w3.org/2000/svg","g");if(!(i.isReadOnly||i.isChartReadOnly||void 0!==n.isReadOnly&&n.isReadOnly||i.areAssignmentsReadOnly)){var a=t.getChartPosition(n.start,i),o=Math.max(t.getChartPosition(n.finish,i),a+4),l=s.createElementNS("http://www.w3.org/2000/svg","line");l.setAttribute("x1",a),l.setAttribute("y1",i.barMargin+i.barHeight+2),l.setAttribute("x2",o-1),l.setAttribute("y2",i.barMargin+i.barHeight+2);var d=i.assignmentThumbClass;void 0!==d&&l.setAttribute("class",d),l.setAttribute("style",i.assignmentThumbStyle),l.style.visibility="hidden",r.appendChild(l),(s=s.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",a),s.setAttribute("y",i.barMargin+i.barHeight-2),s.setAttribute("width",Math.max(0,o-a-1)),s.setAttribute("height",7),s.setAttribute("style","fill: White; fill-opacity: 0; cursor: move"),s.addEventListener("mouseover",(function(){void 0===t.draggingItem&&(l.style.visibility="visible")}),!0),s.addEventListener("mouseout",(function(){l.style.visibility="hidden"}),!0),r.appendChild(s),u(s,r,n,a,o,e,t,i)}return r}},c=function(e){var t=e.scheduleChartView;if(e.itemTop=e.scheduleChartVisibilityIndex*t.settings.itemHeight,t.refreshGridItem(e),void 0!==e.ganttChartItems)for(var i=0;i<e.ganttChartItems.length;i++){var n=e.ganttChartItems[i];n.itemTop=e.itemTop,t.refreshChartItem(n)}},u=function(e,t,i,n,s,r,a,l){var d=i.ganttChartView.ownerDocument;e.addEventListener("mousedown",(function(r){0==r.button&&(delete a.cancelDrag,a.draggingItem=i,a.dragType="Assignment",a.style.cursor=e.style.cursor,a.draggingInitialY=r.clientY,a.draggingInitialThumbPosition=l.barMargin,r.preventDefault(),t.itemLeft=n,t.itemRight=s,i.assignmentThumb=t,DlhSoft.Controls.ToolTip&&l.useUpdatingToolTips&&((toolTip=DlhSoft.Controls.ToolTip.get(e))||(toolTip=DlhSoft.Controls.ToolTip.initialize(void 0,e,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: Arial; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),toolTip.setContent(i.content+" –"),toolTip.show(),toolTip.setPosition(toolTip.x+(s-n)+4,toolTip.y-l.itemHeight-1),toolTip.originalY=toolTip.y,a.toolTip=toolTip))}),!0),void 0===a.draggableAssignmentItems&&(a.draggableAssignmentItems=[]);for(var h=!1,c=0;c<a.draggableAssignmentItems.length;c++)if(a.draggableAssignmentItems[c]==i){h=!0;break}h||(a.addEventListener("mousemove",(function(e){if(void 0!==a.draggingItem&&a.draggingItem==i&&"Assignment"==a.dragType){var o=Math.ceil((e.clientY-a.draggingInitialY)/l.itemHeight)*l.itemHeight;if(m(e.clientY,a),delete a.draggingItem,n=(t=i.assignmentThumb).itemLeft,s=t.itemRight,void 0!==a.temporaryAssignmentThumb){try{t.removeChild(a.temporaryAssignmentThumb)}catch(c){}delete a.temporaryAssignmentThumb}if(a.cancelDrag)delete a.cancelDrag,delete a.draggingItem,a.style.cursor="default";else if(l.temporaryAssignmentThumbTemplate?e=l.temporaryAssignmentThumbTemplate(a,n,a.draggingInitialThumbPosition+o,Math.max(4,s-n-1),l.barHeight):((e=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",n),e.setAttribute("y",a.draggingInitialThumbPosition+o),e.setAttribute("width",Math.max(4,s-n-1)),e.setAttribute("height",l.barHeight),void 0!==l.temporaryAssignmentThumbClass&&e.setAttribute("class",l.temporaryAssignmentThumbClass),e.setAttribute("style",l.temporaryAssignmentThumbStyle)),a.temporaryAssignmentThumb=e,t.appendChild(e),a.draggingItem=i,DlhSoft.Controls.ToolTip&&l.useUpdatingToolTips){toolTip=a.toolTip,e=Math.floor((i.itemTop+a.draggingInitialThumbPosition+o)/l.itemHeight);var h,u=null,g=0;for(h=0;h<r.length;h++){var f=r[h];if(f.isVisible&&(void 0===f.isHidden||!f.isHidden)&&void 0===f.displayRowIndex){if(g==e){f.hasChildren||(u=f);break}g++}}toolTip.setContent(i.content+" –"+(null!=u?" "+u.content:"")),toolTip.setVerticalPosition(Math.max(p(a)+a.chartHeaderContainer.clientHeight,toolTip.originalY+o)),void 0===toolTip.originalX&&(toolTip.originalX=toolTip.x),toolTip.setHorizontalPosition(toolTip.originalX)}}}),!0),d.addEventListener("mouseup",(function(e){if(0==e.button&&void 0!==a.draggingItem&&a.draggingItem==i&&"Assignment"==a.dragType){if(t=i.assignmentThumb,void 0!==a.temporaryAssignmentThumb){try{t.removeChild(a.temporaryAssignmentThumb)}catch(n){}delete a.temporaryAssignmentThumb}e=Math.ceil((e.clientY-a.draggingInitialY)/l.itemHeight)*l.itemHeight,e=Math.floor((i.itemTop+a.draggingInitialThumbPosition+e)/l.itemHeight);var s,d=null,h=0;for(s=0;s<r.length;s++)if((c=r[s]).isVisible&&(void 0===c.isHidden||!c.isHidden)&&void 0===c.displayRowIndex){if(h==e){c.hasChildren||(d=c);break}h++}if(null!=d){var c=(h=i.scheduleChartItem).ganttChartItems,u=[];for(s=0;s<c.length;s++)c[s]!=i&&u.push(c[s]);h.ganttChartItems=u,a.onItemPropertyChanged(h,"ganttChartItems",!1,!0),void 0===d.ganttChartItems&&(d.ganttChartItems=[]),d.ganttChartItems.push(i),a.onItemPropertyChanged(d,"ganttChartItems",!0,!0),i.scheduleChartItem=d,a.onItemPropertyChanged(i,"scheduleChartItem",!0,!0),i.displayRowIndex=e,i.isVirtuallyVisible=!0,a.refreshChartItem(i),o(d,l)}delete a.draggingItem,a.style.cursor="default"}}),!0),a.draggableAssignmentItems.push(i))},p=function(e){var t=0;if(e.offsetParent)do{t+=e.offsetTop,e=e.offsetParent}while(e);return t},m=function(e,t){var i;void 0!==t.draggingItem&&((e-=p(t))<t.chartHeaderContainer.clientHeight+24?(i=t.chartContentContainer.scrollTop,t.chartContentContainer.scrollTop=t.chartContentContainer.scrollTop-20,void 0===t.isDuringVerticalScrolling&&(t.isDuringVerticalScrolling=!0,setTimeout((function(){t.draggingInitialThumbPosition=t.draggingInitialThumbPosition-(i-t.chartContentContainer.scrollTop),delete t.isDuringVerticalScrolling}),0))):e>=t.chartHeaderContainer.clientHeight+t.chartContentContainer.clientHeight-24&&(i=t.chartContentContainer.scrollTop,t.chartContentContainer.scrollTop=t.chartContentContainer.scrollTop+20,void 0===t.isDuringVerticalScrolling&&(t.isDuringVerticalScrolling=!0,setTimeout((function(){t.draggingInitialThumbPosition=t.draggingInitialThumbPosition+(t.chartContentContainer.scrollTop-i),delete t.isDuringVerticalScrolling}),0))))},g=function(e,i,n,s){var r=s.indexOf(e);r<0||i<0||i==r||i>=s.length||(s.splice(r,1),s.splice(i,0,e),t(n),void 0!==n.settings.itemMoveHandler&&n.settings.itemMoveHandler(e,r,i))},f=function(e,i,n,s){for(var r=0;r<i.length;r++)i[r].scheduleChartView=e;e.scheduleChartItems=n,e.settings=s,e.refreshScheduleChartItem=c,e.initializeAssignmentDraggingThumb=function(t,i,n,s,r){u(t,i,n,s,r,e.items,e,e.settings)},e.insertScheduleChartItem=function(t,s){var r=t;s.scheduleChartView=e,s.isVirtuallyVisible=!0,s.scheduleChartIndex=r;var a,o=0;for(a=0;a<r;a++)n[a].isHidden||o++;if(s.scheduleChartVisibilityIndex=o,s.isBarVisible=!1,r=r<n.length?n[r].index:i.length,n.splice(s.scheduleChartIndex,0,s),e.insertItem(r++,s),void 0!==s.ganttChartItems)for(a=0;a<s.ganttChartItems.length;a++)(o=s.ganttChartItems[a]).scheduleChartView=e,o.scheduleChartItem=s,o.isHidden=s.isHidden,o.displayRowIndex=s.scheduleChartVisibilityIndex,o.indentation=s.indentation,e.insertItem(r++,o);for(a=s.scheduleChartIndex+1;a<n.length;a++){if((r=n[a]).scheduleChartIndex=a,void 0!==r.scheduleChartVisibilityIndex&&r.scheduleChartVisibilityIndex++,void 0!==r.ganttChartItems)for(o=0;o<r.ganttChartItems.length;o++)r.ganttChartItems[o].displayRowIndex=r.scheduleChartVisibilityIndex;c(r)}},e.addScheduleChartItem=function(t){e.insertScheduleChartItem(n.length,t)},e.insertScheduleChartItems=function(t,i){for(var n=0;n<i.length;n++)e.insertScheduleChartItem(t++,i[n])},e.addScheduleChartItems=function(t){for(var i=0;i<t.length;i++)e.addScheduleChartItem(t[i])},e.removeScheduleChartItem=function(t){if(void 0!==t.ganttChartItems)for(var i=0;i<t.ganttChartItems.length;i++)e.removeItem(t.ganttChartItems[i]);for(n.splice(t.scheduleChartIndex,1),i=t.scheduleChartIndex;i<n.length;i++){var s=n[i];if(s.scheduleChartIndex=i,void 0!==s.scheduleChartVisibilityIndex&&s.scheduleChartVisibilityIndex--,void 0!==s.ganttChartItems)for(var r=0;r<s.ganttChartItems.length;r++)s.ganttChartItems[r].displayRowIndex=s.scheduleChartVisibilityIndex;c(s)}e.removeItem(t)},e.removeScheduleChartItems=function(t){for(var i=0;i<t.length;i++)e.removeScheduleChartItem(t[i])},e.moveScheduleChartRange=function(i,s,r){if(!(i<0||r<0||r==i||r>n.length-s)){var a,o=[];for(a=i;a<i+s;a++)o.push(n[a]);for(n.splice(i,s),a=0;a<o.length;a++)n.splice(r+a,0,o[a]);if(t(e),void 0!==e.settings.itemMoveHandler)for(a=0;a<o.length;a++)e.settings.itemMoveHandler(o[a],i+a,r+a)}},e.moveScheduleChartItem=function(t,i){g(t,i,e,n)},e.moveScheduleChartItemUp=function(t){var i=n.indexOf(t);i<=0||g(t,i-1,e,n)},e.moveScheduleChartItemDown=function(t){var i=n.indexOf(t);i<0||i>=n.length-1||g(t,i+1,e,n)}},v=function(e,i){e.items=i,e.refresh=function(){t(e)}};return{initialize:e,refresh:t,getDefaultColumns:n,getDefaultScales:DlhSoft.Controls.GanttChartView.getDefaultScales,getDefaultStyleDefinitionTemplate:DlhSoft.Controls.GanttChartView.getDefaultStyleDefinitionTemplate,getDefaultStandardTaskTemplate:DlhSoft.Controls.GanttChartView.getDefaultStandardTaskTemplate,getDefaultMilestoneTaskTemplate:DlhSoft.Controls.GanttChartView.getDefaultMilestoneTaskTemplate,getDefaultItemTemplate:DlhSoft.Controls.GanttChartView.getDefaultItemTemplate,getDefaultAssignmentsTemplate:DlhSoft.Controls.GanttChartView.getDefaultAssignmentsTemplate,initializeTaskDraggingThumbs:DlhSoft.Controls.GanttChartView.initializeTaskDraggingThumbs,initializeDependencyDraggingThumb:DlhSoft.Controls.GanttChartView.initializeDependencyDraggingThumb,initializeAssignmentDraggingThumb:function(e,t,i,n,s){i.scheduleChartView.initializeAssignmentDraggingThumb(e,t,i,n,s)},getWorkingTime:DlhSoft.Controls.GanttChartView.getWorkingTime,getEffort:DlhSoft.Controls.GanttChartView.getEffort,getFinish:DlhSoft.Controls.GanttChartView.getFinish,getStart:DlhSoft.Controls.GanttChartView.getStart,getCompletion:DlhSoft.Controls.GanttChartView.getCompletion,getCompletedFinish:DlhSoft.Controls.GanttChartView.getCompletedFinish,textColumnTemplateBase:DlhSoft.Controls.GanttChartView.textColumnTemplateBase,textInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase,getOutputDate:DlhSoft.Controls.GanttChartView.getOutputDate,getInputDate:DlhSoft.Controls.GanttChartView.getInputDate}}()),null==DlhSoft.Controls.LoadChartView&&(DlhSoft.Controls.LoadChartView=function(){var e=function(e,t,s,r){var a=["DlhSoft.Controls","LoadChartView","DlhSoft.ProjectData.GanttChart.HTML.Controls","5","validate","Licensing"];DlhSoft[a[5]][a[4]](e,a[0],a[1],a[2],a[3],r,s),e.isLoadChartInitializing=!0,r=t,t=[];for(var o=a=0;o<r.length;o++){var l=r[o];if(void 0!==l.isExported&&l.isExported)t.push(l);else if((void 0===l.loadChartItem||l.loadChartItem==l)&&(l.loadChartIndex=l.scheduleChartIndex=a++,l.isBarVisible=!1,t.push(l),void 0!==l.ganttChartItems))for(var d=0;d<l.ganttChartItems.length;d++){var c=l.ganttChartItems[d];c.loadChartItem=c.scheduleChartItem=l,c.displayRowIndex=l.loadChartIndex,t.push(c)}}if("object"!=typeof s&&(s={}),DlhSoft.Controls.GanttChartView.initializeItems(t,s),o=t,i(a=s),void 0===a.gridWidth&&(a.gridWidth="15%"),void 0===a.chartWidth&&(a.chartWidth=a.isGridVisible?"85%":"100%"),void 0===a.columns&&(a.columns=n(o,a)),void 0===a.normalAllocationBarStyle&&null==a.normalAllocationBarClass)switch(a.theme){default:a.normalAllocationBarStyle="fill: Blue; fill-opacity: 0.8; stroke: Blue; stroke-width: 0.65px";break;case"Aero":a.normalAllocationBarStyle="fill: Blue; stroke: Blue"}if(void 0===a.underAllocationBarStyle&&null==a.underAllocationBarClass)switch(a.theme){default:a.underAllocationBarStyle="fill: Blue; fill-opacity: 0.8; stroke: Blue; stroke-width: 0.65px";break;case"Aero":a.underAllocationBarStyle="fill: Blue; stroke: Blue"}if(void 0===a.overAllocationBarStyle&&null==a.overAllocationBarClass)switch(a.theme){default:a.overAllocationBarStyle="fill: Red; fill-opacity: 0.8; stroke: Red; stroke-width: 0.65px";break;case"Aero":a.overAllocationBarStyle="fill: Red; stroke: Red"}return void 0===a.maxDisplayedUnits&&(a.maxDisplayedUnits=1.5),void 0===a.allocationTemplate&&(a.allocationTemplate=h()),a.standardTaskTemplate=a.allocationTemplate,a.milestoneTaskTemplate=a.allocationTemplate,a.areTaskDependenciesVisible=!1,a.isBaselineVisible=!1,a.isTaskCompletedEffortVisible=!1,a.areTaskAssignmentsVisible=!1,m(e,t,r,s),DlhSoft.Controls.GanttChartView.initialize(e,t,s,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),g(e,t,s),e.isLoadChartInitializing=!1,e.isLoadChartInitialized=!0,e},t=function(t){e(t,t.loadChartItems,t.settings,t.license)},i=function(e){if(void 0===e.target&&(e.target="Standard"),void 0===e.theme&&(e.theme="Modern"),void 0===e.isGridVisible)switch(e.target){default:e.isGridVisible=!0;break;case"Phone":e.isGridVisible=!1}void 0===e.isReadOnly&&(e.isReadOnly=!0),void 0===e.selectionMode&&(e.selectionMode="Focus"),void 0===e.isVirtualizing&&(e.isVirtualizing=!0)},n=function(e,t){"object"!=typeof t&&(t={}),i(t);var n=[{header:"",width:32,isSelection:!0},{header:"Resource",width:100}];return n[0].cellTemplate=s(t,n[0],e),n[1].cellTemplate=o(t,n[1]),n[1].exportCellTemplate=o(t,n[1],!1),"Single"!=t.selectionMode&&"Extended"!=t.selectionMode&&"ExtendedFocus"!=t.selectionMode&&n.splice(0,1),n},s=function(e,t){return function(e){return t.isReadOnly?getBooleanNode(e.ganttChartView.ownerDocument,e.isSelected):r(e)}},r=function(e){var t,i=e.ganttChartView.ownerDocument;void 0===e.selectionInput?(t=i.createElement("input"),e.selectionInput=t,t.type="checkbox",t.setAttribute("style","margin: 0px")):t=e.selectionInput,e.isSelected?(t.setAttribute("checked","checked"),t.checked||(t.checked=!0)):t.checked&&(t.checked=!1);var n=function(){t.checked?a(e):void 0!==e.loadChartView&&e.loadChartView.unselectItem(e)};return void 0!==t.changeEventListener&&t.removeEventListener("change",t.changeEventListener,!0),t.addEventListener("change",n,!0),t.changeEventListener=n,i=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),n())},void 0!==t.keyPressEventListener&&t.removeEventListener("keypress",t.keyPressEventListener,!0),t.addEventListener("keypress",i,!0),t.keyPressEventListener=i,t},a=function(e){void 0!==e.loadChartView&&e.loadChartView.selectItem(e)},o=function(e,t,i){var n=function(e){var t=e.content;return(e=e.ganttChartView.ownerDocument.createElement("span")).innerHTML=t,e};return void 0!==i&&!i||e.isReadOnly||e.isGridReadOnly||e.isContentReadOnly?n:function(i){return t.isReadOnly||void 0!==i.isReadOnly&&i.isReadOnly?n(i):l(i,Math.max(0,t.width-2),e)}},l=function(e,t,i){var n,s=e.ganttChartView.ownerDocument;if(void 0===e.contentInput){n=s.createElement("input"),e.contentInput=n,n.type="text",n.addEventListener("focus",(function(){void 0!==e.loadChartView&&(e.loadChartView.currentItem=e),("Focus"==i.selectionMode||"ExtendedFocus"==i.selectionMode)&&!e.isSelected&&a(e)}),!1);var r=function(){e.content=n.value,e.loadChartView.onItemPropertyChanged(e,"content",!0,!0),e.loadChartView.refreshItem(e)};void 0!==n.changeEventListener&&n.removeEventListener("change",n.changeEventListener,!0),n.addEventListener("change",r,!0),n.changeEventListener=r,s=function(e){13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),r())},void 0!==n.keyPressEventListener&&n.removeEventListener("keypress",n.keyPressEventListener,!0),n.addEventListener("keypress",s,!0),n.keyPressEventListener=s,n.addEventListener("focus",(function(){n.style.backgroundColor="White"}),!1),n.addEventListener("blur",(function(){n.style.backgroundColor="Transparent"}),!1)}else n=e.contentInput;return n.value=e.content,n.setAttribute("style","background-color: Transparent; width: "+t+"px; border-width: 0px; padding: 0px"),n},d=function(e){var t=e.loadChartView;if(t.refreshGridItem(e),void 0!==e.ganttChartItems)for(var i=0;i<e.ganttChartItems.length;i++)t.refreshChartItem(e.ganttChartItems[i])},h=function(e,t,i){return function(e){var n,s=void 0!==t?t:e.loadChartView,r=void 0!==i?i:s.settings,a=s.ownerDocument;for(n=s.ownerDocument,void 0===e.chartItemArea&&(e.chartItemArea=n.createElementNS("http://www.w3.org/2000/svg","g")),n=e.chartItemArea.childNodes.length;n-- >0;)e.chartItemArea.removeChild(e.chartItemArea.childNodes[n]);n=e.chartItemArea;var o=s.getChartPosition(e.start,r),l=(s=Math.max(s.getChartPosition(e.finish,r),o+4),a=a.createElementNS("http://www.w3.org/2000/svg","rect"),void 0!==e.units?e.units:1),d=Math.min(l,r.maxDisplayedUnits)/r.maxDisplayedUnits*r.barHeight;return a.setAttribute("x",o),a.setAttribute("y",r.barMargin+(r.barHeight-d)),a.setAttribute("width",Math.max(0,s-o-1)),a.setAttribute("height",d),o=1==l?r.normalAllocationBarClass:l<1?r.underAllocationBarClass:r.overAllocationBarClass,void 0!==e.allocationBarClass&&(o=e.allocationBarClass),void 0!==o?a.setAttribute("class",o):(r=1==l?r.normalAllocationBarStyle:l<1?r.underAllocationBarStyle:r.overAllocationBarStyle,void 0!==e.allocationBarStyle&&(r=e.allocationBarStyle),void 0!==r&&a.setAttribute("style",r)),n.appendChild(a),n}},c=function(e,i,n,s){var r=s.indexOf(e);r<0||i<0||i==r||i>=s.length||(s.splice(r,1),s.splice(i,0,e),t(n),void 0!==n.settings.itemMoveHandler&&n.settings.itemMoveHandler(e,r,i))},u=function(e,t){for(var i in t)0!=i.indexOf("custom")&&0!=i.indexOf("description")||void 0===e[i]&&(e[i]=t[i])},p=function(e,t,i,n,r,a,o,l,d,h,c,p,g,f,v,y,C){var b,S,w=[];if(void 0!==n)for(b=0;b<n.length;b++)w.push({header:(S=C.columns[n[b]]).header,width:S.width,headerClass:S.headerClass,headerStyle:S.headerStyle,cellClass:S.cellClass,cellStyle:S.cellStyle,cellTemplate:void 0!==S.exportCellTemplate?S.exportCellTemplate:S.cellTemplate});else for(b=0;b<C.columns.length;b++)(S=C.columns[b]).isSelection||w.push({header:S.header,width:S.width,headerClass:S.headerClass,headerStyle:S.headerStyle,cellClass:S.cellClass,cellStyle:S.cellStyle,cellTemplate:void 0!==S.exportCellTemplate?S.exportCellTemplate:S.cellTemplate});void 0===i&&(i=C.isGridVisible),b=i?function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i].width;return t}(w)+1:0,void 0!==r?void 0!==o&&o||(r=new Date(r.valueOf()-6e4*r.getTimezoneOffset())):r=C.timelineStart,void 0!==a?void 0!==o&&o||(a=new Date(a.valueOf()-6e4*a.getTimezoneOffset())):a=C.timelineFinish,(r={isExport:!0,isReadOnly:!0,selectionMode:"None",isVirtualizing:!1,isGridVisible:i,isSplitterEnabled:!1,gridWidth:b+"px",columns:w,allowUserToResizeColumns:!1,isGridRowClickTimeScrollingEnabled:!1,isMouseWheelZoomEnabled:!1,timelineStart:r,timelineFinish:a,hourWidth:void 0!==l?l:C.hourWidth,displayedTime:void 0!==r?r:C.timelineStart,currentTime:C.currentTime,isTaskToolTipVisible:!1,isDependencyToolTipVisible:!1,areTaskDependenciesVisible:!1,isBaselineVisible:!1,isTaskCompletedEffortVisible:!1,areTaskAssignmentsVisible:!1,containerClass:C.containerClass,containerStyle:C.containerStyle,border:C.border,theme:C.theme,headerBackground:C.headerBackground,headerHeight:C.headerHeight,itemHeight:C.itemHeight,itemClass:C.itemClass,itemStyle:C.itemStyle,scales:[],visibleWeekStart:C.visibleWeekStart,visibleWeekFinish:C.visibleWeekFinish,workingWeekStart:C.workingWeekStart,workingWeekFinish:C.workingWeekFinish,visibleDayStart:C.visibleDayStart,visibleDayFinish:C.visibleDayFinish,specialNonworkingDays:C.specialNonworkingDays,barMargin:C.barMargin,barHeight:C.barHeight,normalAllocationBarClass:C.normalAllocationBarClass,underAllocationBarClass:C.underAllocationBarClass,overAllocationBarClass:C.overAllocationBarClass,normalAllocationBarStyle:C.normalAllocationBarStyle,underAllocationBarStyle:C.underAllocationBarStyle,overAllocationBarStyle:C.overAllocationBarStyle,alternativeItemClass:C.alternativeItemClass,alternativeChartItemClass:C.alternativeChartItemClass,alternativeItemStyle:C.alternativeItemStyle,alternativeChartItemStyle:C.alternativeChartItemStyle,gridLines:C.gridLines,horizontalGridLines:C.horizontalGridLines,verticalGridLines:C.verticalGridLines,horizontalChartLines:C.horizontalChartLines,target:C.target,months:C.months,daysOfWeek:C.daysOfWeek,weekStartDay:C.weekStartDay,dateFormatter:C.dateFormatter,dateTimeFormatter:C.dateTimeFormatter,isRelativeToTimezone:C.isRelativeToTimezone,allocationTemplate:C.allocationTemplate}).timelineStart=DlhSoft.Controls.GanttChartView.getWeekStart(r.timelineStart,r.weekStartDay),r.timelineFinish=DlhSoft.Controls.GanttChartView.getWeekFinish(r.timelineFinish,r.weekStartDay),v=v.getChartPosition(r.timelineFinish,r)-v.getChartPosition(r.timelineStart,r),r.chartWidth=v+"px";var T=b+v+2+(i?1:0);for(b=0;b<C.scales.length;b++)r.scales.push({scaleType:(i=C.scales[b]).scaleType,isHeaderVisible:i.isHeaderVisible,headerHeight:i.headerHeight,headerTextFormat:i.headerTextFormat,headerClass:i.headerClass,headerStyle:i.headerStyle,isHighlightingVisible:i.isHighlightingVisible,highlightingClass:i.highlightingClass,highlightingStyle:i.highlightingStyle,isSeparatorVisible:i.isSeparatorVisible,separatorClass:i.separatorClass,separatorStyle:i.separatorStyle});var x,D,k=!1;if(null!=c&&void 0!==c.createElement)x=c;else{null!=c&&void 0!==c.focus?D=c:(D=window.open("",null!=c?c:"_blank",void 0!==p&&p&&(void 0===f||f)?"width=320,height=100,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),k=!0),x=D.document;try{var E=document.head.getElementsByTagName("link");for(b=0;b<E.length;b++){var I=E[b],A=x.adoptNode(I.cloneNode(!0));A.href=I.href,x.head.appendChild(A)}}catch(m){}}for(x.title=void 0!==e?e:"Exported chart"+(void 0!==p&&p?" (printable)":""),void 0===d&&(d=0),void 0===h&&(h=y.length-1),e=[],b=E=0;b<y.length;b++)void 0!==(c=y[b]).displayRowIndex&&(c.displayRowIndex<d||c.displayRowIndex>h)||void 0===c.displayRowIndex&&(E++<d||E>h+1)||(C={content:c.content,start:c.start,finish:c.finish,units:c.units,isBarVisible:c.isBarVisible,isRelativeToTimezone:c.isRelativeToTimezone,class:c.class,style:c.style,barClass:c.barClass,barStyle:c.barStyle,isSummaryEnabled:c.isSummaryEnabled,isParentSummarizationEnabled:c.isParentSummarizationEnabled,isHidden:c.isHidden,isExported:!0,tag:c},void 0!==c.displayRowIndex&&(C.displayRowIndex=c.displayRowIndex-d),u(C,c),e.push(C),c.exportItem=C);var V=x.createElement("p");V.innerHTML=void 0!==t?t:"",x.body.appendChild(V);var H=x.createElement("div");H.setAttribute("style","width: "+T+"px");try{DlhSoft.Controls.LoadChartView.initialize(H,e,r,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch(s){}setTimeout((function(){k&&x.body.setAttribute("style","margin: 0px");var e=x.createElement("div");e.appendChild(H),x.body.replaceChild(e,V),g&&(e.setAttribute("style","width: "+H.offsetHeight+"px; height: "+T+"px; overflow: hidden"),e=Math.round((H.offsetWidth-H.offsetHeight)/2),H.setAttribute("style","width: "+T+"px; transform: rotate(90deg) translateX("+e+"px) translateY("+e+"px); -webkit-transform: rotate(90deg) translateX("+e+"px) translateY("+e+"px)")),x.close(),void 0!==typeof D&&(D.focus(),void 0!==p&&p&&(D.print(),(void 0===f||f)&&D.close()))}),0)},m=function(e,i,n,s){for(var r=0;r<i.length;r++)i[r].loadChartView=i[r].scheduleChartView=e;e.loadChartItems=e.scheduleChartItems=n,e.settings=s,e.refreshLoadChartItem=d,e.insertLoadChartItem=function(t,s){var r=t;if(s.loadChartView=s.scheduleChartView=e,s.isVirtuallyVisible=!0,s.loadChartIndex=s.scheduleChartIndex=r,s.isBarVisible=!1,r=r<n.length?n[r].index:i.length,n.splice(s.loadChartIndex,0,s),e.insertItem(r++,s),void 0!==s.ganttChartItems)for(var a=0;a<s.ganttChartItems.length;a++){var o=s.ganttChartItems[a];o.loadChartView=o.scheduleChartView=e,o.loadChartItem=o.scheduleChartItem=s,o.displayRowIndex=s.loadChartIndex,e.insertItem(r++,o)}for(r=s.loadChartIndex+1;r<n.length;r++){if((a=n[r]).loadChartIndex=a.scheduleChartIndex=r,void 0!==a.ganttChartItems)for(o=0;o<a.ganttChartItems.length;o++)a.ganttChartItems[o].displayRowIndex=a.loadChartIndex;d(a)}},e.addLoadChartItem=function(t){e.insertLoadChartItem(n.length,t)},e.insertLoadChartItems=function(t,i){for(var n=0;n<i.length;n++)e.insertLoadChartItem(t++,i[n])},e.addLoadChartItems=function(t){for(var i=0;i<t.length;i++)e.addLoadChartItem(t[i])},e.removeLoadChartItem=function(t){if(void 0!==t.ganttChartItems)for(var i=0;i<t.ganttChartItems.length;i++)e.removeItem(t.ganttChartItems[i]);for(e.removeItem(t),n.splice(t.loadChartIndex,1),t=t.loadChartIndex;t<n.length;t++){if((i=n[t]).loadChartIndex=i.scheduleChartIndex=t,void 0!==i.ganttChartItems)for(var s=0;s<i.ganttChartItems.length;s++)i.ganttChartItems[s].displayRowIndex=i.loadChartIndex;d(i)}},e.removeLoadChartItems=function(t){for(var i=0;i<t.length;i++)e.removeLoadChartItem(t[i])},e.moveLoadChartRange=function(i,s,r){if(!(i<0||r<0||r==i||r>n.length-s)){var a,o=[];for(a=i;a<i+s;a++)o.push(n[a]);for(n.splice(i,s),a=0;a<o.length;a++)n.splice(r+a,0,o[a]);if(t(e),void 0!==e.settings.itemMoveHandler)for(a=0;a<o.length;a++)e.settings.itemMoveHandler(o[a],i+a,r+a)}},e.moveLoadChartItem=function(t,i){c(t,i,e,n)},e.moveLoadChartItemUp=function(t){var i=n.indexOf(t);i<=0||c(t,i-1,e,n)},e.moveLoadChartItemDown=function(t){var i=n.indexOf(t);i<0||i>=n.length-1||c(t,i+1,e,n)}},g=function(e,i,n){e.items=i,e.refresh=function(){t(e)},e.exportContent=function(t,s){void 0===t&&(t={}),p(t.title,t.preparingMessage,t.isGridVisible,t.columnIndexes,t.timelineStart,t.timelineFinish,t.isRelativeToTimezone,t.hourWidth,t.startRowIndex,t.endRowIndex,s,!1,t.rotate,!1,e,i,n)},e.print=function(t){void 0===t&&(t={}),p(t.title,t.preparingMessage,t.isGridVisible,t.columnIndexes,t.timelineStart,t.timelineFinish,t.isRelativeToTimezone,t.hourWidth,t.startRowIndex,t.endRowIndex,null,!0,t.rotate,t.autoClose,e,i,n)}};return{initialize:e,refresh:t,getDefaultColumns:n,getDefaultScales:DlhSoft.Controls.GanttChartView.getDefaultScales,getDefaultAllocationTemplate:h,getDefaultItemTemplate:DlhSoft.Controls.GanttChartView.getDefaultItemTemplate,getWorkingTime:DlhSoft.Controls.GanttChartView.getWorkingTime,textColumnTemplateBase:DlhSoft.Controls.GanttChartView.textColumnTemplateBase,textInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase,getOutputDate:DlhSoft.Controls.GanttChartView.getOutputDate,getInputDate:DlhSoft.Controls.GanttChartView.getInputDate}}()),void 0===DlhSoft&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)}),DlhSoft.assemblies.push({assembly:"DlhSoft.ProjectData.PertChart.HTML.Controls",company:"DlhSoft",product:"Project Data Modern Library",version:"5.3.2.0",copyright:"Copyright © 2012-2016 DlhSoft",title:"Project Data PERT Chart HTML Controls",description:"Project Data PERT Chart related HTML client components"}),DlhSoft.buildReleaseDate=function(e,t,i){return(e=new Date(e,4,17))>DlhSoft.buildReleaseDate?e:DlhSoft.buildReleaseDate}(2017),_0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{"),null==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var e=_0x5c25[1],t=_0x5c25[2],n=[],s=[],r=_0x5c25[3];return{setLicense:function(e,t){n[_0x5c25[7]]({type:e,content:t})},validate:function(a,o,l,d,h,c,u){o=o+_0x5c25[4]+l;for(var p=0;p<s[_0x5c25[5]];p++)if(s[p]==o)return;e:if(typeof c!==t&&typeof u!==e&&(u[_0x5c25[6]]!==e&&(c=u[_0x5c25[6]]),typeof u===t&&(c=u)),typeof c!==t)for(u=0;u<n[_0x5c25[5]];u++)if(p=n[u],p[_0x5c25[8]]==o&&typeof p[_0x5c25[9]]===t){c=p[_0x5c25[9]];break e}!function(n,s){if(typeof n!==t||typeof s!==t)return!1;if(s==r)return!0;var a=s[_0x5c25[11]](_0x5c25[10]);if(0<=a){var o,l=s[_0x5c25[12]](0,a),d=l[_0x5c25[11]](_0x5c25[10]);if(0<=d)try{o=new Date(parseInt(l[_0x5c25[12]](d+1)))}catch(u){}if(typeof o===e&&(o=new Date(2013,11,31)),DlhSoft[_0x5c25[13]]>o)return!1;for(l=l+_0x5c25[10]+n,i=o=0;i<l[_0x5c25[5]];i++)o=(o<<5)-o+(d=l[_0x5c25[14]](i)),o&=o;if(0>o&&(o=Math[_0x5c25[15]](2,32)-o),(l=o.toString(16)[_0x5c25[16]]())==(a=s[_0x5c25[12]](a+1)))return!0}return!1}(o,c)?function(t,i,n,r,a){var o=_0x5c25[17],l=typeof ComponentSource!==e&&ComponentSource?_0x5c25[21]:_0x5c25[18]+_0x5c25[19]+r+_0x5c25[20]+a,d=r+_0x5c25[22]+a+_0x5c25[23],h=_0x5c25[24],c=_0x5c25[25],u=_0x5c25[26];setTimeout((function(){var e=t[_0x5c25[27]],r=e[_0x5c25[29]](_0x5c25[28]);r[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var a=e[_0x5c25[29]](_0x5c25[28]);a[_0x5c25[32]](_0x5c25[30],_0x5c25[33]);var p=e[_0x5c25[29]](_0x5c25[28]);p[_0x5c25[32]](_0x5c25[30],_0x5c25[34]),a[_0x5c25[35]](p),p[_0x5c25[35]](e[_0x5c25[36]](o)),a[_0x5c25[35]](e[_0x5c25[36]](h+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),p[_0x5c25[35]](e[_0x5c25[36]](i)),a[_0x5c25[35]](p),a[_0x5c25[35]](e[_0x5c25[36]](c+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),p[_0x5c25[35]](e[_0x5c25[36]](d)),a[_0x5c25[35]](p),a[_0x5c25[35]](e[_0x5c25[36]](u+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var m=e[_0x5c25[29]](_0x5c25[39]);m[_0x5c25[32]](_0x5c25[30],_0x5c25[40]),m[_0x5c25[32]](_0x5c25[41],l),m[_0x5c25[32]](_0x5c25[42],_0x5c25[43]),m[_0x5c25[35]](e[_0x5c25[36]](_0x5c25[44])),p[_0x5c25[35]](m),(m=e[_0x5c25[29]](_0x5c25[39]))[_0x5c25[32]](_0x5c25[30],_0x5c25[45]),m[_0x5c25[32]](_0x5c25[41],_0x5c25[46]),m[_0x5c25[35]](e[_0x5c25[36]](_0x5c25[47])),m[_0x5c25[50]](_0x5c25[48],(function(){t[_0x5c25[49]](r),s[_0x5c25[7]](n)}),!1),p[_0x5c25[35]](m),a[_0x5c25[35]](p),r[_0x5c25[35]](a),t[_0x5c25[35]](r)}),0),setTimeout((function(){alert(o+_0x5c25[51]+h+_0x5c25[52]+i+_0x5c25[51]+c+_0x5c25[53]+d+_0x5c25[51]+u+_0x5c25[4])}),6e5)}(a,l,o,d,h):a[_0x5c25[6]]=c}}}()),null==DlhSoft.Controls&&(DlhSoft.Controls={}),null==DlhSoft.Controls.Pert&&(DlhSoft.Controls.Pert={}),null==DlhSoft.Controls.Pert.PertChartView&&(DlhSoft.Controls.Pert.PertChartView=function(){var e=function(e,t,r,a){var o=["DlhSoft.Controls.Pert","PertChartView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];if(DlhSoft[o[5]][o[4]](e,o[0],o[1],o[2],o[3],a,r),e.isInitializing=!0,void 0!==e.items)for(a=0;a<e.items.length;a++)delete e.items[a].successors;"object"!=typeof r&&(r={}),n(t,r),i(r,t,e),_(e,t,r),s(t);var d=l(e,t,r),h=e.ownerDocument;(a=h.createElement("div")).setAttribute("style","font-family: Arial; font-size: small; overflow: auto"),o=h.createElement("div"),void 0!==r.containerClass&&o.setAttribute("class",r.containerClass),void 0!==r.containerStyle&&o.setAttribute("style",r.containerStyle),a.appendChild(o),(y=h.createElement("div")).setAttribute("style","border: solid 1px "+r.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden"),o.appendChild(y),(o=h.createElement("div")).setAttribute("style","overflow: auto"),y.appendChild(o);var f=h.createElement("div");f.setAttribute("style","overflow: "+(void 0!==r.isExport&&r.isExport?"hidden":"auto")+"; height: "+d),o.appendChild(f);var v,y=c(t,r),C=u(t,r),b=h.createElement("div");b.setAttribute("style","float: left; overflow: hidden; width: "+y+"px; height: "+C+"px"),f.appendChild(b),(d=h.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("style","width: "+y+"px; height: "+C+"px"),y=r.styleDefinitionTemplate(),d.appendChild(y),d.chartAreaDefinitions=y,d.addEventListener("mousedown",y=function(){setTimeout((function(){try{var e=b.chartArea,t=e.chartAreaDefinitions;e.removeChild(t),e.childNodes.length>0?e.insertBefore(t,e.childNodes[0]):e.appendChild(t)}catch(y){}}),0)},!0),h.addEventListener("mouseup",y,!0),b.appendChild(d),b.chartArea=d,setTimeout((function(){v=e.clientHeight}),0),void 0!==e.heightUpdateTimer&&clearInterval(e.heightUpdateTimer),e.heightUpdateTimer=setInterval((function(){try{if(!(e.clientHeight<=0)){var i=e.clientHeight;if(i!=v){var n=l(e,t,r);f.style.height=n,v=i}}}catch(y){try{clearInterval(e.heightUpdateTimer)}catch(h){}}}),100);var S=function(e,i,n,s){var a;if(r.mouseHandler||r.mouseMoveHandler&&"mousemove"==s||r.mouseDownHandler&&"mousedown"==s||r.clickHandler&&"click"==s||r.doubleClickHandler&&"dblclick"==s){var o=e.which;!o&&e.button&&(1&e.button?o=1:4&e.button?o=2:2&e.button&&(o=3)),a=n.getBoundingClientRect();var l=h.body,d=h.documentElement;for(n=a.left+(window.pageXOffset||d.scrollLeft||l.scrollLeft)-(d.clientLeft||l.clientLeft||0),a=Math.round(a.top+(window.pageYOffset||d.scrollTop||l.scrollTop)-(d.clientTop||l.clientTop||0)),n=Math.round(n),n=e.pageX-n,a=e.pageY-a,l=0;l<t.length;l++){var c=m(d=t[l],r),u=g(d,r);n>=c&&n<c+r.itemWidth&&a>=u&&a<u+r.itemHeight&&(r.mouseHandler&&r.mouseHandler(s,d,o,i,e),r.mouseMoveHandler&&"mousemove"==s&&r.mouseMoveHandler(d),r.mouseDownHandler&&"mousedown"==s&&r.mouseDownHandler(d,o),r.itemClickHandler&&"click"==s&&r.itemClickHandler(d),r.itemDoubleClickHandler&&"dblclick"==s&&r.itemDoubleClickHandler(d))}}};return b.addEventListener("mousemove",(function(e){S(e,0,b,"mousemove")})),b.addEventListener("mousedown",(function(e){S(e,1,b,"mousedown")})),b.addEventListener("click",(function(e){S(e,1,b,"click")})),b.addEventListener("dblclick",(function(e){S(e,2,b,"dblclick")})),b.addEventListener("click",(function(e){e.srcElement&&"rect"!=e.srcElement.nodeName&&e.stopPropagation()}),!0),b.container=f,e.chartContainer=o,e.chartContent=b,e.chartContentContainer=f,f.isInitializing=!0,L(e,a),p(b,d,t,r),f.isInitializing=!1,e.isInitializing=!1,e.isInitialized=!0,e},t=function(t){e(t,t.items,t.settings,t.license)},i=function(e,t,i){if(function(e){void 0===e.timeSpanFormatter&&(e.timeSpanFormatter=h),void 0===e.itemPropertyChangeHandler&&(e.itemPropertyChangeHandler=function(){}),void 0===e.target&&(e.target="Standard"),void 0===e.theme&&(e.theme="Modern")}(e),void 0===e.border)switch(e.theme){default:e.border="#e0e0e0";break;case"ModernBordered":case"Aero":e.border="#9a9a9a"}if(void 0===e.canUserRearrangeItems&&(e.canUserRearrangeItems=!0),void 0===e.snapRearrangedItemsToGuidelines&&(e.snapRearrangedItemsToGuidelines=!0),void 0===e.itemWidth&&(e.itemWidth=40),void 0===e.itemHeight&&(e.itemHeight=40),void 0===e.aspectRatio&&(e.aspectRatio=1),void 0===e.shapeWidth&&(e.shapeWidth=32),void 0===e.shapeHeight&&(e.shapeHeight=32),void 0===e.styleDefinitionTemplate&&(e.styleDefinitionTemplate=T(i,e)),void 0===e.dependencyTextBlockWidth&&(e.dependencyTextBlockWidth=120),void 0===e.shapeStyle&&null==e.shapeClass&&(e.shapeStyle="fill: White; stroke: #606060; stroke-width: 0.75px"),void 0===e.temporaryThumbStyle&&null==e.temporaryThumbClass&&(e.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; "),void 0===e.dependencyLineStyle&&null==e.dependencyLineClass&&(e.dependencyLineStyle="stroke: #8080FF; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)"),void 0===e.virtualEffortDependencyLineStyle&&null==e.virtualEffortDependencyLineClass&&(e.virtualEffortDependencyLineStyle="stroke: #8080FF; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)"),void 0===e.dependencyLineZoneStyle&&null==e.dependencyLineZoneClass&&(e.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none"),void 0===e.taskEventTemplate&&(e.taskEventTemplate=D()),void 0===e.dependencyTextStyle&&(e.dependencyTextStyle="color: #606060; text-anchor: middle"),void 0===e.chartMargin&&(e.chartMargin=16),void 0===e.isTaskEventToolTipVisible)switch(e.target){default:e.isTaskEventToolTipVisible=!0;break;case"Phone":e.isTaskEventToolTipVisible=!1}void 0===e.itemTemplate&&(e.itemTemplate=x(e)),void 0===e.dependencyLineTemplate&&(e.dependencyLineTemplate=k()),void 0===e.isDependencyToolTipVisible&&(e.isDependencyToolTipVisible=e.isTaskEventToolTipVisible),void 0===e.predecessorItemTemplate&&(e.predecessorItemTemplate=E(e))},n=function(e){for(var t=0;t<e.length;t++){var i=e[t];if("string"==typeof i&&(e[t]=i={content:i}),void 0!==i.predecessors){"string"==typeof i.predecessors&&(i.predecessors=i.predecessors.split(","));for(var n=0;n<i.predecessors.length;n++){var s=i.predecessors[n];if("string"==typeof s&&(i.predecessors[n]=s={item:s}),"string"==typeof s.item){var r=parseInt(s.item)-1;s.item=r>=0&&r<e.length?e[r]:null}"string"==typeof s.effort&&(s.effort=parseFloat(s.effort))}}void 0!==i.displayedRowIndex&&(i.actualRowIndex=i.displayedRowIndex),void 0!==i.displayedColumnIndex&&(i.actualColumnIndex=i.displayedColumnIndex),void 0===i.actualRowIndex&&(i.actualRowIndex=0),void 0===i.actualColumnIndex&&(i.actualColumnIndex=0)}},s=function(e){e.positionedItems=[],e.maxRowIndex=null;for(var t=0;t<e.length;t++){var i=e[t],n=e;if(void 0===i.displayedRowIndex){var s;if(void 0!==i.predecessors){s=n.positionedItems;for(var l=[],d=i.predecessors,h=0;h<s.length;h++)for(var c=s[h],u=0;u<d.length;u++)if(d[u].item==c){l.push(c);break}s=l}else s=null;if(null!=s){for(l=s,d=[],h=0;h<l.length;h++)d.indexOf(c=l[h].actualRowIndex)<0&&d.push(c);l=d}else l=null;if(l=null!=l&&l.length>0?N(l):null!=n.maxRowIndex?n.maxRowIndex+1:0,d=d=void 0,void 0===i.displayedColumnIndex){if(d=(d=r(n.positionedItems,l)).length>0?N(d)+1:0,null!=(h=null!=s?r(s,l):null)&&h.length>0){for(c=null,u=0;u<h.length;u++)(null==c||h[u]<c)&&(c=h[u]);h=c+1}else h=null;for(null!=h&&h!=d&&(l++,d=null!=(s=null!=s?a(s):null)&&s.length>0?N(s)+1:0),i.actualColumnIndex=d;o(n.positionedItems,l,d);)l++}else for(;!((d=(d=r(n.positionedItems,l)).length>0?N(d)+1:0)<=i.actualColumnIndex);l++);i.actualRowIndex=l}else void 0===i.displayedColumnIndex&&(s=a(n.positionedItems),i.actualColumnIndex=s.length>0?N(s)+1:0);n.positionedItems.push(i),(null==n.maxRowIndex||i.actualRowIndex>n.maxRowIndex)&&(n.maxRowIndex=i.actualRowIndex)}},r=function(e,t){for(var i=[],n=0;n<e.length;n++){var s=e[n];s.actualRowIndex==t&&i.indexOf(s=s.actualColumnIndex)<0&&i.push(s)}return i},a=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i].actualColumnIndex;t.indexOf(n)<0&&t.push(n)}return t},o=function(e,t,i){for(var n=0;n<e.length;n++){var s=e[n];if(s.actualRowIndex==t&&s.actualColumnIndex==i)return!0}return!1},l=function(e,t,i){var n;if(e.isContentHeightInitialized&&e.isContentHeightAuto)n=t.length>0?"auto":i.itemHeight+"px";else{var s=e.clientHeight-2;s<0&&(s=0),n=s+"px",s<i.itemHeight&&(e.isContentHeightInitialized||(e.isContentHeightAuto=!0),n=t.length>0?"auto":i.itemHeight+"px"),e.isContentHeightInitialized=!0}return n},d=function(e,t){var i=e.createElement("span");return i.innerHTML=t,i},h=function(e){return Math.ceil(e/36e5*1e4/100)/100+"h"},c=function(e,t){for(var i=0,n=0;n<e.length;n++)i=Math.max(i,e[n].actualColumnIndex);return t.itemWidth+i*(t.itemWidth+t.dependencyTextBlockWidth)+2*t.chartMargin},u=function(e,t){for(var i=0,n=0;n<e.length;n++)i=Math.max(i,e[n].actualRowIndex);return t.itemHeight+i*(t.itemHeight+t.dependencyTextBlockWidth/t.aspectRatio)+2*t.chartMargin},p=function(e,t,i,n){for(e=0;e<i.length;e++){var s=i[e],r=m(s,n),a=g(s,n);t.appendChild(v(s,r,a,n))}},m=function(e,t){return void 0!==e.displayedColumnIndex&&(e.actualColumnIndex=e.displayedColumnIndex),Math.max(0,t.chartMargin+e.actualColumnIndex*(t.itemWidth+t.dependencyTextBlockWidth))},g=function(e,t){return void 0!==e.displayedRowIndex&&(e.actualRowIndex=e.displayedRowIndex),Math.max(0,t.chartMargin+e.actualRowIndex*(t.itemHeight+t.dependencyTextBlockWidth/t.aspectRatio))},f=function(e){for(var t,i,n=[],s=0;s<e.length;s++){var r=e[s];if(void 0!==r.predecessors&&r.predecessors.length>0)for(var a=0;a<r.predecessors.length;a++){var o=r.predecessors[a].item;if(void 0!==o){for(t=!0,i=0;i<n;i++)if(o==n[i]){t=!1;break}t&&(y(o.chartItem,o,o.pertChartView.settings),t=m(o,o.pertChartView.settings),i=g(o,o.pertChartView.settings),o.chartItem.setAttribute("transform","translate("+t+", "+i+")"),n.push(o))}}if(void 0!==r.predecessors&&r.predecessors.length>0){for(t=!0,i=0;i<n;i++)if(void 0!==r&&r==n[i]){t=!1;break}t&&(y(r.chartItem,r,r.pertChartView.settings),t=m(r,r.pertChartView.settings),i=g(r,r.pertChartView.settings),r.chartItem.setAttribute("transform","translate("+t+", "+i+")"),n.push(r))}}},v=function(e,t,i,n){var s=e.pertChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");return e.chartItem=s,s.setAttribute("style","-ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),s.setAttribute("transform","translate("+t+", "+i+")"),y(s,e,n),s},y=function(e,t,i){for(var n=e.childNodes.length;n-- >0;)e.removeChild(e.childNodes[n]);if(void 0===t.isShapeVisible||t.isShapeVisible){if(n=i.taskEventTemplate,void 0!==t.taskEventTemplate&&(n=t.taskEventTemplate),n=n(t),e.appendChild(n),void 0!==i.internalExtraTaskTemplate){var s=i.internalExtraTaskTemplate(t);null!=s&&e.appendChild(s)}if(void 0!==i.extraTaskEventTemplate&&null!=(s=i.extraTaskEventTemplate(t))&&e.appendChild(s),i.isTaskEventToolTipVisible&&(s=i.itemTemplate,void 0!==t.template&&(s=t.template),n.appendChild(s(t))),void 0!==t.predecessors)for(n=0;n<t.predecessors.length;n++)if(s=t.predecessors[n],!((void 0===t.pertChartView||t.pertChartView.items.indexOf(s.item))<0)){var r=i.dependencyLineTemplate(t,s);if(r.predecessorIndex=n,function(e){r.addEventListener("click",(function(n){i.dependencyLineClickHandler&&i.dependencyLineClickHandler(e,t,n)})),r.addEventListener("dblclick",(function(n){i.dependencyLineDoubleClickHandler&&i.dependencyLineDoubleClickHandler(e,t,n)}))}(s),e.appendChild(r),i.isDependencyToolTipVisible){var a=i.predecessorItemTemplate;void 0!==s.template&&(a=s.template),r.appendChild(a(t,s))}}}},C=function(e){void 0===e.isWaitingToRefreshChartItem&&(e.isWaitingToRefreshChartItem=!0,setTimeout((function(){y(e.chartItem,e,e.pertChartView.settings);var t=m(e,e.pertChartView.settings),i=g(e,e.pertChartView.settings);e.chartItem.setAttribute("transform","translate("+t+", "+i+")"),delete e.isWaitingToRefreshChartItem}),0))},b=function(e){C(e)},S=function(e){void 0===e.isWaitingToRefreshPredecessorItems&&(e.isWaitingToRefreshPredecessorItems=!0,setTimeout((function(){f(e.pertChartView.items),delete e.isWaitingToRefreshPredecessorItems}),0))},w=function(e){void 0!==e.isWaitingToRefreshChartItem||void 0!==e.isWaitingToRefreshPredecessorItems?(void 0===e.isWaitingToRefreshChartItem&&C(e),void 0===e.isWaitingToRefreshPredecessorItems&&S(e)):(e.isWaitingToRefreshChartItem=!0,e.isWaitingToRefreshPredecessorItems=!0,setTimeout((function(){y(e.chartItem,e,e.pertChartView.settings);var t=m(e,e.pertChartView.settings),i=g(e,e.pertChartView.settings);e.chartItem.setAttribute("transform","translate("+t+", "+i+")"),f(e.pertChartView.items),delete e.isWaitingToRefreshChartItem,delete e.isWaitingToRefreshPredecessorItems}),0))},T=function(e){return function(){var t=e.ownerDocument,i=t.createElementNS("http://www.w3.org/2000/svg","defs"),n=t.createElementNS("http://www.w3.org/2000/svg","marker");return n.setAttribute("id","ArrowMarker"),n.setAttribute("viewBox","0 0 10 10"),n.setAttribute("refX","0"),n.setAttribute("refY","5"),n.setAttribute("markerUnits","strokeWidth"),n.setAttribute("markerWidth","5"),n.setAttribute("markerHeight","4"),n.setAttribute("orient","auto"),(t=t.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("fill","#8080ff"),t.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),n.appendChild(t),i.appendChild(n),i}},x=function(){return function(e){var t=e.pertChartView.ownerDocument,i=t.createElementNS("http://www.w3.org/2000/svg","title");return i.appendChild(d(t,void 0!==e.content?e.content:"")),i}},D=function(e,t,i){return function(n){var s,r=void 0!==t?t:n.pertChartView,a=void 0!==i?i:r.settings,o=void 0!==e?e:r.items,l=r.ownerDocument;for(s=n.pertChartView.ownerDocument,void 0===n.chartItemArea&&(n.chartItemArea=s.createElementNS("http://www.w3.org/2000/svg","g")),s=n.chartItemArea.childNodes.length;s-- >0;)n.chartItemArea.removeChild(n.chartItemArea.childNodes[s]);s=n.chartItemArea;var d,h=(a.itemWidth-a.shapeWidth)/2,c=h+a.shapeWidth,u=(a.itemHeight-a.shapeHeight)/2,p=u+a.shapeHeight,f=a.shapeHeight,v=l.createElementNS("http://www.w3.org/2000/svg","rect");return v.setAttribute("x",h),v.setAttribute("y",u),v.setAttribute("width",Math.max(0,c-h-1)),v.setAttribute("height",Math.max(0,p-u-1)),v.setAttribute("rx",a.shapeWidth/10),v.setAttribute("ry",a.shapeHeight/10),d=a.shapeClass,void 0!==n.shapeClass&&(d=n.shapeClass),void 0!==d?v.setAttribute("class",d):(d=a.shapeStyle,void 0!==n.shapeStyle&&(d=n.shapeStyle),void 0!==d&&v.setAttribute("style",d)),s.appendChild(v),(v=l.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",(h+c)/2),v.setAttribute("y",p-1.5*f/8-6),v.setAttribute("style","font-weight: bold; text-anchor: middle"),void 0===(f=n.displayedText)&&(f=""),v.appendChild(l.createTextNode(f)),s.appendChild(v),a.canUserRearrangeItems&&((l=l.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",h),l.setAttribute("y",u),l.setAttribute("width",Math.max(0,c-h-1)),l.setAttribute("height",Math.max(0,p-u-1)),l.setAttribute("style","fill: White; fill-opacity: 0; cursor: move"),s.appendChild(l),A(l,n,o,m(n,a),g(n,a),r,a)),s}},k=function(e,t){return function(e,i){var n,s=e.pertChartView,r=void 0!==t?t:s.settings,a=(s=s.ownerDocument).createElementNS("http://www.w3.org/2000/svg","g"),o=void 0,l=void 0,d="M ",h=(o=m(e,r)-2,l=g(e,r)-2,m(i.item,r));n=g(i.item,r);var c=m(e,r),u=g(e,r),p=Math.abs(c-h),f=Math.abs(u-n),v=r.shapeWidth+2,y=r.shapeHeight+2,C=v/2,b=y/2,S=Math.max(v,y);return f=f<4*S,p<S?d=n<=u?d+(h+C-o+",")+(n+y-l)+" L "+(c+C-o)+","+(u-l):d+(h+C-o+",")+(n-l)+" L "+(c+C-o)+","+(u+y-l):(d=h<=c?d+(h+v-o+",")+(n+b-l):d+(h-o+",")+(n+b-l),d=f?h<=c?d+" L "+(c-o)+","+(u+b-l):d+" L "+(c+v-o)+","+(u+b-l):n<=u?d+" L "+(c+C-o)+","+(u-l):d+" L "+(c+C-o)+","+(u+y-l)),o=((h<=c?h:c)+(h>=c?h:c))/2+C-o,l=((n<=u?n:u)+(n>=u?n:u))/2+b-l,n=d,(d=s.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",n),void 0!==r.dependencyLineZoneClass&&d.setAttribute("class",r.dependencyLineZoneClass),void 0!==r.dependencyLineZoneStyle&&d.setAttribute("style",r.dependencyLineZoneStyle),a.appendChild(d),(d=s.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",n),(void 0!==i.isEffortVirtual?!i.isEffortVirtual:void 0!==i.effort&&i.effort>0)?(n=r.dependencyLineClass,void 0!==i.dependencyLineClass&&(n=i.dependencyLineClass),void 0!==n&&d.setAttribute("class",n),n=r.dependencyLineStyle,void 0!==i.dependencyLineStyle&&(n=i.dependencyLineStyle)):(n=r.virtualEffortDependencyLineClass,void 0!==i.virtualEffortDependencyLineClass&&(n=i.virtualEffortDependencyLineClass),void 0!==n&&d.setAttribute("class",n),n=r.virtualEffortDependencyLineStyle,void 0!==i.virtualEffortDependencyLineStyle&&(n=i.virtualEffortDependencyLineStyle)),void 0!==n&&d.setAttribute("style",n),a.appendChild(d),(d=s.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",o),d.setAttribute("y",l-6),l=r.dependencyTextClass,void 0!==i.dependencyTextClass&&(l=i.dependencyTextClass),void 0!==l&&d.setAttribute("class",l),r=r.dependencyTextStyle,void 0!==i.dependencyTextStyle&&(r=i.dependencyTextStyle),d.setAttribute("style",r),void 0===(r=i.displayedText)&&(r=""),d.appendChild(s.createTextNode(r)),a.appendChild(d),a}},E=function(){return function(e,t){var i=e.pertChartView.ownerDocument,n=i.createElementNS("http://www.w3.org/2000/svg","title");return n.appendChild(d(i,void 0!==t.content?t.content:"")),n}},I=function(e,t,i,n){void 0!==e.pertChartView&&e.pertChartView.settings.itemPropertyChangeHandler(e,t,i,n)},A=function(e,t,i,n,s,r,a){e.addEventListener("mousedown",(function(i){0==i.button&&(r.draggingItem=t,r.dragType="Position",r.style.cursor=e.style.cursor,r.draggingInitialX=i.clientX,r.draggingInitialY=i.clientY,r.draggingInitialThumbXPosition=n,r.draggingInitialThumbYPosition=s,i.preventDefault())}),!0),void 0===r.draggableItems&&(r.draggableItems=[]);for(var o=!1,l=0;l<r.draggableItems.length;l++)if(r.draggableItems[l]==t){o=!0;break}o||(r.addEventListener("mousemove",(function(e){if(void 0!==r.draggingItem&&r.draggingItem==t&&"Position"==r.dragType){var n=e.clientX-r.draggingInitialX,s=e.clientY-r.draggingInitialY,o=e.clientX;if(void 0!==r.draggingItem){var l=r,d=0;if(l.offsetParent)do{d+=l.offsetLeft,l=l.offsetParent}while(l);(o-=d)<24?(o=r.chartContentContainer.scrollLeft,r.chartContentContainer.scrollLeft=r.chartContentContainer.scrollLeft-48,o-=r.chartContentContainer.scrollLeft,void 0!==r.draggingInitialThumbXPosition&&(r.draggingInitialThumbXPosition=r.draggingInitialThumbXPosition-o)):o>=r.chartContentContainer.clientWidth-24&&(o=r.chartContentContainer.scrollLeft,r.chartContentContainer.scrollLeft=r.chartContentContainer.scrollLeft+48,o=r.chartContentContainer.scrollLeft-o,void 0!==r.draggingInitialThumbXPosition&&(r.draggingInitialThumbXPosition=r.draggingInitialThumbXPosition+o))}if(e=e.clientY,void 0!==r.draggingItem){if(l=0,(o=r).offsetParent)do{l+=o.offsetTop,o=o.offsetParent}while(o);(e-=l)<24?(e=r.chartContentContainer.scrollTop,r.chartContentContainer.scrollTop=r.chartContentContainer.scrollTop-48,e-=r.chartContentContainer.scrollTop,void 0!==r.draggingInitialThumbYPosition&&(r.draggingInitialThumbYPosition=r.draggingInitialThumbYPosition-e)):e>=r.chartContentContainer.clientHeight-24&&(e=r.chartContentContainer.scrollTop,r.chartContentContainer.scrollTop=r.chartContentContainer.scrollTop+48,e=r.chartContentContainer.scrollTop-e,void 0!==r.draggingInitialThumbYPosition&&(r.draggingInitialThumbYPosition=r.draggingInitialThumbYPosition+e))}delete r.draggingItem,r.draggingInitialThumbXPosition+n<0&&(n=-r.draggingInitialThumbXPosition),r.draggingInitialThumbYPosition+s<0&&(s=-r.draggingInitialThumbYPosition),s=(r.draggingInitialThumbYPosition+s-a.chartMargin)/(a.itemHeight+a.dependencyTextBlockWidth/a.aspectRatio),a.snapRearrangedItemsToGuidelines&&(s=Math.round(s)),t.actualRowIndex=s,n=(r.draggingInitialThumbXPosition+n-a.chartMargin)/(a.itemWidth+a.dependencyTextBlockWidth),a.snapRearrangedItemsToGuidelines&&(n=Math.round(n)),t.actualColumnIndex=n,I(t,"actualRowIndex",!0,!1),I(t,"actualColumnIndex",!0,!1),void 0!==t.displayedColumnIndex&&delete t.displayedColumnIndex,void 0!==t.displayedRowIndex&&delete t.displayedRowIndex,V(t,i,r.chartContent,a,!1),r.draggingItem=t,r.draggingPerformed=!0}}),!0),document.addEventListener("mouseup",(function(e){0==e.button&&void 0!==r.draggingItem&&r.draggingItem==t&&"Position"==r.dragType&&(V(t,i,r.chartContent,a,!0),e=r.draggingItem,delete r.draggingItem,r.style.cursor="default",r.draggingPerformed&&(I(e,"actualColumnIndex",!0,!0),I(e,"actualRowIndex",!0,!0),delete r.draggingPerformed))}),!0),r.draggableItems.push(t))},V=function(e,t,i,n,s){var r=e.pertChartView.ownerDocument;if(s)void 0!==i.temporaryRectangle&&((r=i.chartArea).removeChild(i.temporaryRectangle),delete i.temporaryRectangle),setTimeout((function(){y(e.chartItem,e,n),f(t),setTimeout((function(){H(i,t,n,!0)}),0)}));else{void 0!==i.temporaryRectangle?s=i.temporaryRectangle:((s=r.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",0),s.setAttribute("y",0),s.setAttribute("width",n.shapeWidth),s.setAttribute("height",n.shapeHeight),s.setAttribute("rx",n.shapeWidth/10),s.setAttribute("ry",n.shapeHeight/10),void 0!==n.temporaryThumbClass&&s.setAttribute("class",n.temporaryThumbClass),s.setAttribute("style",n.temporaryThumbStyle),i.temporaryRectangle=s,(r=i.chartArea).appendChild(s)),r=m(e,n)+(n.itemWidth-n.shapeWidth)/2;var a=g(e,n)+(n.itemHeight-n.shapeHeight)/2;s.setAttribute("transform","translate("+r+", "+a+")"),setTimeout((function(){H(i,t,n,!1)}),0)}},H=function(e,t,i,n){var s=c(t,i);t=u(t,i),(n||s>e.clientWidth)&&(e.style.width=s+"px"),(n||t>e.clientHeight)&&(e.style.height=t+"px"),n&&e.chartArea.setAttribute("style","width: "+s+"px; height: "+t+"px")},L=function(e,t){for(var i=e.childNodes.length;i-- >0;)e.removeChild(e.childNodes[i]);e.appendChild(t)},F=function(e,t){for(var i in t)0!=i.indexOf("custom")&&0!=i.indexOf("description")||void 0===e[i]&&(e[i]=t[i])},O=function(e,t,i,n,s,r,a,o){var l=c(a,o={isExport:!0,canUserRearrangeItems:!1,isTaskEventToolTipVisible:!1,isDependencyToolTipVisible:!1,containerClass:o.containerClass,containerStyle:o.containerStyle,border:o.border,theme:o.theme,itemWidth:o.itemWidth,itemHeight:o.itemHeight,aspectRatio:o.aspectRatio,shapeWidth:o.shapeWidth,shapeHeight:o.shapeHeight,shapeClass:o.shapeClass,shapeStyle:o.shapeStyle,shapeCornerRadius:o.shapeCornerRadius,dependencyTextStyle:o.dependencyTextStyle,dependencyLineClass:o.dependencyLineClass,dependencyLineStyle:o.dependencyLineStyle,virtualEffortDependencyLineClass:o.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:o.virtualEffortDependencyLineStyle,dependencyTextBlockWidth:o.dependencyTextBlockWidth,chartMargin:0,target:o.target,timeSpanFormatter:o.timeSpanFormatter,taskEventTemplate:o.taskEventTemplate,dependencyLineTemplate:o.dependencyLineTemplate}),d=u(a,o);o.chartWidth=l+"px",o.chartHeight=d+"px";var h,p,m=l+2,g=(l=d+2,!1);if(null!=i&&void 0!==i.createElement)h=i;else{null!=i&&void 0!==i.focus?p=i:(p=window.open("",null!=i?i:"_blank",void 0!==n&&n&&(void 0===r||r)?"width=320,height=100,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),g=!0),h=p.document;try{var f=document.head.getElementsByTagName("link");for(i=0;i<f.length;i++){var v=f[i],y=h.adoptNode(v.cloneNode(!0));y.href=v.href,h.head.appendChild(y)}}catch(S){}}for(h.title=void 0!==e?e:"Exported chart"+(void 0!==n&&n?" (printable)":""),e=[],i=0;i<a.length;i++)F(v={content:(f=a[i]).content,displayedText:f.displayedText,isShapeVisible:f.isShapeVisible,shapeClass:f.shapeClass,shapeStyle:f.shapeStyle,dependencyTextStyle:f.dependencyTextStyle,displayedRowIndex:f.actualRowIndex,displayedColumnIndex:f.actualColumnIndex,isExported:!0},f),e.push(v),f.exportItem=v;for(i=0;i<a.length;i++)if(v=(f=a[i]).exportItem,void 0!==f.predecessors)for(v.predecessors=[],y=0;y<f.predecessors.length;y++)v.predecessors.push({item:(d=f.predecessors[y]).item.exportItem,content:d.content,displayedText:d.displayedText,effort:d.effort,isEffortVirtual:d.isEffortVirtual,dependencyLineClass:d.dependencyLineClass,dependencyLineStyle:d.dependencyLineStyle,virtualEffortDependencyLineClass:d.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:d.virtualEffortDependencyLineStyle,dependencyTextStyle:d.dependencyTextStyle});var C=h.createElement("p");C.innerHTML=void 0!==t?t:"",h.body.appendChild(C);var b=h.createElement("div");b.setAttribute("style","width: "+m+"px; height: "+l+"px");try{DlhSoft.Controls.Pert.PertChartView.initialize(b,e,o,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch(w){}setTimeout((function(){g&&h.body.setAttribute("style","margin: 0px");var e=h.createElement("div");e.appendChild(b),h.body.replaceChild(e,C),s&&(e.setAttribute("style","width: "+b.offsetHeight+"px; height: "+m+"px; overflow: hidden"),e=Math.round((b.offsetWidth-b.offsetHeight)/2),b.setAttribute("style","width: "+m+"px; transform: rotate(90deg) translateX("+e+"px) translateY("+e+"px); -webkit-transform: rotate(90deg) translateX("+e+"px) translateY("+e+"px)")),h.close(),void 0!==typeof p&&(p.focus(),void 0!==n&&n&&(p.print(),(void 0===r||r)&&p.close()))}),0)},P=function(e,t){if(void 0===e&&(e=0),null==(i=R(t)))return[];for(var i=[i],n=B(e,t),s=0;s<n.length;s++)i.push(n[s].dependentItem);return i},B=function(e,t){var i,n=R(t);if(null==n)return[];e:{for(i=t.length;i-- >0;){var s=t[i];if(0==z(s).length){i=s;break e}}i=null}if(null==i)return[];for(n=M(n,i),i=[],s=0;s<n.length;s++)i.push(n[s]);return i},M=function(e,t){if(null==e||null==t||e==t||void 0===t.predecessors)return[];var i,n=[],s=[],r=null;for(i=0;i<t.predecessors.length;i++)predecessorItem=t.predecessors[i],predecessorItem.dependentItem=t,void 0!==predecessorItem.item&&null!=(a=W(e,predecessorItem.item))&&((void 0===predecessorItem.isEffortVirtual||!predecessorItem.isEffortVirtual)&&predecessorItem.effort>0&&(a+=predecessorItem.effort),(null==r||a>=r)&&((null==r||a>r)&&(r=a,s=[]),s.push(predecessorItem)));for(i=0;i<s.length;i++){for(var a=M(e,(r=s[i]).item),o=0;o<a.length;o++)n.push(a[o]);n.push(r)}return n},R=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(void 0===i.predecessors||0==i.predecessors.length)return i}return null},W=function(e,t){if(null==e||null==t)return null;if(e==t)return 0;for(var i=null,n=z(e),s=0;s<n.length;s++){var r=n[s],a=W(r.dependentItem,t);null!=a&&((a+=(void 0===predecessorItem.isEffortVirtual||!predecessorItem.isEffortVirtual)&&r.predecessorItem.effort>0?r.predecessorItem.effort:0)<0&&(a=0),(null==i||a>i)&&(i=a))}return i},z=function(e){for(var t=[],i=e.pertChartView.items,n=0;n<i.length;n++){var s=i[n];if(void 0!==s.predecessors)for(var r=0;r<s.predecessors.length;r++){var a=s.predecessors[r];void 0!==a.item&&a.item==e&&t.push({dependentItem:s,predecessorItem:a})}}return t},N=function(e){for(var t=null,i=0;i<e.length;i++)(null==t||e[i]>t)&&(t=e[i]);return t},_=function(e,i,n){for(var s=0;s<i.length;s++)i[s].pertChartView=e;e.items=i,e.settings=n,e.refresh=function(){t(e)},e.refreshItems=function(){for(var e=0;e<i.length;e++){var t=i[e];C(t),S(t)}},e.refreshChartItems=function(){for(var e=0;e<i.length;e++)C(i[e])},e.refreshItem=b,e.refreshChartItem=C,e.refreshPredecessorItems=S,e.refreshItemGraph=w,e.scrollToItem=function(e){var t=m(e,n),i=t-e.pertChartView.chartContentContainer.scrollLeft;i<0?e.pertChartView.chartContentContainer.scrollLeft=t:i>e.pertChartView.chartContentContainer.clientWidth-e.pertChartView.settings.itemWidth&&(e.pertChartView.chartContentContainer.scrollLeft=t-(e.pertChartView.chartContentContainer.clientWidth-e.pertChartView.settings.itemWidth)),(i=(t=g(e,n))-e.pertChartView.chartContentContainer.scrollTop)<0?e.pertChartView.chartContentContainer.scrollTop=t:i>e.pertChartView.chartContentContainer.clientHeight-e.pertChartView.settings.itemHeight&&(e.pertChartView.chartContentContainer.scrollTop=t-(e.pertChartView.chartContentContainer.clientHeight-e.pertChartView.settings.itemHeight))},e.scrollToLeft=function(){e.chartContentContainer.scrollLeft=0},e.scrollToRight=function(){e.chartContentContainer.scrollLeft=e.chartContent.clientWidth},e.scrollToTop=function(){e.chartContentContainer.scrollTop=0},e.scrollToBottom=function(){e.chartContentContainer.scrollTop=e.chartContent.clientHeight},e.getChartWidth=function(){return c(i,n)},e.getChartHeight=function(){return u(i,n)},e.getItemTop=function(e){return g(e,n)},e.getItemLeft=function(e){return m(e,n)},e.onItemPropertyChanged=I,e.initializeTasEventkDraggingThumbs=function(t,i,n,s){A(t,i,e.items,n,s,e,e.settings)},e.exportContent=function(e,t){void 0===e&&(e={}),O(e.title,e.preparingMessage,t,!1,e.rotate,!1,i,n)},e.print=function(e){void 0===e&&(e={}),O(e.title,e.preparingMessage,null,!0,e.rotate,e.autoClose,i,n)},e.isItemCritical=function(e,t){return P(t,i).indexOf(e)>=0},e.isDependencyCritical=function(e,t){return B(t,i).indexOf(e)>=0},e.getCriticalItems=function(e){return P(e,i)},e.getCriticalDependencies=function(e){return B(e,i)},e.repositionEnds=function(){if(0!=i.length){for(var e=!1,t=0;t<i.length;t++){for(var n=i[t],s=0,r=0;r<i.length;r++){var a=i[r];if(void 0!==a.predecessors){for(var o=0;o<a.predecessors.length&&!(void 0!==a.predecessors[o].item&&a.predecessors[o].item==n&&++s>1);o++);if(s>1)break}}s>1&&(e=!0)}(t=i[0]).displayedRowIndex=e?.5:0,(n=i[i.length-1]).displayedRowIndex=e?.5:0,w(t),w(n)}}};return{initialize:e,initializeItems:n,refresh:t,getDefaultStyleDefinitionTemplate:T,getDefaultTaskEventTemplate:D,getDefaultItemTemplate:x,getDefaultDependencyLineTemplate:k,getDefaultPredecessorItemTemplate:E,initializeTaskEventDraggingThumbs:function(e,t,i,n){t.pertChartView.initializeTaskEventDraggingThumbs(e,t,i,n)},defaultTimeSpanFormatter:h}}()),null==DlhSoft.Controls.Pert.NetworkDiagramView&&(DlhSoft.Controls.Pert.NetworkDiagramView=function(){var e=function(e,t,r,a){var o=["DlhSoft.Controls.Pert","NetworkDiagramView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];if(DlhSoft[o[5]][o[4]](e,o[0],o[1],o[2],o[3],a,r),e.isInitializing=!0,void 0!==e.items)for(a=0;a<e.items.length;a++)delete e.items[a].successors;"object"!=typeof r&&(r={}),n(t,r),i(r,t,e),X(e,t,r),u(t,r),s(t);var d=l(e,t,r),h=e.ownerDocument;(a=h.createElement("div")).setAttribute("style","font-family: Arial; font-size: small; overflow: auto"),o=h.createElement("div"),void 0!==r.containerClass&&o.setAttribute("class",r.containerClass),void 0!==r.containerStyle&&o.setAttribute("style",r.containerStyle),a.appendChild(o),(C=h.createElement("div")).setAttribute("style","border: solid 1px "+r.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden"),o.appendChild(C),(o=h.createElement("div")).setAttribute("style","overflow: auto"),C.appendChild(o);var c=h.createElement("div");c.setAttribute("style","overflow: "+(void 0!==r.isExport&&r.isExport?"hidden":"auto")+"; height: "+d),o.appendChild(c);var y,C=p(t,r),b=m(t,r),S=h.createElement("div");S.setAttribute("style","float: left; overflow: hidden; width: "+C+"px; height: "+b+"px"),c.appendChild(S),(d=h.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("style","width: "+C+"px; height: "+b+"px"),C=r.styleDefinitionTemplate(),d.appendChild(C),d.chartAreaDefinitions=C,d.addEventListener("mousedown",C=function(){setTimeout((function(){try{var e=S.chartArea,t=e.chartAreaDefinitions;e.removeChild(t),e.childNodes.length>0?e.insertBefore(t,e.childNodes[0]):e.appendChild(t)}catch(a){}}),0)},!0),h.addEventListener("mouseup",C,!0),S.appendChild(d),S.chartArea=d,setTimeout((function(){y=e.clientHeight}),0),void 0!==e.heightUpdateTimer&&clearInterval(e.heightUpdateTimer),e.heightUpdateTimer=setInterval((function(){try{if(!(e.clientHeight<=0)){var i=e.clientHeight;if(i!=y){var n=l(e,t,r);c.style.height=n,y=i}}}catch(d){try{clearInterval(e.heightUpdateTimer)}catch(h){}}}),100);var w=function(e,i,n,s){var a;if(r.mouseHandler||r.mouseMoveHandler&&"mousemove"==s||r.mouseDownHandler&&"mousedown"==s||r.clickHandler&&"click"==s||r.doubleClickHandler&&"dblclick"==s){var o=e.which;!o&&e.button&&(1&e.button?o=1:4&e.button?o=2:2&e.button&&(o=3)),a=n.getBoundingClientRect();var l=h.body,d=h.documentElement;for(n=a.left+(window.pageXOffset||d.scrollLeft||l.scrollLeft)-(d.clientLeft||l.clientLeft||0),a=Math.round(a.top+(window.pageYOffset||d.scrollTop||l.scrollTop)-(d.clientTop||l.clientTop||0)),n=Math.round(n),n=e.pageX-n,a=e.pageY-a,l=0;l<t.length;l++){var c=f(d=t[l],r),u=v(d,r);n>=c&&n<c+r.itemWidth&&a>=u&&a<u+r.itemHeight&&(r.mouseHandler&&r.mouseHandler(s,d,o,i,e),r.mouseMoveHandler&&"mousemove"==s&&r.mouseMoveHandler(d),r.mouseDownHandler&&"mousedown"==s&&r.mouseDownHandler(d,o),r.itemClickHandler&&"click"==s&&r.itemClickHandler(d),r.itemDoubleClickHandler&&"dblclick"==s&&r.itemDoubleClickHandler(d))}}};return S.addEventListener("mousemove",(function(e){w(e,0,S,"mousemove")})),S.addEventListener("mousedown",(function(e){w(e,1,S,"mousedown")})),S.addEventListener("click",(function(e){w(e,1,S,"click")})),S.addEventListener("dblclick",(function(e){w(e,2,S,"dblclick")})),S.addEventListener("click",(function(e){e.srcElement&&"rect"!=e.srcElement.nodeName&&e.stopPropagation()}),!0),S.container=c,e.chartContainer=o,e.chartContent=S,e.chartContentContainer=c,c.isInitializing=!0,O(e,a),g(S,d,t,r),c.isInitializing=!1,e.isInitializing=!1,e.isInitialized=!0,e},t=function(t){e(t,t.items,t.settings,t.license)},i=function(e,t,i){if(function(e){void 0===e.dateTimeFormatter&&(e.dateTimeFormatter=h),void 0===e.timeSpanFormatter&&(e.timeSpanFormatter=c),void 0===e.itemPropertyChangeHandler&&(e.itemPropertyChangeHandler=function(){}),void 0===e.target&&(e.target="Standard"),void 0===e.theme&&(e.theme="Modern")}(e),void 0===e.border)switch(e.theme){default:e.border="#e0e0e0";break;case"ModernBordered":case"Aero":e.border="#9a9a9a"}if(void 0===e.canUserRearrangeItems&&(e.canUserRearrangeItems=!0),void 0===e.snapRearrangedItemsToGuidelines&&(e.snapRearrangedItemsToGuidelines=!0),void 0===e.itemWidth&&(e.itemWidth=220),void 0===e.itemHeight&&(e.itemHeight=100),void 0===e.aspectRatio&&(e.aspectRatio=1),void 0===e.shapeWidth&&(e.shapeWidth=212),void 0===e.shapeHeight&&(e.shapeHeight=92),void 0===e.styleDefinitionTemplate&&(e.styleDefinitionTemplate=D(i,e)),void 0===e.shapeStyle&&null==e.shapeClass&&(e.shapeStyle="fill: White; stroke: #0000ff; stroke-width: 1px"),void 0===e.milestoneStyle&&null==e.milestoneClass&&(e.milestoneStyle="fill: White; stroke: #000000; stroke-width: 1px"),void 0===e.temporaryThumbStyle&&null==e.temporaryThumbClass&&(e.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; "),void 0===e.dependencyLineStyle&&null==e.dependencyLineClass&&(e.dependencyLineStyle="stroke: #8080FF; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)"),void 0===e.dependencyLineZoneStyle&&null==e.dependencyLineZoneClass&&(e.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none"),void 0===e.taskTemplate&&(e.taskTemplate=E()),void 0===e.minDependencyLineLength&&(e.minDependencyLineLength=48),void 0===e.diagramMargin&&(e.diagramMargin=16),void 0===e.isTaskToolTipVisible)switch(e.target){default:e.isTaskToolTipVisible=!0;break;case"Phone":e.isTaskToolTipVisible=!1}void 0===e.itemTemplate&&(e.itemTemplate=k(e)),void 0===e.dependencyLineTemplate&&(e.dependencyLineTemplate=I()),void 0===e.isDependencyToolTipVisible&&(e.isDependencyToolTipVisible=e.isTaskToolTipVisible),void 0===e.predecessorItemTemplate&&(e.predecessorItemTemplate=A(e))},n=function(e,t){for(var i=new Date,n=0;n<e.length;n++){var s=e[n];if("string"==typeof s&&(e[n]=s={content:s}),"string"==typeof s.earlyStart){try{s.earlyStart=Date.parse(s.earlyStart)}catch(l){s.earlyStart=new Date(parseInt(s.earlyStart))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(s.earlyStart=new Date(s.earlyStart.valueOf()+6e4*i.getTimezoneOffset()))}if("string"==typeof s.earlyFinish){try{s.earlyFinish=Date.parse(s.earlyFinish)}catch(Y){s.earlyFinish=new Date(parseInt(s.earlyFinish))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(s.earlyFinish=new Date(s.earlyFinish.valueOf()+6e4*i.getTimezoneOffset()))}if("string"==typeof s.lateStart){try{s.lateStart=Date.parse(s.lateStart)}catch(G){s.lateStart=new Date(parseInt(s.lateStart))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(s.lateStart=new Date(s.lateStart.valueOf()+6e4*i.getTimezoneOffset()))}if("string"==typeof s.lateFinish){try{s.lateFinish=Date.parse(s.lateFinish)}catch(X){s.lateFinish=new Date(parseInt(s.lateFinish))}(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(s.earlyFinish=new Date(s.earlyFinish.valueOf()+6e4*i.getTimezoneOffset()))}if("string"==typeof s.effort)try{s.effort=parseInt(s.effort)}catch(d){}if("string"==typeof s.isMilestone&&(s.isMilestone=s.isMilestone.toLowerCase()==trueStringValue),"string"==typeof s.slack)try{s.slack=parseInt(s.slack)}catch(h){}if(void 0!==s.predecessors){"string"==typeof s.predecessors&&(s.predecessors=s.predecessors.split(","));for(var r=0;r<s.predecessors.length;r++){var a=s.predecessors[r];if("string"==typeof a&&(s.predecessors[r]=a={item:a}),"string"==typeof a.item){var o=parseInt(a.item)-1;a.item=o>=0&&o<e.length?e[o]:null}"string"==typeof a.lag&&(a.lag=parseFloat(a.lag))}}void 0!==s.displayedRowIndex&&(s.actualRowIndex=s.displayedRowIndex),void 0!==s.displayedColumnIndex&&(s.actualColumnIndex=s.displayedColumnIndex),void 0===s.actualRowIndex&&(s.actualRowIndex=0),void 0===s.actualColumnIndex&&(s.actualColumnIndex=0)}},s=function(e){e.positionedItems=[],e.maxRowIndex=null;for(var t=0;t<e.length;t++){var i=e[t],n=e;if(void 0===i.displayedRowIndex){var s;if(void 0!==i.predecessors){s=n.positionedItems;for(var l=[],d=i.predecessors,h=0;h<s.length;h++)for(var c=s[h],u=0;u<d.length;u++)if(d[u].item==c){l.push(c);break}s=l}else s=null;if(null!=s){for(l=s,d=[],h=0;h<l.length;h++)d.indexOf(c=l[h].actualRowIndex)<0&&d.push(c);l=d}else l=null;if(l=null!=l&&l.length>0?_(l):null!=n.maxRowIndex?n.maxRowIndex+1:0,d=d=void 0,void 0===i.displayedColumnIndex){if(d=(d=r(n.positionedItems,l)).length>0?_(d)+1:0,null!=(h=null!=s?r(s,l):null)&&h.length>0){for(c=null,u=0;u<h.length;u++)(null==c||h[u]<c)&&(c=h[u]);h=c+1}else h=null;for(null!=h&&h!=d&&(l++,d=null!=(s=null!=s?a(s):null)&&s.length>0?_(s)+1:0),i.actualColumnIndex=d;o(n.positionedItems,l,d);)l++}else for(;!((d=(d=r(n.positionedItems,l)).length>0?_(d)+1:0)<=i.actualColumnIndex);l++);i.actualRowIndex=l}else void 0===i.displayedColumnIndex&&(s=a(n.positionedItems),i.actualColumnIndex=s.length>0?_(s)+1:0);n.positionedItems.push(i),(null==n.maxRowIndex||i.actualRowIndex>n.maxRowIndex)&&(n.maxRowIndex=i.actualRowIndex)}},r=function(e,t){for(var i=[],n=0;n<e.length;n++){var s=e[n];s.actualRowIndex==t&&i.indexOf(s=s.actualColumnIndex)<0&&i.push(s)}return i},a=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i].actualColumnIndex;t.indexOf(n)<0&&t.push(n)}return t},o=function(e,t,i){for(var n=0;n<e.length;n++){var s=e[n];if(s.actualRowIndex==t&&s.actualColumnIndex==i)return!0}return!1},l=function(e,t,i){var n;if(e.isContentHeightInitialized&&e.isContentHeightAuto)n=t.length>0?"auto":i.itemHeight+"px";else{var s=e.clientHeight-2;s<0&&(s=0),n=s+"px",s<i.itemHeight&&(e.isContentHeightInitialized||(e.isContentHeightAuto=!0),n=t.length>0?"auto":i.itemHeight+"px"),e.isContentHeightInitialized=!0}return n},d=function(e,t){var i=e.createElement("span");return i.innerHTML=t,i},h=function(e){var t;t=e.getFullYear();var i=e.getMonth()+1;i<10&&(i="0"+i);var n=e.getDate();return n<10&&(n="0"+n),t=i+"/"+n+"/"+t,(i=e.getHours())<10&&(i="0"+i.toString()),(e=e.getMinutes())<10&&(e="0"+e.toString()),t+" "+i+":"+e},c=function(e){return Math.ceil(e/36e5*1e4/100)/100+"h"},u=function(e){var t,i,n=new Date(864e5*Math.floor((new Date).valueOf()/864e5)),s=new Date;for(i=0;i<e.length;i++){(t=e[i]).index=i;var r=t.earlyStart,a=t.earlyFinish,o=t.lateStart,l=t.lateFinish;void 0===t.earlyStart&&(t.earlyStart=n),void 0===t.earlyFinish&&(t.earlyFinish=void 0!==t.isMilestone&&t.isMilestone?t.earlyStart:new Date(n.valueOf()+864e5)),void 0===t.lateStart&&(t.lateStart=n),void 0===t.lateFinish&&(t.lateFinish=void 0!==t.isMilestone&&t.isMilestone?t.lateStart:new Date(n.valueOf()+864e5)),(void 0===t.isRelativeToTimezone||t.isRelativeToTimezone)&&(t.earlyStart=new Date(t.earlyStart.valueOf()-6e4*s.getTimezoneOffset()),t.earlyFinish=new Date(t.earlyFinish.valueOf()-6e4*s.getTimezoneOffset()),t.lateStart=new Date(t.lateStart.valueOf()-6e4*s.getTimezoneOffset()),t.lateFinish=new Date(t.lateFinish.valueOf()-6e4*s.getTimezoneOffset()),t.isRelativeToTimezone=!1),void 0===t.effort&&(t.effort=0),void 0===t.slack&&(t.slack=0),void 0===t.isMilestone&&(t.isMilestone=!1),(void 0===r||t.earlyStart.valueOf()!=r.valueOf())&&V(t,"earlyStart",!1,!0),(void 0===a||t.earlyFinish.valueOf()!=a.valueOf())&&V(t,"earlyFinish",!1,!0),(void 0===o||t.lateStart.valueOf()!=o.valueOf())&&V(t,"lateStart",!1,!0),(void 0===l||t.lateFinish.valueOf()!=l.valueOf())&&V(t,"lateFinish",!1,!0)}},p=function(e,t){for(var i=0,n=0;n<e.length;n++)i=Math.max(i,e[n].actualColumnIndex);return t.itemWidth+i*(t.itemWidth+t.minDependencyLineLength)+2*t.diagramMargin},m=function(e,t){for(var i=0,n=0;n<e.length;n++)i=Math.max(i,e[n].actualRowIndex);return t.itemHeight+i*(t.itemHeight+t.minDependencyLineLength/t.aspectRatio)+2*t.diagramMargin},g=function(e,t,i,n){for(e=0;e<i.length;e++){var s=i[e],r=f(s,n),a=v(s,n);t.appendChild(C(s,r,a,n))}},f=function(e,t){return void 0!==e.displayedColumnIndex&&(e.actualColumnIndex=e.displayedColumnIndex),Math.max(0,t.diagramMargin+e.actualColumnIndex*(t.itemWidth+t.minDependencyLineLength))},v=function(e,t){return void 0!==e.displayedRowIndex&&(e.actualRowIndex=e.displayedRowIndex),Math.max(0,t.diagramMargin+e.actualRowIndex*(t.itemHeight+t.minDependencyLineLength/t.aspectRatio))},y=function(e){for(var t,i,n=[],s=0;s<e.length;s++){var r=e[s];if(void 0!==r.predecessors&&r.predecessors.length>0)for(var a=0;a<r.predecessors.length;a++){var o=r.predecessors[a].item;if(void 0!==o){for(t=!0,i=0;i<n;i++)if(o==n[i]){t=!1;break}t&&(b(o.chartItem,o,o.networkDiagramView.settings),t=f(o,o.networkDiagramView.settings),i=v(o,o.networkDiagramView.settings),o.chartItem.setAttribute("transform","translate("+t+", "+i+")"),n.push(o))}}if(void 0!==r.predecessors&&r.predecessors.length>0){for(t=!0,i=0;i<n;i++)if(void 0!==r&&r==n[i]){t=!1;break}t&&(b(r.chartItem,r,r.networkDiagramView.settings),t=f(r,r.networkDiagramView.settings),i=v(r,r.networkDiagramView.settings),r.chartItem.setAttribute("transform","translate("+t+", "+i+")"),n.push(r))}}},C=function(e,t,i,n){var s=e.networkDiagramView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");return e.chartItem=s,s.setAttribute("style","-ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),s.setAttribute("transform","translate("+t+", "+i+")"),b(s,e,n),s},b=function(e,t,i){for(var n=e.childNodes.length;n-- >0;)e.removeChild(e.childNodes[n]);if(void 0===t.isShapeVisible||t.isShapeVisible){if(n=i.taskTemplate,void 0!==t.taskTemplate&&(n=t.taskTemplate),n=n(t),e.appendChild(n),void 0!==i.internalExtraTaskTemplate){var s=i.internalExtraTaskTemplate(t);null!=s&&e.appendChild(s)}if(void 0!==i.extraTaskTemplate&&null!=(s=i.extraTaskTemplate(t))&&e.appendChild(s),i.isTaskToolTipVisible&&(s=i.itemTemplate,void 0!==t.template&&(s=t.template),n.appendChild(s(t))),void 0!==t.predecessors)for(n=0;n<t.predecessors.length;n++)if(s=t.predecessors[n],!((void 0===t.networkDiagramView||t.networkDiagramView.items.indexOf(s.item))<0||void 0!==s.item.isShapeVisible&&!s.item.isShapeVisible)){var r=i.dependencyLineTemplate(t,s);if(r.predecessorIndex=n,function(e){r.addEventListener("click",(function(n){i.dependencyLineClickHandler&&i.dependencyLineClickHandler(e,t,n)})),r.addEventListener("dblclick",(function(n){i.dependencyLineDoubleClickHandler&&i.dependencyLineDoubleClickHandler(e,t,n)}))}(s),e.appendChild(r),i.isDependencyToolTipVisible){var a=i.predecessorItemTemplate;void 0!==s.template&&(a=s.template),r.appendChild(a(t,s))}}}},S=function(e){void 0===e.isWaitingToRefreshChartItem&&(e.isWaitingToRefreshChartItem=!0,setTimeout((function(){b(e.chartItem,e,e.networkDiagramView.settings);var t=f(e,e.networkDiagramView.settings),i=v(e,e.networkDiagramView.settings);e.chartItem.setAttribute("transform","translate("+t+", "+i+")"),delete e.isWaitingToRefreshChartItem}),0))},w=function(e){S(e)},T=function(e){void 0===e.isWaitingToRefreshPredecessorItems&&(e.isWaitingToRefreshPredecessorItems=!0,setTimeout((function(){y(e.networkDiagramView.items),delete e.isWaitingToRefreshPredecessorItems}),0))},x=function(e){void 0!==e.isWaitingToRefreshChartItem||void 0!==e.isWaitingToRefreshPredecessorItems?(void 0===e.isWaitingToRefreshChartItem&&S(e),void 0===e.isWaitingToRefreshPredecessorItems&&T(e)):(e.isWaitingToRefreshChartItem=!0,e.isWaitingToRefreshPredecessorItems=!0,setTimeout((function(){b(e.chartItem,e,e.networkDiagramView.settings);var t=f(e,e.networkDiagramView.settings),i=v(e,e.networkDiagramView.settings);e.chartItem.setAttribute("transform","translate("+t+", "+i+")"),y(e.networkDiagramView.items),delete e.isWaitingToRefreshChartItem,delete e.isWaitingToRefreshPredecessorItems}),0))},D=function(e){return function(){var t=e.ownerDocument,i=t.createElementNS("http://www.w3.org/2000/svg","defs"),n=t.createElementNS("http://www.w3.org/2000/svg","marker");return n.setAttribute("id","ArrowMarker"),n.setAttribute("viewBox","0 0 10 10"),n.setAttribute("refX","0"),n.setAttribute("refY","5"),n.setAttribute("markerUnits","strokeWidth"),n.setAttribute("markerWidth","5"),n.setAttribute("markerHeight","4"),n.setAttribute("orient","auto"),(t=t.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("fill","#8080ff"),t.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),n.appendChild(t),i.appendChild(n),i}},k=function(){return function(e){var t=e.networkDiagramView.ownerDocument,i=t.createElementNS("http://www.w3.org/2000/svg","title");return i.appendChild(d(t,e.content)),i}},E=function(e,t,i){return function(n){var s=void 0!==t?t:n.networkDiagramView,r=void 0!==i?i:s.settings,a=void 0!==e?e:s.items,o=s.ownerDocument,l=function(e){var t=e.networkDiagramView.ownerDocument;for(void 0===e.chartItemArea&&(e.chartItemArea=t.createElementNS("http://www.w3.org/2000/svg","g")),t=e.chartItemArea.childNodes.length;t-- >0;)e.chartItemArea.removeChild(e.chartItemArea.childNodes[t]);return e.chartItemArea}(n),d=(r.itemWidth-r.shapeWidth)/2,h=d+r.shapeWidth,c=(r.itemHeight-r.shapeHeight)/2,u=c+r.shapeHeight,p=0,m=r.shapeHeight,g=r.shapeWidth;n.isMilestone&&(d+=p=g/16,h-=p,g-=2*p),n.isMilestone&&((y=o.createElementNS("http://www.w3.org/2000/svg","polygon")).setAttribute("points",d+","+c+" "+(d-p)+","+(c+u)/2+" "+d+","+u+" "+h+","+u+" "+(h+p)+","+(c+u)/2+" "+h+","+c),p=r.milestoneClass,void 0!==n.milestoneClass&&(p=n.milestoneClass),void 0!==p?y.setAttribute("class",p):(p=r.milestoneStyle,void 0!==n.milestoneStyle&&(p=n.milestoneStyle),void 0!==p&&y.setAttribute("style",p)),l.appendChild(y)),(y=o.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",d),y.setAttribute("y",c),y.setAttribute("width",Math.max(0,h-d-1)),y.setAttribute("height",Math.max(0,u-c-1)),p=r.shapeClass,void 0!==n.shapeClass&&(p=n.shapeClass),void 0!==p?y.setAttribute("class",p):(p=r.shapeStyle,void 0!==n.shapeStyle&&(p=n.shapeStyle),void 0!==p&&y.setAttribute("style",p)),l.appendChild(y),(p=o.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",d),p.setAttribute("y1",c+3*m/8),p.setAttribute("x2",h-1),p.setAttribute("y2",c+3*m/8),y=r.shapeClass,void 0!==n.shapeClass&&(y=n.shapeClass),void 0!==y&&p.setAttribute("class",y),y=r.shapeStyle,void 0!==n.shapeStyle&&(y=n.shapeStyle),void 0!==y&&p.setAttribute("style",y),l.appendChild(p),(p=o.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",d),p.setAttribute("y1",u-3*m/8),p.setAttribute("x2",h-1),p.setAttribute("y2",u-3*m/8),y=r.shapeClass,void 0!==n.shapeClass&&(y=n.shapeClass),void 0!==y&&p.setAttribute("class",y),y=r.shapeStyle,void 0!==n.shapeStyle&&(y=n.shapeStyle),void 0!==y&&p.setAttribute("style",y),l.appendChild(p),(p=o.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",d+3*g/8),p.setAttribute("y1",c),p.setAttribute("x2",d+3*g/8),p.setAttribute("y2",c+3*m/8),y=r.shapeClass,void 0!==n.shapeClass&&(y=n.shapeClass),void 0!==y&&p.setAttribute("class",y),y=r.shapeStyle,void 0!==n.shapeStyle&&(y=n.shapeStyle),void 0!==y&&p.setAttribute("style",y),l.appendChild(p),(p=o.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",h-3*g/8),p.setAttribute("y1",c),p.setAttribute("x2",h-3*g/8),p.setAttribute("y2",c+3*m/8),y=r.shapeClass,void 0!==n.shapeClass&&(y=n.shapeClass),void 0!==y&&p.setAttribute("class",y),y=r.shapeStyle,void 0!==n.shapeStyle&&(y=n.shapeStyle),void 0!==y&&p.setAttribute("style",y),l.appendChild(p),(p=o.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",d+3*g/8),p.setAttribute("y1",u),p.setAttribute("x2",d+3*g/8),p.setAttribute("y2",u-3*m/8),y=r.shapeClass,void 0!==n.shapeClass&&(y=n.shapeClass),void 0!==y&&p.setAttribute("class",y),y=r.shapeStyle,void 0!==n.shapeStyle&&(y=n.shapeStyle),void 0!==y&&p.setAttribute("style",y),l.appendChild(p),(p=o.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",h-3*g/8),p.setAttribute("y1",u),p.setAttribute("x2",h-3*g/8),p.setAttribute("y2",u-3*m/8),y=r.shapeClass,void 0!==n.shapeClass&&(y=n.shapeClass),void 0!==y&&p.setAttribute("class",y),y=r.shapeStyle,void 0!==n.shapeStyle&&(y=n.shapeStyle),void 0!==y&&p.setAttribute("style",y),l.appendChild(p),(y=o.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",(d+h)/2),y.setAttribute("y",u-3*m/8-6),y.setAttribute("style","font-weight: bold; text-anchor: middle"),void 0===(p=n.displayedText)&&(p=""),y.appendChild(o.createTextNode(p)),l.appendChild(y);var y=(p=function(e){var t;return(t=(e=r.dateTimeFormatter(new Date(e.valueOf()+6e4*(new Date).getTimezoneOffset()))).indexOf(" "))>=0?(value1=e.substr(0,t),value2=e.substr(t+1)):(value1=e,value2=""),[value1,value2]})(n.earlyStart),C=o.createElementNS("http://www.w3.org/2000/svg","text");return C.setAttribute("x",d+3*g/8/2),C.setAttribute("y",u-5*m/8-20),C.setAttribute("style","text-anchor: middle"),C.appendChild(o.createTextNode(y[0])),l.appendChild(C),(C=o.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",d+3*g/8/2),C.setAttribute("y",u-5*m/8-4),C.setAttribute("style","text-anchor: middle"),C.appendChild(o.createTextNode(y[1])),l.appendChild(C),y=r.timeSpanFormatter(n.effort),(C=o.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",(d+h)/2),C.setAttribute("y",u-5*m/8-12),C.setAttribute("style","text-anchor: middle"),C.appendChild(o.createTextNode(y)),l.appendChild(C),y=p(n.earlyFinish),(C=o.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",h-3*g/8/2),C.setAttribute("y",u-5*m/8-20),C.setAttribute("style","text-anchor: middle"),C.appendChild(o.createTextNode(y[0])),l.appendChild(C),(C=o.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",h-3*g/8/2),C.setAttribute("y",u-5*m/8-4),C.setAttribute("style","text-anchor: middle"),C.appendChild(o.createTextNode(y[1])),l.appendChild(C),y=p(n.lateStart),(m=o.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",d+3*g/8/2),m.setAttribute("y",u-20),m.setAttribute("style","text-anchor: middle"),m.appendChild(o.createTextNode(y[0])),l.appendChild(m),(m=o.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",d+3*g/8/2),m.setAttribute("y",u-4),m.setAttribute("style","text-anchor: middle"),m.appendChild(o.createTextNode(y[1])),l.appendChild(m),y=r.timeSpanFormatter(n.slack),(m=o.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",(d+h)/2),m.setAttribute("y",u-12),m.setAttribute("style","text-anchor: middle"),m.appendChild(o.createTextNode(y)),l.appendChild(m),y=p(n.lateFinish),(m=o.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",h-3*g/8/2),m.setAttribute("y",u-20),m.setAttribute("style","text-anchor: middle"),m.appendChild(o.createTextNode(y[0])),l.appendChild(m),(m=o.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",h-3*g/8/2),m.setAttribute("y",u-4),m.setAttribute("style","text-anchor: middle"),m.appendChild(o.createTextNode(y[1])),l.appendChild(m),r.canUserRearrangeItems&&((o=o.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",d),o.setAttribute("y",c),o.setAttribute("width",Math.max(0,h-d-1)),o.setAttribute("height",Math.max(0,u-c-1)),o.setAttribute("style","fill: White; fill-opacity: 0; cursor: move"),l.appendChild(o),H(o,n,a,f(n,r),v(n,r),s,r)),l}},I=function(e,t){return function(e,i){var n,s=e.networkDiagramView,r=void 0!==t?t:s.settings,a=s.ownerDocument;s=a.createElementNS("http://www.w3.org/2000/svg","g"),n="M ";var o=f(e,r)-2,l=v(e,r)-2,d=f(i.item,r),h=v(i.item,r),c=f(e,r),u=v(e,r),p=Math.abs(c-d),m=Math.abs(u-h),g=r.shapeWidth+2,y=r.shapeHeight+2,C=g/2,b=y/2,S=Math.max(g,y);return m=m<4*S,p<S?n=h<=u?n+(d+C-o+",")+(h+y-l)+" L "+(c+C-o)+","+(u-l):n+(d+C-o+",")+(h-l)+" L "+(c+C-o)+","+(u+y-l):(n=d<=c?n+(d+g-o+",")+(h+b-l):n+(d-o+",")+(h+b-l),n=m?d<=c?n+" L "+(c-o)+","+(u+b-l):n+" L "+(c+g-o)+","+(u+b-l):h<=u?n+" L "+(c+C-o)+","+(u-l):n+" L "+(c+C-o)+","+(u+y-l)),(o=a.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",n),void 0!==r.dependencyLineZoneClass&&o.setAttribute("class",r.dependencyLineZoneClass),void 0!==r.dependencyLineZoneStyle&&o.setAttribute("style",r.dependencyLineZoneStyle),s.appendChild(o),(a=a.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",n),n=r.dependencyLineClass,void 0!==i.dependencyLineClass&&(n=i.dependencyLineClass),void 0!==n&&a.setAttribute("class",n),r=r.dependencyLineStyle,void 0!==i.dependencyLineStyle&&(r=i.dependencyLineStyle),void 0!==r&&a.setAttribute("style",r),s.appendChild(a),s}},A=function(){return function(e,t){var i=e.networkDiagramView.ownerDocument,n=i.createElementNS("http://www.w3.org/2000/svg","title");return n.appendChild(d(i,t.item.displayedText+" - "+e.displayedText)),n}},V=function(e,t,i,n){void 0!==e.networkDiagramView&&e.networkDiagramView.settings.itemPropertyChangeHandler(e,t,i,n)},H=function(e,t,i,n,s,r,a){e.addEventListener("mousedown",(function(i){0==i.button&&(r.draggingItem=t,r.dragType="Position",r.style.cursor=e.style.cursor,r.draggingInitialX=i.clientX,r.draggingInitialY=i.clientY,r.draggingInitialThumbXPosition=n,r.draggingInitialThumbYPosition=s,i.preventDefault())}),!0),void 0===r.draggableItems&&(r.draggableItems=[]);for(var o=!1,l=0;l<r.draggableItems.length;l++)if(r.draggableItems[l]==t){o=!0;break}o||(r.addEventListener("mousemove",(function(e){if(void 0!==r.draggingItem&&r.draggingItem==t&&"Position"==r.dragType){var n=e.clientX-r.draggingInitialX,s=e.clientY-r.draggingInitialY,o=e.clientX;if(void 0!==r.draggingItem){var l=r,d=0;if(l.offsetParent)do{d+=l.offsetLeft,l=l.offsetParent}while(l);(o-=d)<24?(o=r.chartContentContainer.scrollLeft,r.chartContentContainer.scrollLeft=r.chartContentContainer.scrollLeft-48,o-=r.chartContentContainer.scrollLeft,void 0!==r.draggingInitialThumbXPosition&&(r.draggingInitialThumbXPosition=r.draggingInitialThumbXPosition-o)):o>=r.chartContentContainer.clientWidth-24&&(o=r.chartContentContainer.scrollLeft,r.chartContentContainer.scrollLeft=r.chartContentContainer.scrollLeft+48,o=r.chartContentContainer.scrollLeft-o,void 0!==r.draggingInitialThumbXPosition&&(r.draggingInitialThumbXPosition=r.draggingInitialThumbXPosition+o))}if(e=e.clientY,void 0!==r.draggingItem){if(l=0,(o=r).offsetParent)do{l+=o.offsetTop,o=o.offsetParent}while(o);(e-=l)<24?(e=r.chartContentContainer.scrollTop,r.chartContentContainer.scrollTop=r.chartContentContainer.scrollTop-48,e-=r.chartContentContainer.scrollTop,void 0!==r.draggingInitialThumbYPosition&&(r.draggingInitialThumbYPosition=r.draggingInitialThumbYPosition-e)):e>=r.chartContentContainer.clientHeight-24&&(e=r.chartContentContainer.scrollTop,r.chartContentContainer.scrollTop=r.chartContentContainer.scrollTop+48,e=r.chartContentContainer.scrollTop-e,void 0!==r.draggingInitialThumbYPosition&&(r.draggingInitialThumbYPosition=r.draggingInitialThumbYPosition+e))}delete r.draggingItem,r.draggingInitialThumbXPosition+n<0&&(n=-r.draggingInitialThumbXPosition),r.draggingInitialThumbYPosition+s<0&&(s=-r.draggingInitialThumbYPosition),s=(r.draggingInitialThumbYPosition+s-a.diagramMargin)/(a.itemHeight+a.minDependencyLineLength/a.aspectRatio),a.snapRearrangedItemsToGuidelines&&(s=Math.round(s)),t.actualRowIndex=s,n=(r.draggingInitialThumbXPosition+n-a.diagramMargin)/(a.itemWidth+a.minDependencyLineLength),a.snapRearrangedItemsToGuidelines&&(n=Math.round(n)),t.actualColumnIndex=n,V(t,"actualRowIndex",!0,!1),V(t,"actualColumnIndex",!0,!1),void 0!==t.displayedColumnIndex&&delete t.displayedColumnIndex,void 0!==t.displayedRowIndex&&delete t.displayedRowIndex,L(t,i,r.chartContent,a,!1),r.draggingItem=t,r.draggingPerformed=!0}}),!0),document.addEventListener("mouseup",(function(e){0==e.button&&void 0!==r.draggingItem&&r.draggingItem==t&&"Position"==r.dragType&&(L(t,i,r.chartContent,a,!0),e=r.draggingItem,delete r.draggingItem,r.style.cursor="default",r.draggingPerformed&&(V(e,"actualColumnIndex",!0,!0),V(e,"actualRowIndex",!0,!0),delete r.draggingPerformed))}),!0),r.draggableItems.push(t))},L=function(e,t,i,n,s){var r=e.networkDiagramView.ownerDocument;if(s)void 0!==i.temporaryRectangle&&((r=i.chartArea).removeChild(i.temporaryRectangle),delete i.temporaryRectangle),setTimeout((function(){b(e.chartItem,e,n),y(t),setTimeout((function(){F(i,t,n,!0)}),0)}));else{void 0!==i.temporaryRectangle?s=i.temporaryRectangle:((s=r.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",0),s.setAttribute("y",0),s.setAttribute("width",n.shapeWidth),s.setAttribute("height",n.shapeHeight),void 0!==n.temporaryThumbClass&&s.setAttribute("class",n.temporaryThumbClass),s.setAttribute("style",n.temporaryThumbStyle),i.temporaryRectangle=s,(r=i.chartArea).appendChild(s)),r=f(e,n)+(n.itemWidth-n.shapeWidth)/2;var a=v(e,n)+(n.itemHeight-n.shapeHeight)/2;s.setAttribute("transform","translate("+r+", "+a+")"),setTimeout((function(){F(i,t,n,!1)}),0)}},F=function(e,t,i,n){var s=p(t,i);t=m(t,i),(n||s>e.clientWidth)&&(e.style.width=s+"px"),(n||t>e.clientHeight)&&(e.style.height=t+"px"),n&&e.chartArea.setAttribute("style","width: "+s+"px; height: "+t+"px")},O=function(e,t){for(var i=e.childNodes.length;i-- >0;)e.removeChild(e.childNodes[i]);e.appendChild(t)},P=function(e,t){for(var i in t)0!=i.indexOf("custom")&&0!=i.indexOf("description")||void 0===e[i]&&(e[i]=t[i])},B=function(e,t,i,n,s,r,a,o,l){l=p(o,i={isExport:!0,canUserRearrangeItems:!1,isTaskToolTipVisible:!1,isDependencyToolTipVisible:!1,containerClass:l.containerClass,containerStyle:l.containerStyle,border:l.border,theme:l.theme,itemWidth:l.itemWidth,itemHeight:l.itemHeight,aspectRatio:l.aspectRatio,shapeWidth:l.shapeWidth,shapeHeight:l.shapeHeight,shapeClass:l.shapeClass,milestoneClass:l.milestoneClass,shapeStyle:l.shapeStyle,milestoneStyle:l.milestoneStyle,dependencyLineClass:l.dependencyLineClass,dependencyLineStyle:l.dependencyLineStyle,minDependencyLineLength:l.minDependencyLineLength,diagramMargin:0,target:l.target,dateTimeFormatter:l.dateTimeFormatter,timeSpanFormatter:l.timeSpanFormatter,isRelativeToTimezone:l.isRelativeToTimezone,taskTemplate:l.taskTemplate,dependencyLineTemplate:l.dependencyLineTemplate});var d=m(o,i);i.chartWidth=l+"px",i.chartHeight=d+"px";var c,u,g=l+2,f=(l=d+2,!1);if(null!=n&&void 0!==n.createElement)c=n;else{null!=n&&void 0!==n.focus?u=n:(u=window.open("",null!=n?n:"_blank",void 0!==s&&s&&(void 0===a||a)?"width=320,height=100,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),f=!0),c=u.document;try{var v=document.head.getElementsByTagName("link");for(n=0;n<v.length;n++){var C=v[n],b=c.adoptNode(C.cloneNode(!0));b.href=C.href,c.head.appendChild(b)}}catch(h){}}for(c.title=void 0!==e?e:"Exported diagram"+(void 0!==s&&s?" (printable)":""),e=[],n=0;n<o.length;n++)P(C={content:(v=o[n]).content,earlyStart:v.earlyStart,earlyFinish:v.earlyFinish,lateStart:v.lateStart,lateFinish:v.lateFinish,isMilestone:v.isMilestone,effort:v.effort,slack:v.slack,isShapeVisible:v.isShapeVisible,isRelativeToTimezone:v.isRelativeToTimezone,shapeClass:v.shapeClass,milestoneClass:v.milestoneClass,shapeStyle:v.shapeStyle,milestoneStyle:v.milestoneStyle,displayedRowIndex:v.actualRowIndex,displayedColumnIndex:v.actualColumnIndex,isExported:!0},v),e.push(C),v.exportItem=C;for(n=0;n<o.length;n++)if(C=(v=o[n]).exportItem,void 0!==v.predecessors)for(C.predecessors=[],b=0;b<v.predecessors.length;b++)C.predecessors.push({item:(d=v.predecessors[b]).item.exportItem,dependencyLineClass:d.dependencyLineClass,dependencyLineStyle:d.dependencyLineStyle});var S=c.createElement("p");S.innerHTML=void 0!==t?t:"",c.body.appendChild(S);var w=c.createElement("div");w.setAttribute("style","width: "+g+"px; height: "+l+"px");try{DlhSoft.Controls.Pert.NetworkDiagramView.initialize(w,e,i,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch(y){}setTimeout((function(){f&&c.body.setAttribute("style","margin: 0px");var e=c.createElement("div");e.appendChild(w),c.body.replaceChild(e,S),r&&(e.setAttribute("style","width: "+w.offsetHeight+"px; height: "+g+"px; overflow: hidden"),e=Math.round((w.offsetWidth-w.offsetHeight)/2),w.setAttribute("style","width: "+g+"px; transform: rotate(90deg) translateX("+e+"px) translateY("+e+"px); -webkit-transform: rotate(90deg) translateX("+e+"px) translateY("+e+"px)")),c.close(),void 0!==typeof u&&(u.focus(),void 0!==s&&s&&(u.print(),(void 0===a||a)&&u.close()))}),0)},M=function(e,t){var i,n;e:{for(i=0;i<t.length;i++){var s=t[i];if(void 0===s.predecessors||0==s.predecessors.length){i=s;break e}}i=null}if(null==i)return[];e:{for(s=t.length;s-- >0;)if(0==N(n=t[s]).length)break e;n=null}if(null==n)return[];for(s=[i],i=W(i,n),n=0;n<i.length;n++)s.push(i[n]);return s},R=function(e,t){for(var i=M(0,t),n=[],s=0;s<i.length;s++){var r=i[s];if(void 0!==r.predecessors)for(var a=0;a<r.predecessors.length;a++){var o=r.predecessors[a];void 0!==o.item&&i.indexOf(o.item)>=0&&n.push(o)}}return n},W=function(e,t){if(null==e||null==t||e==t||void 0===t.predecessors)return[];var i,n=[],s=[],r=null;for(i=0;i<t.predecessors.length;i++)if(predecessorItem=t.predecessors[i],void 0!==predecessorItem.item){var a=z(e,predecessorItem.item);null!=a&&(predecessorItem.item.effort>0&&(a+=predecessorItem.item.effort),(null==r||a>=r)&&((null==r||a>r)&&(r=a,s=[]),s.push(predecessorItem)))}for(i=0;i<s.length;i++){for(nextPredecessorItem=s[i],r=W(e,nextPredecessorItem.item),a=0;a<r.length;a++)n.push(r[a]);n.push(t)}return n},z=function(e,t){if(null==e||null==t)return null;if(e==t)return 0;for(var i=null,n=N(e),s=0;s<n.length;s++){var r=n[s],a=z(r.dependentItem,t);null!=a&&((a+=void 0!==r.predecessorItem.item&&r.predecessorItem.item.effort>0?r.predecessorItem.item.effort:0)<0&&(a=0),(null==i||a>i)&&(i=a))}return i},N=function(e){for(var t=[],i=e.networkDiagramView.items,n=0;n<i.length;n++){var s=i[n];if(void 0!==s.predecessors)for(var r=0;r<s.predecessors.length;r++){var a=s.predecessors[r];void 0!==a.item&&a.item==e&&t.push({dependentItem:s,predecessorItem:a})}}return t},_=function(e){for(var t=null,i=0;i<e.length;i++)(null==t||e[i]>t)&&(t=e[i]);return t},G=function(e){return void 0!==e?new Date(e.valueOf()+6e4*e.getTimezoneOffset()):e},Y=function(e){return void 0!==e?new Date(e.valueOf()-6e4*e.getTimezoneOffset()):e},X=function(e,i,n){for(var s=0;s<i.length;s++)i[s].networkDiagramView=e;e.items=i,e.settings=n,e.refresh=function(){t(e)},e.refreshItems=function(){for(var e=0;e<i.length;e++){var t=i[e];S(t),T(t)}},e.refreshChartItems=function(){for(var e=0;e<i.length;e++)S(i[e])},e.refreshItem=w,e.refreshChartItem=S,e.refreshPredecessorItems=T,e.refreshItemGraph=x,e.scrollToItem=function(e){var t=f(e,n),i=t-e.networkDiagramView.chartContentContainer.scrollLeft;i<0?e.networkDiagramView.chartContentContainer.scrollLeft=t:i>e.networkDiagramView.chartContentContainer.clientWidth-e.networkDiagramView.settings.itemWidth&&(e.networkDiagramView.chartContentContainer.scrollLeft=t-(e.networkDiagramView.chartContentContainer.clientWidth-e.networkDiagramView.settings.itemWidth)),(i=(t=v(e,n))-e.networkDiagramView.chartContentContainer.scrollTop)<0?e.networkDiagramView.chartContentContainer.scrollTop=t:i>e.networkDiagramView.chartContentContainer.clientHeight-e.networkDiagramView.settings.itemHeight&&(e.networkDiagramView.chartContentContainer.scrollTop=t-(e.networkDiagramView.chartContentContainer.clientHeight-e.networkDiagramView.settings.itemHeight))},e.scrollToLeft=function(){e.chartContentContainer.scrollLeft=0},e.scrollToRight=function(){e.chartContentContainer.scrollLeft=e.chartContent.clientWidth},e.scrollToTop=function(){e.chartContentContainer.scrollTop=0},e.scrollToBottom=function(){e.chartContentContainer.scrollTop=e.chartContent.clientHeight},e.getChartWidth=function(){return p(i,n)},e.getChartHeight=function(){return m(i,n)},e.getItemTop=function(e){return v(e,n)},e.getItemLeft=function(e){return f(e,n)},e.onItemPropertyChanged=V,e.initializeTaskDraggingThumbs=function(t,i,n,s){H(t,i,e.items,n,s,e,e.settings)},e.exportContent=function(e,t){void 0===e&&(e={}),B(e.title,e.preparingMessage,e.isRelativeToTimezone,t,!1,e.rotate,!1,i,n)},e.print=function(e){void 0===e&&(e={}),B(e.title,e.preparingMessage,e.isRelativeToTimezone,null,!0,e.rotate,e.autoClose,i,n)},e.isItemCritical=function(e,t){return M(0,i).indexOf(e)>=0},e.isDependencyCritical=function(e,t){return R(0,i).indexOf(e)>=0},e.getCriticalItems=function(e){return M(0,i)},e.getCriticalDependencies=function(e){return R(0,i)},e.repositionEnds=function(){if(0!=i.length){for(var e=!1,t=0;t<i.length;t++){for(var n=i[t],s=0,r=0;r<i.length;r++){var a=i[r];if(void 0!==a.predecessors){for(var o=0;o<a.predecessors.length&&!(void 0!==a.predecessors[o].item&&a.predecessors[o].item==n&&++s>1);o++);if(s>1)break}}s>1&&(e=!0)}(t=i[0]).displayedRowIndex=e?.5:0,(n=i[i.length-1]).displayedRowIndex=e?.5:0,x(t),x(n)}},e.getOutputDate=G,e.getInputDate=Y};return{initialize:e,initializeItems:n,refresh:t,getDefaultStyleDefinitionTemplate:D,getDefaultTaskTemplate:E,getDefaultItemTemplate:k,getDefaultDependencyLineTemplate:I,getDefaultPredecessorItemTemplate:A,initializeTaskDraggingThumbs:function(e,t,i,n){t.networkDiagramView.initializeTaskDraggingThumbs(e,t,i,n)},defaultDateTimeFormatter:function(e){return h(new Date(e.valueOf()+6e4*(new Date).getTimezoneOffset()))},defaultTimeSpanFormatter:c,getOutputDate:G,getInputDate:Y}}()),void 0===DlhSoft&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)}),DlhSoft.assemblies.push({assembly:"DlhSoft.Data.HTML.Controls",company:"DlhSoft",product:"Data Modern Library",version:"5.2.3.0",copyright:"Copyright � 2014-2015 DlhSoft",title:"Data HTML Controls",description:"Data related HTML client components"}),DlhSoft.buildReleaseDate=function(e,t,i){return(e=new Date(e,4,8))>DlhSoft.buildReleaseDate?e:DlhSoft.buildReleaseDate}(2015),_0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{"),null==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var e=_0x5c25[1],t=_0x5c25[2],n=[],s=[],r=_0x5c25[3];return{setLicense:function(e,t){n[_0x5c25[7]]({type:e,content:t})},validate:function(a,o,l,d,h,c,u){o=o+_0x5c25[4]+l;for(var p=0;p<s[_0x5c25[5]];p++)if(s[p]==o)return;e:if(typeof c!==t&&typeof u!==e&&(u[_0x5c25[6]]!==e&&(c=u[_0x5c25[6]]),typeof u===t&&(c=u)),typeof c!==t)for(u=0;u<n[_0x5c25[5]];u++)if(p=n[u],p[_0x5c25[8]]==o&&typeof p[_0x5c25[9]]===t){c=p[_0x5c25[9]];break e}!function(n,s){if(typeof n!==t||typeof s!==t)return!1;if(s==r)return!0;var a=s[_0x5c25[11]](_0x5c25[10]);if(0<=a){var o,l=s[_0x5c25[12]](0,a),d=l[_0x5c25[11]](_0x5c25[10]);if(0<=d)try{o=new Date(parseInt(l[_0x5c25[12]](d+1)))}catch(u){}if(typeof o===e&&(o=new Date(2013,11,31)),DlhSoft[_0x5c25[13]]>o)return!1;for(l=l+_0x5c25[10]+n,i=o=0;i<l[_0x5c25[5]];i++)o=(o<<5)-o+(d=l[_0x5c25[14]](i)),o&=o;if(0>o&&(o=Math[_0x5c25[15]](2,32)-o),(l=o.toString(16)[_0x5c25[16]]())==(a=s[_0x5c25[12]](a+1)))return!0}return!1}(o,c)?function(t,i,n,r,a){var o=_0x5c25[17],l=typeof ComponentSource!==e&&ComponentSource?_0x5c25[21]:_0x5c25[18]+_0x5c25[19]+r+_0x5c25[20]+a,d=r+_0x5c25[22]+a+_0x5c25[23],h=_0x5c25[24],c=_0x5c25[25],u=_0x5c25[26];setTimeout((function(){var e=t[_0x5c25[27]],r=e[_0x5c25[29]](_0x5c25[28]);r[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var a=e[_0x5c25[29]](_0x5c25[28]);a[_0x5c25[32]](_0x5c25[30],_0x5c25[33]);var p=e[_0x5c25[29]](_0x5c25[28]);p[_0x5c25[32]](_0x5c25[30],_0x5c25[34]),a[_0x5c25[35]](p),p[_0x5c25[35]](e[_0x5c25[36]](o)),a[_0x5c25[35]](e[_0x5c25[36]](h+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),p[_0x5c25[35]](e[_0x5c25[36]](i)),a[_0x5c25[35]](p),a[_0x5c25[35]](e[_0x5c25[36]](c+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),p[_0x5c25[35]](e[_0x5c25[36]](d)),a[_0x5c25[35]](p),a[_0x5c25[35]](e[_0x5c25[36]](u+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var m=e[_0x5c25[29]](_0x5c25[39]);m[_0x5c25[32]](_0x5c25[30],_0x5c25[40]),m[_0x5c25[32]](_0x5c25[41],l),m[_0x5c25[32]](_0x5c25[42],_0x5c25[43]),m[_0x5c25[35]](e[_0x5c25[36]](_0x5c25[44])),p[_0x5c25[35]](m),(m=e[_0x5c25[29]](_0x5c25[39]))[_0x5c25[32]](_0x5c25[30],_0x5c25[45]),m[_0x5c25[32]](_0x5c25[41],_0x5c25[46]),m[_0x5c25[35]](e[_0x5c25[36]](_0x5c25[47])),m[_0x5c25[50]](_0x5c25[48],(function(){t[_0x5c25[49]](r),s[_0x5c25[7]](n)}),!1),p[_0x5c25[35]](m),a[_0x5c25[35]](p),r[_0x5c25[35]](a),t[_0x5c25[35]](r)}),0),setTimeout((function(){alert(o+_0x5c25[51]+h+_0x5c25[52]+i+_0x5c25[51]+c+_0x5c25[53]+d+_0x5c25[51]+u+_0x5c25[4])}),6e5)}(a,l,o,d,h):a[_0x5c25[6]]=c}}}()),void 0===DlhSoft&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)}),DlhSoft.assemblies.push({assembly:"DlhSoft.Data.HTML.Controls",company:"DlhSoft",product:"Data Modern Library",version:"5.2.3.0",copyright:"Copyright � 2014-2015 DlhSoft",title:"Data HTML Controls",description:"Data related HTML client components"}),DlhSoft.buildReleaseDate=function(e,t,i){return(e=new Date(e,4,8))>DlhSoft.buildReleaseDate?e:DlhSoft.buildReleaseDate}(2015),_0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{"),null==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var e=_0x5c25[1],t=_0x5c25[2],n=[],s=[],r=_0x5c25[3];return{setLicense:function(e,t){n[_0x5c25[7]]({type:e,content:t})},validate:function(a,o,l,d,h,c,u){o=o+_0x5c25[4]+l;for(var p=0;p<s[_0x5c25[5]];p++)if(s[p]==o)return;e:if(typeof c!==t&&typeof u!==e&&(u[_0x5c25[6]]!==e&&(c=u[_0x5c25[6]]),typeof u===t&&(c=u)),typeof c!==t)for(u=0;u<n[_0x5c25[5]];u++)if(p=n[u],p[_0x5c25[8]]==o&&typeof p[_0x5c25[9]]===t){c=p[_0x5c25[9]];break e}!function(n,s){if(typeof n!==t||typeof s!==t)return!1;if(s==r)return!0;var a=s[_0x5c25[11]](_0x5c25[10]);if(0<=a){var o,l=s[_0x5c25[12]](0,a),d=l[_0x5c25[11]](_0x5c25[10]);if(0<=d)try{o=new Date(parseInt(l[_0x5c25[12]](d+1)))}catch(u){}if(typeof o===e&&(o=new Date(2013,11,31)),DlhSoft[_0x5c25[13]]>o)return!1;for(l=l+_0x5c25[10]+n,i=o=0;i<l[_0x5c25[5]];i++)o=(o<<5)-o+(d=l[_0x5c25[14]](i)),o&=o;if(0>o&&(o=Math[_0x5c25[15]](2,32)-o),(l=o.toString(16)[_0x5c25[16]]())==(a=s[_0x5c25[12]](a+1)))return!0}return!1}(o,c)?function(t,i,n,r,a){var o=_0x5c25[17],l=typeof ComponentSource!==e&&ComponentSource?_0x5c25[21]:_0x5c25[18]+_0x5c25[19]+r+_0x5c25[20]+a,d=r+_0x5c25[22]+a+_0x5c25[23],h=_0x5c25[24],c=_0x5c25[25],u=_0x5c25[26];setTimeout((function(){var e=t[_0x5c25[27]],r=e[_0x5c25[29]](_0x5c25[28]);r[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var a=e[_0x5c25[29]](_0x5c25[28]);a[_0x5c25[32]](_0x5c25[30],_0x5c25[33]);var p=e[_0x5c25[29]](_0x5c25[28]);p[_0x5c25[32]](_0x5c25[30],_0x5c25[34]),a[_0x5c25[35]](p),p[_0x5c25[35]](e[_0x5c25[36]](o)),a[_0x5c25[35]](e[_0x5c25[36]](h+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),p[_0x5c25[35]](e[_0x5c25[36]](i)),a[_0x5c25[35]](p),a[_0x5c25[35]](e[_0x5c25[36]](c+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),p[_0x5c25[35]](e[_0x5c25[36]](d)),a[_0x5c25[35]](p),a[_0x5c25[35]](e[_0x5c25[36]](u+_0x5c25[10])),(p=e[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var m=e[_0x5c25[29]](_0x5c25[39]);m[_0x5c25[32]](_0x5c25[30],_0x5c25[40]),m[_0x5c25[32]](_0x5c25[41],l),m[_0x5c25[32]](_0x5c25[42],_0x5c25[43]),m[_0x5c25[35]](e[_0x5c25[36]](_0x5c25[44])),p[_0x5c25[35]](m),(m=e[_0x5c25[29]](_0x5c25[39]))[_0x5c25[32]](_0x5c25[30],_0x5c25[45]),m[_0x5c25[32]](_0x5c25[41],_0x5c25[46]),m[_0x5c25[35]](e[_0x5c25[36]](_0x5c25[47])),m[_0x5c25[50]](_0x5c25[48],(function(){t[_0x5c25[49]](r),s[_0x5c25[7]](n)}),!1),p[_0x5c25[35]](m),a[_0x5c25[35]](p),r[_0x5c25[35]](a),t[_0x5c25[35]](r)}),0),setTimeout((function(){alert(o+_0x5c25[51]+h+_0x5c25[52]+i+_0x5c25[51]+c+_0x5c25[53]+d+_0x5c25[51]+u+_0x5c25[4])}),6e5)}(a,l,o,d,h):a[_0x5c25[6]]=c}}}());var DlhSoft,__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};function initializeGanttChartTemplates(e,t){if("Default"!=t&&"Aero"!=t){var i=e.itemHeight-8,n=i-2,s="http://www.w3.org/2000/svg";e.styleDefinitionTemplate=function(t){var i=t.ownerDocument,n=i.createElementNS(s,"defs"),r=i.createElementNS(s,"marker");r.setAttribute("id","ArrowMarker"),r.setAttribute("viewBox","0 0 9 9"),r.setAttribute("refX","0"),r.setAttribute("refY","4.5"),r.setAttribute("markerUnits","strokeWidth"),r.setAttribute("markerWidth",4.5*(e.arrowSize?e.arrowSize:1)),r.setAttribute("markerHeight",3.5*(e.arrowSize?e.arrowSize:1)),r.setAttribute("orient","auto");var a=i.createElementNS(s,"path");return a.setAttribute("fill",e.arrowFill?e.arrowFill:"#3b87d9"),a.setAttribute("d","M 0 0 L 9 4.5 L 0 9 z"),r.appendChild(a),n.appendChild(r),n},e.standardTaskTemplate=function(e){var t=e.ganttChartView,o=t.settings,l=t.ownerDocument,d=r(e);if(o.isBaselineVisible&&void 0!==e.baselineStart&&void 0!==e.baselineFinish){var h=t.getChartPosition(e.baselineStart),c=Math.max(t.getChartPosition(e.baselineFinish),h+4),u=l.createElementNS(s,"rect");u.setAttribute("x",h),u.setAttribute("y",2),u.setAttribute("width",Math.max(0,c-h-1)),u.setAttribute("height",i),u.setAttribute("rx",o.barCornerRadius),u.setAttribute("ry",o.barCornerRadius);var p=o.baselineBarClass;if(void 0!==e.baselineBarClass&&(p=e.baselineBarClass),void 0!==p)u.setAttribute("class",p);else{var m=o.baselineBarStyle;void 0!==e.baselineBarStyle&&(m=e.baselineBarStyle),void 0!==m&&u.setAttribute("style",m)}d.appendChild(u)}var g=t.getChartPosition(e.start),f=Math.max(t.getChartPosition(e.finish),g+4),v=t.getChartPosition(e.completedFinish)+1,y=l.createElementNS(s,"rect");y.setAttribute("x",g),y.setAttribute("y",4),y.setAttribute("width",Math.max(0,f-g-1)),y.setAttribute("height",i),y.setAttribute("rx",o.barCornerRadius),y.setAttribute("ry",o.barCornerRadius);var C=o.standardBarClass;if(void 0!==e.standardBarClass&&(C=e.standardBarClass),void 0!==e.barClass&&(C=e.barClass),void 0!==C)y.setAttribute("class",C);else{var b=o.standardBarStyle;void 0!==e.standardBarStyle&&(b=e.standardBarStyle),void 0!==e.barStyle&&(b=e.barStyle),void 0!==b&&y.setAttribute("style",b)}if(d.appendChild(y),o.isTaskCompletedEffortVisible){var S=l.createElementNS(s,"rect");S.setAttribute("x",g+1),S.setAttribute("y",5),S.setAttribute("width",Math.max(0,v-2-1-g-1)),S.setAttribute("height",n),S.setAttribute("rx",o.completedBarCornerRadius),S.setAttribute("ry",o.completedBarCornerRadius);var w=o.standardCompletedBarClass;if(void 0!==e.standardCompletedBarClass&&(w=e.standardCompletedBarClass),void 0!==e.completedBarClass&&(w=e.completedBarClass),void 0!==w)S.setAttribute("class",w);else{var T=o.standardCompletedBarStyle;void 0!==e.standardCompletedBarStyle&&(T=e.standardCompletedBarStyle),void 0!==e.completedBarStyle&&(T=e.completedBarStyle),void 0!==T&&S.setAttribute("style",T)}d.appendChild(S)}if(!(o.isReadOnly||o.isChartReadOnly||void 0!==e.isReadOnly&&e.isReadOnly||void 0!==e.isBarReadOnly&&e.isBarReadOnly)){var x=l.createElementNS(s,"rect");x.setAttribute("x",g),x.setAttribute("y",4),x.setAttribute("width",Math.max(0,f-g-1)),x.setAttribute("height",i),x.setAttribute("style","fill: White; fill-opacity: 0; cursor: move"),o.isTaskStartReadOnly||d.appendChild(x);var D=l.createElementNS(s,"rect");D.setAttribute("x",g-4),D.setAttribute("y",4),D.setAttribute("width",4),D.setAttribute("height",i),D.setAttribute("style","fill: White; fill-opacity: 0; cursor: e-resize"),o.isDraggingTaskStartEndsEnabled&&!o.isTaskStartReadOnly&&"TouchEnabled"!=o.interaction&&d.appendChild(D);var k=l.createElementNS(s,"rect");k.setAttribute("x",f-4),k.setAttribute("y",4),k.setAttribute("width",8),k.setAttribute("height",i),k.setAttribute("style","fill: White; fill-opacity: 0; cursor: e-resize"),o.isTaskEffortReadOnly||"TouchEnabled"==o.interaction||d.appendChild(k);var E=l.createElementNS(s,"rect");if(E.setAttribute("x",v-2),E.setAttribute("y",4),E.setAttribute("width",6),E.setAttribute("height",i),E.setAttribute("style","fill: White; fill-opacity: 0; cursor: e-resize"),!o.isTaskCompletionReadOnly&&o.isTaskCompletedEffortVisible&&"TouchEnabled"!=o.interaction){d.appendChild(E);var I=l.createElementNS(s,"title"),A=void 0!==o.areToolTipsSimplified&&o.areToolTipsSimplified?NaN:t.getItemCompletion(e);I.appendChild(a(l,isNaN(A)?"":Math.round(100*A*100)/100+"%")),E.appendChild(I)}if(t.initializeTaskDraggingThumbs(x,D,k,E,e,g,f,v),o.areTaskDependenciesVisible&&!o.areTaskPredecessorsReadOnly&&!e.isPart){var V=null;(void 0===o.allowCreatingStartDependencies||o.allowCreatingStartDependencies)&&((V=l.createElementNS(s,"circle")).setAttribute("cx",g),V.setAttribute("cy",4+i/2),V.setAttribute("r",i/4),V.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),d.appendChild(V));var H=l.createElementNS(s,"circle");H.setAttribute("cx",f-2),H.setAttribute("cy",4+i/2),H.setAttribute("r",i/4),H.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),d.appendChild(H),t.initializeDependencyDraggingThumbs(H,V,d,e,4+i/2,f-2,g)}}return d},e.summaryTaskTemplate=function(e){var t=e.ganttChartView,i=t.settings,n=t.ownerDocument,a=r(e),o=t.getChartPosition(e.start),l=t.getChartPosition(e.finish),d=2.15*i.barHeight/2.65,h=n.createElementNS(s,"rect");h.setAttribute("x",o),h.setAttribute("y",i.barMargin),h.setAttribute("width",Math.max(0,l-o-1)),h.setAttribute("height",d);var c=i.summaryBarClass;if(void 0!==e.summaryBarClass&&(c=e.summaryBarClass),void 0!==e.barClass&&(c=e.barClass),void 0!==c)h.setAttribute("class",c);else{var u=i.summaryBarStyle;void 0!==e.summaryBarStyle&&(u=e.summaryBarStyle),void 0!==e.barStyle&&(u=e.barStyle),void 0!==u&&h.setAttribute("style",u)}if(a.appendChild(h),!e.isExpanded){var p=n.createElementNS(s,"line");p.setAttribute("x1",o),p.setAttribute("y1",i.barMargin+d+2.5),p.setAttribute("x2",l-1),p.setAttribute("y2",i.barMargin+d+2.5);var m=i.collapsedSummaryLineClass;if(void 0!==e.collapsedSummaryLineClass&&(m=e.collapsedSummaryLineClass),void 0!==m)p.setAttribute("class",m);else{var g=i.collapsedSummaryLineStyle;void 0!==e.collapsedSummaryLineStyle&&(g=e.collapsedSummaryLineStyle),void 0!==g&&p.setAttribute("style",g)}a.appendChild(p)}var f,v=n.createElementNS(s,"polygon"),y=i.barMargin-.25,C=d+1.5,b=3*i.barHeight/4,S=i.barHeight/4;v.setAttribute("points",(f=o-1-i.barHeight/3)+","+y+" "+f+","+(y+C)+" "+(f+b/2)+","+(y+C+S)+" "+(f+b)+","+(y+C)+" "+(f+b)+","+y),void 0!==c&&v.setAttribute("class",c),void 0!==u&&v.setAttribute("style",u),a.appendChild(v);var w=n.createElementNS(s,"polygon");if(w.setAttribute("points",(f=l+i.barHeight/3)+","+y+" "+f+","+(y+C)+" "+(f-b/2)+","+(y+C+S)+" "+(f-b)+","+(y+C)+" "+(f-b)+","+y),void 0!==c&&w.setAttribute("class",c),void 0!==u&&w.setAttribute("style",u),a.appendChild(w),!(i.isReadOnly||i.isChartReadOnly||void 0!==e.isReadOnly&&e.isReadOnly||void 0!==e.isBarReadOnly&&e.isBarReadOnly)&&i.areTaskDependenciesVisible&&!i.areTaskPredecessorsReadOnly&&!e.isPart){var T=null;(void 0===i.allowCreatingStartDependencies||i.allowCreatingStartDependencies)&&((T=n.createElementNS(s,"circle")).setAttribute("cx",o-.5),T.setAttribute("cy",i.barMargin+i.barHeight/2),T.setAttribute("r",i.barHeight/4),T.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),a.appendChild(T));var x=n.createElementNS(s,"circle");x.setAttribute("cx",l-.5),x.setAttribute("cy",i.barMargin+i.barHeight/2),x.setAttribute("r",2.5),x.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),a.appendChild(x),t.initializeDependencyDraggingThumbs(x,T,a,e,i.barMargin+i.barHeight/2,l-1.5,o)}return a},e.milestoneTaskTemplate=function(e){var t=e.ganttChartView,i=t.settings,n=t.ownerDocument,a=r(e);if(i.isBaselineVisible&&void 0!==e.baselineStart){var o=t.getChartPosition(e.baselineStart),l=n.createElementNS(s,"polygon"),d=i.barMargin-1,h=i.barHeight+1;l.setAttribute("points",o+","+d+" "+(o-h/2)+","+(d+h/2)+" "+o+","+(d+h)+" "+(o+h/2)+","+(d+h/2));var c=i.baselineBarClass;if(void 0!==e.baselineBarClass&&(c=e.baselineBarClass),void 0!==c)l.setAttribute("class",c);else{var u=i.baselineBarStyle;void 0!==e.baselineBarStyle&&(u=e.baselineBarStyle)}l.setAttribute("style",u),a.appendChild(l)}var p=t.getChartPosition(e.start),m=n.createElementNS(s,"polygon"),g=p-1,f=i.barMargin,v=i.barHeight+1;m.setAttribute("points",g+","+f+" "+(g-v/2)+","+(f+v/2)+" "+g+","+(f+v)+" "+(g+v/2)+","+(f+v/2));var y=i.milestoneBarClass;if(void 0!==e.milestoneBarClass&&(y=e.milestoneBarClass),void 0!==e.barClass&&(y=e.barClass),void 0!==y)m.setAttribute("class",y);else{var C=i.milestoneBarStyle;void 0!==e.milestoneBarStyle&&(C=e.milestoneBarStyle),void 0!==e.barStyle&&(C=e.barStyle),void 0!==C&&m.setAttribute("style",C)}if(a.appendChild(m),!(i.isReadOnly||i.isChartReadOnly||void 0!==e.isReadOnly&&e.isReadOnly||void 0!==e.isBarReadOnly&&e.isBarReadOnly)){var b=n.createElementNS(s,"rect");if(b.setAttribute("x",g-v/2),b.setAttribute("y",i.barMargin),b.setAttribute("width",v),b.setAttribute("height",v),b.setAttribute("style","fill: White; fill-opacity: 0; cursor: move"),a.appendChild(b),t.initializeTaskDraggingThumbs(b,null,null,null,e,g,g,g),i.areTaskDependenciesVisible&&!i.areTaskPredecessorsReadOnly&&!e.isPart){var S=n.createElementNS(s,"circle");S.setAttribute("cx",g),S.setAttribute("cy",i.barMargin+i.barHeight/2),S.setAttribute("r",i.barHeight/4),S.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),a.appendChild(S),t.initializeDependencyDraggingThumbs(S,null,a,e,i.barMargin+i.barHeight/2,g,g)}}return a},e.dependencyLineTemplate=function(e,t){var i=e.ganttChartView,n=i.settings,r=i.ownerDocument,a=r.createElementNS(s,"g"),o=function(e,t){var s,r,a,o,l=i.getItemTop(t.item),d=i.getItemTop(e),h="M ",c=n.itemHeight,u=c/2,p=c/3.5,m=3.5,g=!1;if(l!=d||void 0!==t.dependencyType&&"FinishStart"!=t.dependencyType&&"FS"!=t.dependencyType&&"StartFinish"!=t.dependencyType&&"SF"!=t.dependencyType){if(void 0===t.dependencyType||"StartStart"!=t.dependencyType&&"SS"!=t.dependencyType&&"StartFinish"!=t.dependencyType&&"SF"!=t.dependencyType?(s=i.getChartPosition(t.item.finish)-1,t.item.hasChildren&&(void 0===t.item.isSummaryEnabled||t.item.isSummaryEnabled)?s+=5*n.barMargin/8+.25:t.item.isMilestone?s+=c/4:s<(o=i.getChartPosition(t.item.start)+4-1)&&(s=o),r=s+p):(s=i.getChartPosition(t.item.start),t.item.hasChildren&&(void 0===t.item.isSummaryEnabled||t.item.isSummaryEnabled)?s-=5*n.barMargin/8+.25:t.item.isMilestone&&(s-=c/4),r=s-p),h+=s+" "+((l-=d)+u)+" L "+r+" "+(l+u),void 0===t.dependencyType||"FinishFinish"!=t.dependencyType&&"FF"!=t.dependencyType&&"StartFinish"!=t.dependencyType&&"SF"!=t.dependencyType)if(s=i.getChartPosition(e.start),void 0===t.dependencyType||"StartStart"!=t.dependencyType&&"SS"!=t.dependencyType)if(e.isMilestone)a=s-1;else{a=s+1.5;var f=i.getChartPosition(e.finish);a<r&&f-r>2*p&&e.start>=t.item.finish&&(a=r)}else g=!0,e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)?s-=5*n.barMargin/8+1:e.isMilestone&&(s-=c/4+1),a=s-p;else s=i.getChartPosition(e.finish)-1,void 0===t.dependencyType||"FinishFinish"!=t.dependencyType&&"FF"!=t.dependencyType?e.isMilestone?a=s:(s<(o=i.getChartPosition(e.start)+4)&&(s=o),a=s-2.5):(g=!0,e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled)?s+=5*n.barMargin/8+1:e.isMilestone?s+=c/4+1:s<(o=i.getChartPosition(e.start)+4-1)&&(s=o),a=s+p);void 0===t.dependencyType||"StartStart"!=t.dependencyType&&"SS"!=t.dependencyType&&"StartFinish"!=t.dependencyType&&"SF"!=t.dependencyType?(a<r&&((l-=p/6)<=0?l+=u:l-=u-2.5,h+=" "+r+" "+(l+u)),h+=" "+a+" "+(l+u)):(a>r&&((l-=p/6)<=0?l+=u:l-=u-2.5,h+=" "+r+" "+(l+u)),h+=" "+a+" "+(l+u)),l=g?u+.5:l<=0?n.barMargin-(e.isMilestone||e.hasChildren?1:4)-m:c-n.barMargin+(e.isMilestone||e.hasChildren?1:4)+m,g&&(a>s-m&&(m=-m),s-=m),h+=" "+a+" "+l,g&&(h+=" "+s+" "+l)}else void 0===t.dependencyType||"FinishStart"==t.dependencyType||"FS"==t.dependencyType?(s=i.getChartPosition(t.item.finish),r=i.getChartPosition(e.start)):(s=i.getChartPosition(t.item.start),r=i.getChartPosition(e.finish)),h+=s+" "+((l=l-d+.5)+u)+" L "+(r+(r>s?-1:1)*(c/5-1))+" "+(l+u);return h}(e,t),l=r.createElementNS(s,"path");l.setAttribute("d",o),void 0!==n.dependencyLineZoneClass&&l.setAttribute("class",n.dependencyLineZoneClass),void 0!==n.dependencyLineZoneStyle&&l.setAttribute("style",n.dependencyLineZoneStyle),a.appendChild(l);var d=r.createElementNS(s,"path");d.setAttribute("d",o);var h=n.dependencyLineClass;if(void 0!==t.dependencyLineClass&&(h=t.dependencyLineClass),void 0!==h)d.setAttribute("class",h);else{var c=n.dependencyLineStyle;void 0!==t.dependencyLineStyle&&(c=t.dependencyLineStyle),void 0!==c&&d.setAttribute("style",c)}return a.appendChild(d),a},e.assignmentsTemplate=function(e){var t=e.ganttChartView,i=t.settings,n=t.ownerDocument,r=n.createElementNS(s,"text"),a=t.getChartPosition(e.finish);(e.isMilestone||e.hasChildren&&(void 0===e.isSummaryEnabled||e.isSummaryEnabled))&&(a+=i.barHeight/2),r.setAttribute("x",a+7),r.setAttribute("y",i.barMargin+i.barHeight-1);var o="Phone"==i.target?e.content:e.assignmentsContent;return void 0===o&&(o=""),r.appendChild(n.createTextNode(o)),void 0!==i.assignmentsClass?r.setAttribute("class",i.assignmentsClass):void 0!==i.assignmentsStyle&&r.setAttribute("style",i.assignmentsStyle),r},e.itemTemplate=function(t){var i=t.ganttChartView,n=t.ganttChartView.ownerDocument,r=n.createElementNS(s,"title");if(r.appendChild(a(n,t.content)),void 0===e.areToolTipsSimplified||!e.areToolTipsSimplified)if(void 0===t.loadChartView){if(void 0===t.scheduleChartView&&t.parent&&(r.appendChild(n.createTextNode("\n")),r.appendChild(n.createTextNode("Parent: "+t.parent.content))),void 0!==t.scheduleChartView&&t.scheduleChartItem&&(r.appendChild(n.createTextNode("\n")),r.appendChild(n.createTextNode("Row: "+t.scheduleChartItem.content))),t.hasChildren&&(r.appendChild(n.createTextNode("\n")),r.appendChild(n.createTextNode("Children: "+t.children.length))),r.appendChild(n.createTextNode("\n")),r.appendChild(n.createTextNode((t.isMilestone?"":"Start: ")+e.dateTimeFormatter(i.getOutputDate(t.start)))),t.isMilestone||(r.appendChild(n.createTextNode("\n")),r.appendChild(n.createTextNode("Finish: "+e.dateTimeFormatter(i.getOutputDate(t.finish))))),e.areTaskAssignmentsVisible&&t.assignmentsContent&&(r.appendChild(n.createTextNode("\n")),r.appendChild(n.createTextNode("Assignments: "+t.assignmentsContent))),!t.isMilestone&&(r.appendChild(n.createTextNode("\n")),r.appendChild(n.createTextNode("Effort: "+i.getItemTotalEffort(t)/36e5+"h")),e.isTaskCompletedEffortVisible)){var l=i.getItemCompletion(t);isNaN(l)||(r.appendChild(n.createTextNode("\n")),r.appendChild(n.createTextNode("Completed: "+Math.round(100*l*100)/100+"%")))}if(e.areTaskDependenciesVisible&&t.predecessors&&t.predecessors.length>0){r.appendChild(n.createTextNode("\n"));for(var d="",h=0;h<t.predecessors.length;h++){var c=t.predecessors[h];c.item&&(d.length>0&&(d+=", "),d+=c.item.content,c.dependencyType&&(d+=" ("+o(c.dependencyType)+")"))}r.appendChild(n.createTextNode("Predecessors: "+d))}}else isNaN(t.units)||(r.appendChild(n.createTextNode("\n")),r.appendChild(n.createTextNode("Allocation: "+Math.round(100*t.units*100)/100+"%")));return r},e.predecessorItemTemplate=function(t,i){var n=t.ganttChartView.ownerDocument,r=n.createElementNS(s,"title");return r.appendChild(a(n,i.item.content+" - "+t.content)),void 0!==e.areToolTipsSimplified&&e.areToolTipsSimplified||(i.dependencyType&&(r.appendChild(n.createTextNode("\n")),r.appendChild(a(n,"Type: "+o(i.dependencyType)))),i.lag&&(r.appendChild(n.createTextNode("\n")),r.appendChild(a(n,"Lag: "+i.lag/36e5+"h")))),r}}function r(e){void 0===e.chartItemArea&&(e.chartItemArea=e.ganttChartView.ownerDocument.createElementNS(s,"g"));for(var t=e.chartItemArea.childNodes.length;t-- >0;)e.chartItemArea.removeChild(e.chartItemArea.childNodes[t]);return e.chartItemArea}function a(e,t){var i=e.createElement("span");return i.innerHTML=t,i}function o(e){switch(e){case"StartStart":case"SS":return"SS";case"FinishFinish":case"FF":return"FF";case"StartFinish":case"SF":return"SF";case"FinishStart":case"FS":default:return"FS"}}}function initializePertChartTemplates(e,t){if("Default"!=t){var i="http://www.w3.org/2000/svg";e.styleDefinitionTemplate=function(){var t=document.createElementNS(i,"defs"),n=document.createElementNS(i,"marker");n.setAttribute("id","PertArrowMarker"),n.setAttribute("viewBox","0 0 10 10"),n.setAttribute("refX","0"),n.setAttribute("refY","5"),n.setAttribute("markerUnits","strokeWidth"),n.setAttribute("markerWidth","5"),n.setAttribute("markerHeight","4"),n.setAttribute("orient","auto");var s=document.createElementNS(i,"path");return s.setAttribute("fill",e.arrowFill?e.arrowFill:"#3b87d9"),s.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),n.appendChild(s),t.appendChild(n),t}}}function initializeGanttChartTheme(e,t){if("Default"!=t)if("Aero"!=t){switch(e.headerHeight=62,e.itemHeight=28,e.barCornerRadius=1,e.completedBarCornerRadius=1,e.arrowSize=2,e.hourWidth=5,t){case"Generic-bright":e.headerBackground="white",e.mainStroke="#005c9e",e.mainFill="white",e.accentFill="#005c9e",e.diamondFill="#e31d3b",e.diamondStroke="#005c9e";break;case"Generic-blue":e.headerBackground="white";break;case"Purple-green":e.headerBackground="#dddfd4",e.mainStroke="#005173",e.mainFill="#a0729d",e.accentFill="#91bc0e";break;case"Blue-navy":e.headerBackground="#eeeeee",e.selectedGridBackground="#e8e8e8",e.mainStroke="#6534ff",e.mainFill="#369bf9",e.accentFill="#227fd5",e.alternativeGridBackground="#f9f9f9";break;case"Orange-brown":e.headerBackground="#eeeeee",e.selectedGridBackground="#e8e8e8",e.mainStroke="#6534ff",e.mainFill="#ffbf5a",e.accentFill="#d5a05a",e.diamondFill="#a91923",e.diamondStroke="#222222",e.alternativeBackground="#f9f9f9";break;case"Teal-green":e.headerBackground="#eeeeee",e.mainStroke="#6534ff",e.mainFill="#5ebcbb",e.accentFill="#3294a1",e.diamondFill="#4c7f3d",e.diamondStroke="#222222";break;case"Steel-blue":e.border="#aaaaaa",e.headerBackground="#4b5d6b",e.headerForeground="white",e.headerBorder="#aaaaaa",e.containerBackground="#a5b5c2",e.chartBackground="#bfcfda",e.gridForeground="gray",e.toggleFill="gray",e.selectedGridForeground="#4b5d6b",e.selectedGridBackground="#95a5b2",e.nonworkingBackground="#95a5b2",e.mainStroke="#6534ff",e.mainFill="#6699cc",e.accentFill="#4c7f3d",e.diamondFill="#4b5d6b",e.diamondStroke="#222222";break;case"Cyan-green":e.headerBackground="#dddddd",e.mainStroke="#6534ff",e.mainFill="#1fb5ce",e.accentFill="#1fce43",e.diamondFill="#d6485b",e.diamondStroke="#222222";break;case"Purple-beige":e.selectedGridBackground="#bfb8a4",e.mainStroke="#005c9e",e.mainFill="#a68b99",e.accentFill="#bfb8a4",e.diamondFill="#bfb8a4",e.diamondStroke="#005c9e",e.alternativeGridBackground="#f0eeeb",e.alternativeChartBackground="#f9f9f9";break;case"Dark-black":e.containerClass="dark",e.border="#222222",e.headerBackground="#111111",e.headerForeground="#eeeeee",e.headerBorder="#222222",e.containerBackground="#222222",e.gridForeground="#dddddd",e.chartForeground="#dddddd",e.scaleSeparatorBorder="#505050",e.toggleFill="#808080",e.toggleHoveringFill="white",e.selectedGridForeground="white",e.selectedGridBackground="#404040",e.nonworkingBackground="#333333",e.mainStroke="gray",e.accentFill="#ffbb00",e.summaryFill="#505050",e.diamondFill="#ffbb00",e.currentTimeStroke="#289451";break;case"Gray-blue":e.headerBackground="white",e.containerBackground="#f0f0f0",e.selectedGridBackground="white",e.mainStroke="#005c9e",e.mainFill="white",e.accentFill="#0087be",e.diamondFill="#607080",e.diamondStroke="#005c9e";break;case"DlhSoft-gray":e.border="#aaaaaa",e.headerBackground="#e31d3b",e.headerForeground="white",e.headerBorder="transparent",e.selectedGridBackground="#e8e8e8",e.mainStroke="#666",e.mainFill="#f0f0f0",e.accentFill="#ad927f",e.summaryFill="#666",e.diamondFill="#82a0b3",e.diamondStroke="#666",e.alternativeGridBackground="#f8f8f8",e.currentTimeStroke="#82a0b3"}e.containerBackground&&(e.containerStyle="background-color: "+e.containerBackground),e.headerForeground&&(e.columnHeaderStyle="color: "+e.headerForeground),e.gridForeground?(e.itemStyle="color: "+e.gridForeground+(e.gridBackground?"; background-color: "+e.gridBackground:""),e.selectedGridForeground&&(e.selectedItemStyle="color: "+e.selectedGridForeground+"; background-color: "+(e.selectedGridBackground?e.selectedGridBackground:e.gridForeground))):(e.selectedGridForeground||e.selectedGridBackground)&&(e.selectedItemStyle="color: "+(e.selectedGridForeground?e.selectedGridForeground:"black")+"; background-color: "+(e.selectedGridBackground?e.selectedGridBackground:"#f0f0f0")),e.toggleFill&&(e.toggleButtonStyle="fill: "+e.toggleFill),e.toggleHoveringFill&&(e.toggleButtonHoveringStyle="fill: "+e.toggleHoveringFill),e.scales=[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: "+(e.nonworkingBackground?e.nonworkingBackground:"#f8f8f8")+"; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 7px 5px; border-right: 1px solid "+(e.headerBorder?e.headerBorder:"#e8e8e8")+"; border-bottom: 1px solid "+(e.headerBorder?e.headerBorder:"#e8e8e8")+(e.headerForeground?"; color: "+e.headerForeground:""),isSeparatorVisible:!0,separatorStyle:"stroke: "+(e.scaleSeparatorBorder?e.scaleSeparatorBorder:"#c8bfe7")+"; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 7px 5px; border-right: 1px solid "+(e.headerBorder?e.headerBorder:"#e8e8e8")+(e.headerForeground?"; color: "+e.headerForeground:"")},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: "+(e.currentTimeStroke?e.currentTimeStroke:"#e31d3b")+"; stroke-width: 0.5px"}],e.chartBackground&&e.scales.splice(0,0,{scaleType:"Custom",isHeaderVisible:!1,intervals:[{start:new Date(1,0,1),finish:new Date(1e4,11,31,23,59,59,999)}],isHighlightingVisible:!0,highlightingStyle:"fill: "+e.chartBackground}),e.mainFill&&(e.standardBarStyle="stroke: "+(e.mainStroke?e.mainStroke:e.mainFill)+"; fill: "+e.mainFill,e.collapsedSummaryLineStyle="stroke: "+(e.mainStroke?e.mainStroke:e.mainFill)+"; stroke-width: 0.65px; stroke-dasharray: 2 2"),e.accentFill&&(e.standardCompletedBarStyle="stroke: "+e.accentFill+"; fill: "+e.accentFill),e.summaryFill&&(e.summaryBarStyle="stroke: "+(e.summaryStroke?e.summaryStroke:e.summaryFill)+"; fill: "+e.summaryFill),e.diamondFill&&(e.milestoneBarStyle="stroke: "+(e.diamondStroke?e.diamondStroke:e.diamondFill)+"; fill: "+e.diamondFill),e.mainStroke&&(e.baselineBarStyle="fill: none; stroke: "+e.mainStroke+"; stroke-width: 0.65px; stroke-dasharray: 2, 2",e.arrowFill=e.mainStroke,e.dependencyLineStyle="stroke: "+e.arrowFill+"; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)"),e.chartForeground&&(e.assignmentsStyle="font-size: x-small; fill: "+e.chartForeground),e.alternativeBackground&&(e.alternativeGridBackground=e.alternativeBackground,e.alternativeChartBackground=e.alternativeBackground),e.alternativeGridBackground&&(e.alternativeItemStyle="background-color: "+e.alternativeGridBackground),e.alternativeChartBackground&&(e.alternativeChartItemStyle="fill: "+e.alternativeChartBackground)}else e.theme="Aero"}function initializeLoadChartTheme(e,t){initializeGanttChartTheme(e,t),"Default"!=t&&(e.barHeight=20,e.allocationFill=e.mainFill?"white"!=e.mainFill?e.mainFill:e.mainStroke:"#8abbed",e.normalAllocationBarStyle=e.underAllocationBarStyle="stroke: "+e.allocationFill+"; fill: "+e.allocationFill,e.overAllocationBarStyle="stroke: #e31d3b; fill: #e31d3b")}function initializePertChartTheme(e,t){"Default"!=t&&(e.shapeStyle="fill: White; stroke: #606060; stroke-width: 1px",e.milestoneStyle="fill: White; stroke: #606060; stroke-width: 1px",e.dependencyLineStyle="stroke: #8abbed; stroke-width: 0.65px; fill: none; marker-end: url(#PertArrowMarker)",e.virtualEffortDependencyLineStyle="stroke: #8abbed; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#PertArrowMarker)")}!function(e){var t,i,n,s,r,a,o,l,d,h,c,u;t=e.Controls||(e.Controls={}),function(t){t.initialize=function(e,t,n){return new i(e,t,n)},t.get=function(e){return e.component};var i=function(){function t(i,n,s){this.host=i,this.settings=n,this.isInitialized=!1;var r="DlhSoft.Controls ContentControl DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");e[r[5]][r[4]](i,r[0],r[1],r[2],r[3],s,n),this.host.component=this,void 0===n&&(n={}),this.settings=n,t.initializeSettings(this.settings),void 0!==(n=this.settings.content)&&null!=n||(n=t.getContent(i)),this.content=n,this.settings.content=n,this.refresh(),this.isInitialized=!0}return t.initializeSettings=function(e){void 0===e.theme&&(e.theme="Modern"),void 0===e.containerStyle&&(e.containerStyle="font-family: Arial; font-size: "+("Modern"==e.theme?"12px":"small")),void 0===e.contentTemplate&&(e.contentTemplate=function(e,t){if(void 0!==t&&null!=t||(t=""),t instanceof HTMLElement)return t;var i=e.createElement("span");return i.innerHTML=t.toString(),i})},t.getContent=function(e){var t,i=e.ownerDocument.createElement("span"),n=[];for(t=0;t<e.childNodes.length;t++)n.push(e.childNodes[t]);for(t=e.childNodes.length;0<t--;)e.removeChild(e.childNodes[t]);for(t=0;t<n.length;t++)i.appendChild(n[t]);return i},t.prototype.refresh=function(){for(var e=this.host.ownerDocument,t=this.host.childNodes.length;0<t--;)this.host.removeChild(this.host.childNodes[t]);this.contentContainer=this.settings.contentTemplate(e,this.content),null!=this.settings.containerStyle&&this.contentContainer.setAttribute("style",this.settings.containerStyle),void 0!==this.settings.containerClass&&this.contentContainer.setAttribute("class",this.settings.containerClass),this.host.appendChild(this.contentContainer)},t.prototype.setContent=function(e){this.content=e,this.settings.content=e,this.refresh()},t}();t.Element=i}(i=t.ContentControl||(t.ContentControl={})),function(t){t.initialize=function(e,t,n,s){return new i(e,t,n,s)},t.get=function(e){return e.component};var i=function(){function t(i,n,s,r){this.host=i,this.settings=s,this.isInitialized=!1;var a="DlhSoft.Controls ItemsControl DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");e[a[5]][a[4]](i,a[0],a[1],a[2],a[3],r,s),this.host.component=this,void 0===s&&(s={}),this.settings=s,t.initializeSettings(this.settings),void 0!==n&&null!=n||(n=this.settings.items),void 0!==n&&null!=n||(n=t.getItems(i)),this.items=n,this.settings.items=n,this.refresh(),this.isInitialized=!0}return t.initializeSettings=function(e){void 0===e.theme&&(e.theme="Modern"),void 0===e.itemContainerStyle&&(e.itemContainerStyle="font-family: Arial; font-size: "+("Modern"==e.theme?"12px":"small")),void 0===e.itemTemplate&&(e.itemTemplate=function(e,t){if(void 0!==t&&null!=t||(t=""),t instanceof HTMLElement)return t;var i=e.createElement("span");return i.innerHTML=t.toString(),i})},t.getItems=function(e){var t,i=[];for(t=0;t<e.childNodes.length;t++)e.childNodes[t]instanceof HTMLElement&&i.push(e.childNodes[t]);for(t=e.childNodes.length;0<t--;)e.removeChild(e.childNodes[t]);return i},t.prototype.refresh=function(){for(var e=this.host.ownerDocument,t=this.host.childNodes.length;0<t--;)this.host.removeChild(this.host.childNodes[t]);for(this.itemContainers=[],t=0;t<this.items.length;t++){var i=this.settings.itemTemplate(e,this.items[t]);null!=this.settings.itemContainerStyle&&i.setAttribute("style",this.settings.itemContainerStyle),void 0!==this.settings.itemContainerClass&&i.setAttribute("class",this.settings.itemContainerClass),this.host.appendChild(i)}},t.prototype.setItems=function(e){this.items=e,this.settings.items=e,this.refresh()},t}();t.Element=i}(t.ItemsControl||(t.ItemsControl={})),function(t){t.initialize=function(e,t,i,s){return new n(e,t,i,s)},t.get=function(e){return e.component};var n=function(){function t(n,s,r,a){this.host=n,this.clickHandler=s,this.settings=r,this.isInitialized=!1,s="DlhSoft.Controls Button DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" "),e[s[5]][s[4]](n,s[0],s[1],s[2],s[3],a,r),this.host.component=this,void 0===r&&(r={}),this.settings=r,t.initializeSettings(this.settings);var o=this.host.ownerDocument;(this.inputHost=n instanceof HTMLInputElement?n:null)&&(o=o.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(o,this.inputHost),this.host=o,e[s[5]][s[4]](o,s[0],s[1],s[2],s[3],a,r),this.host.component=this),(r=this.host.getAttribute("style"))&&(this.settings.containerStyle=r+";"+this.settings.containerStyle,this.host.setAttribute("style","")),(r=this.host.getAttribute("class"))&&!this.settings.containerClass&&(this.settings.containerClass=r,this.host.setAttribute("class","")),void 0!==(r=this.settings.content)&&null!=r||(r=i.Element.getContent(n)),this.content=r,this.settings.content=r,this.isEnabled=this.settings.isEnabled,this.isInitialRefresh=!0,this.refresh(),this.isInitialized=!0}return t.initializeSettings=function(e){i.Element.initializeSettings(e),e.containerStyle+=("Modern"==e.theme?"; color: #505050":"")+"; display: inline-block; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; background-color: #f0f0f0; border: 1px solid #e0e0e0; "+("Modern"==e.theme?"":"; border-radius: 3px"),void 0===e.inputType&&(e.inputType="button"),void 0===e.isEnabled&&(e.isEnabled=!0),void 0===e.disabledStyle&&(e.disabledStyle="opacity: 0.5"),void 0===e.hoveringStyle&&(e.hoveringStyle="background-color: "+("Modern"==e.theme?"#e8e8ff":"#e8e8e8")),void 0===e.pressedStyle&&(e.pressedStyle="background-color: "+("Modern"==e.theme?"#d0d0ff":"#e8e8e8")),void 0===e.contentStyle&&(e.contentStyle="padding: 4px 8px 4px 8px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default")},t.prototype.refresh=function(){var e=this;if(!(this.isInitialRefresh&&(delete this.isInitialRefresh,this instanceof s.Element))){for(var t=this.host.ownerDocument,n=this.host.childNodes.length;0<n--;)this.host.removeChild(this.host.childNodes[n]);this.inputHost?(this.inputElement=this.inputHost,this.inputElement.value&&(this.content=this.inputElement.value)):this.inputElement=t.createElement("input"),this.settings.inputName&&this.inputElement.setAttribute("name",this.settings.inputName),this.inputElement.value||(this.inputElement.value=this.inputElement.name),this.inputElement.setAttribute("type","toggleButton"!=this.settings.inputType?this.settings.inputType:"checkbox"),this.inputElement.style.display="none",this.host.appendChild(this.inputElement),this.contentControlHost=t.createElement("div"),this.contentControlHost.setAttribute("style",this.settings.containerStyle),void 0!==this.settings.containerClass&&this.contentControlHost.setAttribute("class",this.settings.containerClass),this.host.appendChild(this.contentControlHost),this.contentControl=new i.Element(this.contentControlHost,{theme:this.settings.theme,containerStyle:null,content:this.content,contentTemplate:function(t,i){void 0!==i&&null!=i||(i="");var n=t.createElement("div");e.contentContainer=n,n.setAttribute("style",e.settings.contentStyle),void 0!==e.settings.contentClass&&n.setAttribute("class",e.settings.contentClass),n.appendChild(e.settings.contentTemplate(t,i));var s=t.createElement("div");e.hoverableContainer=s,e.isEnabled||(e.hoverableContainer.setAttribute("style",e.settings.disabledStyle),void 0!==e.settings.disabledClass&&e.hoverableContainer.setAttribute("class",e.settings.disabledClass));var r=t.createElement("div");return e.pressableContainer=r,r.appendChild(n),s.appendChild(r),s.onmouseenter=function(){e.isEnabled&&e.hoverableContainer==s&&(s.setAttribute("style",e.settings.hoveringStyle),void 0!==e.settings.hoveringClass&&s.setAttribute("class",e.settings.hoveringClass),"toggleButton"!=e.settings.inputType&&e.isPressed&&(r.setAttribute("style",e.settings.pressedStyle),void 0!==e.settings.pressedClass&&r.setAttribute("class",e.settings.pressedClass)),e.isHovering=!0,e.settings.hoveringHandler&&e.settings.hoveringHandler(e))},s.onmouseleave=function(){e.isEnabled&&e.hoverableContainer==s&&(e.isHovering=!1,s.setAttribute("style",""),s.setAttribute("class",""),"toggleButton"!=e.settings.inputType&&(r.setAttribute("style",""),r.setAttribute("class","")),e.settings.unhoveringHandler&&e.settings.unhoveringHandler(e))},"toggleButton"!=e.settings.inputType?(r.onmousedown=function(){e.isEnabled&&e.pressableContainer==r&&(r.setAttribute("style",e.settings.pressedStyle),void 0!==e.settings.pressedClass&&r.setAttribute("class",e.settings.pressedClass),e.isPressed=!0,e.settings.pressedHandler&&e.settings.pressedHandler(e))},t.addEventListener("mouseup",(function(){e.isEnabled&&e.pressableContainer==r&&(e.isPressed=!1,r.setAttribute("style",""),r.setAttribute("class",""),e.settings.unpressedHandler&&e.settings.unpressedHandler(e))}),!1),r.onmouseup=function(){if(e.isEnabled&&e.pressableContainer==r){e.clickHandler&&e.clickHandler();try{var t=e.inputElement.ownerDocument.createEvent("HTMLEvents");t.initEvent("click",!0,!0),e.inputElement.dispatchEvent(t)}catch(i){}}}):r.onmousedown=function(){if(e.isEnabled&&e.pressableContainer==r)if(e.isPressed){e.isPressed=!1,r.setAttribute("style",""),r.setAttribute("class",""),e.settings.unpressedHandler&&e.settings.unpressedHandler(e),e.clickHandler&&e.clickHandler();try{(i=e.inputElement.ownerDocument.createEvent("HTMLEvents")).initEvent("click",!0,!0),e.inputElement.dispatchEvent(i),(n=e.inputElement.ownerDocument.createEvent("HTMLEvents")).initEvent("change",!0,!0),e.inputElement.dispatchEvent(n)}catch(t){}}else{r.setAttribute("style",e.settings.pressedStyle),void 0!==e.settings.pressedClass&&r.setAttribute("class",e.settings.pressedClass),e.isPressed=!0,e.settings.pressedHandler&&e.settings.pressedHandler(e),e.clickHandler&&e.clickHandler();try{var i=e.inputElement.ownerDocument.createEvent("HTMLEvents");i.initEvent("click",!0,!0),e.inputElement.dispatchEvent(i);var n=e.inputElement.ownerDocument.createEvent("HTMLEvents");n.initEvent("change",!0,!0),e.inputElement.dispatchEvent(n)}catch(s){}}},s}},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}},t.prototype.setContent=function(e){this.content=e,this.settings.content=e,this.refresh()},t.prototype.enable=function(){this.isEnabled=!0,this.settings.isEnabled=!0,this.refresh()},t.prototype.disable=function(){this.isEnabled=!1,this.settings.isEnabled=!1,this.refresh()},t}();t.Element=n}(n=t.Button||(t.Button={})),function(e){e.initialize=function(e,i,n,s){return new t(e,i,n,s)},e.get=function(e){return e.component};var t=function(e){function t(t,i,n,s){var r=this;e.call(this,t,void 0,n,s),this.toggleHandler=i,this.isInitialized=!1,this.settings.inputType="toggleButton",this.clickHandler=function(){r.toggleHandler&&r.toggleHandler(r.isPressed)},this.refresh(),this.isInitialized=!0}return __extends(t,e),t}(n.Element);e.Element=t}(s=t.ToggleButton||(t.ToggleButton={})),function(t){t.initialize=function(e,t,n){return new i(e,t,n)},t.get=function(e){return e.component};var i=function(){function t(i,n,s){this.host=i,this.settings=n,this.isInitialized=!1;var r="DlhSoft.Controls TextBox DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");e[r[5]][r[4]](i,r[0],r[1],r[2],r[3],s,n),this.host.component=this,void 0===n&&(n={}),this.settings=n,t.initializeSettings(this.settings);var a=this.host.ownerDocument;(this.inputHost=i instanceof HTMLInputElement?i:null)&&(i=a.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(i,this.inputHost),this.host=i,e[r[5]][r[4]](i,r[0],r[1],r[2],r[3],s,n),this.host.component=this),void 0!==(n=n.value)&&null!=n||(n=this.inputHost?this.inputHost.value:this.host.innerText?this.host.innerText:this.host.innerHTML),this.value=n,this.settings.value=n,this.isEnabled=this.settings.isEnabled,this.refresh(),this.isInitialized=!0}return t.initializeSettings=function(e){void 0===e.theme&&(e.theme="Modern"),void 0===e.isEnabled&&(e.isEnabled=!0),void 0===e.isReadOnly&&(e.isReadOnly=!1),void 0===e.inputStyle&&"Modern"==e.theme&&(e.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px")},t.prototype.refresh=function(){for(var e=this,t=this.host.ownerDocument,i=this.host.childNodes.length;0<i--;)this.host.removeChild(this.host.childNodes[i]);this.inputElement=this.inputHost?this.inputHost:t.createElement("input"),this.settings.inputName&&this.inputElement.setAttribute("name",this.settings.inputName),this.inputElement.setAttribute("type","text"),void 0!==this.settings.inputStyle&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass),this.inputElement.value=this.value,this.settings.isReadOnly?this.inputElement.setAttribute("readonly","readonly"):this.inputElement.removeAttribute("readonly"),this.settings.isEnabled?this.inputElement.removeAttribute("disabled"):this.inputElement.setAttribute("disabled","disabled"),this.host.appendChild(this.inputElement),this.inputElement.onchange=function(){e.isEnabled&&(e.value=e.inputElement.value,e.settings.changeHandler&&e.settings.changeHandler(e.value))},this.inputElement.onclick=function(){e.settings.clickHandler&&e.settings.clickHandler()}},t.prototype.getValue=function(){return this.value},t.prototype.setValue=function(e){this.value=e,this.settings.value=e,this.refresh()},t.prototype.enable=function(){this.isEnabled=!0,this.settings.isEnabled=!0,this.refresh()},t.prototype.disable=function(){this.isEnabled=!1,this.settings.isEnabled=!1,this.refresh()},t}();t.Element=i}(t.TextBox||(t.TextBox={})),function(t){t.initialize=function(e,t,n,s){return new i(e,t,n,s)},t.get=function(e){return e.component};var i=function(){function t(i,n,s,r){this.host=i,this.selectedTime=n,this.settings=s,this.isInitialized=!1;var a="DlhSoft.Controls CalendarSelector DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");e[a[5]][a[4]](i,a[0],a[1],a[2],a[3],r,s),this.host.component=this,void 0===s&&(s={}),this.settings=s,t.initializeSettings(this.settings),void 0===n&&(n=s.minValue),n<s.minValue&&(n=s.minValue),this.selectedTime=n,null==this.settings.displayedTime&&(i=this.settings.rows*this.settings.columns,this.settings.displayedTime=Math.floor(this.selectedTime/i)*i),this.settings.displayedTime<s.minValue&&(this.settings.displayedTime=s.minValue),this.refresh(),this.isInitialized=!0}return t.initializeSettings=function(e){void 0===e.theme&&(e.theme="Modern"),void 0===e.rows?e.rows=4:0>=e.rows&&(e.rows=1),void 0===e.columns?e.columns=3:0>=e.columns&&(e.columns=1),void 0===e.headerProvider&&(e.headerProvider=function(t,i){return t.createTextNode(null!=i?i.toString()+" - "+(i+e.rows*e.columns-1).toString():"?")}),void 0===e.headerStyle&&(e.headerStyle="color: "+("Modern"==e.theme?"#505050":"Black")+"; background-color: #f0f0f0; padding: 8px; font-size: "+("Modern"==e.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),void 0===e.timeStyle&&(e.timeStyle="color: "+("Modern"==e.theme?"#505050":"Black")+"; min-width: "+Math.max(128/e.columns,64)+"px; height: "+Math.max(80/e.rows,20)+"px; padding: 2px; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; font-size: "+("Modern"==e.theme?"12px":"small")),void 0===e.selectedTimeStyle&&(e.selectedTimeStyle="background-color: #3399ff; color: White; padding: 2px"),void 0===e.timeFormatter&&(e.timeFormatter=function(e){return e.toString()}),void 0===e.invertMatrix&&(e.invertMatrix=!1),void 0===e.minValue&&(e.minValue=0),void 0===e.scrollingHeight&&(e.scrollingHeight="auto")},t.prototype.refresh=function(){for(var e=this,t=this.host.ownerDocument,i=this.host.childNodes.length;0<i--;)this.host.removeChild(this.host.childNodes[i]);(i=t.createElement("table")).cellSpacing="0",i.cellPadding="0",i.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&i.setAttribute("class",this.settings.containerClass);var n=null!=this.settings.displayedTime?this.settings.displayedTime:0,s=t.createElement("tr");s.setAttribute("style",this.settings.headerStyle),s.setAttribute("class",this.settings.headerClass),(r=t.createElement("td")).setAttribute("style","text-align: left; padding-left: 4px"),(a=t.createElement("a")).setAttribute("href","javascript://"),a.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),a.appendChild(t.createTextNode("◄")),a.onclick=function(t){e.setDisplayedValue(n-e.settings.rows*e.settings.columns),t.stopPropagation()},r.appendChild(a),s.appendChild(r),(r=t.createElement("td")).setAttribute("style",this.settings.headerStyle),r.setAttribute("class",this.settings.headerClass),(a=t.createElement("span")).appendChild(this.settings.headerProvider(t,this.settings.displayedTime)),r.appendChild(a),s.appendChild(r),(r=t.createElement("td")).setAttribute("style","text-align: right; padding-right: 4px"),(a=t.createElement("a")).setAttribute("href","javascript://"),a.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),a.appendChild(t.createTextNode("►")),a.onclick=function(t){e.setDisplayedValue(n+e.settings.rows*e.settings.columns),t.stopPropagation()},r.appendChild(a),s.appendChild(r),i.appendChild(s),r=t.createElement("tr"),i.appendChild(r),(s=t.createElement("td")).colSpan=3,r.appendChild(s),(r=t.createElement("div")).setAttribute("style","padding: 2px; max-height: "+this.settings.scrollingHeight+"; overflow-y: auto"),s.appendChild(r),(s=t.createElement("table")).cellSpacing="0",s.cellPadding="0",r.appendChild(s);for(var r=null!=this.settings.displayedTime?this.settings.displayedTime:0,a=null!=this.selectedTime?this.selectedTime:0,o=this.settings.rows,l=this.settings.columns,d=0;d<o;d++){for(var h=t.createElement("tr"),c=0;c<l;c++){this.settings.invertMatrix&&(r=n+c*o+d);var p,m=t.createElement("td");m.setAttribute("style",this.settings.timeStyle),m.setAttribute("class",this.settings.timeClass);try{p=this.settings.timeFormatter(r)}catch(u){p=r.toString()}var g=t.createElement("div");m.appendChild(g);var f=t.createElement("a");f.setAttribute("href","javascript://"),f.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),f.appendChild(t.createTextNode(p)),g.appendChild(f),null!=a&&r==a&&(g.setAttribute("style",this.settings.selectedTimeStyle),g.setAttribute("class",this.settings.selectedTimeClass),this.selectedElement=g),f.value=r,f.onclick=function(t){e.setValue(t.currentTarget.value),t.stopPropagation()},h.appendChild(m),r++}s.appendChild(h)}this.host.appendChild(i)},t.prototype.getValue=function(){return this.selectedTime},t.prototype.setValue=function(e){(!e||e<this.settings.minValue)&&(e=this.settings.minValue),this.selectedTime=e,this.refresh(),this.settings.selectedTimeChangeHandler&&this.settings.selectedTimeChangeHandler(e)},t.prototype.setDisplayedValue=function(e){(!e||e<this.settings.minValue)&&(e=this.settings.minValue),null!=this.settings.displayedTime&&e==this.settings.displayedTime||(this.settings.displayedTime=e,this.refresh(),this.settings.displayedTimeChangeHandler&&this.settings.displayedTimeChangeHandler(e))},t}();t.Element=i}(r=t.CalendarSelector||(t.CalendarSelector={})),function(t){t.initialize=function(e,t,n,s){return new i(e,t,n,s)},t.get=function(e){return e.component};var i=function(){function t(i,n,s,r){this.host=i,this.selectedDate=n,this.settings=s,this.isInitialized=!1;var a="DlhSoft.Controls Calendar DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");e[a[5]][a[4]](i,a[0],a[1],a[2],a[3],r,s),this.host.component=this,void 0===s&&(s={}),this.settings=s,t.initializeSettings(this.settings),void 0===n&&(n=new Date),n<this.settings.minValue&&(n=this.settings.minValue),this.selectedDates=(this.selectedDate=n)?[this.selectedDate]:[],this.selectedDateRanges=(this.selectedDateRange=this.selectedDate?{start:this.selectedDate,finish:this.selectedDate}:null)?[this.selectedDateRange]:null,null==this.settings.displayedDate&&(this.settings.displayedDate=this.selectedDate),this.settings.displayedDate<this.settings.minValue&&(this.settings.displayedDate=this.settings.minValue),this.refresh(),this.isInitialized=!0}return t.initializeSettings=function(e){void 0===e.theme&&(e.theme="Modern"),void 0===e.isReadOnly&&(e.isReadOnly=!1),void 0===e.isTodayLinkVisible&&(e.isTodayLinkVisible=!1),void 0===e.defaultTimeOfDay&&(e.defaultTimeOfDay=0),void 0===e.allowMultipleSelection&&(e.allowMultipleSelection=!1),void 0===e.allowRangeSelection&&(e.allowRangeSelection=!1),void 0===e.monthYearHeaderStyle&&(e.monthYearHeaderStyle="color: "+("Modern"==e.theme?"#505050":"Black")+"; background-color: #f0f0f0; padding: 8px; font-size: "+("Modern"==e.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),void 0===e.dayOfWeekHeaderStyle&&(e.dayOfWeekHeaderStyle="color: "+("Modern"==e.theme?"#505050":"Black")+"; padding: 3px; padding-top: 4px; padding-bottom: 2px; border-bottom: 1px solid "+("Modern"==e.theme?"#e0e0e0":"Silver")+"; font-size: "+("Modern"==e.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),void 0===e.dayStyle&&(e.dayStyle="color: "+("Modern"==e.theme?"#505050":"Black")+"; min-width: 24px; padding: 2px; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; font-size: "+("Modern"==e.theme?"12px":"small")+(e.allowMultipleSelection||e.allowRangeSelection?"; height: "+("Modern"==e.theme?"18px":"20px"):"")),void 0===e.otherMonthDayStyle&&(e.otherMonthDayStyle="color: "+("Modern"==e.theme?"#c0c0c0":"Silver")),void 0===e.selectedDayStyle&&(e.selectedDayStyle="background-color: #3399ff; color: White; padding: 2px"),void 0===e.disabledDayStyle&&(e.disabledDayStyle="color: "+("Modern"==e.theme?"#c0c0c0":"Silver")),void 0===e.todayLinkStyle&&(e.todayLinkStyle="color: "+("Modern"==e.theme?"#505050":"Black")+"; padding: 4px; border-top: 1px solid "+("Modern"==e.theme?"#e0e0e0":"Silver")+"; font-size: "+("Modern"==e.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),void 0===e.todayString&&(e.todayString="Today"),void 0===e.months&&(e.months="January February March April May June July August September October November December".split(" ")),void 0===e.daysOfWeek&&(e.daysOfWeek="Su Mo Tu We Th Fr Sa".split(" ")),void 0===e.monthRows&&(e.monthRows=1),1>e.monthRows&&(e.monthRows=1),void 0===e.monthColumns&&(e.monthColumns=1),1>e.monthColumns&&(e.monthColumns=1),void 0===e.monthCellSpacing&&(e.monthCellSpacing="0"),void 0===e.applyMonthStyleForSingleCell&&(e.applyMonthStyleForSingleCell=!1),void 0===e.applyNextMonthButtonToLastColumn&&(e.applyNextMonthButtonToLastColumn=!0),void 0===e.applyNextMonthButtonToLastRow&&(e.applyNextMonthButtonToLastRow=!1),void 0===e.containerStyle&&(e.containerStyle=("Modern"==e.theme?"":"border: 1px solid #707070; ")+"font-family: Arial"+(void 0===e.monthCellStyle&&(1<e.monthRows||1<e.monthColumns||e.applyMonthStyleForSingleCell)?"Modern"==e.theme?"; margin: -2px":"; padding: 2px":"Modern"==e.theme?"; border: 1px solid #e0e0e0":"")),void 0===e.monthCellStyle&&(e.monthCellStyle="margin: 2px; border: 1px solid "+("Modern"==e.theme?"#e0e0e0":"Silver")),void 0===e.calendarSelectorLevels&&(e.calendarSelectorLevels=0),void 0===e.calendarSelectorPopupStyle&&(e.calendarSelectorPopupStyle="background-color: White; border: 1px solid "+("Modern"==e.theme?"#e0e0e0":"#707070")+"; font-family: Arial"),void 0===e.minValue&&(e.minValue=new Date(101,0,1))},t.prototype.refresh=function(){for(var e=this,i=this.host.ownerDocument,n=this.host.childNodes.length;0<n--;)this.host.removeChild(this.host.childNodes[n]);var s,a;(n=i.createElement("table")).cellSpacing=this.settings.monthCellSpacing,n.cellPadding="0",n.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&n.setAttribute("class",this.settings.containerClass);var o=t.getDate(null!=this.settings.displayedDate?this.settings.displayedDate:null!=this.selectedDate?this.selectedDate:new Date);this.settings.defaultTimeOfDay>=t.dayDuration&&(o=t.subtractDay(o)),s=o;for(var l=0;l<this.settings.monthRows;l++){var d=i.createElement("tr");n.appendChild(d);for(var h=0;h<this.settings.monthColumns;h++){a=i.createElement("td"),d.appendChild(a);var c=i.createElement("table");c.cellSpacing="0",c.cellPadding="0",(1<this.settings.monthRows||1<this.settings.monthColumns||this.settings.applyMonthStyleForSingleCell)&&(c.setAttribute("style",this.settings.monthCellStyle),c.setAttribute("class",this.settings.monthCellClass)),a.appendChild(c),(a=i.createElement("tr")).setAttribute("style",this.settings.monthYearHeaderStyle),a.setAttribute("class",this.settings.monthYearHeaderClass);var u=i.createElement("td");u.setAttribute("style","text-align: left; padding-left: 4px"),0==l&&0==h&&((p=i.createElement("a")).setAttribute("href","javascript://"),p.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),p.appendChild(i.createTextNode("◄")),p.onclick=function(i){for(var n=o;n.getMonth()==o.getMonth();)n=t.subtractDay(n);e.setDisplayedValue(n),i.stopPropagation()},u.appendChild(p)),a.appendChild(u),(u=i.createElement("td")).setAttribute("style",this.settings.monthYearHeaderStyle),u.setAttribute("class",this.settings.monthYearHeaderClass),u.colSpan=5;var p=i.createElement("span"),m=i.createTextNode(this.settings.months[s.getMonth()]+" "+s.getFullYear());if(1>this.settings.calendarSelectorLevels||0<l||0<h)p.appendChild(m);else{var g=i.createElement("a");g.setAttribute("href","javascript://"),g.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),g.appendChild(m),p.appendChild(g);var f=i.createElement("div");f.setAttribute("style","display: none; position: absolute; margin-left: -40px"),g.appendChild(f);var v=i.createElement("div");v.setAttribute("style",this.settings.calendarSelectorPopupStyle),this.settings.calendarSelectorPopupClass&&v.setAttribute("class",this.settings.calendarSelectorPopupClass),f.appendChild(v),g.onclick=function(t){if((t.target||t.srcElement)==g){if("none"!=f.style.display)f.style.display="none";else{var i=12*o.getFullYear()+o.getMonth(),n={theme:e.settings.theme,headerProvider:function(t,i){var n=t.createTextNode(Math.floor(i/12).toString());if(2>e.settings.calendarSelectorLevels)return n;var a=t.createElement("a");a.setAttribute("href","javascript://"),a.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),a.appendChild(n);var o=t.createElement("div");o.setAttribute("style","display: none; position: absolute; margin-left: -10px"),a.appendChild(o);var l=t.createElement("div");return l.setAttribute("style",e.settings.calendarSelectorPopupStyle),e.settings.calendarSelectorPopupClass&&l.setAttribute("class",e.settings.calendarSelectorPopupClass),o.appendChild(l),a.onclick=function(t){if((t.target||t.srcElement)==a){if("none"!=o.style.display)o.style.display="none";else{var n=Math.floor(i/12)-1;o.style.display="block";var d=r.initialize(l,n,{rows:5,columns:2,invertMatrix:!0,headerProvider:function(t,i){var n=t.createTextNode((i+1).toString()+" - "+(i+10).toString());if(3>e.settings.calendarSelectorLevels)return n;var s=t.createElement("a");s.setAttribute("href","javascript://"),s.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),s.appendChild(n);var a=t.createElement("div");a.setAttribute("style","display: none; position: absolute; margin-left: -10px"),s.appendChild(a);var o=t.createElement("div");return o.setAttribute("style",e.settings.calendarSelectorPopupStyle),e.settings.calendarSelectorPopupClass&&o.setAttribute("class",e.settings.calendarSelectorPopupClass),a.appendChild(o),s.onclick=function(e){if((e.target||e.srcElement)==s){if("none"!=a.style.display)a.style.display="none";else{var t=Math.floor(i/10);a.style.display="block",r.initialize(o,t,{rows:5,columns:2,invertMatrix:!0,headerProvider:function(e,t){return e.createTextNode((10*t+1).toString()+" - "+(10*(t+10)).toString())},timeFormatter:function(e){return(10*e+1).toString()+"-"+(10*e+10).toString().substr((10*e+10).toString().length-2)},minValue:10},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.").settings.selectedTimeChangeHandler=function(e){d.setDisplayedValue(10*e)}}e.stopPropagation()}},s},timeFormatter:function(e){return(e+1).toString()},minValue:100},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");d.settings.selectedTimeChangeHandler=function(e){s.setDisplayedValue(12*(e+1))}}t.stopPropagation()}},a},timeFormatter:function(t){return e.settings.months[t-12*Math.floor(t/12)]},minValue:1212};f.style.display="block";var s=r.initialize(v,i,n,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");s.settings.selectedTimeChangeHandler=function(t){e.setDisplayedValue(new Date(Math.floor(t/12),t-12*Math.floor(t/12),1))}}t.stopPropagation()}}}for(u.appendChild(p),a.appendChild(u),(u=i.createElement("td")).setAttribute("style","text-align: right; padding-right: 4px"),(this.settings.applyNextMonthButtonToLastRow?l==this.settings.monthRows-1:0==l)&&(this.settings.applyNextMonthButtonToLastColumn?h==this.settings.monthColumns-1:0==h)&&((p=i.createElement("a")).setAttribute("href","javascript://"),p.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),p.appendChild(i.createTextNode("►")),p.onclick=function(i){for(var n=o;n.getMonth()==o.getMonth();)n=t.addDay(n);e.setDisplayedValue(n),i.stopPropagation()},u.appendChild(p)),a.appendChild(u),c.appendChild(a),u=i.createElement("tr"),a=0;7>a;a++)(p=i.createElement("td")).setAttribute("style",this.settings.dayOfWeekHeaderStyle),p.setAttribute("class",this.settings.dayOfWeekHeaderClass),p.appendChild(i.createTextNode(this.settings.daysOfWeek[a])),u.appendChild(p);for(c.appendChild(u),null!=(u=null!=this.selectedDate?t.getDate(this.selectedDate):null)&&this.settings.defaultTimeOfDay>=t.dayDuration&&(u=t.subtractDay(u)),p=s.getMonth(),a=t.getFirstDayOfMonth(s),m=t.getPreviousWeekStart(a),s=0;6>s;s++){var y=i.createElement("tr");for(a=0;7>a;a++){var C=i.createElement("td");C.setAttribute("style",this.settings.dayStyle),C.setAttribute("class",this.settings.dayClass);var b=m.getDate().toString(),S=i.createElement("span");C.appendChild(S);var w=i.createElement("span");S.appendChild(w);var T=void 0!==this.settings.disabledDateSelector&&this.settings.disabledDateSelector(m),x=m.getMonth()==p,D=i.createElement("a");D.setAttribute("href","javascript://"),D.setAttribute("style","text-decoration: none; display: inline-block; cursor: "+(this.settings.isReadOnly||T||!x&&(this.settings.allowRangeSelection||this.settings.allowMultipleSelection)?"default":"pointer")+"; color: inherit; width: 20px"),D.appendChild(i.createTextNode(b)),w.appendChild(D),T?(S.setAttribute("style",this.settings.disabledDayStyle),S.setAttribute("class",this.settings.disabledDayClass)):x?((b=u&&Math.abs(m.valueOf()-u.valueOf())<=t.hourDuration||this.isValueSelected(m))&&(S.setAttribute("style",this.settings.selectedDayStyle),S.setAttribute("class",this.settings.selectedDayClass)),this.settings.highlightingStyleSelector&&(S=this.settings.highlightingStyleSelector(m,b))&&w.setAttribute("style",S),this.settings.highlightingClassSelector&&(S=this.settings.highlightingClassSelector(m,b))&&w.setAttribute("class",S)):(w.setAttribute("style",this.settings.otherMonthDayStyle),w.setAttribute("class",this.settings.otherMonthDayClass)),!this.settings.isReadOnly&&!T&&(D.value=t.addTimeOfDay(m,this.settings.defaultTimeOfDay),this.settings.allowMultipleSelection||this.settings.allowRangeSelection?this.settings.allowRangeSelection?x&&(D.onmousedown=function(t){var i=t.currentTarget.value;e.draggingFromDate=i,e.setValue(i),t.preventDefault()},D.onmouseover=function(t){e.draggingFromDate&&(t=t.currentTarget.value,!e.draggingToDate||t.valueOf()!=e.draggingToDate.valueOf())&&(e.draggingToDate=t,e.setValueRange({start:e.draggingFromDate,finish:e.draggingToDate}))}):x&&(D.onclick=function(t){e.invertValueSelection(t.currentTarget.value),t.stopPropagation()}):D.onclick=function(t){var i=t.currentTarget.value;e.setDisplayedValue(i),e.setValue(i),t.stopPropagation()}),y.appendChild(C),m=t.addDay(m)}c.appendChild(y)}s=m}}!this.settings.isReadOnly&&this.settings.isTodayLinkVisible&&(l=i.createElement("tr"),(d=i.createElement("td")).colSpan=7,d.setAttribute("style",this.settings.todayLinkStyle),d.setAttribute("class",this.settings.todayLinkClass),(h=i.createElement("a")).setAttribute("href","javascript://"),h.setAttribute("style","text-decoration: none; color: inherit; cursor: pointer"),h.appendChild(i.createTextNode(this.settings.todayString)),d.appendChild(h),h.value=t.addTimeOfDay(t.getDate(new Date),this.settings.defaultTimeOfDay),h.onclick=function(t){var i=t.currentTarget.value;e.setDisplayedValue(i),e.setValue(i),t.stopPropagation()},l.appendChild(d),n.appendChild(l)),this.host.appendChild(n),this.isInitialized||i.addEventListener("mouseup",(function(){e.draggingToDate&&delete e.draggingToDate,e.draggingFromDate&&delete e.draggingFromDate}),!0)},t.prototype.getValue=function(){return this.selectedDate},t.prototype.setValue=function(e){null!=e&&e<this.settings.minValue&&(e=this.settings.minValue),(null==this.selectedDate&&null!=e||null!=this.selectedDate&&null==e||null!=this.selectedDate&&null!=e&&e.valueOf()!=this.selectedDate.valueOf()||this.settings.forceSetOnClick)&&(this.isDuringInternalSetValue=!0,this.selectedDate=e,this.setValues(null!=e?[e]:[]),delete this.isDuringInternalSetValue,null==this.settings.displayedDate&&null!=e?(this.settings.displayedDate=e,this.refresh(),this.settings.displayedDateChangeHandler&&this.settings.displayedDateChangeHandler(e)):this.refresh(),this.settings.selectedDateChangeHandler&&this.settings.selectedDateChangeHandler(e))},t.prototype.setDisplayedValue=function(e){null!=e&&e<this.settings.minValue&&(e=this.settings.minValue),null!=this.settings.displayedDate&&e.valueOf()==this.settings.displayedDate.valueOf()||(this.settings.displayedDate=e,this.refresh(),this.settings.displayedDateChangeHandler&&this.settings.displayedDateChangeHandler(e))},t.prototype.getValues=function(){return this.selectedDates},t.prototype.setValues=function(e){this.selectedDates=e,0<e.length&&(this.isDuringInternalSetValues=!0,this.selectedDate=e[0],this.setValueRanges([{start:this.selectedDate,finish:this.selectedDate}]),delete this.isDuringInternalSetValues)},t.prototype.getValueRange=function(){return this.selectedDateRange},t.prototype.setValueRange=function(e){if(e.finish||(e.finish=e.start),e.finish<e.start){var t=e.finish;e.finish=e.start,e.start=t}this.setValueRanges([e])},t.prototype.getValueRanges=function(){return this.selectedDateRanges},t.prototype.setValueRanges=function(e){if(this.selectedDateRanges=e,0<e.length&&(this.selectedDateRange=e[0],!this.isDuringInternalSetValues)){this.selectedDates=[];for(var i=0;i<e.length;i++){var n=e[i];if(n.finish||(n.finish=n.start),n.finish<n.start){var s=n.finish;n.finish=n.start,n.start=s}for(s=n.start;s<=n.finish;s=t.addDay(s))this.selectedDates.push(s)}this.selectedDate=this.selectedDateRange.start}this.isDuringInternalSetValue||(this.refresh(),this.settings.selectedDateChangeHandler&&this.settings.selectedDateChangeHandler(this.selectedDate)),this.settings.selectionChangedHandler&&this.settings.selectionChangedHandler()},t.prototype.isValueSelected=function(e){e=e.valueOf();for(var t=0;t<this.selectedDates.length;t++)if(this.selectedDates[t].valueOf()==e)return!0;return!1},t.prototype.invertValueSelection=function(e){for(var t=e.valueOf(),i=0;i<this.selectedDates.length;i++)if(this.selectedDates[i].valueOf()==t)return void(1<this.selectedDates.length&&(this.selectedDates.splice(i,1),this.setValues(this.selectedDates)));this.selectedDates.push(e),this.setValues(this.selectedDates)},t.getDate=function(e){var i=e.getTimezoneOffset()*t.minuteDuration;return new Date(Math.floor((e.valueOf()-i)/t.dayDuration)*t.dayDuration+i)},t.getPreviousWeekStart=function(e){for(var i=e=t.getDate(e);0<e.getDay();)e=t.subtractDay(e);if(i.valueOf()-e.valueOf()>6.5*t.dayDuration)for(i=0;7>i;i++)e=t.addDay(e);return e},t.addDay=function(e){var i=e.getTimezoneOffset()*t.minuteDuration;return i=(e=new Date(e.valueOf()-i+t.dayDuration)).getTimezoneOffset()*t.minuteDuration,new Date(e.valueOf()+i)},t.subtractDay=function(e){return t.getDate(new Date(e.valueOf()-t.dayDuration))},t.addTimeOfDay=function(e,i){var n=e.getTimezoneOffset()*t.minuteDuration;return n=(e=new Date(e.valueOf()-n+i)).getTimezoneOffset()*t.minuteDuration,new Date(e.valueOf()+n)},t.getFirstDayOfMonth=function(e){for(e=t.getDate(e);1<e.getDate();)e=t.subtractDay(e);return e},t.weekDuration=7*(t.dayDuration=24*(t.hourDuration=60*(t.minuteDuration=60*(t.secondDuration=1e3)))),t.initialSundayDateTimeValue=3*t.dayDuration,t}();t.Element=i}(a=t.Calendar||(t.Calendar={})),function(t){t.initialize=function(e,t,n,s){return new i(e,t,n,s)},t.get=function(e){return e.component};var i=function(){function t(i,n,s,r){this.host=i,this.value=n,this.settings=s,this.isInitialized=!1,this.dropDownButtonElement=null;var a="DlhSoft.Controls DatePicker DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");e[a[5]][a[4]](i,a[0],a[1],a[2],a[3],r,s),this.host.component=this,void 0===s&&(s={}),this.settings=s,t.initializeSettings(this.settings);var o=this.host.ownerDocument;if(this.inputHost=i instanceof HTMLInputElement?i:null){if(null==n)try{n=this.settings.dateTimeParser(this.inputHost.value)}catch(l){}i=o.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(i,this.inputHost),this.host=i,e[a[5]][a[4]](i,a[0],a[1],a[2],a[3],r,s),this.host.component=this}void 0===n&&(n=s.isNullValueAccepted?null:new Date),this.value=n,this.refresh(),this.isInitialized=!0}return t.initializeSettings=function(e){void 0===e.isTodayLinkVisible&&(e.isTodayLinkVisible=!0),void 0===e.calendarSelectorLevels&&(e.calendarSelectorLevels=1/0),void 0===e.popupStyle&&(e.popupStyle="background-color: White; border: 1px solid "+("Modern"==e.theme?"#e0e0e0":"#707070")+"; font-family: Arial"),void 0===e.calendarSelectorPopupStyle&&(e.calendarSelectorPopupStyle=e.popupStyle),void 0===e.calendarSelectorPopupClass&&(e.calendarSelectorPopupClass=e.popupClass),a.Element.initializeSettings(e),void 0===e.openDropDownOnInputClick&&(e.openDropDownOnInputClick=!0),void 0===e.dateTimeFormatter&&(e.dateTimeFormatter=function(t){if(null==t&&e.isNullValueAccepted)return"";var i=function(e,t){void 0===t&&(t=2);for(var i=e.toString();i.length<t;)i="0"+i;return i},n=t.getFullYear(),s=t.getMonth()+1,r=t.getDate(),a=t.getHours();return t=t.getMinutes(),i(s)+"/"+i(r)+"/"+i(n,4)+" "+i(a)+":"+i(t)}),void 0===e.dateTimeParser&&(e.dateTimeParser=function(t){return void 0===t||null==t||0==t.length?e.isNullValueAccepted?null:new Date:(t=new Date(t),isNaN(t.valueOf())||t.getFullYear()<=0?new Date:t)}),void 0===e.isNullValueAccepted&&(e.isNullValueAccepted=!0),void 0===e.isDropDownButtonVisible&&(e.isDropDownButtonVisible=!1),void 0===e.dropDownButtonDefinition&&(e.dropDownButtonDefinition="<svg style='display: inline-block; margin-left: 4px; cursor: pointer; vertical-align: middle' width='12' height='12'><rect x='0' y='0' width='12' height='3' style='fill: #707070; stroke: #707070; stroke-width: 0.65'/><rect x='0' y='3' width='12' height='9' style='fill: none; stroke: #707070; stroke-width: 0.65'/><line x1='3' y1='3' x2='3' y2='12' style='stroke: #707070; stroke-width: 0.65'/><line x1='6' y1='3' x2='6' y2='12' style='stroke: #707070; stroke-width: 0.65'/><line x1='9' y1='3' x2='9' y2='12' style='stroke: #707070; stroke-width: 0.65'/><line x1='0' y1='6' x2='12' y2='6' style='stroke: #707070; stroke-width: 0.65'/><line x1='0' y1='9' x2='12' y2='9' style='stroke: #707070; stroke-width: 0.65'/></svg>"),void 0===e.inputStyle&&"Modern"==e.theme&&(e.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px")},t.prototype.refresh=function(){for(var e=this,t=this.host.ownerDocument,i=this.host.childNodes.length;0<i--;)this.host.removeChild(this.host.childNodes[i]);if((i=t.createElement("div")).setAttribute("style","margin-top: -1px"),this.inputHost)(n=t.createElement("span")).setAttribute("style","display: inline-block"),n.appendChild(i),this.host.appendChild(n),this.popupElement=(i=this.host.firstChild).firstChild,this.inputHost.parentElement&&this.inputHost.parentElement.removeChild(this.inputHost),this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.inputHost,this.popupElement),this.inputElement=this.inputHost;else{var n=t.createElement("span");n.setAttribute("style","display: inline-block");var s=t.createElement("input");n.appendChild(s),n.appendChild(i),this.host.appendChild(n),this.inputElement=(i=this.host.firstChild).firstChild,this.popupElement=i.childNodes[1]}this.popupElement&&((i=t.createElement("div")).setAttribute("style",this.settings.popupStyle),this.settings.popupClass&&i.setAttribute("class",this.settings.popupClass),this.popupElement.appendChild(i)),this.inputElement&&(void 0!==this.settings.inputStyle&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass)),this.settings.isDropDownButtonVisible&&(this.dropDownButtonElement=t.createElement("span"),this.dropDownButtonElement.setAttribute("style","display: inline-block"),this.dropDownButtonElement.innerHTML=this.settings.dropDownButtonDefinition,this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.dropDownButtonElement,this.popupElement)),this.inputElement&&(this.inputElement.DatePicker=this,this.setValue(this.value),this.settings.isReadOnly&&this.inputElement.setAttribute("readonly","readonly")),this.popupElement&&(i=this.popupElement.firstChild,this.calendarHost=t.createElement("div"),i.appendChild(this.calendarHost)),this.calendarHost&&(this.calendar=new a.Element(this.calendarHost,this.value,{theme:this.settings.theme,isReadOnly:this.settings.isReadOnly,displayedDate:this.settings.displayedDate,defaultTimeOfDay:this.settings.defaultTimeOfDay,isTodayLinkVisible:this.settings.isTodayLinkVisible,containerStyle:null,monthYearHeaderStyle:this.settings.monthYearHeaderStyle,monthYearHeaderClass:this.settings.monthYearHeaderClass,dayOfWeekHeaderStyle:this.settings.dayOfWeekHeaderStyle,dayOfWeekHeaderClass:this.settings.dayOfWeekHeaderClass,dayStyle:this.settings.dayStyle,dayClass:this.settings.dayClass,otherMonthDayStyle:this.settings.otherMonthDayStyle,otherMonthDayClass:this.settings.otherMonthDayClass,selectedDayStyle:this.settings.selectedDayStyle,selectedDayClass:this.settings.selectedDayClass,disabledDayStyle:this.settings.disabledDayStyle,disabledDayClass:this.settings.disabledDayClass,todayLinkStyle:this.settings.todayLinkStyle,todayLinkClass:this.settings.todayLinkClass,monthRows:this.settings.monthRows,monthColumns:this.settings.monthColumns,monthCellSpacing:this.settings.monthCellSpacing,monthCellStyle:this.settings.monthCellStyle,monthCellClass:this.settings.monthCellClass,highlightingStyleSelector:this.settings.highlightingStyleSelector,highlightingClassSelector:this.settings.highlightingClassSelector,disabledDateSelector:this.settings.disabledDateSelector,applyMonthStyleForSingleCell:this.settings.applyMonthStyleForSingleCell,applyNextMonthButtonToLastColumn:!0,applyNextMonthButtonToLastRow:!1,allowMultipleSelection:!1,allowRangeSelection:!1,calendarSelectorLevels:this.settings.calendarSelectorLevels,calendarSelectorPopupStyle:this.settings.calendarSelectorPopupStyle,calendarSelectorPopupClass:this.settings.calendarSelectorPopupClass,minValue:this.settings.minValue,months:this.settings.months,daysOfWeek:this.settings.daysOfWeek,todayString:this.settings.todayString,forceSetOnClick:!0,selectedDateChangeHandler:function(t){e.setValue(t),e.settings.selectedDateChangeHandler&&e.settings.selectedDateChangeHandler(t)}},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),this.inputElement&&(this.inputElement.addEventListener("change",(function(){e.refreshValue()}),!0),this.dropDownButtonElement&&(this.dropDownButtonElement.onmousedown=function(){e.recordClick(),e.refreshValue(),setTimeout((function(){e.toggleDropDown()}),0)}),this.popupElement)&&(this.popupElement.style.position="absolute",this.popupElement.style.display="none",this.inputElement.addEventListener("focus",(function(){e.settings.openDropDownOnInputClick&&(e.openDropDown(),e.focusValue=e.inputElement.value)}),!0),this.inputElement.addEventListener("blur",(function(){e.settings.openDropDownOnInputClick&&void 0!==e.focusValue&&delete e.focusValue}),!0),this.inputElement.addEventListener("keydown",(function(t){13==t.keyCode?e.settings.openDropDownOnInputClick&&e.refreshValue():e.closeDropDown()}),!0),this.inputElement.addEventListener("mousedown",(function(){setTimeout((function(){!e.settings.openDropDownOnInputClick||void 0!==e.focusValue&&e.inputElement.value!=e.focusValue||(e.refreshValue(),e.openDropDown())}),0),e.recordClick()}),!0),this.inputElement.addEventListener("input",(function(){e.closeDropDown()}),!0),this.popupElement.onmousedown=function(){e.recordClick()},t.addEventListener("mousedown",(function(){setTimeout((function(){e.isDuringRecordedClick()||e.closeDropDown()}),0)}),!0),t.addEventListener("mousewheel",(function(){e.closeDropDown()}),!0),t.addEventListener("DOMMouseScroll",(function(){e.closeDropDown()}),!0))},t.prototype.recordClick=function(){var e=this;this.isDuringClick||(this.isDuringClick=!0,setTimeout((function(){delete e.isDuringClick}),0))},t.prototype.isDuringRecordedClick=function(){return void 0!==this.isDuringClick},t.prototype.getValue=function(){return this.value},t.prototype.setValue=function(e){this.resetValue(e)},t.prototype.setDisplayedValue=function(e){this.calendar&&this.calendar.setDisplayedValue(e)},t.prototype.refreshValue=function(){this.resetValue()},t.prototype.resetValue=function(e){if(!this.isDuringInternalSetValue){this.isDuringInternalSetValue=!0,this.closeDropDown();var t,i=this.value;try{this.value=null!=e?e:this.settings.dateTimeParser(this.inputElement.value)}catch(s){}null!=this.value&&this.value<this.settings.minValue&&(this.value=this.settings.isNullValueAccepted?null:this.settings.minValue),this.settings.disabledDateSelector&&null!=this.value&&this.settings.disabledDateSelector(this.value)&&(this.value=this.settings.isNullValueAccepted?null:new Date);try{t=this.settings.dateTimeFormatter(this.value)}catch(r){t=""}if(t!=this.inputElement.value&&(this.inputElement.value=t,this.isInitialized))try{var n=this.inputElement.ownerDocument.createEvent("HTMLEvents");n.initEvent("change",!0,!0),this.inputElement.dispatchEvent(n)}catch(a){}(this.value&&!i||!this.value&&i||this.value&&i&&this.value.valueOf()!=i.valueOf())&&(this.calendar&&(this.calendar.selectedDate=this.value,this.calendar.refresh()),this.settings.valueChangeHandler&&this.settings.valueChangeHandler(this.value)),delete this.isDuringInternalSetValue}},t.prototype.openDropDown=function(){this.isOpen||this.toggleDropDown()},t.prototype.closeDropDown=function(){this.isOpen&&this.toggleDropDown()},t.prototype.toggleDropDown=function(){var e=this;(this.isOpen=!this.isOpen)&&this.value&&this.setDisplayedValue(this.value);var t=function(){var t=e.inputElement.getBoundingClientRect();e.popupElement.style.position="fixed",e.popupElement.style.zIndex="1",e.popupElement.style.left=t.left+"px",e.popupElement.style.top=t.top+t.height+"px",e.popupElement.style.display=e.isOpen?"block":"none";var i=e.popupElement.getBoundingClientRect();i.bottom>e.popupElement.ownerDocument.documentElement.clientHeight&&t.top>=i.height&&(e.popupElement.style.top=t.top-i.height+2+"px"),i.right>e.popupElement.ownerDocument.documentElement.clientWidth&&e.popupElement.ownerDocument.documentElement.clientWidth>=i.width&&(e.popupElement.style.left=e.popupElement.ownerDocument.documentElement.clientWidth-i.width+"px")};if(t(),this.isOpen&&this.settings.dropDownOpenedHandler?this.settings.dropDownOpenedHandler():!this.isOpen&&this.settings.dropDownClosedHandler&&this.settings.dropDownClosedHandler(),this.isOpen){var i=this.host.ownerDocument.documentElement.clientWidth,n=this.host.ownerDocument.documentElement.clientHeight,s=this.host.getBoundingClientRect();this.positionChangeHandlerTimer=setInterval((function(){var r=e.host.ownerDocument.documentElement.clientWidth,a=e.host.ownerDocument.documentElement.clientHeight,o=e.host.getBoundingClientRect();r!=i||a!=n?e.closeDropDown():(o.left!=s.left||o.top!=s.top||o.width!=s.width||o.height!=s.height)&&t(),i=r,n=a,s=o}),100)}else this.positionChangeHandlerTimer&&(clearInterval(this.positionChangeHandlerTimer),delete this.positionChangeHandlerTimer)},t}();t.Element=i}(o=t.DatePicker||(t.DatePicker={})),function(t){var i=function(){function t(i,n,s,r,a){this.host=i,this.selectedTime=n,this.header=s,this.settings=r,this.isInitialized=!1;var o="DlhSoft.Controls CalendarDay DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");e[o[5]][o[4]](i,o[0],o[1],o[2],o[3],a,r),this.host.component=this,void 0===r&&(r={}),void 0!==s&&void 0===r.header&&(r.header=s),this.settings=r,t.initializeSettings(this.settings),void 0===n&&(i=new Date,n=new Date(i.valueOf()-i.getTimezoneOffset()*t.minuteDuration).getTime(),n-=Math.floor(n/t.dayDuration)*t.dayDuration),this.selectedTime=n,this.refresh(),this.isInitialized=!0}return t.initializeSettings=function(e){void 0===e.theme&&(e.theme="Modern"),void 0===e.isReadOnly&&(e.isReadOnly=!1),void 0===e.isNowLinkVisible&&(e.isNowLinkVisible=!1),void 0===e.header&&(e.header="Time of day"),void 0===e.isHeaderVisible&&(e.isHeaderVisible=!0),void 0===e.headerStyle&&(e.headerStyle="color: "+("Modern"==e.theme?"#505050":"Black")+"; background-color: #f0f0f0; padding: 8px; font-size: "+("Modern"==e.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),void 0===e.timeStyle&&(e.timeStyle="color: "+("Modern"==e.theme?"#505050":"Black")+"; min-width: 24px; padding: 2px; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; font-size: "+("Modern"==e.theme?"12px":"small")),void 0===e.selectedTimeStyle&&(e.selectedTimeStyle="background-color: #3399ff; color: White; padding: 2px"),void 0===e.disabledTimeStyle&&(e.disabledTimeStyle="color: "+("Modern"==e.theme?"#c0c0c0":"Silver")),void 0===e.nowLinkStyle&&(e.nowLinkStyle="color: "+("Modern"==e.theme?"#505050":"Black")+"; padding: 4px; border-top: 1px solid "+("Modern"==e.theme?"#e0e0e0":"Silver")+"; font-size: "+("Modern"==e.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),void 0===e.nowString&&(e.nowString="Now"),void 0===e.hourDivisions?e.hourDivisions=2:0>=e.hourDivisions&&(e.hourDivisions=1),void 0===e.timeFormatter&&(e.timeFormatter=function(e){var i=Math.floor(e/t.hourDuration),n=(e=Math.floor((e-i*t.hourDuration)/t.minuteDuration),function(e,t){void 0===t&&(t=2);for(var i=e.toString();i.length<t;)i="0"+i;return i});return n(i)+":"+n(e)}),void 0===e.hourColumns?e.hourColumns=4:0>=e.hourColumns&&(e.hourColumns=1),void 0===e.scrollingHeight&&(e.scrollingHeight="auto")},t.prototype.refresh=function(){for(var e=this,i=this.host.ownerDocument,n=this.host.childNodes.length;0<n--;)this.host.removeChild(this.host.childNodes[n]);if((n=i.createElement("table")).cellSpacing="0",n.cellPadding="0",n.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&n.setAttribute("class",this.settings.containerClass),this.settings.isHeaderVisible){var s=i.createElement("tr");s.setAttribute("style",this.settings.headerStyle),s.setAttribute("class",this.settings.headerClass),(r=i.createElement("td")).setAttribute("style",this.settings.headerStyle),r.setAttribute("class",this.settings.headerClass),(a=i.createElement("span")).appendChild(i.createTextNode(this.settings.header)),r.appendChild(a),s.appendChild(r),n.appendChild(s)}r=i.createElement("tr"),n.appendChild(r),s=i.createElement("td"),r.appendChild(s),(r=i.createElement("div")).setAttribute("style","max-height: "+this.settings.scrollingHeight+"; overflow-y: auto"),s.appendChild(r),(s=i.createElement("table")).cellSpacing="0",s.cellPadding="0",r.appendChild(s);for(var r=null!=this.selectedTime?t.getTime(this.selectedTime,this.settings.hourDivisions):null,a=this.settings.hourDivisions,o=this.settings.hourColumns,l=24/o,d=0;d<l*a;d++){for(var h=i.createElement("tr"),c=0;c<o;c++){var p,m=(c*l+d/a)*t.hourDuration,g=i.createElement("td");g.setAttribute("style",this.settings.timeStyle),g.setAttribute("class",this.settings.timeClass);try{p=this.settings.timeFormatter(m)}catch(u){p=(m/t.hourDuration).toString()}var f=i.createElement("span");g.appendChild(f);var v=i.createElement("span");f.appendChild(v);var y=void 0!==this.settings.disabledTimeSelector&&this.settings.disabledTimeSelector(m),C=i.createElement("a");if(C.setAttribute("href","javascript://"),C.setAttribute("style","text-decoration: none; display: inline-block; cursor: "+(this.settings.isReadOnly||y?"default":"pointer")+"; color: inherit; width: 40px"),C.appendChild(i.createTextNode(p)),v.appendChild(C),y)f.setAttribute("style",this.settings.disabledTimeStyle),f.setAttribute("class",this.settings.disabledTimeClass);else{var b=null!=r&&m==r;b&&(f.setAttribute("style",this.settings.selectedTimeStyle),f.setAttribute("class",this.settings.selectedTimeClass),this.selectedElement=f),this.settings.highlightingStyleSelector&&(f=this.settings.highlightingStyleSelector(m,b))&&v.setAttribute("style",f),this.settings.highlightingClassSelector&&(b=this.settings.highlightingClassSelector(m,b))&&v.setAttribute("class",b)}!this.settings.isReadOnly&&!y&&(C.value=m,C.onclick=function(t){e.setValue(t.currentTarget.value),t.stopPropagation()}),h.appendChild(g)}s.appendChild(h)}!this.settings.isReadOnly&&this.settings.isNowLinkVisible&&(p=i.createElement("tr"),(s=i.createElement("td")).setAttribute("style",this.settings.nowLinkStyle),s.setAttribute("class",this.settings.nowLinkClass),(r=i.createElement("a")).setAttribute("href","javascript://"),r.setAttribute("style","text-decoration: none; color: inherit; cursor: pointer"),r.appendChild(i.createTextNode(this.settings.nowString)),s.appendChild(r),r.value=-1,r.onclick=function(i){var n=i.currentTarget.value;0>n&&(n=new Date,n=new Date(n.valueOf()-n.getTimezoneOffset()*t.minuteDuration).getTime(),n-=Math.floor(n/t.dayDuration)*t.dayDuration),e.setValue(n),i.stopPropagation()},p.appendChild(s),n.appendChild(p)),this.host.appendChild(n)},t.prototype.getValue=function(){return this.selectedTime},t.prototype.setValue=function(e){null!=e&&0>e&&(e=0),(e!=this.selectedTime||this.settings.forceSetOnClick)&&(this.selectedTime=e,this.refresh(),this.settings.selectedTimeChangeHandler&&this.settings.selectedTimeChangeHandler(e))},t.getTime=function(e,i){var n=t.hourDuration/i;return Math.floor(e/n)*n},t.dayDuration=24*(t.hourDuration=60*(t.minuteDuration=60*(t.secondDuration=1e3))),t}();t.Element=i}(l=t.CalendarDay||(t.CalendarDay={})),function(t){t.initialize=function(e,t,n,s,r){return new i(e,t,n,s,r)},t.get=function(e){return e.component};var i=function(){function t(i,n,s,r,a){this.host=i,this.value=n,this.header=s,this.settings=r,this.isInitialized=!1,this.dropDownButtonElement=null;var o="DlhSoft.Controls TimePicker DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");if(e[o[5]][o[4]](i,o[0],o[1],o[2],o[3],a,r),this.host.component=this,void 0===r&&(r={}),void 0!==s&&void 0===r.header&&(r.header=s),this.settings=r,t.initializeSettings(this.settings),s=this.host.ownerDocument,this.inputHost=i instanceof HTMLInputElement?i:null){if(null==n)try{n=this.settings.timeParser(this.inputHost.value)}catch(l){}i=s.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(i,this.inputHost),this.host=i,e[o[5]][o[4]](i,o[0],o[1],o[2],o[3],a,r),this.host.component=this}void 0===n&&(r.isNullValueAccepted?n=null:(n=new Date,n=new Date(n.valueOf()-n.getTimezoneOffset()*t.minuteDuration).getTime(),n-=Math.floor(n/t.dayDuration)*t.dayDuration)),this.value=n,this.refresh(),this.isInitialized=!0}return t.initializeSettings=function(e){void 0===e.isNowLinkVisible&&(e.isNowLinkVisible=!0),void 0===e.timeFormatter&&(e.timeFormatter=function(i){if(null==i&&e.isNullValueAccepted)return"";var n=Math.floor(i/t.hourDuration),s=(i=Math.floor((i-n*t.hourDuration)/t.minuteDuration),function(e,t){void 0===t&&(t=2);for(var i=e.toString();i.length<t;)i="0"+i;return i});return s(n)+":"+s(i)}),l.Element.initializeSettings(e),void 0===e.openDropDownOnInputClick&&(e.openDropDownOnInputClick=!0),void 0===e.timeParser&&(e.timeParser=function(i){if(void 0===i||null==i||0==i.length)return e.isNullValueAccepted?null:0;var n=i.lastIndexOf(" ");return n>=0&&(i=i.substr(n+1)),i=new Date("01/01/1970 "+i),isNaN(i.valueOf())||i.getFullYear()<=0||1970!=i.getFullYear()||0!=i.getMonth()||1!=i.getDate()?(i=new Date,(i=new Date(i.valueOf()-i.getTimezoneOffset()*t.minuteDuration).getTime())-Math.floor(i/t.dayDuration)*t.dayDuration):i.getTime()-i.getTimezoneOffset()*t.minuteDuration}),void 0===e.isNullValueAccepted&&(e.isNullValueAccepted=!0),void 0===e.isDropDownButtonVisible&&(e.isDropDownButtonVisible=!1),void 0===e.dropDownButtonDefinition&&(e.dropDownButtonDefinition="<svg style='display: inline-block; margin-left: 4px; cursor: pointer; vertical-align: middle' width='12' height='12'><circle cx='6' cy='6' r='6' style='fill: none; stroke: #707070; stroke-width: 0.65'/><line x1='6' y1='2' x2='6' y2='6' style='stroke: #707070; stroke-width: 0.65'/><line x1='6' y1='6' x2='10' y2='6' style='stroke: #707070; stroke-width: 0.65'/></svg>"),void 0===e.popupStyle&&(e.popupStyle="background-color: White; border: 1px solid "+("Modern"==e.theme?"#e0e0e0":"#707070")+"; font-family: Arial"),void 0===e.inputStyle&&"Modern"==e.theme&&(e.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px"),void 0===e.defaultPrefix&&(e.defaultPrefix="")},t.prototype.refresh=function(){for(var e=this,t=this.host.ownerDocument,i=this.host.childNodes.length;0<i--;)this.host.removeChild(this.host.childNodes[i]);if((i=t.createElement("div")).setAttribute("style","margin-top: -1px"),this.inputHost)(n=t.createElement("span")).setAttribute("style","display: inline-block"),n.appendChild(i),this.host.appendChild(n),this.popupElement=(i=this.host.firstChild).firstChild,this.inputHost.parentElement&&this.inputHost.parentElement.removeChild(this.inputHost),this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.inputHost,this.popupElement),this.inputElement=this.inputHost;else{var n=t.createElement("span");n.setAttribute("style","display: inline-block");var s=t.createElement("input");n.appendChild(s),n.appendChild(i),this.host.appendChild(n),this.inputElement=(i=this.host.firstChild).firstChild,this.popupElement=i.childNodes[1]}this.popupElement&&((i=t.createElement("div")).setAttribute("style",this.settings.popupStyle),this.settings.popupClass&&i.setAttribute("class",this.settings.popupClass),this.popupElement.appendChild(i)),this.inputElement&&(void 0!==this.settings.inputStyle&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass)),this.settings.isDropDownButtonVisible&&(this.dropDownButtonElement=t.createElement("span"),this.dropDownButtonElement.setAttribute("style","display: inline-block"),this.dropDownButtonElement.innerHTML=this.settings.dropDownButtonDefinition,this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.dropDownButtonElement,this.popupElement)),this.inputElement&&(this.inputElement.TimePicker=this,this.setValue(this.value),this.settings.isReadOnly&&this.inputElement.setAttribute("readonly","readonly")),this.popupElement&&(i=this.popupElement.firstChild,this.calendarDayHost=t.createElement("div"),i.appendChild(this.calendarDayHost)),this.calendarDayHost&&(this.calendarDay=new l.Element(this.calendarDayHost,this.value,void 0,{theme:this.settings.theme,isReadOnly:this.settings.isReadOnly,header:this.settings.header,isHeaderVisible:this.settings.isHeaderVisible,isNowLinkVisible:this.settings.isNowLinkVisible,containerStyle:null,headerStyle:this.settings.headerStyle,headerClass:this.settings.headerClass,timeStyle:this.settings.timeStyle,timeClass:this.settings.timeClass,selectedTimeStyle:this.settings.selectedTimeStyle,selectedTimeClass:this.settings.selectedTimeClass,disabledTimeStyle:this.settings.disabledTimeStyle,disabledTimeClass:this.settings.disabledTimeClass,nowLinkStyle:this.settings.nowLinkStyle,nowLinkClass:this.settings.nowLinkClass,highlightingStyleSelector:this.settings.highlightingStyleSelector,highlightingClassSelector:this.settings.highlightingClassSelector,disabledTimeSelector:this.settings.disabledTimeSelector,nowString:this.settings.nowString,hourDivisions:this.settings.hourDivisions,timeFormatter:this.settings.timeFormatter,hourColumns:this.settings.hourColumns,scrollingHeight:this.settings.scrollingHeight,forceSetOnClick:!0,selectedTimeChangeHandler:function(t){e.setValue(t),e.settings.selectedTimeChangeHandler&&e.settings.selectedTimeChangeHandler(t)}},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),this.inputElement&&(this.inputElement.addEventListener("change",(function(){e.refreshValue()}),!0),this.dropDownButtonElement&&(this.dropDownButtonElement.onmousedown=function(){e.recordClick(),e.refreshValue(),setTimeout((function(){e.toggleDropDown()}),0)}),this.popupElement)&&(this.popupElement.style.position="absolute",this.popupElement.style.display="none",this.inputElement.addEventListener("focus",(function(){e.settings.openDropDownOnInputClick&&(e.openDropDown(),e.focusValue=e.inputElement.value)}),!0),this.inputElement.addEventListener("blur",(function(){e.settings.openDropDownOnInputClick&&void 0!==e.focusValue&&delete e.focusValue}),!0),this.inputElement.addEventListener("keydown",(function(t){13==t.keyCode?e.settings.openDropDownOnInputClick&&e.refreshValue():e.closeDropDown()}),!0),this.inputElement.addEventListener("mousedown",(function(){setTimeout((function(){!e.settings.openDropDownOnInputClick||void 0!==e.focusValue&&e.inputElement.value!=e.focusValue||(e.refreshValue(),e.openDropDown())}),0),e.recordClick()}),!0),this.inputElement.addEventListener("input",(function(){e.closeDropDown()}),!0),this.popupElement.onmousedown=function(){e.recordClick()},t.addEventListener("mousedown",(function(){setTimeout((function(){e.isDuringRecordedClick()||e.closeDropDown()}),0)}),!0),t.addEventListener("mousewheel",(function(t){e.isMouseWheelScrollingPopup(t)||e.closeDropDown()}),!0),t.addEventListener("DOMMouseScroll",(function(t){e.isMouseWheelScrollingPopup(t)||e.closeDropDown()}),!0))},t.prototype.recordClick=function(){var e=this;this.isDuringClick||(this.isDuringClick=!0,setTimeout((function(){delete e.isDuringClick}),0))},t.prototype.isDuringRecordedClick=function(){return void 0!==this.isDuringClick},t.prototype.isMouseWheelScrollingPopup=function(e){for(var t=void 0!==e.wheelDelta?e.wheelDelta/120:void 0!==e.detail?-e.detail/3:0,i=(e=e.target,!1);null!=e;){if(0<e.offsetHeight&&e.offsetHeight<e.scrollHeight&&!(1>=e.scrollTop&&0<t||e.scrollTop>=e.scrollHeight-e.clientHeight-1&&0>t)&&(i=!0),e==this.popupElement)return i;e=e.parentElement}return!1},t.prototype.getValue=function(){return this.value},t.prototype.setValue=function(e){this.resetValue(e)},t.prototype.refreshValue=function(){this.resetValue()},t.prototype.resetValue=function(e){if(!this.isDuringInternalSetValue){this.isDuringInternalSetValue=!0,this.closeDropDown();var i,n=this.value;try{this.value=null!=e?e:this.settings.timeParser(this.inputElement.value)}catch(r){}this.settings.disabledTimeSelector&&null!=this.value&&this.settings.disabledTimeSelector(this.value)&&(this.settings.isNullValueAccepted?this.value=null:(e=new Date,this.value=new Date(e.valueOf()-e.getTimezoneOffset()*t.minuteDuration).getTime(),this.value-=Math.floor(this.value/t.dayDuration)*t.dayDuration)),0<(e=0<=(e=this.inputElement.value?this.inputElement.value.lastIndexOf(" "):-1)?this.inputElement.value.substr(0,e):this.settings.defaultPrefix).length&&(e+=" ");try{i=e+this.settings.timeFormatter(this.value)}catch(a){}if(i!=this.inputElement.value&&(this.inputElement.value=i,this.isInitialized))try{var s=this.inputElement.ownerDocument.createEvent("HTMLEvents");s.initEvent("change",!0,!0),this.inputElement.dispatchEvent(s)}catch(o){}(this.value&&!n||!this.value&&n||this.value&&n&&this.value!=n)&&(this.calendarDay&&(this.calendarDay.selectedTime=this.value,this.calendarDay.refresh()),this.settings.valueChangeHandler&&this.settings.valueChangeHandler(this.value)),delete this.isDuringInternalSetValue}},t.prototype.openDropDown=function(){this.isOpen||this.toggleDropDown()},t.prototype.closeDropDown=function(){this.isOpen&&this.toggleDropDown()},t.prototype.toggleDropDown=function(){var e=this;this.isOpen=!this.isOpen;var t=function(){var t=e.inputElement.getBoundingClientRect();e.popupElement.style.position="fixed",e.popupElement.style.zIndex="1",e.popupElement.style.left=t.left+"px",e.popupElement.style.top=t.top+t.height+"px",e.popupElement.style.display=e.isOpen?"block":"none";var i=e.popupElement.getBoundingClientRect();i.bottom>e.popupElement.ownerDocument.documentElement.clientHeight&&t.top>=i.height&&(e.popupElement.style.top=t.top-i.height+2+"px"),i.right>e.popupElement.ownerDocument.documentElement.clientWidth&&e.popupElement.ownerDocument.documentElement.clientWidth>=i.width&&(e.popupElement.style.left=e.popupElement.ownerDocument.documentElement.clientWidth-i.width+"px")};if(t(),this.isOpen&&this.settings.dropDownOpenedHandler?this.settings.dropDownOpenedHandler():!this.isOpen&&this.settings.dropDownClosedHandler&&this.settings.dropDownClosedHandler(),this.isOpen){this.calendarDay.selectedElement&&this.calendarDay.selectedElement.scrollIntoView();var i=this.host.ownerDocument.documentElement.clientWidth,n=this.host.ownerDocument.documentElement.clientHeight,s=this.host.getBoundingClientRect();this.positionChangeHandlerTimer=setInterval((function(){var r=e.host.ownerDocument.documentElement.clientWidth,a=e.host.ownerDocument.documentElement.clientHeight,o=e.host.getBoundingClientRect();r!=i||a!=n?e.closeDropDown():(o.left!=s.left||o.top!=s.top||o.width!=s.width||o.height!=s.height)&&t(),i=r,n=a,s=o}),100)}else this.positionChangeHandlerTimer&&(clearInterval(this.positionChangeHandlerTimer),delete this.positionChangeHandlerTimer)},t.dayDuration=24*(t.hourDuration=60*(t.minuteDuration=60*(t.secondDuration=1e3))),t}();t.Element=i}(d=t.TimePicker||(t.TimePicker={})),function(e){e.initialize=function(e,i,n,s){return new t(e,i,n,s)},e.get=function(e){return e["DateTimePicker.component"]};var t=function(){function t(i,n,s,r){var a,l=this;this.host=i,this.value=n,this.settings=s,this.isInitialized=!1,this.host["DateTimePicker.component"]=this,void 0===s&&(s={}),void 0!==s.license&&void 0!==s.datePickerSettings&&(s.datePickerSettings.license=s.license),this.settings=s,t.initializeSettings(this.settings),void 0===n&&(n=s.datePickerSettings.isNullValueAccepted?null:new Date),this.value=n,this.timePicker=d.initialize(i,void 0,void 0,this.settings.timePickerSettings,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),this.inputElement=this.timePicker.inputElement,this.inputElement["DateTimePicker.component"]=this,this.datePicker=o.initialize(this.inputElement,this.value,this.settings.datePickerSettings,r),this.value=this.datePicker.value;try{a=n?this.datePicker.settings.dateTimeFormatter(n):""}catch(e){a=""}0<=(i=a.lastIndexOf(" "))&&(a=a.substr(0,i)),this.timePicker.settings.defaultPrefix=a;var h=this.datePicker.settings.dropDownOpenedHandler;this.datePicker.settings.dropDownOpenedHandler=function(){l.datePicker.isOpen&&l.timePicker.isOpen&&l.timePicker.closeDropDown(),l.isOpen=l.datePicker.isOpen,h&&h()};var c=this.datePicker.settings.dropDownClosedHandler;this.datePicker.settings.dropDownClosedHandler=function(){l.isOpen=l.datePicker.isOpen,c&&c()};var u=this.timePicker.settings.dropDownOpenedHandler;this.timePicker.settings.dropDownOpenedHandler=function(){l.timePicker.isOpen&&!l.value?l.timePicker.closeDropDown():(l.timePicker.isOpen&&l.datePicker.isOpen&&l.datePicker.closeDropDown(),l.isTimeOpen=l.timePicker.isOpen,u&&u())};var p=this.timePicker.settings.dropDownClosedHandler;this.timePicker.settings.dropDownClosedHandler=function(){l.isTimeOpen=l.timePicker.isOpen,p&&p()};var m=this.datePicker.settings.valueChangeHandler;this.datePicker.settings.valueChangeHandler=function(e){l.value=e,m&&m(e)},this.inputElement&&(this.inputElement.addEventListener("focus",(function(){if(l.settings.openDropDownOnInputClick){switch(l.getCurrentValuePart()){default:l.openDropDown();break;case"Time":l.timePicker.refreshValue(),l.openTimeDropDown()}l.focusValue=l.inputElement.value}}),!0),this.inputElement.addEventListener("blur",(function(){l.settings.openDropDownOnInputClick&&void 0!==l.focusValue&&delete l.focusValue}),!0),this.inputElement.addEventListener("keydown",(function(e){13==e.keyCode?l.settings.openDropDownOnInputClick&&l.refreshValue():l.closeDropDown()}),!0),this.inputElement.addEventListener("mousedown",(function(){setTimeout((function(){if(l.settings.openDropDownOnInputClick&&(void 0===l.focusValue||l.inputElement.value==l.focusValue))switch(l.getCurrentValuePart()){default:l.datePicker.refreshValue(),l.openDropDown();break;case"Time":l.timePicker.refreshValue(),l.openTimeDropDown()}}),0)}),!0)),this.isInitialized=!0}return t.initializeSettings=function(e){if(void 0===e.theme&&(e.theme="Modern"),void 0===e.isReadOnly&&(e.isReadOnly=!1),void 0===e.isNullValueAccepted&&(e.isNullValueAccepted=!0),void 0===e.openDropDownOnInputClick&&(e.openDropDownOnInputClick=!0),void 0===e.datePickerSettings&&(e.datePickerSettings={}),e.datePickerSettings.isReadOnly=e.isReadOnly,e.datePickerSettings.theme=e.theme,void 0===e.datePickerSettings.isTodayLinkVisible&&(e.datePickerSettings.isTodayLinkVisible=e.areCurrentLinksVisible),void 0===e.datePickerSettings.defaultTimeOfDay&&(e.datePickerSettings.defaultTimeOfDay=e.defaultTimeOfDay),e.datePickerSettings.openDropDownOnInputClick=!1,void 0===e.datePickerSettings.isDropDownButtonVisible&&(e.datePickerSettings.isDropDownButtonVisible=e.areDropDownButtonsVisible),e.datePickerSettings.allowMultipleSelection=!1,e.datePickerSettings.allowRangeSelection=!1,void 0===e.datePickerSettings.dateTimeFormatter&&(e.datePickerSettings.dateTimeFormatter=e.dateTimeFormatter),void 0===e.datePickerSettings.dateTimeParser&&(e.datePickerSettings.dateTimeParser=e.dateTimeParser),e.datePickerSettings.isNullValueAccepted=e.isNullValueAccepted,void 0===e.datePickerSettings.valueChangeHandler&&(e.datePickerSettings.valueChangeHandler=e.valueChangeHandler),void 0===e.datePickerSettings.popupClass&&(e.datePickerSettings.popupClass=e.popupClass),void 0===e.datePickerSettings.popupStyle&&(e.datePickerSettings.popupStyle=e.popupStyle),void 0===e.datePickerSettings.inputClass&&(e.datePickerSettings.inputClass=e.inputClass),void 0===e.datePickerSettings.inputStyle&&(e.datePickerSettings.inputStyle=e.inputStyle),void 0===e.datePickerSettings.disabledDateSelector&&(e.datePickerSettings.disabledDateSelector=e.disabledDateSelector),void 0===e.datePickerSettings.calendarSelectorLevels&&(e.datePickerSettings.calendarSelectorLevels=e.calendarSelectorLevels),void 0===e.datePickerSettings.months&&(e.datePickerSettings.months=e.months),void 0===e.datePickerSettings.daysOfWeek&&(e.datePickerSettings.daysOfWeek=e.daysOfWeek),void 0===e.timePickerSettings&&(e.timePickerSettings={}),e.timePickerSettings.theme=e.theme,e.timePickerSettings.isReadOnly=e.isReadOnly,void 0===e.timePickerSettings.isNowLinkVisible&&(e.timePickerSettings.isNowLinkVisible=e.areCurrentLinksVisible),void 0===e.timePickerSettings.nowString&&(e.timePickerSettings.nowString="Current"),e.timePickerSettings.openDropDownOnInputClick=!1,void 0===e.timePickerSettings.isDropDownButtonVisible&&(e.timePickerSettings.isDropDownButtonVisible=e.areDropDownButtonsVisible),void 0===e.timePickerSettings.timeFormatter&&void 0!==e.datePickerSettings.dateTimeFormatter&&(e.timePickerSettings.timeFormatter=function(t){var i=new Date(1970,0,1);return t=null!=t?e.datePickerSettings.dateTimeFormatter(new Date(i.valueOf()+t)):"",(i=t.lastIndexOf(" "))<0?"":t.substr(i+1)}),void 0===e.timePickerSettings.timeParser&&void 0!==e.datePickerSettings.dateTimeParser&&void 0!==e.datePickerSettings.dateTimeFormatter&&(e.timePickerSettings.timeParser=function(i){if((n=i.lastIndexOf(" "))<0)return e.isNullValueAccepted?null:(i=new Date,(i=new Date(i.valueOf()-i.getTimezoneOffset()*t.minuteDuration).getTime())-Math.floor(i/t.dayDuration)*t.dayDuration);i=i.substr(n+1);var n,s=e.datePickerSettings.dateTimeFormatter(new Date(1970,0,1));return(n=s.indexOf(" "))>=0&&(s=s.substr(0,n+1)),i=e.datePickerSettings.dateTimeParser(s+i),isNaN(i.valueOf())||i.getFullYear()<=0||1970!=i.getFullYear()||0!=i.getMonth()||1!=i.getDate()?(i=new Date,(i=new Date(i.valueOf()-i.getTimezoneOffset()*t.minuteDuration).getTime())-Math.floor(i/t.dayDuration)*t.dayDuration):i.getTime()-i.getTimezoneOffset()*t.minuteDuration}),e.timePickerSettings.isNullValueAccepted=e.isNullValueAccepted,void 0!==e.timePickerSettings.disabledTimeSelector){var i=e.datePickerSettings.disabledDateSelector;e.datePickerSettings.disabledDateSelector=function(n){var s=!1;return i&&(s=i(n)),!!s||(n=new Date(n.valueOf()-n.getTimezoneOffset()*t.minuteDuration).getTime(),n-=Math.floor(n/t.dayDuration)*t.dayDuration,e.timePickerSettings.disabledTimeSelector(n))}}void 0===e.timePickerSettings.popupClass&&(e.timePickerSettings.popupClass=e.popupClass),void 0===e.timePickerSettings.popupStyle&&(e.timePickerSettings.popupStyle=e.popupStyle),e.timePickerSettings.inputClass=void 0,e.timePickerSettings.inputStyle=null,void 0===e.timePickerSettings.disabledTimeSelector&&(e.timePickerSettings.disabledTimeSelector=e.disabledTimeSelector)},t.prototype.refreshValue=function(){this.datePicker.refreshValue(),this.timePicker.refreshValue()},t.prototype.getValue=function(){return this.datePicker.getValue()},t.prototype.setValue=function(e){this.datePicker.setValue(e)},t.prototype.getTimeValue=function(){return this.timePicker.getValue()},t.prototype.setTimeValue=function(e){this.timePicker.setValue(e)},t.prototype.openDropDown=function(){this.datePicker.openDropDown()},t.prototype.closeDropDown=function(){this.datePicker.closeDropDown()},t.prototype.openTimeDropDown=function(){this.timePicker.openDropDown()},t.prototype.closeTimeDropDown=function(){this.timePicker.closeDropDown()},t.prototype.getCurrentValuePart=function(){if(!this.inputElement||!this.inputElement.value)return null;var e=this.inputElement.value.lastIndexOf(" ");return 0>e?"Date":this.inputElement.selectionStart>e?"Time":"Date"},t.dayDuration=24*(t.hourDuration=60*(t.minuteDuration=60*(t.secondDuration=1e3))),t}();e.Element=t}(t.DateTimePicker||(t.DateTimePicker={})),function(t){t.initialize=function(e,t,n,s,r){return new i(e,t,n,s,r)},t.get=function(e){return e.component};var i=function(){function t(i,n,s,r,a){this.host=i,this.availableChoices=n,this.value=s,this.settings=r,this.isInitialized=!1,this.dropDownButtonElement=null;var o="DlhSoft.Controls MultiSelectorComboBox DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");e[o[5]][o[4]](i,o[0],o[1],o[2],o[3],a,r),this.host.component=this,void 0===r&&(r={}),this.settings=r,t.initializeSettings(this.settings),void 0===this.settings.choiceStyle&&!(this instanceof c.Element)&&(this.settings.choiceStyle="cursor: pointer");var l=this.host.ownerDocument;(this.inputHost=i instanceof HTMLInputElement?i:null)&&(null==s&&(s=this.inputHost.value),i=l.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(i,this.inputHost),this.host=i,e[o[5]][o[4]](i,o[0],o[1],o[2],o[3],a,r),this.host.component=this),void 0!==n&&null!=n||(n=[]),this.availableChoices=n,void 0!==s&&null!=s||(s=""),this.value=s,this.refresh(),this.isInitialized=!0}return t.initializeSettings=function(e){void 0===e.theme&&(e.theme="Modern"),void 0===e.isReadOnly&&(e.isReadOnly=!1),void 0===e.autoAppendAvailableChoices&&(e.autoAppendAvailableChoices=!1),void 0===e.openDropDownOnInputClick&&(e.openDropDownOnInputClick=!0),void 0===e.isDropDownButtonVisible&&(e.isDropDownButtonVisible=!1),void 0===e.dropDownButtonDefinition&&(e.dropDownButtonDefinition="<span style='display: inline-block; margin-left: 1px; color: "+("Modern"==e.theme?"#909090":"#707070")+"; font-size: "+("Modern"==e.theme?"10px":"x-small")+"; "+(e.isReadOnly?"opacity: 0.25":"cursor: pointer")+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none'>▼</span>"),void 0===e.separator&&(e.separator=","),void 0===e.isSpaceSeparated&&(e.isSpaceSeparated=!0),void 0===e.delimiters&&(e.delimiters=["["]),void 0===e.areCheckBoxesVisible&&(e.areCheckBoxesVisible=!0),void 0===e.popupStyle&&(e.popupStyle="background-color: White; color: "+("Modern"==e.theme?"#505050":"Black")+"; border: 1px solid "+("Modern"==e.theme?"#e0e0e0":"#707070")+"; font-family: Arial; font-size: "+("Modern"==e.theme?"12px":"small")+"; max-height: 188px; overflow-y: auto"),void 0===e.inputStyle&&"Modern"==e.theme&&(e.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px")},t.prototype.refresh=function(){for(var e=this,t=this.host.ownerDocument,i=this.host.childNodes.length;0<i--;)this.host.removeChild(this.host.childNodes[i]);if((i=t.createElement("div")).setAttribute("style","margin-top: -1px"),this.inputHost)(n=t.createElement("span")).setAttribute("style","display: inline-block"),n.appendChild(i),this.host.appendChild(n),this.popupElement=(i=this.host.firstChild).firstChild,this.inputHost.parentElement&&this.inputHost.parentElement.removeChild(this.inputHost),this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.inputHost,this.popupElement),this.inputElement=this.inputHost;else{var n=t.createElement("span");n.setAttribute("style","display: inline-block");var s=t.createElement("input");n.appendChild(s),n.appendChild(i),this.host.appendChild(n),this.inputElement=(i=this.host.firstChild).firstChild,this.popupElement=i.childNodes[1]}this.popupElement&&((i=t.createElement("div")).setAttribute("style",this.settings.popupStyle),this.settings.popupClass&&i.setAttribute("class",this.settings.popupClass),this.popupElement.appendChild(i)),this.inputElement&&(void 0!==this.settings.inputStyle&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass)),this.settings.isDropDownButtonVisible&&(this.dropDownButtonElement=t.createElement("span"),this.dropDownButtonElement.setAttribute("style","display: inline-block"),this.dropDownButtonElement.innerHTML=this.settings.dropDownButtonDefinition,this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.dropDownButtonElement,this.popupElement)),this.inputElement&&(this.inputElement.MultiSelectorComboBox=this,this.setValue(this.value),(this.settings.isReadOnly||this instanceof u.Element)&&this.inputElement.setAttribute("readonly","readonly")),this.popupElement&&(i=this.popupElement.firstChild,this.checkBoxListElement=t.createElement("div"),this.checkBoxListElement.setAttribute("style","margin: 2px; margin-left: 0px; padding-right: 2px; padding-bottom: 2px"),i.appendChild(this.checkBoxListElement),this.refreshSelectedChoices()),this.inputElement&&(this.inputElement.addEventListener("change",(function(){e.refreshValue(),e.refreshAvailableChoices()}),!0),this.dropDownButtonElement&&(this.dropDownButtonElement.onmousedown=function(){e.recordClick(),e.refreshValue(),setTimeout((function(){e.toggleDropDown()}),0)}),this.popupElement)&&(this.popupElement.style.position="absolute",this.popupElement.style.display="none",this.inputElement.addEventListener("focus",(function(){e.settings.openDropDownOnInputClick&&(e.openDropDown(),e.focusValue=e.inputElement.value)}),!0),this.inputElement.addEventListener("blur",(function(){e.settings.openDropDownOnInputClick&&void 0!==e.focusValue&&delete e.focusValue}),!0),this.inputElement.addEventListener("keydown",(function(t){13==t.keyCode?e.settings.openDropDownOnInputClick&&e.refreshValue():e.closeDropDown()}),!0),this.inputElement.addEventListener("mousedown",(function(){setTimeout((function(){!e.settings.openDropDownOnInputClick||void 0!==e.focusValue&&e.inputElement.value!=e.focusValue||(e.refreshValue(),e.openDropDown())}),0),e.recordClick()}),!0),this.inputElement.addEventListener("input",(function(){e.closeDropDown()}),!0),this.popupElement.onmousedown=function(){e.recordClick()},t.addEventListener("mousedown",(function(){setTimeout((function(){e.isDuringRecordedClick()||e.closeDropDown()}),0)}),!0),t.addEventListener("mousewheel",(function(t){e.isMouseWheelScrollingPopup(t)||e.closeDropDown()}),!0),t.addEventListener("DOMMouseScroll",(function(t){e.isMouseWheelScrollingPopup(t)||e.closeDropDown()}),!0))},t.prototype.recordClick=function(){var e=this;this.isDuringClick||(this.isDuringClick=!0,setTimeout((function(){delete e.isDuringClick}),0))},t.prototype.isDuringRecordedClick=function(){return void 0!==this.isDuringClick},t.prototype.isMouseWheelScrollingPopup=function(e){for(var t=void 0!==e.wheelDelta?e.wheelDelta/120:void 0!==e.detail?-e.detail/3:0,i=(e=e.target,!1);null!=e;){if(0<e.offsetHeight&&e.offsetHeight<e.scrollHeight&&!(1>=e.scrollTop&&0<t||e.scrollTop>=e.scrollHeight-e.clientHeight-1&&0>t)&&(i=!0),e==this.popupElement)return i;e=e.parentElement}return!1},t.prototype.getValue=function(){return this.value},t.prototype.setValue=function(e){this.resetValue(e)},t.prototype.refreshValue=function(){this.resetValue()},t.prototype.resetValue=function(e){this.isDuringInternalSetValue||(this.closeDropDown(),this.setValueInternal(e))},t.prototype.setValueInternal=function(e,t){if(!this.isDuringInternalSetValue){this.isDuringInternalSetValue=!0,void 0===t&&(t=!0);var i=this.value,n=this.value=void 0!==e&&null!=e?e:this.inputElement.value;if(n!=this.inputElement.value&&(this.inputElement.value=n,this.isInitialized))try{var s=this.inputElement.ownerDocument.createEvent("HTMLEvents");s.initEvent("change",!0,!0),this.inputElement.dispatchEvent(s)}catch(r){}(this.value&&!i||!this.value&&i||this.value&&i&&this.value.valueOf()!=i.valueOf())&&(t&&this.refreshSelectedChoices(),this.settings.valueChangeHandler&&this.settings.valueChangeHandler(this.value)),delete this.isDuringInternalSetValue}},t.prototype.refreshAvailableChoices=function(){if(this.settings.autoAppendAvailableChoices){for(var e=this.getSelectedChoices(!1),t=0;t<e.length;t++){var i=e[t];0>this.availableChoices.indexOf(i)&&this.availableChoices.push(i)}this.refreshSelectedChoices()}},t.prototype.getSelectedChoice=function(e){return this.getSelectedChoices(e)[0]},t.prototype.getSelectedChoices=function(e){void 0===e&&(e=!0);for(var t=[],i=this.value.trim(),n=i.split(this.settings.separator),s=0;s<n.length;s++)if(0!=(i=n[s].trim()).length){for(var r=0;r<this.settings.delimiters.length;r++){var a=i.indexOf(this.settings.delimiters[r]);0<=a&&(i=i.substr(0,a).trim())}(!e||0<=this.availableChoices.indexOf(i))&&t.push(i)}return t},t.prototype.refreshSelectedChoices=function(){for(var e=this,t=this.checkBoxListElement.childNodes.length;0<t--;)this.checkBoxListElement.removeChild(this.checkBoxListElement.childNodes[t]);if(this.checkBoxElements=[],this.checkBoxListElement){t=this.getSelectedChoices();for(var i=0;i<this.availableChoices.length;i++){var n=document.createElement("div");n.setAttribute("style","padding: 1px; padding-left: 2px; padding-right: 2px");var s=this.availableChoices[i],r=document.createElement("input");r.setAttribute("type","checkbox"),r.setAttribute("value",s);var a=0<=t.indexOf(s);a&&r.setAttribute("checked","checked"),this.settings.areCheckBoxesVisible&&(r.setAttribute("style","margin-bottom: -1px"+("Modern"==this.settings.theme&&null!=this.settings.inputStyle?"; border: 1px solid #e0e0e0":"")),r.onchange=function(t){var i=(t=t.currentTarget).getAttribute("value");e.setSelectedChoice(i,t.checked,!1)},n.appendChild(r)),this.checkBoxElements.push(r);var o=document.createElement(this instanceof c.Element?"div":"span");o.setAttribute("style",this.settings.choiceStyle),o.setAttribute("class",this.settings.choiceClass);var l=document.createElement(this instanceof c.Element?"div":"span");a&&(l.setAttribute("style",this.settings.selectedChoiceStyle),l.setAttribute("class",this.settings.selectedChoiceClass)),(a=document.createElement("span")).innerHTML=s,l.appendChild(a),o.appendChild(l),o.checkBox=r,o.onclick=function(t){var i=t.currentTarget.checkBox.getAttribute("value");e.setValue(i),t.stopPropagation()},n.appendChild(o),this.checkBoxListElement.appendChild(n)}}},t.prototype.selectChoice=function(e){this.setSelectedChoice(e,!0)},t.prototype.unselectChoice=function(e){this.setSelectedChoice(e,!1)},t.prototype.setSelectedChoice=function(e,t,i){void 0===i&&(i=!0),e=e.trim();for(var n=this.value.trim(),s=n.split(this.settings.separator),r="",a=!1,o=0;o<s.length;o++)if(0!=(n=s[o].trim()).length){for(var l=n,d=0;d<this.settings.delimiters.length;d++){var h=n.indexOf(this.settings.delimiters[d]);0<=h&&(n=n.substr(0,h).trim())}(n!=e||t)&&(r+=(0<r.length?this.settings.separator+(this.settings.isSpaceSeparated?" ":""):"")+l,n==e&&(a=!0))}!a&&t&&(r+=(0<r.length?this.settings.separator+(this.settings.isSpaceSeparated?" ":""):"")+e),i?this.setValue(r):this.setValueInternal(r,!1)},t.prototype.openDropDown=function(){this.isOpen||this.toggleDropDown()},t.prototype.closeDropDown=function(){this.isOpen&&this.toggleDropDown()},t.prototype.toggleDropDown=function(){var e=this;if(!this.settings.isReadOnly&&(this.isOpen||!(0>=this.availableChoices.length))){(this.isOpen=!this.isOpen)&&this.refreshAvailableChoices();var t=function(){var t=e.inputElement.getBoundingClientRect();e.popupElement.style.position="fixed",e.popupElement.style.zIndex="1",e.popupElement.style.left=t.left+"px",e.popupElement.style.top=t.top+t.height+"px",e.popupElement.style.minWidth=e.inputElement.offsetWidth+"px",e.popupElement.style.display=e.isOpen?"block":"none";var i=e.popupElement.getBoundingClientRect();i.bottom>e.popupElement.ownerDocument.documentElement.clientHeight&&t.top>=i.height&&(e.popupElement.style.top=t.top-i.height+2+"px"),i.right>e.popupElement.ownerDocument.documentElement.clientWidth&&e.popupElement.ownerDocument.documentElement.clientWidth>=i.width&&(e.popupElement.style.left=e.popupElement.ownerDocument.documentElement.clientWidth-i.width+"px")};if(t(),this.isOpen&&this.settings.dropDownOpenedHandler?this.settings.dropDownOpenedHandler():!this.isOpen&&this.settings.dropDownClosedHandler&&this.settings.dropDownClosedHandler(),this.isOpen){var i=this.host.ownerDocument.documentElement.clientWidth,n=this.host.ownerDocument.documentElement.clientHeight,s=this.host.getBoundingClientRect();this.positionChangeHandlerTimer=setInterval((function(){var r=e.host.ownerDocument.documentElement.clientWidth,a=e.host.ownerDocument.documentElement.clientHeight,o=e.host.getBoundingClientRect();r!=i||a!=n?e.closeDropDown():(o.left!=s.left||o.top!=s.top||o.width!=s.width||o.height!=s.height)&&t(),i=r,n=a,s=o}),100)}else this.positionChangeHandlerTimer&&(clearInterval(this.positionChangeHandlerTimer),delete this.positionChangeHandlerTimer)}},t}();t.Element=i}(h=t.MultiSelectorComboBox||(t.MultiSelectorComboBox={})),function(e){e.initialize=function(e,i,n,s,r){return new t(e,i,n,s,r)},e.get=function(e){return e.component};var t=function(e){function t(t,i,n,s,r){e.call(this,t,i,n,s,r),this.isInitialized=!1,this.settings.areCheckBoxesVisible=!1,void 0===s.choiceStyle&&(s.choiceStyle="padding: 2px; margin-right: -4px; cursor: pointer"),void 0===s.selectedChoiceStyle&&(s.selectedChoiceStyle="background-color: #3399ff; color: White; margin: -3px; padding: 2px"),this.refresh(),this.isInitialized=!0}return __extends(t,e),t}(h.Element);e.Element=t}(c=t.ComboBox||(t.ComboBox={})),function(e){e.initialize=function(e,i,n,s,r){return new t(e,i,n,s,r)},e.get=function(e){return e.component};var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(c.Element);e.Element=t}(u=t.DropDownList||(t.DropDownList={})),function(t){t.initialize=function(e,t,n,s){return new i(e,t,n,s)},t.get=function(e){return e["ToolTip.component"]};var i=function(){function t(i,n,s,r){var a=this;this.content=i,this.targetElement=n,this.settings=s,this.isInitialized=!1,this.isEnabled=!0,this.isVisible=!1;var o=(n=n.ownerDocument).createElement("span");n.body.appendChild(o);var l="DlhSoft.Controls ToolTip DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");e[l[5]][l[4]](o,l[0],l[1],l[2],l[3],r,s),i&&i instanceof HTMLElement?(i.parentNode&&i.parentNode.removeChild(i),r=i):(r=n.createElement("span")).innerHTML=i,o.appendChild(r),this.host=o,this.contentContainer=r,this.host["ToolTip.component"]=this,this.contentContainer["ToolTip.component"]=this,this.targetElement["ToolTip.component"]=this,void 0===s&&(s={}),this.settings=s,t.initializeSettings(this.settings),this.contentContainer.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&this.contentContainer.setAttribute("class",this.settings.containerClass),this.isEnabled=this.settings.isEnabled,(this.isVisible=this.settings.isVisible)?this.show():this.hide(),this.refresh();var d=!1;this.targetElement.addEventListener("mouseenter",(function(){a.isEnabled&&(a.show(),d=!0)})),this.targetElement.addEventListener("mouseleave",(function(){a.isEnabled&&(d=!1,isNaN(a.settings.duration)||setTimeout((function(){d||a.hide()}),a.settings.duration))})),this.contentContainer.addEventListener("mouseenter",(function(){a.isEnabled&&(d=!0)})),this.contentContainer.addEventListener("mouseleave",(function(){a.isEnabled&&(d=!1,isNaN(a.settings.duration)||setTimeout((function(){d||a.hide()}),a.settings.duration))})),this.targetElement.addEventListener("mouseup",(function(){a.isEnabled&&a.hide()}),!0),n.addEventListener("mousedown",(function(){a.isEnabled&&(d||a.hide())}),!0),n.addEventListener("mousewheel",(function(){a.isEnabled&&a.hide()}),!0),n.addEventListener("DOMMouseScroll",(function(){a.isEnabled&&a.hide()}),!0),this.isInitialized=!0}return t.initializeSettings=function(e){void 0===e.theme&&(e.theme="Modern"),void 0===e.isEnabled&&(e.isEnabled=!0),void 0===e.duration&&(e.duration=0),void 0===e.isVisible&&(e.isVisible=!1),void 0===e.containerStyle&&(e.containerStyle="cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+("Modern"==e.theme?"#e0e0e0":"#707070")+"; background-color: "+("Modern"==e.theme?"White":"#ffffc0")+"; color: "+("Modern"==e.theme?"#505050":"Black")+"; font-family: Arial; font-size: "+("Modern"==e.theme?"12px":"small")+"; padding: 4px")},t.prototype.refresh=function(){var e=this.targetElement.getBoundingClientRect();this.x=e.left,this.y=e.top+e.height,this.contentContainer.style.position="fixed",this.contentContainer.style.zIndex="1",this.contentContainer.style.left=this.x+"px",this.contentContainer.style.top=this.y+"px",this.contentContainer.style.display=this.settings.isVisible?"inline-block":"none";var t=this.contentContainer.getBoundingClientRect();t.bottom>this.contentContainer.ownerDocument.documentElement.clientHeight&&e.top>=t.height&&(this.contentContainer.style.top=e.top-t.height+2+"px"),t.right>this.contentContainer.ownerDocument.documentElement.clientWidth&&this.contentContainer.ownerDocument.documentElement.clientWidth>=t.width&&(this.contentContainer.style.left=this.contentContainer.ownerDocument.documentElement.clientWidth-t.width+"px")},t.prototype.setPosition=function(e,t){this.setHorizontalPosition(e),this.setVerticalPosition(t)},t.prototype.setHorizontalPosition=function(e){this.x=e,this.contentContainer.style.left=this.x+"px"},t.prototype.setVerticalPosition=function(e){this.y=e,this.contentContainer.style.top=this.y+"px"},t.prototype.enable=function(){this.isEnabled||(this.settings.isEnabled=this.isEnabled=!0)},t.prototype.disable=function(){this.isEnabled&&(this.settings.isEnabled=this.isEnabled=!1)},t.prototype.show=function(){t.previouslyShown&&t.previouslyShown.hide(),t.previouslyShown=this,this.isVisible||(this.settings.isVisible=this.isVisible=!0,this.refresh(),this.settings.shownHandler&&this.settings.shownHandler())},t.prototype.hide=function(){this.isVisible&&(this.settings.isVisible=this.isVisible=!1,this.refresh(),this.settings.hiddenHandler&&this.settings.hiddenHandler())},t.prototype.setContent=function(e){e&&e instanceof HTMLElement?(e.parentNode&&e.parentNode.removeChild(e),this.host.replaceChild(e,this.contentContainer),this.contentContainer=e):this.contentContainer.innerHTML=e},t}();t.Element=i}(t.ToolTip||(t.ToolTip={})),function(e){function i(e,i){for(var n=t.TreeGrid.getDefaultColumns(e,i),s=0;s<n.length;s++)delete n[s].isTreeView;return n}e.initialize=function(e,n,s,r){if(n)for(var a=0;a<n.length;a++)delete n[a].indentation,delete n[a].isExpanded;return s||(s={}),s.columns||(s.columns=i(n,s)),t.TreeGrid.initialize(e,n,s,r)},e.getDefaultColumns=i}(t.Grid||(t.Grid={}))}(DlhSoft||(DlhSoft={}));