typeof DlhSoft>"u"&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)}),DlhSoft.assemblies.push({assembly:"DlhSoft.ProjectData.GanttChart.HTML.Controls",company:"DlhSoft",product:"Project Data Modern Library",version:"5.3.20.17",copyright:"Copyright \xa9 2012-2024 DlhSoft",title:"Project Data Gantt Chart HTML Controls",description:"Project Data Gantt Chart related HTML client components"}),DlhSoft.buildReleaseDate=function(t,fe,Ee){return(t=new Date(t,4,9))>DlhSoft.buildReleaseDate?t:DlhSoft.buildReleaseDate}(2024);var _0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{");null==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var t=_0x5c25[1],fe=_0x5c25[2],Ee=[],We=[],Ge=_0x5c25[3];return{setLicense:function(De,ye){Ee[_0x5c25[7]]({type:De,content:ye})},validate:function(De,ye,ke,xe,he,Ce,ae){ye=ye+_0x5c25[4]+ke;for(var ue=0;ue<We[_0x5c25[5]];ue++)if(We[ue]==ye)return;e:if(typeof Ce!==fe&&typeof ae!==t&&(ae[_0x5c25[6]]!==t&&(Ce=ae[_0x5c25[6]]),typeof ae===fe&&(Ce=ae)),typeof Ce!==fe)for(ae=0;ae<Ee[_0x5c25[5]];ae++)if((ue=Ee[ae])[_0x5c25[8]]==ye&&typeof ue[_0x5c25[9]]===fe){Ce=ue[_0x5c25[9]];break e}!function(De,ye){if(typeof De!==fe||typeof ye!==fe)return!1;if(ye==Ge)return!0;var ke=ye[_0x5c25[11]](_0x5c25[10]);if(0<=ke){var he,xe=ye[_0x5c25[12]](0,ke),Ce=xe[_0x5c25[11]](_0x5c25[10]);if(0<=Ce)try{he=new Date(parseInt(xe[_0x5c25[12]](Ce+1)))}catch{}if(typeof he===t&&(he=new Date(2013,11,31)),DlhSoft[_0x5c25[13]]>he)return!1;for(xe=xe+_0x5c25[10]+De,i=he=0;i<xe[_0x5c25[5]];i++)he=(he<<5)-he+(Ce=xe[_0x5c25[14]](i)),he&=he;if(0>he&&(he=Math[_0x5c25[15]](2,32)-he),(xe=he.toString(16)[_0x5c25[16]]())==(ke=ye[_0x5c25[12]](ke+1)))return!0}return!1}(ye,Ce)?function(De,ye,ke,xe,he){var Ce=_0x5c25[17],ue=typeof ComponentSource!==t&&ComponentSource?_0x5c25[21]:_0x5c25[18]+_0x5c25[19]+xe+_0x5c25[20]+he,H=xe+_0x5c25[22]+he+_0x5c25[23],a=_0x5c25[24],D=_0x5c25[25],k=_0x5c25[26];setTimeout(function(){var h=De[_0x5c25[27]],T=h[_0x5c25[29]](_0x5c25[28]);T[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var y=h[_0x5c25[29]](_0x5c25[28]);y[_0x5c25[32]](_0x5c25[30],_0x5c25[33]);var F=h[_0x5c25[29]](_0x5c25[28]);F[_0x5c25[32]](_0x5c25[30],_0x5c25[34]),y[_0x5c25[35]](F),F[_0x5c25[35]](h[_0x5c25[36]](Ce)),y[_0x5c25[35]](h[_0x5c25[36]](a+_0x5c25[10])),(F=h[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),F[_0x5c25[35]](h[_0x5c25[36]](ye)),y[_0x5c25[35]](F),y[_0x5c25[35]](h[_0x5c25[36]](D+_0x5c25[10])),(F=h[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),F[_0x5c25[35]](h[_0x5c25[36]](H)),y[_0x5c25[35]](F),y[_0x5c25[35]](h[_0x5c25[36]](k+_0x5c25[10])),(F=h[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var x=h[_0x5c25[29]](_0x5c25[39]);x[_0x5c25[32]](_0x5c25[30],_0x5c25[40]),x[_0x5c25[32]](_0x5c25[41],ue),x[_0x5c25[32]](_0x5c25[42],_0x5c25[43]),x[_0x5c25[35]](h[_0x5c25[36]](_0x5c25[44])),F[_0x5c25[35]](x),(x=h[_0x5c25[29]](_0x5c25[39]))[_0x5c25[32]](_0x5c25[30],_0x5c25[45]),x[_0x5c25[32]](_0x5c25[41],_0x5c25[46]),x[_0x5c25[35]](h[_0x5c25[36]](_0x5c25[47])),x[_0x5c25[50]](_0x5c25[48],function(){De[_0x5c25[49]](T),We[_0x5c25[7]](ke)},!1),F[_0x5c25[35]](x),y[_0x5c25[35]](F),T[_0x5c25[35]](y),De[_0x5c25[35]](T)},0),setTimeout(function(){alert(Ce+_0x5c25[51]+a+_0x5c25[52]+ye+_0x5c25[51]+D+_0x5c25[53]+H+_0x5c25[51]+k+_0x5c25[4])},6e5)}(De,ke,ye,xe,he):De[_0x5c25[6]]=Ce}}}()),null==DlhSoft.Controls&&(DlhSoft.Controls={}),null==DlhSoft.Controls.GanttChartView&&(DlhSoft.Controls.GanttChartView=function(){var t="undefined",fe=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ee=["January","February","March","April","May","June","July","August","September","October","November","December"],We=[31,28,31,30,31,30,31,31,30,31,30,31],Ge=new Date(2592e5),Je=new Date(3155762592e5),se=function(e,n,s,r,o){return e.internalEventListeners&&e.internalEventListeners.push({object:n,event:s,handler:r,useCapture:o}),r},De=function(e,n){var s=document.createEvent("MouseEvents");s.initMouseEvent(n,!0,!0,document.defaultView,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(s)},ye=function(e,n,s,r){function o(re){if(typeof A.x!==t&&!(e.offsetWidth<=0)){var Ve=e.offsetWidth-(re=A.gridWidth+(re.clientX-A.x))-3,Ue=Math.max(1,s.minGridWidth),Ke=Math.max(1,s.minChartWidth);re<Ue?(Ve-=Ue-re,re=Ue):Ve<Ke&&(re-=Ke-Ve,Ve=Ke),re<1&&(re=1),Ve<1&&(Ve=1),typeof g.percent!==t&&delete g.percent,re=Math.ceil(1e6*re/e.offsetWidth)/1e4,g.style.width=re+"%",I.style.width=100-re+"%",s.gridWidth=g.offsetWidth+"px",s.chartWidth=I.offsetWidth+"px",Wt(A,g,s),typeof s.splitterPositionChangeHandler!==t&&setTimeout(function(){s.splitterPositionChangeHandler(g.offsetWidth,I.offsetWidth)},0)}}if(typeof e.ownerDocument.createElementNS!==t&&typeof e.ownerDocument.addEventListener!==t){var l=["DlhSoft.Controls","GanttChartView","DlhSoft.ProjectData.GanttChart.HTML.Controls","5","validate","Licensing"];if(DlhSoft[l[5]][l[4]](e,l[0],l[1],l[2],l[3],r,s),e.isInitializing=!0,typeof e.initializedItems!==t&&(e.initializedItems.forEach(function(re){re.gridItemContainer&&re.gridItemContainer.parentNode&&re.gridItemContainer.parentNode.removeChild(re.gridItemContainer),re.chartItemArea&&re.chartItemArea.parentNode&&re.chartItemArea.parentNode.removeChild(re.chartItemArea),delete re.ganttChartView,delete re.chartItem,delete re.chartItemArea,delete re.gridItem,delete re.gridItemContent,delete re.gridItemSelectionContainer,delete re.gridItemContainer,delete re.alternativeContentContainer,delete re.toggleButton,delete re.parent,delete re.children,delete re.selectionInput,delete re.contentInput,delete re.startInput,delete re.finishInput,delete re.milestoneInput,delete re.assignmentsContentInput,delete re.completedInput,delete re.dependsOf,delete re.touchMoveHandler,delete re.touchEndHandler}),typeof e.draggableItems!==t&&delete e.draggableItems,typeof e.draggableDependencyItems!==t&&delete e.draggableDependencyItems,typeof e.draggableOrderingItems!==t&&delete e.draggableOrderingItems),e.initializedItems=n.slice(),e.internalEventListeners&&e.internalEventListeners.forEach(function(re){re.object.removeEventListener(re.event,re.handler,re.useCapture)}),e.internalEventListeners=[],typeof e.settings!==t&&typeof e.settings.toggleButtonAreaWidth!==t&&delete e.settings.toggleButtonAreaWidth,typeof e.items!==t)for(r=0;r<e.items.length;r++)delete e.items[r].successors;if("object"!=typeof s&&(s={}),Ce(n,s),he(s,n,e),Mn(e,n,s),l=s.scales,je(r=s.columns,e,s),B(n,e),O(n,s,e),typeof s.visibilityFilter!==t){En(n,s.visibilityFilter);for(var v=0,m=0;m<n.length;m++){var d=n[m];if(typeof d.ganttChartItems!==t){d.isHidden||(d.scheduleChartVisibilityIndex=v++);for(var u=0;u<d.ganttChartItems.length;u++){var p=d.ganttChartItems[u];d.isHidden&&(p.isHidden=!0),p.displayRowIndex=d.scheduleChartVisibilityIndex}}}}var R=ae(e,n,s),f=e.ownerDocument;(v=f.createElement("div")).setAttribute("style","font-family: "+(s.classic?"Arial":"system-ui, Arial")+"; font-size: "+(s.classic?"small":"12px")+"; overflow: auto"),m=f.createElement("div"),typeof s.containerClass!==t&&m.setAttribute("class",s.containerClass),typeof s.containerStyle!==t&&m.setAttribute("style",s.containerStyle),v.appendChild(m),(d=f.createElement("div")).setAttribute("style","border: solid 1px "+s.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto"),m.appendChild(d);var g=f.createElement("div");g.setAttribute("style","overflow: auto; float: left; border-right: solid 1px "+s.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+s.gridWidth),s.isGridVisible&&d.appendChild(g);var I=f.createElement("div");I.setAttribute("style","overflow: auto; float: right; width: "+s.chartWidth),d.appendChild(I);var A=f.createElement("div");A.setAttribute("style","position: relative; opacity: 0; left: 0px; width: "+2*s.splitterWidth+"px; height: 0px; border-left: solid "+s.splitterWidth+"px "+s.splitterBackground+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: ew-resize; -ms-touch-action: pinch-zoom; touch-action: auto"),A.addEventListener("mouseover",se(e,A,"mouseover",function(){A.style.opacity=1,A.isWaiting!==t&&delete A.isWaiting},!0),!0),A.addEventListener("mouseout",se(e,A,"mouseout",function(){typeof A.isWaiting===t&&(A.isWaiting=!0,setTimeout(function(){typeof A.isWaiting!==t&&(delete A.isWaiting,typeof A.x===t&&(A.style.opacity=0))},250))},!0),!0),A.addEventListener("mousedown",se(e,A,"mousedown",function(re){0==re.button&&(A.style.opacity=1,A.x=re.clientX,A.gridWidth=g.offsetWidth)},!0),!0),A.addEventListener("touchstart",se(e,A,"touchstart",function(re){re=re.touches[0],A.style.opacity=1,A.x=re.clientX,A.gridWidth=g.offsetWidth},!0),!0),f.addEventListener("mousemove",se(e,f,"mousemove",function(re){o(re)},!0),!0),f.addEventListener("touchmove",se(e,f,"touchmove",function(re){o(re.touches[0])},!0),!0),f.addEventListener("mouseup",se(e,f,"mouseup",function(){typeof A.x!==t&&(delete A.x,A.style.opacity=0),DlhSoft.Controls.ToolTip&&(s.useUpdatingToolTips||s.useInlineToolTips)&&((toolTip=e.toolTip)&&(toolTip.disable(),toolTip.hide()),(toolTip=e.resourceRoolTip)&&(toolTip.disable(),toolTip.hide()))},!0),!0),f.addEventListener("touchend",se(e,f,"touchend",function(){typeof A.x!==t&&(delete A.x,A.style.opacity=0)},!0),!0),s.isGridVisible&&s.isSplitterEnabled&&d.appendChild(A),(m=f.createElement("div")).setAttribute("style","float: right; background: "+s.headerBackground+"; width: 0px; height: "+s.headerHeight+"px"),g.appendChild(m),(d=f.createElement("div")).setAttribute("style","overflow: hidden; background: "+s.headerBackground+"; border-bottom: solid 1px "+s.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: "+s.headerHeight+"px"),g.appendChild(d),(u=f.createElement("div")).setAttribute("style","float: right; background: "+s.headerBackground+"; width: 0px; height: "+s.headerHeight+"px"),I.appendChild(u),(p=f.createElement("div")).setAttribute("style","overflow: hidden; background: "+s.headerBackground+"; border-bottom: solid 1px "+s.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: "+s.headerHeight+"px"),I.appendChild(p);var V=f.createElement("div");V.setAttribute("style","overflow-x: "+(typeof s.isExport!==t&&s.isExport?"hidden":"scroll")+"; overflow-y: "+(typeof s.isExport!==t&&s.isExport?"hidden":"auto")+"; height: "+R),g.appendChild(V);var W=f.createElement("div");W.setAttribute("style","overflow-x: "+(typeof s.isExport!==t&&s.isExport?"hidden":"scroll")+"; overflow-y: "+(typeof s.isExport!==t&&s.isExport?"hidden":"auto")+"; height: "+R),I.appendChild(W),R=ft(r);var j=f.createElement("div");j.setAttribute("style","background: "+s.headerBackground+"; border-bottom: solid 1px "+s.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+R+"px; overflow: hidden; height: "+s.headerHeight+"px"),d.appendChild(j);var z=f.createElement("div");if(z.setAttribute("style","float: left; width: "+R+"px; overflow: auto"+(s.horizontalGridLines?"; border-bottom: 1px solid "+s.horizontalGridLines+"; margin-bottom: -1px; ; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box":"")),V.appendChild(z),typeof s.extraSpaceHeight!==t){var Y=f.createElement("div");Y.setAttribute("style","overflow: hidden; width: "+R+"px; height: "+s.extraSpaceHeight+"px"),V.appendChild(Y)}var de,Te,_=q(s.timelineFinish,s),ne=f.createElement("div");ne.setAttribute("style","background: "+s.headerBackground+"; border-bottom: solid 1px "+s.border+"; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+_+"px; height: "+s.headerHeight+"px"),s.extendTimelineToEntireWeeks?p.appendChild(ne):(R=f.createElement("div"),p.appendChild(R),de=(Te=Ne(s.timelineStart,s.intendedTimelineStart,s,de={workingWeekStart:s.visibleWeekStart,workingWeekFinish:s.visibleWeekFinish,workingDayStart:s.visibleDayStart,workingDayFinish:s.visibleDayFinish})/36e5*s.hourWidth)+Ne(s.intendedTimelineStart,s.intendedTimelineFinish,s,de)/36e5*s.hourWidth,R.setAttribute("style","overflow-x: hidden; width: "+de+"px; transform: translateX(-"+Te+"px);"),R.appendChild(ne));var Se=f.createElement("div");Se.setAttribute("style","float: left; overflow: hidden; width: "+_+"px; height: 0px"),s.extendTimelineToEntireWeeks?W.appendChild(Se):(R=f.createElement("div"),W.appendChild(R),R.setAttribute("style","overflow-x: hidden; width: "+de+"px; transform: translateX(-"+Te+"px); clip-path: xywh(0 0 "+de+"px 100%);"),R.appendChild(Se));var it,Oe,Tt,Ei,Re=f.createElementNS("http://www.w3.org/2000/svg","svg");Re.setAttribute("style","width: "+_+"px; height: 0px"),Te=s.styleDefinitionTemplate(e),Re.appendChild(Te),Re.chartAreaDefinitions=Te,Te=f.createElementNS("http://www.w3.org/2000/svg","g"),Re.appendChild(Te),Se.chartAreaAlternativeRows=Te,Re.addEventListener("mousedown",se(e,Re,"mousedown",Te=function(){setTimeout(function(){try{var re=Se.chartArea,Ve=re.chartAreaDefinitions;re.removeChild(Ve),re.childNodes.length>0?re.insertBefore(Ve,re.childNodes[0]):re.appendChild(Ve)}catch{}},0)},!0),!0),f.addEventListener("mouseup",se(e,f,"mouseup",Te,!0),!0),e.resetChartAreaDefinitions=Te,Se.appendChild(Re),Se.chartArea=Re,typeof s.extraSpaceHeight!==t&&((Te=f.createElement("div")).setAttribute("style","overflow: hidden; width: "+_+"px; height: "+s.extraSpaceHeight+"px"),W.appendChild(Te),W.chartExtraSpace=Te),setTimeout(function(){Oe=screen.deviceXDPI,it=e.isInitialized?-1:e.offsetWidth,Tt=e.isInitialized?-1:e.offsetHeight,Ei=I.offsetHeight},0),typeof e.splitterUpdateTimer!==t&&clearInterval(e.splitterUpdateTimer),e.splitterUpdateTimer=setInterval(function(){try{if(typeof A.x===t&&!(e.offsetWidth<=0)){var re=e.offsetWidth,Ve=I.offsetHeight,Ue=screen.deviceXDPI;if(re!=it||Ue!=Oe){var Ke=typeof g.percent!==t?g.percent*re:g.offsetWidth,nt=I.offsetWidth,ze=Math.max(1,s.minGridWidth),lt=Math.max(1,s.minChartWidth);Ke<ze?(nt-=ze-Ke,Ke=ze):nt<lt&&(Ke-=lt-nt,nt=lt),Ke<1&&(Ke=1),nt<1&&(nt=1);var et=Math.ceil(100*Ke/re);if(g.percent=et/100,g.style.width=et+"%",I.style.width=100-et+"%",s.gridWidth=g.offsetWidth+"px",s.chartWidth=I.offsetWidth+"px",Wt(A,g,s),typeof s.splitterPositionChangeHandler!==t){var tt=g.offsetWidth,ht=I.offsetWidth;tt>0&&ht>0&&setTimeout(function(){s.splitterPositionChangeHandler(tt,ht)},0)}it=re,Tt=Ve,Oe=Ue}else Ve!=Ei&&(Wt(A,g,s),Ei=Ve)}}catch{try{clearInterval(e.splitterUpdateTimer)}catch{}}},100),typeof e.heightUpdateTimer!==t&&clearInterval(e.heightUpdateTimer),e.heightUpdateTimer=setInterval(function(){try{if(!(e.clientHeight<=0)){var re=e.clientHeight;if(re!=Tt){var Ve=ae(e,n,s);V.style.height=Ve,W.style.height=Ve,Wt(A,g,s),"auto"!=W.style.height&&(Se.availableHeight=W.clientHeight),Ht(Se,Et(n,s)),Pt(n,W,s),Tt=re=e.clientHeight}}}catch{try{clearInterval(e.heightUpdateTimer)}catch{}}},100),typeof e.scaleUpdateTimer!==t&&clearInterval(e.scaleUpdateTimer),e.chartScale=1,e.scaleUpdateTimer=setInterval(function(){try{var re=e.getItemsHeight(),Ve=e.gridContent.clientHeight/re;e.chartScale=Ve,e.chartContent.style.transform="scaleY("+Ve+") translateY(-"+(re-e.gridContent.clientHeight)/2+"px)"}catch{}},1e3);var dt=function(re,Ve,Ue,Ke,nt,ze){var lt;if(s.mouseHandler||s.mouseMoveHandler&&"mousemove"==ze||s.mouseDownHandler&&"mousedown"==ze||(s.clickHandler||s.itemClickHandler||s.chartClickHandler||s.chartItemClickHandler)&&"click"==ze||(s.doubleClickHandler||s.itemDoubleClickHandler||s.chartDoubleClickHandler||s.chartItemDoubleClickHandler)&&"dblclick"==ze){var et=re.which;!et&&re.button&&(1&re.button?et=1:4&re.button?et=2:2&re.button&&(et=3)),lt=nt.getBoundingClientRect();var tt=f.body,ht=f.documentElement;nt=lt.left+(window.pageXOffset||ht.scrollLeft||tt.scrollLeft)-(ht.clientLeft||tt.clientLeft||0),lt=Math.round(lt.top+(window.pageYOffset||ht.scrollTop||tt.scrollTop)-(ht.clientTop||tt.clientTop||0)),nt=Math.round(nt),nt=re.pageX-nt,ht=(re.pageY-lt)/e.chartScale;var ut,ct,pt=lt=0;if(Ue){for(tt=0;tt<n.length;tt++)if((pt=n[tt]).isVisible&&(typeof pt.isHidden===t||!pt.isHidden)&&ht<=(pt=pt.itemTop+s.itemHeight)){ut=n[tt];break}}else if(Ve){var St,di=s.scales,Gt=0;for(tt=0;tt<di.length;tt++)(typeof(St=di[tt]).isHeaderVisible===t||St.isHeaderVisible)&&Gt++;var wn=s.headerHeight;for(Gt>0&&(wn=s.headerHeight/Gt),tt=0;tt<di.length;tt++)if((typeof(St=di[tt]).isHeaderVisible===t||St.isHeaderVisible)&&(Gt=wn,typeof St.headerHeight!==t&&(Gt=St.headerHeight),ht<=(pt+=Gt))){ut=St;break}}if(Ve)ct=te(nt,s);else for(ht=s.columns,tt=0;tt<ht.length;tt++)if(nt<=(lt+=(pt=ht[tt]).width?pt.width:0)){ct=pt;break}s.mouseHandler&&s.mouseHandler(ze,Ue,Ve,ut,ct,et,Ke,re),s.mouseMoveHandler&&"mousemove"==ze&&s.mouseMoveHandler(Ue,Ve,ut,ct),s.mouseDownHandler&&"mousedown"==ze&&s.mouseDownHandler(Ue,Ve,ut,ct,et),s.clickHandler&&"click"==ze&&s.clickHandler(Ue,Ve,ut,ct),s.doubleClickHandler&&"dblclick"==ze&&s.doubleClickHandler(Ue,Ve,ut,ct),s.itemClickHandler&&"click"==ze&&Ue&&ut&&s.itemClickHandler(Ve,ut,ct),s.itemDoubleClickHandler&&"dblclick"==ze&&Ue&&ut&&s.itemDoubleClickHandler(Ve,ut,ct),s.chartClickHandler&&"click"==ze&&Ve&&s.chartClickHandler(Ue,ut,ct),s.chartDoubleClickHandler&&"dblclick"==ze&&Ve&&s.chartDoubleClickHandler(Ue,ut,ct),s.chartItemClickHandler&&"click"==ze&&Ue&&Ve&&s.chartItemClickHandler(ut,ct),s.chartItemDoubleClickHandler&&"dblclick"==ze&&Ue&&Ve&&s.chartItemDoubleClickHandler(ut,ct)}};j.addEventListener("mousemove",se(e,j,"mousemove",function(re){dt(re,!1,!1,0,j,"mousemove")})),j.addEventListener("mousedown",se(e,j,"mousedown",function(re){dt(re,!1,!1,1,j,"mousedown")})),j.addEventListener("click",se(e,j,"click",function(re){dt(re,!1,!1,1,j,"click")})),j.addEventListener("dblclick",se(e,j,"dblclick",function(re){dt(re,!1,!1,2,j,"dblclick")})),z.addEventListener("mousemove",se(e,z,"mousemove",function(re){dt(re,!1,!0,0,z,"mousemove")})),z.addEventListener("mousedown",se(e,z,"mousedown",function(re){dt(re,!1,!0,1,z,"mousedown")})),z.addEventListener("click",se(e,z,"click",function(re){dt(re,!1,!0,1,z,"click")})),z.addEventListener("dblclick",se(e,z,"dblclick",function(re){dt(re,!1,!0,2,z,"dblclick")})),ne.addEventListener("mousemove",se(e,ne,"mousemove",function(re){dt(re,!0,!1,0,ne,"mousemove")})),ne.addEventListener("mousedown",se(e,ne,"mousedown",function(re){dt(re,!0,!1,1,ne,"mousedown")})),ne.addEventListener("click",se(e,ne,"click",function(re){dt(re,!0,!1,1,ne,"click")})),ne.addEventListener("dblclick",se(e,ne,"dblclick",function(re){dt(re,!0,!1,2,ne,"dblclick")})),Se.addEventListener("mousemove",se(e,Se,"mousemove",function(re){dt(re,!0,!0,0,Se,"mousemove")})),Se.addEventListener("mousedown",se(e,Se,"mousedown",function(re){dt(re,!0,!0,1,Se,"mousedown")})),Se.addEventListener("click",se(e,Se,"click",function(re){dt(re,!0,!0,1,Se,"click")})),Se.addEventListener("dblclick",se(e,Se,"dblclick",function(re){dt(re,!0,!0,2,Se,"dblclick")})),Se.addEventListener("touchmove",se(e,Se,"touchmove",function(re){e.draggingItem&&re.preventDefault()},!0),!0),z.container=V,Se.container=W,j.container=d,ne.container=p,e.gridContainer=g,e.chartContainer=I,e.gridContent=z,e.chartContent=Se,e.gridContentContainer=V,e.chartContentContainer=W,e.gridHeader=j,e.chartHeader=ne,e.gridHeaderContainer=d,e.chartHeaderContainer=p,e.splitter=A,W.isInitializing=!0,Te=ue(n,s),Ln(e,v),"auto"!=W.style.height&&(Se.availableHeight=W.clientHeight),at(j,r,s,e),ie(ne,Re,l,s),Sn(Re,n,s),Dn(z,Se,Re,n,r,Te,s,e),Wt(A,g,s),W.isInitializing=!1,Pt(n,W,s),W.scrollLeft=q(s.displayedTime,s),p.scrollLeft!=W.scrollLeft&&(p.scrollLeft=W.scrollLeft),An(e,V,g,d,m,z,W,p,I,u,Se,A,n,s);var Vi=!1,vn=function(re,Ve){if(typeof Ve===t&&(Ve=0),s.hourWidth!=re){Vi=!0;var ze,Ue=W.scrollLeft,Ke=Ve,nt=s.hourWidth;for(s.hourWidth=re,typeof s.hourWidthChangeHandler!==t&&setTimeout(function(){s.hourWidthChangeHandler(s.hourWidth)},0),_=q(s.timelineFinish,s),ne.style.width=_+"px",Se.style.width=_+"px",Re.style.width=_+"px",typeof W.chartExtraSpace!==t&&(W.chartExtraSpace.style.width=_+"px"),ze=ne.childNodes.length;ze-- >0;)ne.removeChild(ne.childNodes[ze]);var lt=[];for(ze=Re.childNodes.length;ze-- >1;){var et=Re.childNodes[ze];et!=Se.chartAreaAlternativeRows&&("Scale-Highlighting"!=et.tag&&"Scale-Highlighting-CurrentTime"!=et.tag&&"Scale-Separator"!=et.tag&&"Scale-Separator-CurrentTime"!=et.tag&&lt.push(et),Re.removeChild(et))}for(ie(ne,Re,s.scales,s),ze=0;ze<n.length;ze++)et=n[ze],(!s.isVirtualizing||typeof et.isVirtuallyVisible!==t&&et.isVirtuallyVisible)&&(mt(et.chartPredecessorItems,et,s),yt(et.chartItem,et,s));for(ze=lt.length;ze-- >0;)Re.appendChild(lt[ze]);Ht(Se,Et(n,s)),W.scrollLeft=Ke*(re/nt)-(Ke-Ue),setTimeout(function(){Vi=!1},200)}};return e.setHourWidth=vn,(s.classic&&typeof s.isMouseWheelZoomEnabled===t||s.isMouseWheelZoomEnabled)&&(Re.addEventListener("mousewheel",se(e,Re,"mousewheel",r=function(re){if(re.preventDefault(),re.stopPropagation(),!Vi){var Ve=typeof re.wheelDelta!==t?re.wheelDelta>=0?1:-1:typeof re.detail!==t?-re.detail>=0?1:-1:0,Ue=e.settings,Ke=Ue.hourWidth,nt=typeof Ue.isMouseWheelZoomEnabledMinHourWidth!==t?Ue.isMouseWheelZoomEnabledMinHourWidth:1;Ve<0?Ke/=1.2*-Ve:Ve>0&&(Ke=1.2*Ke*Ve)>(Ve=typeof Ue.isMouseWheelZoomEnabledMaxHourWidth!==t?Ue.isMouseWheelZoomEnabledMaxHourWidth:20)&&(Ke=Ve),Ke<nt&&(Ke=nt),vn(Ke,re.offsetX)}})),Re.addEventListener("DOMMouseScroll",se(e,Re,"DOMMouseScroll",r))),e.isInitializing=!1,e.isInitialized=!0,e}alert("The required HTML5 features are not supported by the application host. Some features will be unavailable. Consider upgrading.")},ke=function(e){ye(e,e.items,e.settings,e.license)},xe=function(e){typeof e.dateTimePickerType===t&&(e.dateTimePickerType="text"),typeof e.useDatePicker===t&&(e.useDatePicker=!0),typeof e.useTimePicker===t&&(e.useTimePicker=!0),typeof e.useResourceSelector===t&&(e.useResourceSelector=!0),typeof e.useInlineToolTips===t&&(e.useInlineToolTips=!0),typeof e.useInlineToolTipsForDependencies===t&&(e.useInlineToolTipsForDependencies=!0),typeof e.useUpdatingToolTips===t&&(e.useUpdatingToolTips=!0),typeof e.dateFormatter===t&&(e.dateFormatter=D),typeof e.dateTimeFormatter===t&&(e.dateTimeFormatter=k),typeof e.dateTimeParser===t&&(e.dateTimeParser=T),typeof e.itemPropertyChangeHandler===t&&(e.itemPropertyChangeHandler=function(){}),typeof e.target===t&&(e.target="Standard"),typeof e.theme===t&&(e.theme="Modern"),typeof e.isGridVisible===t&&(e.isGridVisible="Phone"!==e.target),typeof e.interaction===t&&(e.interaction="Phone"!=e.target?"Standard":"TouchEnabled"),typeof e.isSplitterEnabled===t&&(e.isSplitterEnabled=!0),typeof e.isReadOnly===t&&(e.isReadOnly=!1),typeof e.isGridReadOnly===t&&(e.isGridReadOnly=!1),typeof e.isChartReadOnly===t&&(e.isChartReadOnly=!1),typeof e.isContentReadOnly===t&&(e.isContentReadOnly=!1),typeof e.isAssignmentsContentReadOnly===t&&(e.isAssignmentsContentReadOnly=!1),typeof e.isIndividualItemNonworkingTimeHighlighted===t&&(e.isIndividualItemNonworkingTimeHighlighted=!1),typeof e.areTaskInterruptionsHighlighted===t&&(e.areTaskInterruptionsHighlighted=!1),typeof e.areTaskDependencyConstraintsEnabled===t&&(e.areTaskDependencyConstraintsEnabled=!1),typeof e.alwaysHandleInvalidDependencies===t&&(e.alwaysHandleInvalidDependencies=!1),typeof e.selectionMode===t&&(e.selectionMode="Focus"),typeof e.isVirtualizing===t&&(e.isVirtualizing=!0)},he=function(e,n,s){if(xe(e),typeof e.gridWidth===t&&(e.gridWidth="35%"),typeof e.chartWidth===t&&(e.chartWidth=e.isGridVisible?"65%":"100%"),typeof e.minGridWidth===t&&(e.minGridWidth=32),typeof e.minColumnWidth===t&&(e.minColumnWidth=32),typeof e.minChartWidth===t&&(e.minChartWidth=36),typeof e.border===t)switch(e.theme){default:e.border="#e0e0e0";break;case"ModernBordered":case"Aero":e.border="#9a9a9a"}if(typeof e.splitterWidth===t&&(e.splitterWidth=4),typeof e.splitterBackground===t&&(e.splitterBackground=e.border),typeof e.indentationLevelWidth===t&&(e.indentationLevelWidth=16),typeof e.itemHeight===t&&(e.itemHeight=e.classic?21:28),typeof e.headerBackground===t&&(e.headerBackground=e.classic?"#f4f4f4":"white"),typeof e.headerHeight===t&&(e.headerHeight=2*(e.classic?21:31)),typeof e.columns===t&&(e.columns=x(n,e)),typeof e.toggleButtonStyle===t&&null==e.toggleButtonClass&&(e.toggleButtonStyle="fill: Gray"),typeof e.toggleButtonHoveringStyle===t&&null==e.toggleButtonHoveringClass&&(e.toggleButtonHoveringStyle="fill: Black"),typeof e.collapsedToggleButtonTemplate===t&&(e.collapsedToggleButtonTemplate=Fi(s,e)),typeof e.expandedToggleButtonTemplate===t&&(e.expandedToggleButtonTemplate=Oi(s,e)),typeof e.gridLines!==t&&(typeof e.horizontalGridLines===t&&(e.horizontalGridLines=e.gridLines),typeof e.verticalGridLines===t&&(e.verticalGridLines=e.gridLines),typeof e.horizontalChartLines===t&&(e.horizontalChartLines=e.gridLines)),!e.classic&&typeof e.verticalGridHeaderLines===t&&(e.verticalGridHeaderLines=e.verticalGridLines?e.verticalGridLines:"#e0e0e0"),typeof e.itemStyle===t&&typeof e.horizontalGridLines!==t&&(e.itemStyle="border-top: solid 1px "+e.horizontalGridLines+"; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box",typeof e.cellStyle===t&&(e.cellStyle=typeof e.verticalGridLines!==t?"border-right: solid 1px "+e.verticalGridLines+"; height: "+e.itemHeight+"px; padding-top: 2px; padding-left: 2px":"height: "+e.itemHeight+"px; padding-top: 2px")),typeof e.cellStyle===t&&typeof e.verticalGridLines!==t&&(e.cellStyle="border-right: solid 1px "+e.verticalGridLines+"; height: "+e.itemHeight+"px; padding-top: 3px; padding-left: 2px"),!e.classic&&typeof e.cellStyle===t&&(e.cellStyle="padding-left: 2px;",typeof e.columnHeaderStyle===t&&(e.columnHeaderStyle="padding-left: 2px")),typeof e.selectedItemStyle===t&&null==e.selectedItemClass&&(e.selectedItemStyle=e.classic?"Aero"===e.theme?typeof e.horizontalGridLines!==t||typeof e.verticalGridLines===t?"background-color: LightBlue; border-top: solid 1px "+(typeof e.horizontalGridLines!==t?e.horizontalGridLines:"White")+"; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box":"background-color: LightBlue":typeof e.horizontalGridLines!==t||typeof e.verticalGridLines===t?"background-color: #f4f4f4; border-top: solid 1px "+(typeof e.horizontalGridLines!==t?e.horizontalGridLines:"White")+"; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box":"background-color: #f4f4f4":"background-color: #8dd2ff60;"),typeof e.summaryItemStyle===t&&null==e.summaryItemClass&&(e.summaryItemStyle="font-weight: bold"),typeof e.daysOfWeek===t&&(e.daysOfWeek=fe),typeof e.months===t&&(e.months=Ee),typeof e.weekStartDay===t&&(e.weekStartDay=0),typeof e.currentTime===t)e.currentTime=new Date;else if("string"==typeof e.currentTime)try{e.currentTime=new Date(e.currentTime)}catch{e.currentTime=new Date(parseInt(e.currentTime))}if("string"==typeof e.displayedTime)try{e.displayedTime=new Date(e.displayedTime)}catch{e.displayedTime=new Date(parseInt(e.displayedTime))}if("string"==typeof e.timelineStart)try{e.timelineStart=new Date(e.timelineStart)}catch{e.timelineStart=new Date(parseInt(e.timelineStart))}if("string"==typeof e.timelineFinish)try{e.timelineFinish=new Date(e.timelineFinish)}catch{e.timelineFinish=new Date(parseInt(e.timelineFinish))}if(!e.classic&&typeof e.scales===t&&(e.scales=[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: "+(e.nonworkingBackground?e.nonworkingBackground:"#f8f8f8")+"; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 7px 5px; border-right: 1px solid "+(e.headerBorder?e.headerBorder:"#e8e8e8")+"; border-bottom: 1px solid "+(e.headerBorder?e.headerBorder:"#e8e8e8")+(e.headerForeground?"; color: "+e.headerForeground:""),isSeparatorVisible:!0,separatorStyle:"stroke: "+(e.scaleSeparatorBorder?e.scaleSeparatorBorder:"#c8bfe7")+"; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 7px 5px; border-right: 1px solid "+(e.headerBorder?e.headerBorder:"#e8e8e8")+(e.headerForeground?"; color: "+e.headerForeground:"")},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: "+(e.currentTimeStroke?e.currentTimeStroke:"#e31d3b")+"; stroke-width: 0.5px"}]),e.classic||(typeof e.alternativeItemStyle===t&&(e.alternativeItemStyle="background-color: #8080800c;"),typeof e.alternativeChartItemStyle===t&&(e.alternativeChartItemStyle="fill: #8080800c;")),!e.classic&&typeof e.arrowSize===t&&(e.arrowSize=1.5),typeof e.isRelativeToTimezone===t||e.isRelativeToTimezone){if(e.currentTime=new Date(e.currentTime.valueOf()-6e4*e.currentTime.getTimezoneOffset()),typeof e.displayedTime!==t&&(e.displayedTime=new Date(e.displayedTime.valueOf()-6e4*e.displayedTime.getTimezoneOffset())),typeof e.timelineStart!==t&&(e.timelineStart=new Date(e.timelineStart.valueOf()-6e4*e.timelineStart.getTimezoneOffset())),typeof e.timelineFinish!==t&&(e.timelineFinish=new Date(e.timelineFinish.valueOf()-6e4*e.timelineFinish.getTimezoneOffset())),typeof e.scales!==t)for(n=0;n<e.scales.length;n++){var r=e.scales[n];if(typeof r.intervals!==t)for(var o=0;o<r.intervals.length;o++){var l=r.intervals[o];typeof l.start!==t&&(l.start=new Date(l.start.valueOf()-6e4*l.start.getTimezoneOffset())),typeof l.finish!==t&&(l.finish=new Date(l.finish.valueOf()-6e4*l.finish.getTimezoneOffset()))}}e.isRelativeToTimezone=!1}if(typeof e.schedule!==t&&null!=e.schedule&&((e.schedule!=e.previousSchedule||e.schedule.workingWeekStart!=e.previousSchedule.workingWeekStart)&&(e.workingWeekStart=e.schedule.workingWeekStart),(e.schedule!=e.previousSchedule||e.schedule.workingWeekFinish!=e.previousSchedule.workingWeekFinish)&&(e.workingWeekFinish=e.schedule.workingWeekFinish),(e.schedule!=e.previousSchedule||e.schedule.workingDayStart!=e.previousSchedule.workingDayStart)&&(e.visibleDayStart=e.schedule.workingDayStart),(e.schedule!=e.previousSchedule||e.schedule.workingDayFinish!=e.previousSchedule.workingDayFinish)&&(e.visibleDayFinish=e.schedule.workingDayFinish),(e.schedule!=e.previousSchedule||e.schedule.specialNonworkingDays!=e.previousSchedule.specialNonworkingDays)&&(e.specialNonworkingDays=e.schedule.specialNonworkingDays)),typeof e.extendTimelineToEntireWeeks===t&&(e.extendTimelineToEntireWeeks=!0),e.intendedTimelineStart=e.timelineStart,e.intendedTimelineFinish=e.timelineFinish,e.timelineStart=typeof e.timelineStart===t?new Date(U(e.currentTime,e.weekStartDay).valueOf()-6048e5):U(e.timelineStart,e.weekStartDay),e.timelineFinish=typeof e.timelineFinish===t?new Date(U(e.currentTime,e.weekStartDay).valueOf()+320544e5):J(e.timelineFinish,e.weekStartDay),typeof e.intendedTimelineStart===t&&(e.intendedTimelineStart=e.timelineStart),typeof e.intendedTimelineFinish===t&&(e.intendedTimelineFinish=e.timelineFinish),!e.isExport&&typeof e.specialNonworkingDays!==t&&"function"!=typeof e.specialNonworkingDays)for(n=0;n<e.specialNonworkingDays.length;n++)e.specialNonworkingDays[n]=S(new Date(e.specialNonworkingDays[n].valueOf()-6e4*(e.specialNonworkingDays[n].getTimezoneOffset()<0?e.specialNonworkingDays[n].getTimezoneOffset():0)));if(!e.isExport&&typeof e.resourceSchedules!==t)for(r=0;r<e.resourceSchedules.length;r++)if(typeof(o=e.resourceSchedules[r].value).specialNonworkingDays!==t)for(n=0;n<o.specialNonworkingDays.length;n++)o.specialNonworkingDays[n]=S(new Date(o.specialNonworkingDays[n].valueOf()-6e4*(o.specialNonworkingDays[n].getTimezoneOffset()<0?o.specialNonworkingDays[n].getTimezoneOffset():0)));if(typeof e.scales===t&&(e.scales=G(e)),typeof e.updateScale===t&&(e.updateScale=9e5),typeof e.hourWidth===t&&(e.hourWidth=e.classic?2.5:5),typeof e.displayedTime===t&&(e.displayedTime=e.currentTime,setTimeout(function(){var f=s.chartContentContainer.scrollLeft-12*e.hourWidth;s.chartContentContainer.scrollLeft-f<s.chartContentContainer.clientWidth/3&&(s.chartContentContainer.scrollLeft=Math.max(0,f))},0)),e.previousSchedule=e.schedule,typeof e.visibleDayStart===t&&(e.visibleDayStart=288e5),typeof e.visibleDayFinish===t&&(e.visibleDayFinish=576e5),e.visibleDayStart>=e.visibleDayFinish&&(e.visibleWeekStart=0,e.visibleWeekFinish=864e5),typeof e.visibleWeekStart===t&&(e.visibleWeekStart=0),typeof e.visibleWeekFinish===t&&(e.visibleWeekFinish=6),e.visibleWeekStart>e.visibleWeekFinish&&(e.visibleWeekStart==e.visibleWeekFinish+1?(e.visibleWeekStart=0,e.visibleWeekFinish=6):e.visibleWeekFinish=e.visibleWeekStart),typeof e.workingWeekStart===t&&(e.workingWeekStart=1),typeof e.workingWeekFinish===t&&(e.workingWeekFinish=5),e.workingWeekStart>e.workingWeekFinish&&(e.workingWeekStart==e.workingWeekFinish+1?(e.workingWeekStart=0,e.workingWeekFinish=6):e.workingWeekFinish=e.workingWeekStart),e.workingDayStart=e.visibleDayStart,e.workingDayFinish=e.visibleDayFinish,!e.classic&&typeof e.barMargin===t&&(e.barMargin=4),typeof e.barHeight===t&&(e.barHeight=typeof e.barMargin===t?e.itemHeight/2:e.itemHeight-2*e.barMargin),typeof e.barMargin===t&&(e.barMargin=(e.itemHeight-e.barHeight)/2),typeof e.barCornerRadius===t&&(e.barCornerRadius=e.classic?"Aero"===e.theme?3:0:2),!e.classic&&typeof e.completedBarMargin===t&&(e.completedBarMargin=1),typeof e.completedBarMargin===t&&(e.completedBarMargin=e.barHeight/2.5),typeof e.completedBarHeight===t&&(e.completedBarHeight=e.barHeight-2*e.completedBarMargin),typeof e.completedBarCornerRadius===t&&(e.completedBarCornerRadius=0),e.completedBarCornerRadius=Math.min(e.completedBarCornerRadius,Math.max(0,e.barCornerRadius-1)),typeof e.styleDefinitionTemplate===t&&(e.styleDefinitionTemplate=Ni(s,e)),typeof e.standardBarStyle===t&&null==e.standardBarClass)if(e.classic)switch(e.theme){default:e.standardBarStyle="fill: #8abbed; fill-opacity: 0.8; stroke: #8abbed; stroke-width: 0.65px";break;case"ModernBordered":e.standardBarStyle="fill: #8abbed; fill-opacity: 0.8; stroke: Blue; stroke-width: 0.65px";break;case"Aero":e.standardBarStyle="fill: url(#BlueGradient); fill-opacity: 0.8; stroke: Blue"}else e.standardBarStyle="fill: #8dd2ff; fill-opacity: 0.8; stroke: #3b87d9; stroke-width: 0.65px;";if(typeof e.standardCompletedBarStyle===t&&null==e.standardCompletedBarClass&&(e.standardCompletedBarStyle=e.classic?"Aero"===e.theme?"fill: #808080; stroke: #202020; stroke-width: 0.65px":"fill: #3b87d9; stroke: #3b87d9; stroke-width: 0.65px":"fill: #1ca3ec; stroke: #1ca3ec; stroke-width: 0.5px;"),typeof e.summaryBarStyle===t&&null==e.summaryBarClass)switch(e.theme){default:e.summaryBarStyle="fill: #607080; stroke: #607080; stroke-width: 0.65px";break;case"ModernBordered":e.summaryBarStyle="fill: #607080; stroke: #202020; stroke-width: 0.65px";break;case"Aero":e.summaryBarStyle="fill: url(#BlackGradient); stroke: Black"}if(typeof e.summaryCompletedBarStyle===t&&null==e.summaryCompletedBarClass&&(e.summaryCompletedBarStyle="Aero"===e.theme?"fill: #a0a0a0; stroke: #303030; stroke-width: 0.65px":"fill: #404040; stroke: #404040; stroke-width: 0.65px"),typeof e.collapsedSummaryLineStyle===t&&null==e.collapsedSummaryLineClass&&(e.collapsedSummaryLineStyle="stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2 2"),typeof e.milestoneBarStyle===t&&null==e.milestoneBarClass)if(e.classic)switch(e.theme){default:e.milestoneBarStyle="fill: #607080; stroke: #607080; stroke-width: 0.65px";break;case"ModernBordered":e.milestoneBarStyle="fill: #607080; stroke: #202020; stroke-width: 0.65px";break;case"Aero":e.milestoneBarStyle="fill: url(#BlackGradient); stroke: Black"}else e.milestoneBarStyle="fill: #f8c758; stroke: #3b87d9; stroke-width: 0.65px;";if(typeof e.completedBarThumbStyle===t&&null==e.completedBarThumbClass&&(e.completedBarThumbStyle="fill: White; stroke: #a0a0a0; stroke-width: 1px; transform: translateY(3px);"),typeof e.baselineBarStyle===t&&null==e.baselineBarClass&&(e.baselineBarStyle="Aero"===e.theme?"fill: none; stroke: Blue; stroke-dasharray: 2, 2":"fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2"),typeof e.dependencyPointerStyle===t&&null==e.dependencyPointerClass&&(e.dependencyPointerStyle=e.classic?"Aero"===e.theme?"fill: Blue; stroke: Blue":"fill: #3b87d9; stroke: #3b87d9; stroke-width: 0.65px":"fill: White; stroke: #a0a0a0; stroke-width: 1px;"),typeof e.dependencyLineStyle===t&&null==e.dependencyLineClass&&(e.dependencyLineStyle=e.classic?"Aero"===e.theme?"stroke: Blue; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)":"stroke: #3b87d9; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)":"stroke: #3b87d9; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker);"),typeof e.dependencyLineZoneStyle===t&&null==e.dependencyLineZoneClass&&(e.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none"),typeof e.temporaryDependencyLineStyle===t&&null==e.temporaryDependencyLineClass&&(e.temporaryDependencyLineStyle="Aero"===e.theme?"stroke: Blue; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)":"stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)"),typeof e.assignmentsStyle===t&&null==e.assignmentsClass&&(e.assignmentsStyle="stroke-width: 0.25px; font-size: "+(e.classic?"x-small":"12px")),e.classic||(e.assignmentsStyle=e.assignmentsStyle+"; transform: translateX(10px) translateY(-1px);"),typeof e.standardTaskTemplate===t&&(e.standardTaskTemplate=Yi()),typeof e.summaryTaskTemplate===t&&(e.summaryTaskTemplate=Ui()),typeof e.milestoneTaskTemplate===t&&(e.milestoneTaskTemplate=Zi()),typeof e.horizontalChartLines!==t){var m=e.internalPreTaskTemplate;e.internalPreTaskTemplate=function(f){if(typeof f.scheduleChartItem!==t)return typeof m!==t?m(f):null;var v=f.ganttChartView.ownerDocument,g=v.createElementNS("http://www.w3.org/2000/svg","g");typeof m!==t&&g.appendChild(m(f));var I=v.createElementNS("http://www.w3.org/2000/svg","line");return I.setAttribute("x1",0),I.setAttribute("y1",-.5),I.setAttribute("x2",q(e.timelineFinish,e)),I.setAttribute("y2",-.5),I.setAttribute("style","stroke: "+e.horizontalChartLines+"; stroke-width: 0.5px"),g.appendChild(I),f.index==f.ganttChartView.items.length-1&&((I=v.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",0),I.setAttribute("y1",e.itemHeight),I.setAttribute("x2",q(e.timelineFinish,e)),I.setAttribute("y2",e.itemHeight),I.setAttribute("style","stroke: "+e.horizontalChartLines+"; stroke-width: 0.5px"),g.appendChild(I)),g}}typeof e.isTaskToolTipVisible===t&&(e.isTaskToolTipVisible="Phone"!==e.target),typeof e.itemTemplate===t&&(e.itemTemplate=Gi(e)),typeof e.areTaskAssignmentsVisible===t&&(e.areTaskAssignmentsVisible=!0),typeof e.assignmentsTemplate===t&&(e.assignmentsTemplate=Xi()),typeof e.isTaskCompletedEffortVisible===t&&(e.isTaskCompletedEffortVisible=!0),typeof e.areTaskDependenciesVisible===t&&(e.areTaskDependenciesVisible=!0),typeof e.dependencyLineTemplate===t&&(e.dependencyLineTemplate=_i()),typeof e.isDependencyToolTipVisible===t&&(e.isDependencyToolTipVisible=e.isTaskToolTipVisible),typeof e.predecessorItemTemplate===t&&(e.predecessorItemTemplate=$i(e)),typeof e.isDraggingTaskStartEndsEnabled===t&&(e.isDraggingTaskStartEndsEnabled=!0),typeof e.areTaskDependencyConstraintsEnabledWhileDragging===t&&(e.areTaskDependencyConstraintsEnabledWhileDragging=!1),typeof e.isTaskStartReadOnly===t&&(e.isTaskStartReadOnly=!1),typeof e.isTaskEffortReadOnly===t&&(e.isTaskEffortReadOnly=!1),typeof e.isTaskCompletionReadOnly===t&&(e.isTaskCompletionReadOnly=!1),typeof e.areTaskPredecessorsReadOnly===t&&(e.areTaskPredecessorsReadOnly=!1),typeof e.isBaselineVisible===t&&(e.isBaselineVisible=!0),void 0===typeof e.areStandardTaskLabelsVisible&&(e.areStandardTaskLabelsVisible=!1),void 0===typeof e.areSummaryTaskLabelsVisible&&(e.areSummaryTaskLabelsVisible=!1),void 0===typeof e.areMilestoneTaskLabelsVisible&&(e.areMilestoneTaskLabelsVisible=!1),typeof e.isSummaryTaskCompletedEffortVisible===t&&(e.isSummaryTaskCompletedEffortVisible=!1);var d=null;if(e.isIndividualItemNonworkingTimeHighlighted||e.areTaskInterruptionsHighlighted)for(n=0;n<e.scales.length;n++)if("NonworkingTime"==e.scales[n].scaleType){d=e.scales[n];break}if(null!=d&&e.isIndividualItemNonworkingTimeHighlighted){var u=e.internalPreTaskTemplate;e.internalPreTaskTemplate=function(f){if(typeof f.scheduleChartItem!==t&&(f.content||!f.schedule))return typeof u!==t?u(f):null;var v;if(typeof(v=ce(f))===t)v=null;else{var I,A,g=[];for(I=wt(e.timelineStart,typeof v.workingWeekFinish!==t?v.workingWeekFinish:e.workingWeekFinish),A=ui(I,typeof v.workingWeekStart!==t?v.workingWeekStart:e.workingWeekStart);I<e.timelineFinish;I=Xe(I),A=Xe(A)){g.push({start:I,finish:A});var W,V=Xe(I);for(dd=A;dd<V;dd=W)v.workingDayStart>e.visibleDayStart&&g.push({start:dd,finish:new Date(dd.valueOf()+v.workingDayStart)}),W=Q(dd),v.workingDayFinish<e.visibleDayFinish&&g.push({start:new Date(dd.valueOf()+v.workingDayFinish),finish:W})}if(typeof v.specialNonworkingDays!==t)if("function"==typeof v.specialNonworkingDays)for(I=wt(e.timelineStart,e.workingWeekFinish),A=Q(I);I<e.timelineFinish;I=Q(I),A=Q(A))v.specialNonworkingDays(I)&&g.push({start:I,finish:A});else for(V=0;V<v.specialNonworkingDays.length;V++)A=Q(I=v.specialNonworkingDays[V]),g.push({start:I,finish:A});v=g}if(null==v||0==v.length)return typeof u!==t?u(f):null;for(I=(g=f.ganttChartView.ownerDocument).createElementNS("http://www.w3.org/2000/svg","g"),A=0;A<v.length;A++)if(W=(V=v[A]).finish,V=q(V.start,e),!((W=q(W,e)-V)<=0)){var R=g.createElementNS("http://www.w3.org/2000/svg","rect");R.setAttribute("x",V-1),R.setAttribute("y",0),R.setAttribute("width",W),R.setAttribute("height",e.itemHeight),R.setAttribute("class",d.highlightingClass),R.setAttribute("style",d.highlightingStyle),I.appendChild(R)}return typeof u!==t&&I.appendChild(u(f)),I}}if(null!=d&&e.areTaskInterruptionsHighlighted){var p=e.internalExtraTaskTemplate;e.internalExtraTaskTemplate=function(f){if(typeof f.scheduleChartItem!==t)return typeof p!==t?p(f):null;var v;if(f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)||f.isMilestone)v=null;else{var I,A,g=ce(f);for(v=[],I=wt(S(f.start),typeof g!==t&&typeof g.workingWeekFinish!==t?g.workingWeekFinish:e.workingWeekFinish),A=ui(I,typeof g!==t&&typeof g.workingWeekStart!==t?g.workingWeekStart:e.workingWeekStart);I<f.finish;I=Xe(I),A=Xe(A))v.push({start:I>=f.start?I:f.start,finish:A<=f.finish?A:f.finish});var V=typeof g!==t&&typeof g.specialNonworkingDays!==t?g.specialNonworkingDays:e.specialNonworkingDays;if(typeof V!==t)if("function"==typeof V)for(I=wt(S(f.start),typeof g!==t&&typeof g.workingWeekFinish!==t?g.workingWeekFinish:e.workingWeekFinish),A=Q(I);I<S(f.finish);I=Q(I),A=Q(A))g.specialNonworkingDays(I)&&v.push({start:I,finish:A});else for(g=0;g<V.length;g++)A=Q(I=V[g]),I>=f.start&&A<=f.finish&&v.push({start:I,finish:A})}if(null==v||0==v.length)return typeof p!==t?p(f):null;for(A=(I=f.ganttChartView.ownerDocument).createElementNS("http://www.w3.org/2000/svg","g"),V=0;V<v.length;V++){var W=(g=v[V]).finish;if(g=q(g.start,e),!((W=q(W,e)-g)<=0)){var R=I.createElementNS("http://www.w3.org/2000/svg","rect");R.setAttribute("x",g-1),R.setAttribute("y",e.barMargin),R.setAttribute("width",W),R.setAttribute("height",e.barHeight),R.setAttribute("class",d.highlightingClass),R.setAttribute("style",d.highlightingStyle),A.appendChild(R)}}return typeof p!==t&&A.appendChild(p(f)),A}}typeof e.enableHorizontalScrollingDuringDragging===t&&(e.enableHorizontalScrollingDuringDragging=!0),typeof e.horizontalScrollingDragAreaWidth===t&&(e.horizontalScrollingDragAreaWidth=24),typeof e.horizontalScrollingDragAmount===t&&(e.horizontalScrollingDragAmount=20),typeof e.enableVerticalScrollingDuringDragging===t&&(e.enableVerticalScrollingDuringDragging=!0),typeof e.verticalScrollingDragAreaHeight===t&&(e.verticalScrollingDragAreaHeight=24),typeof e.verticalScrollingDragAmount===t&&(e.verticalScrollingDragAmount=20)},Ce=function(e,n){for(var s=0;s<e.length;s++){var r=e[s];if("string"==typeof r&&(e[s]=r={content:r}),"string"==typeof r.indentation&&(r.indentation=parseInt(r.indentation)),"string"==typeof r.isExpanded&&(r.isExpanded="true"==r.isExpanded.toLowerCase()),"string"==typeof r.start){try{r.start=new Date(r.start)}catch{r.start=new Date(parseInt(r.start))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.start=new Date(r.start.valueOf()+6e4*r.start.getTimezoneOffset())),r.preferredStart=r.start}if("string"==typeof r.finish){try{r.finish=new Date(r.finish)}catch{r.finish=new Date(parseInt(r.finish))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.finish=new Date(r.finish.valueOf()+6e4*r.finish.getTimezoneOffset()))}if("string"==typeof r.completedFinish){try{r.completedFinish=new Date(r.completedFinish)}catch{r.completedFinish=new Date(parseInt(r.completedFinish))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.completedFinish=new Date(r.completedFinish.valueOf()+6e4*r.completedFinish.getTimezoneOffset()))}if("string"==typeof r.isMilestone&&(r.isMilestone="true"==r.isMilestone.toLowerCase()),"string"==typeof r.baselineStart){try{r.baselineStart=new Date(r.baselineStart)}catch{r.baselineStart=new Date(parseInt(r.baselineStart))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.baselineStart=new Date(r.baselineStart.valueOf()+6e4*r.baselineStart.getTimezoneOffset()))}if("string"==typeof r.baselineFinish){try{r.baselineFinish=new Date(r.baselineFinish)}catch{r.baselineFinish=new Date(parseInt(r.baselineFinish))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.baselineFinish=new Date(r.baselineFinish.valueOf()+6e4*r.baselineFinish.getTimezoneOffset()))}if("string"==typeof r.minStart){try{r.minStart=new Date(r.minStart)}catch{r.minStart=new Date(parseInt(r.minStart))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.minStart=new Date(r.minStart.valueOf()+6e4*r.minStart.getTimezoneOffset()))}if("string"==typeof r.maxStart){try{r.maxStart=new Date(r.maxStart)}catch{r.maxStart=new Date(parseInt(r.maxStart))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.maxStart=new Date(r.maxStart.valueOf()+6e4*r.maxStart.getTimezoneOffset()))}if("string"==typeof r.minFinish){try{r.minFinish=new Date(r.minFinish)}catch{r.minFinish=new Date(parseInt(r.minFinish))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.minFinish=new Date(r.minFinish.valueOf()+6e4*r.minFinish.getTimezoneOffset()))}if("string"==typeof r.maxFinish){try{r.maxFinish=new Date(r.maxFinish)}catch{r.maxFinish=new Date(parseInt(r.maxFinish))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.maxFinish=new Date(r.maxFinish.valueOf()+6e4*r.maxFinish.getTimezoneOffset()))}if(typeof r.predecessors!==t){"string"==typeof r.predecessors&&(r.predecessors=r.predecessors.split(","));for(var o=0;o<r.predecessors.length;o++){var l=r.predecessors[o];if("string"==typeof l&&(r.predecessors[o]=l={item:l}),"string"==typeof l.item){var m=parseInt(l.item)-1;l.item=m>=0&&m<e.length?e[m]:null}"string"==typeof l.lag&&(l.lag=parseFloat(l.lag))}}if(typeof r.schedule!==t&&typeof r.schedule.specialNonworkingDays!==t&&"function"!=typeof n.specialNonworkingDays)for(o=0;o<r.schedule.specialNonworkingDays.length;o++)r.schedule.specialNonworkingDays[o]=S(new Date(r.schedule.specialNonworkingDays[o].valueOf()-6e4*r.schedule.specialNonworkingDays[o].getTimezoneOffset()));typeof r.wasGridItemContentLoaded!==t&&delete r.wasGridItemContentLoaded}},ae=function(e,n,s){var r;if(e.isContentHeightInitialized&&e.isContentHeightAuto)r=n.length>0?"auto":s.itemHeight+"px";else{var o=e.clientHeight-s.headerHeight-2;o<0&&(o=0),r=o+"px",o<s.itemHeight&&(e.isContentHeightInitialized||(e.isContentHeightAuto=!0),r=n.length>0?"auto":s.itemHeight+"px"),e.isContentHeightInitialized=!0}return r},ue=function(e,n){if(typeof n.toggleButtonAreaWidth!==t)return n.toggleButtonAreaWidth;var s=0;if(n.isGridVisible)for(var r=0;r<e.length;r++)if((typeof e[r].scheduleChartItem===t||e[r].scheduleChartItem==e[r])&&e[r].indentation>0){s=16;break}return n.toggleButtonAreaWidth=s},H=function(e,n){var s=e.createElement("span");return s.innerHTML=n,s},a=function(e,n){return e.createTextNode(1==n?"\u2713":"")},D=function(e){var n=e.getFullYear(),s=e.getMonth()+1;return s<10&&(s="0"+s),(e=e.getDate())<10&&(e="0"+e),s+"/"+e+"/"+n},k=function(e){var n=D(e),s=e.getHours();return s<10&&(s="0"+s.toString()),(e=e.getMinutes())<10&&(e="0"+e.toString()),n+" "+s+":"+e},h=function(e){return new Date(e.valueOf()+6e4*e.getTimezoneOffset())},T=function(e){var s,r,o,l,m,n=new Date;if(null==e||""==e)return n;if((o=e.indexOf(" "))>=0?(s=e.substr(0,o),l=e.substr(o+1)):(s=e,l="0"),(o=s.indexOf("/"))>=0){for(e=s.substr(0,o);e.length>0&&"0"==e.substr(0,1);)e=e.substr(1);if(e=parseInt(e)-1,(o=(s=s.substr(o+1)).indexOf("/"))>=0){for(r=s.substr(0,o),o=s.substr(o+1);o.length>0&&"0"==o.substr(0,1);)o=o.substr(1);s=parseInt(o)}else r=s,s=n.getFullYear();for(;r.length>0&&"0"==r.substr(0,1);)r=r.substr(1);r=parseInt(r)}else{for(;s.length>0&&"0"==s.substr(0,1);)s=s.substr(1);r=parseInt(s),e=n.getMonth(),s=n.getFullYear()}for((o=l.indexOf(":"))>=0?(m=l.substr(0,o),l=l.substr(o+1)):(m=l,l="0");m.length>1&&"0"==m.substr(0,1);)m=m.substr(1);for(o=parseInt(m);l.length>1&&"0"==l.substr(0,1);)l=l.substr(1);return l=parseInt(l),isNaN(s)||isNaN(e)||isNaN(r)||s<=0||e<0||e>=12||r<1||r>We[e]+(1!=e||s%400!=0&&(s%100==0||s%4!=0)?0:1)?isNaN(o)||isNaN(l)||o<0||o>=24||l<0||l>=60?n:new Date(n.getFullYear(),n.getMonth(),n.getDate(),o,l,0,0):isNaN(o)||isNaN(l)||o<0||o>=24||l<0||l>=60?new Date(s,e,r,0,0,0,0):new Date(s,e,r,o,l,0,0)},y=function(e){return new Date(e.valueOf()-6e4*e.getTimezoneOffset())},F=function(e,n){var s=e.ownerDocument,r=s.createElementNS("http://www.w3.org/2000/svg","svg");return r.setAttribute("style","width: 12px; height: 12px; vertical-align: initial"),r.setAttribute("focusable","false"),(s=s.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("id","PART_Border"),s.setAttribute("width","12"),s.setAttribute("height","12"),s.setAttribute("style","fill: White; fill-opacity: 0"),r.appendChild(s),e.setAttribute("id","PART_Button"),typeof n.toggleButtonClass!==t&&e.setAttribute("class",n.toggleButtonClass),typeof n.toggleButtonStyle!==t&&e.setAttribute("style",n.toggleButtonStyle),r.appendChild(e),r},x=function(e,n){"object"!=typeof n&&(n={}),xe(n);var s=[{header:"",width:32,isSelection:!0},{header:"Task",width:140,isTreeView:!0},{header:"Start",width:140},{header:"Finish",width:140},{header:"Milestone",width:80},{header:"Completed",width:80},{header:"Assignments",width:200}];return s[0].cellTemplate=N(n,s[0],e),s[1].cellTemplate=oe(n,s[1],e),s[1].exportCellTemplate=oe(n,s[1],e,!1),s[2].cellTemplate=He(n,s[2]),s[2].exportCellTemplate=He(n,s[2],!1),s[3].cellTemplate=Ie(n,s[3]),s[3].exportCellTemplate=Ie(n,s[3],!1),s[4].cellTemplate=Fe(n,s[4]),s[4].exportCellTemplate=Fe(n,s[4],!1),s[5].cellTemplate=Be(n,s[5]),s[5].exportCellTemplate=Be(n,s[5],!1),s[6].cellTemplate=Me(n,s[6]),s[6].exportCellTemplate=Me(n,s[6],!1),"Single"!=n.selectionMode&&"Extended"!=n.selectionMode&&"ExtendedFocus"!=n.selectionMode&&s.splice(0,1),s},N=function(e,n,s){return function(r){return n.isReadOnly?a(r.ganttChartView.ownerDocument,r.isSelected):P(r,e,s)}},P=function(e,n){var r,s=e.ganttChartView.ownerDocument;typeof e.selectionInput===t?(r=s.createElement("input"),e.selectionInput=r,r.type="checkbox",r.setAttribute("style","margin: 0px")):r=e.selectionInput,e.isSelected?(r.setAttribute("checked","checked"),r.checked||(r.checked=!0)):r.checked&&(r.checked=!1);var o=function(){X(e,!!r.checked,n.selectionMode)};return typeof r.changeEventListener!==t&&r.removeEventListener("change",r.changeEventListener,!0),r.addEventListener("change",o,!0),r.changeEventListener=o,s=function(l){13==l.keyCode&&(l.preventDefault(),l.stopPropagation(),o())},typeof r.keyPressEventListener!==t&&r.removeEventListener("keypress",r.keyPressEventListener,!0),r.addEventListener("keypress",s,!0),r.keyPressEventListener=s,r},X=function(e,n,s){var r;if(e.isSelected=n,le(e,"isSelected",!0,!0),Li(e),typeof e.ganttChartView!==t&&(e.ganttChartView.selectedItem=e,"Extended"!=s&&"ExtendedFocus"!=s&&(e.ganttChartView.selectedItems=[e]),"Extended"!=s&&"ExtendedFocus"!=s))for(r=0;r<e.ganttChartView.items.length;r++)(n=e.ganttChartView.items[r])!=e&&n.isSelected&&(n.isSelected=!1,le(n,"isSelected",!1,!0),Li(n));if(typeof e.ganttChartView!==t&&("Extended"==s||"ExtendedFocus"==s)){for(s=[],r=0;r<e.ganttChartView.items.length;r++)(n=e.ganttChartView.items[r]).isSelected&&s.push(n);e.ganttChartView.selectedItems=s}},ee=function(e,n){typeof e.ganttChartView!==t&&(e.ganttChartView.currentItem=e),("Focus"==n.selectionMode||"ExtendedFocus"==n.selectionMode)&&(typeof e.scheduleChartItem!==t&&(e=e.scheduleChartItem),e.isSelected||X(e,!0,n.selectionMode))},oe=function(e,n,s,r){var o=function(l){return H(l.ganttChartView.ownerDocument,l.content)};return typeof r!==t&&!r||e.isReadOnly||e.isGridReadOnly||e.isContentReadOnly?o:function(l){return n.isReadOnly||typeof l.isReadOnly!==t&&l.isReadOnly?o(l):ve(l,Math.max(0,n.width-l.indentation*l.ganttChartView.settings.indentationLevelWidth-l.ganttChartView.settings.toggleButtonAreaWidth-16),e)}},ve=function(e,n,s){var o,r=e.ganttChartView.ownerDocument;if(typeof e.contentInput===t){o=r.createElement("input"),e.contentInput=o,o.type="text",o.addEventListener("focus",function(){ee(e,s)},!1);var l=function(){e.content=o.value,le(e,"content",!0,!0),xt(e)};typeof o.changeEventListener!==t&&o.removeEventListener("change",o.changeEventListener,!0),o.addEventListener("change",l,!0),o.changeEventListener=l,r=function(m){13==m.keyCode&&(m.preventDefault(),m.stopPropagation(),l())},typeof o.keyPressEventListener!==t&&o.removeEventListener("keypress",o.keyPressEventListener,!0),o.addEventListener("keypress",r,!0),o.keyPressEventListener=r,o.addEventListener("focus",function(){o.style.backgroundColor="White"},!1),o.addEventListener("blur",function(){o.style.backgroundColor="Transparent"},!1)}else o=e.contentInput;return o.value=e.content,r="",e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&(r="; font-weight: bold"),o.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+r+(s.classic?"":"; font-size: 12px; padding: 1px;")),o},He=function(e,n,s){var r=function(o){return o.ganttChartView.ownerDocument.createTextNode(typeof o.start===t||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?"":e.dateTimeFormatter(h(o.start)))};return typeof s!==t&&!s||e.isReadOnly||e.isGridReadOnly?r:function(o){return n.isReadOnly||typeof o.isReadOnly!==t&&o.isReadOnly||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?r(o):Ae(o,Math.max(0,n.width-16),e)}},Ae=function(e,n,s){var r=e.ganttChartView.ownerDocument,o=r.createElement("input");e.startInput=o;try{o.type=s.dateTimePickerType}catch{o.type="text"}o.addEventListener("focus",function(){ee(e,s)},!1),o.addEventListener("focus",function(){o.style.backgroundColor="White"},!1),o.addEventListener("blur",function(){o.style.backgroundColor="Transparent"},!1),typeof e.start!==t&&(o.value=s.dateTimeFormatter(h(e.start))),DlhSoft.Controls.DatePicker&&"text"==s.dateTimePickerType&&s.useDatePicker&&o.addEventListener("focus",function(){if(!e.isWaitingToRefreshGridItem){var d=(s.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).get(o);if(!d||!d.isOpen){var u=0,p=0;try{u=o.selectionStart,p=o.selectionEnd}catch{}(d=(s.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).initialize(o,void 0,{inputStyle:null,isDropDownButtonVisible:!1,defaultTimeOfDay:s.workingDayStart,dateTimeFormatter:s.dateTimeFormatter,dateTimeParser:s.dateTimeParser,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid "+s.border,disabledDateSelector:Le(s),disabledTimeSelector:pe(s),calendarSelectorLevels:s.calendarSelectorLevels,months:s.months,daysOfWeek:Pe(s.daysOfWeek),weekStart:s.weekStartDay},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{o.selectionStart=u,o.selectionEnd=p}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{o.focus()}catch{}},100):r.createEvent&&setTimeout(function(){var f=r.createEvent("MouseEvents");f.initEvent("blur",!0,!1),o.dispatchEvent(f)})}}},!0);var l="";e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&(l="; font-weight: bold"),o.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+l+(s.classic?"":"; font-size: 12px; padding: 1px;")),e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)?o.setAttribute("disabled","true"):o.removeAttribute("disabled");var m=function(){if(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled){var u,p,d=e.completedFinish>e.start;s.isTaskEffortPreservedWhenStartChangesInGrid&&(u=gt(e,s),p=Mt(e,s));var f=e.start.valueOf(),v=e.finish.valueOf(),g=e.completedFinish.valueOf(),I=s.dateTimeParser(o.value);(null==I||isNaN(I))&&(I=new Date),I=_e(y(I),s,!0,e.isMilestone,ce(e)),(!s.validateStartFinish||I<=e.finish||e.isMilestone)&&(e.start=I,e.preferredStart=e.start,e.isMilestone&&(e.finish=e.start),e.start.valueOf()!=f&&le(e,"start",!0,!0),e.finish<e.start&&(e.finish=e.start,e.finish.valueOf()!=v&&le(e,"finish",!1,!0)),e.completedFinish<e.start||!d?(e.completedFinish=e.start,e.completedFinish.valueOf()!=g&&le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,e.completedFinish.valueOf()!=g&&le(e,"completedFinish",!1,!0)),typeof e.completedInput!==t&&(typeof(d=e.completedInput).changeEventListener!==t&&d.removeEventListener("change",d.changeEventListener,!0),delete e.completedInput),s.isTaskEffortPreservedWhenStartChangesInGrid&&(li(e,u,s),ai(e,p,s)))}st(e)};return typeof o.changeEventListener!==t&&o.removeEventListener("change",o.changeEventListener,!0),o.addEventListener("change",m,!0),o.changeEventListener=m,n=function(d){13==d.keyCode&&(d.preventDefault(),d.stopPropagation(),m())},typeof o.keyPressEventListener!==t&&o.removeEventListener("keypress",o.keyPressEventListener,!0),o.addEventListener("keypress",n,!0),o.keyPressEventListener=n,o},Ie=function(e,n,s){var r=function(o){return typeof o.finish===t||typeof o.isMilestone!==t&&1==o.isMilestone&&typeof o.start!==t&&o.finish.valueOf()==o.start.valueOf()||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?o.ganttChartView.ownerDocument.createTextNode(""):o.ganttChartView.ownerDocument.createTextNode(e.dateTimeFormatter(h(o.finish)))};return typeof s!==t&&!s||e.isReadOnly||e.isGridReadOnly?r:function(o){return n.isReadOnly||typeof o.isReadOnly!==t&&o.isReadOnly||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?r(o):be(o,Math.max(0,n.width-16),e)}},be=function(e,n,s){var r=e.ganttChartView.ownerDocument,o=r.createElement("input");e.finishInput=o;try{o.type=s.dateTimePickerType}catch{o.type="text"}o.addEventListener("focus",function(){ee(e,s)},!1),o.addEventListener("focus",function(){o.style.backgroundColor="White"},!1),o.addEventListener("blur",function(){o.style.backgroundColor="Transparent"},!1),typeof e.finish!==t&&(o.value=s.dateTimeFormatter(h(e.finish))),DlhSoft.Controls.DatePicker&&"text"==s.dateTimePickerType&&s.useDatePicker&&o.addEventListener("focus",function(){if(!e.isWaitingToRefreshGridItem){var u=(s.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).get(o);if(!u||!u.isOpen){var p=0,f=0;try{p=o.selectionStart,f=o.selectionEnd}catch{}(u=(s.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).initialize(o,void 0,{inputStyle:null,isDropDownButtonVisible:!1,defaultTimeOfDay:s.workingDayFinish,dateTimeFormatter:s.dateTimeFormatter,dateTimeParser:s.dateTimeParser,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid "+s.border,disabledDateSelector:Le(s),disabledTimeSelector:me(s,e),calendarSelectorLevels:s.calendarSelectorLevels,months:s.months,daysOfWeek:Pe(s.daysOfWeek),weekStart:s.weekStartDay},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{o.selectionStart=p,o.selectionEnd=f}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{o.focus()}catch{}},100):r.createEvent&&setTimeout(function(){var v=r.createEvent("MouseEvents");v.initEvent("blur",!0,!1),o.dispatchEvent(v)})}}},!0);var l="";typeof e.isMilestone!==t&&1==e.isMilestone&&(l="; visibility: hidden");var m="";e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&(m="; font-weight: bold"),o.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+l+m+(s.classic?"":"; font-size: 12px; padding: 1px;")),e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)?o.setAttribute("disabled","true"):o.removeAttribute("disabled");var d=function(){if(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled){var u=e.finish.valueOf(),p=e.completedFinish.valueOf(),f=s.dateTimeParser(o.value);(null==f||isNaN(f))&&(f=new Date),f=y(f),o.value.length>0&&o.value.indexOf(" ")<0&&0==L(f)&&(f=Q(f)),f=_e(f,s,e.isMilestone,!0,ce(e)),(!s.validateStartFinish||f>=e.start)&&(e.finish=f,e.finish<e.start&&(e.finish=e.start),e.finish.valueOf()!=u&&le(e,"finish",!0,!0),e.completedFinish<e.start?(e.completedFinish=e.start,e.completedFinish.valueOf()!=p&&le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,e.completedFinish.valueOf()!=p&&le(e,"completedFinish",!1,!0)),typeof e.completedInput!==t&&(typeof(u=e.completedInput).changeEventListener!==t&&u.removeEventListener("change",u.changeEventListener,!0),delete e.completedInput))}st(e)};return typeof o.changeEventListener!==t&&o.removeEventListener("change",o.changeEventListener,!0),o.addEventListener("change",d,!0),o.changeEventListener=d,n=function(u){13==u.keyCode&&(u.preventDefault(),u.stopPropagation(),d())},typeof o.keyPressEventListener!==t&&o.removeEventListener("keypress",o.keyPressEventListener,!0),o.addEventListener("keypress",n,!0),o.keyPressEventListener=n,o},Le=function(e){return function(n){if(n.getDay()<e.workingWeekStart||n.getDay()>e.workingWeekFinish)return!0;if(e.specialNonworkingDays){if("function"==typeof e.specialNonworkingDays)return e.specialNonworkingDays(y(n));n=y(n).valueOf();for(var s=0;s<e.specialNonworkingDays.length;s++)if(n==e.specialNonworkingDays[s].valueOf())return!0}return!1}},pe=function(e){return function(n){return n<e.visibleDayStart||n>=e.visibleDayFinish}},me=function(e,n){return function(s){return(S(n.start)<S(n.finish)?s<=e.visibleDayStart:s<e.visibleDayStart)||s>e.visibleDayFinish}},Pe=function(e){if(e){for(var n=[],s=0;s<e.length;s++){var r=(r=e[s]).length>0?r[0].toUpperCase()+(r.length>1?r[1]:""):"";n.push(r)}return n}},Fe=function(e,n,s){var r=function(o){return typeof o.isMilestone===t||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?o.ganttChartView.ownerDocument.createTextNode(""):a(o.ganttChartView.ownerDocument,o.isMilestone)};return typeof s!==t&&!s||e.isReadOnly||e.isGridReadOnly?r:function(o){return n.isReadOnly||typeof o.isReadOnly!==t&&o.isReadOnly||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?r(o):rt(o,e)}},rt=function(e,n){var r,s=e.ganttChartView.ownerDocument;if(typeof e.milestoneInput===t?(r=s.createElement("input"),e.milestoneInput=r,r.type="checkbox",r.setAttribute("style","margin: 0px; margin-left: 2px; margin-right: 2px"),r.addEventListener("focus",function(){ee(e,n)},!1)):r=e.milestoneInput,e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)||typeof e.isMilestone===t||!e.isMilestone?r.removeAttribute("checked"):r.setAttribute("checked","checked"),!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled){var o=function(){r.checked?(e.isMilestone=!0,le(e,"isMilestone",!0,!0),e.finish>e.start&&(e.finish=e.start,le(e,"finish",!1,!0)),e.completedFinish>e.start&&(e.completedFinish=e.start,le(e,"completedFinish",!1,!0))):(e.isMilestone=!1,le(e,"isMilestone",!0,!0)),st(e)};typeof r.changeEventListener!==t&&r.removeEventListener("change",r.changeEventListener,!0),r.addEventListener("change",o,!0),r.changeEventListener=o,s=function(l){13==l.keyCode&&(l.preventDefault(),l.stopPropagation(),o())},typeof r.keyPressEventListener!==t&&r.removeEventListener("keypress",r.keyPressEventListener,!0),r.addEventListener("keypress",s,!0),r.keyPressEventListener=s}else r.setAttribute("style","visibility: hidden");return r},Me=function(e,n,s){var r=function(o){return typeof o.assignmentsContent===t||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?o.ganttChartView.ownerDocument.createTextNode(""):H(o.ganttChartView.ownerDocument,o.assignmentsContent)};return typeof s!==t&&!s||e.isReadOnly||e.isGridReadOnly||e.isAssignmentsContentReadOnly?r:function(o){return n.isReadOnly||typeof o.isReadOnly!==t&&o.isReadOnly||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?r(o):Qe(o,Math.max(0,n.width-16),e)}},Qe=function(e,n,s){var l,r=e.ganttChartView,o=r.ownerDocument;if(typeof e.assignmentsContentInput===t){l=o.createElement("input"),e.assignmentsContentInput=l,l.type="text",l.addEventListener("focus",function(){ee(e,s)},!1);var m=function(){e.assignmentsContent=l.value,le(e,"assignmentsContent",!0,!0),!e.hasChildren&&e.hasFixedEffort&&(e.fixedEffort=gt(e,s),e.fixedEffortAssignments=Ct(e)),bt(e);var u=null;if(DlhSoft.Controls.MultiSelectorComboBox&&(u=DlhSoft.Controls.MultiSelectorComboBox.get(l)),null!=u&&u.availableChoices.length>0)var p=setInterval(function(){!u.isOpen&&o.activeElement!=e.assignmentsContentInput&&(clearInterval(p),st(e))},100);else st(e)};typeof l.changeEventListener!==t&&l.removeEventListener("change",l.changeEventListener,!0),l.addEventListener("change",function(u){l.dontAutoFocus=!0,m()},!0),l.changeEventListener=m;var d=function(u){13==u.keyCode&&(u.preventDefault(),u.stopPropagation(),typeof l.dontAutoFocus!==t&&delete l.dontAutoFocus,m())};typeof l.keyPressEventListener!==t&&l.removeEventListener("keypress",l.keyPressEventListener,!0),l.addEventListener("keypress",d,!0),l.keyPressEventListener=d,l.addEventListener("focus",function(){l.style.backgroundColor="White"},!1),l.addEventListener("blur",function(){l.style.backgroundColor="Transparent"},!1)}else l=e.assignmentsContentInput;return typeof e.assignmentsContent!==t&&(l.value=e.assignmentsContent),DlhSoft.Controls.MultiSelectorComboBox&&s.useResourceSelector&&l.addEventListener("focus",function(){if(!e.isWaitingToRefreshGridItem){var u=DlhSoft.Controls.MultiSelectorComboBox.get(l);if(!u||!u.isOpen&&u.availableChoices.length>0){typeof(u=s.assignableResources)===t&&(u=Qt(r.items),s.assignableResources=u);var p=0,f=0;try{p=l.selectionStart,f=l.selectionEnd}catch{}(u=DlhSoft.Controls.MultiSelectorComboBox.initialize(l,u,void 0,{inputStyle:null,autoAppendAvailableChoices:s.autoAppendAssignableResources,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; color: Black; border: 1px solid "+s.border+"; font-size: small; max-height: 188px; overflow-y: auto"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{l.selectionStart=p,l.selectionEnd=f}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{l.focus()}catch{}},100):o.createEvent&&setTimeout(function(){var v=o.createEvent("MouseEvents");v.initEvent("blur",!0,!1),l.dispatchEvent(v)})}}},!0),d="",e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&(d="; font-weight: bold"),l.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+d+(s.classic?"":"; font-size: 12px; padding: 1px;")),l},Be=function(e,n,s){var r=function(o){return typeof o.start===t||typeof o.finish===t||o.finish.valueOf()==o.start.valueOf()||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?o.ganttChartView.ownerDocument.createTextNode(""):a(o.ganttChartView.ownerDocument,o.ganttChartView.isItemCompleted(o))};return typeof s!==t&&!s||e.isReadOnly||e.isGridReadOnly?r:function(o){return n.isReadOnly||typeof o.isReadOnly!==t&&o.isReadOnly||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?r(o):qe(o,e)}},qe=function(e,n){var r,s=e.ganttChartView.ownerDocument;typeof e.completedInput===t?(r=s.createElement("input"),e.completedInput=r,r.type="checkbox",r.setAttribute("style","margin: 0px; margin-left: 2px; margin-right: 2px"),r.addEventListener("focus",function(){ee(e,n)},!1)):r=e.completedInput,e.isSetAsCompleted||(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)&&e.completedFinish>=e.finish&&e.finish>e.start&&(typeof e.isMilestone===t||!e.isMilestone)?r.setAttribute("checked","checked"):r.removeAttribute("checked"),e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&r.setAttribute("style","visibility: hidden");var o=function(){r.checked?(e.completedFinish<e.finish&&(e.completedFinish=e.finish,le(e,"completedFinish",!0,!0)),(e.isMilestone||e.finish.valueOf()<=e.start.valueOf())&&(e.isSetAsCompleted=!0,le(e,"isSetAsCompleted",!0,!0))):(e.completedFinish>e.start&&(e.completedFinish=e.start,le(e,"completedFinish",!0,!0)),(e.isMilestone||e.finish.valueOf()<=e.start.valueOf())&&(e.isSetAsCompleted=!1,le(e,"isSetAsCompleted",!0,!0))),st(e)};return typeof r.changeEventListener!==t&&r.removeEventListener("change",r.changeEventListener,!0),r.addEventListener("change",o,!0),r.changeEventListener=o,s=function(l){13==l.keyCode&&(l.preventDefault(),l.stopPropagation(),o())},typeof r.keyPressEventListener!==t&&r.removeEventListener("keypress",r.keyPressEventListener,!0),r.addEventListener("keypress",s,!0),r.keyPressEventListener=s,r},ft=function(e){for(var n=0,s=0;s<e.length;s++)n+=e[s].width;return n},je=function(e,n,s){for(var r=ue(n.items,s),o=0;o<e.length;o++){var l=e[o];l.ganttChartView=n,typeof l.width===t&&(l.width=100),typeof l.minWidth===t&&(l.minWidth=Math.min(l.width,s.minColumnWidth+(l.isTreeView?r:0))),typeof l.maxWidth===t&&(l.maxWidth=s.maxColumnWidth),typeof l.cellTemplate===t&&(l.cellTemplate=function(m){return H(m.ganttChartView.ownerDocument,m.content)}),(s.verticalGridLines||s.verticalGridHeaderLines)&&(l.minWidth<4&&(l.minWidth=4),l.width<l.minWidth&&(l.width=l.minWidth))}},at=function(e,n,s,r){var o=e.ownerDocument,l=o.createElement("div");typeof s.columnHeaderClass!==t&&l.setAttribute("class",s.columnHeaderClass),typeof s.columnHeaderStyle!==t&&l.setAttribute("style",s.columnHeaderStyle);for(var m=0;m<n.length;m++)l.appendChild(E(o,n[m],s,r));e.appendChild(l)},E=function(e,n,s,r){var o=e.createElement("div");o.setAttribute("style","overflow-y: hidden; vertical-align: middle; display: table-cell; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: "+s.headerHeight+"px");var l=e.createElement("div"),m=n.width>=4?2:n.width/2;if(l.setAttribute("style","padding-left: "+m+"px; padding-right: "+m+"px; overflow-x: hidden; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+n.width+"px"),m=e.createElement("div"),typeof n.headerClass!==t&&m.setAttribute("class",n.headerClass),typeof n.headerStyle!==t&&m.setAttribute("style",n.headerStyle),m.appendChild(H(e,n.header)),l.appendChild(m),o.appendChild(l),s.verticalGridLines||s.verticalGridHeaderLines||n.width>=1&&(typeof s.allowUserToResizeColumns===t||s.allowUserToResizeColumns)&&(typeof n.allowUserToResize===t||n.allowUserToResize)){o.isGripperVisible=!1,r=n.ganttChartView;var d=function(f){o.isGripperVisible=f,o.style.cursor=f?s.classic?"e-resize":"ew-resize":"default",o.style.borderRight=f?"solid 1px "+s.border:s.verticalGridLines||s.verticalGridHeaderLines?"solid 1px "+(s.verticalGridHeaderLines?s.verticalGridHeaderLines:s.verticalGridLines):"",l.style.width=n.width-(o.style.borderRight?1:0)+"px"};if((s.verticalGridLines||s.verticalGridHeaderLines)&&d(),n.width>=1&&(typeof s.allowUserToResizeColumns===t||s.allowUserToResizeColumns)&&(typeof n.allowUserToResize===t||n.allowUserToResize)){var u=s.splitterWidth;o.addEventListener("mouseover",function(f){!DlhSoft.Controls.GanttChartView.isGripperDragging&&!(o.isGripperDragging||typeof f.offsetX===t&&f.currentTarget!=o)&&d((typeof f.offsetX!==t?f.offsetX:f.layerX-f.currentTarget.offsetLeft)>=n.width-u)},!0),o.addEventListener("mousemove",function(f){!DlhSoft.Controls.GanttChartView.isGripperDragging&&!(o.isGripperDragging||typeof f.offsetX===t&&f.currentTarget!=o)&&d((typeof f.offsetX!==t?f.offsetX:f.layerX-f.currentTarget.offsetLeft)>=n.width-u)},!0),l.addEventListener("mouseover",function(f){!DlhSoft.Controls.GanttChartView.isGripperDragging&&!o.isGripperDragging&&typeof f.offsetX===t&&f.currentTarget==l&&d(f.layerX-f.currentTarget.offsetLeft>=n.width-u)},!1),l.addEventListener("mousemove",se(r,l,"mousemove",function(f){!DlhSoft.Controls.GanttChartView.isGripperDragging&&!o.isGripperDragging&&typeof f.offsetX===t&&f.currentTarget==l&&d(f.layerX-f.currentTarget.offsetLeft>=n.width-u)})),o.addEventListener("mousedown",se(r,o,"mousedown",function(f){0!=f.button||!o.isGripperVisible||DlhSoft.Controls.GanttChartView.isGripperDragging||(DlhSoft.Controls.GanttChartView.isGripperDragging=!0,o.isGripperDragging=!0,o.initialGripperDraggingX=f.clientX,o.initialColumnWidth=n.width)},!0),!0),e.addEventListener("mousemove",se(r,e,"mousemove",function(f){o.isGripperDragging&&(n.width=Math.max(n.minWidth,o.initialColumnWidth+(f.clientX-o.initialGripperDraggingX)),typeof n.maxWidth!==t&&n.width>n.maxWidth&&(n.width=n.maxWidth),l.style.width=n.width-1+"px",typeof s.columnWidthChangeHandler!==t&&setTimeout(function(){s.columnWidthChangeHandler(n,n.width)},0),r.isWaitingToRefreshColumns||(r.isWaitingToRefreshColumns=!0,setTimeout(function(){var v=ft(s.columns);r.gridHeader.style.width=v+"px",r.gridContent.style.width=v+"px",delete r.isWaitingToRefreshColumns,r.refreshGridItems()},0)))},!0),!0),e.addEventListener("mouseup",se(r,e,"mouseup",function(){o.isGripperDragging&&(delete o.isGripperDragging,delete o.initialGripperDraggingX,delete o.initialColumnWidth,d(!1),delete DlhSoft.Controls.GanttChartView.isGripperDragging)},!0),!0),o.addEventListener("mouseout",se(r,o,"mouseout",function(){o.isGripperDragging||d(!1)}))}}return o},B=function(e,n){for(var s=-1,r=null,o=null,l=[],m=0;m<e.length;m++){var d=e[m];if(typeof d.scheduleChartItem===t&&(typeof d.isSelected===t&&(d.isSelected=!1),d.isSelected&&(null==o&&(o=d),l.push(d)),typeof d.indentation===t&&(d.indentation=0),0==m&&0!=d.indentation&&(d.indentation=0,le(d,"indentation",!1,!0)),typeof d.isExpanded===t&&(d.isExpanded=!0),null!=r)){var u=r.indentation+1;d.indentation>u&&(d.indentation=u,le(d,"indentation",!1,!0)),r.hasChildren=d.indentation>r.indentation,r.hasChildren&&typeof r.isMilestone!==t&&r.isMilestone&&(r.isMilestone=!1,le(r,"isMilestone",!1,!0))}d.isVisible=s<0||d.indentation<=s,typeof d.scheduleChartItem===t&&(d.isVisible&&!d.isExpanded&&(s=d.indentation),d.isExpanded&&d.indentation==s&&(s=-1),r=d)}null!=r&&(r.hasChildren=!1),n.selectedItem=o,n.selectedItems=l},O=function(e,n,s){s.isTimingInformationInitialized=!1,s.isBasicTimingInformationInitialized=!1;var l,m,d,r=S(n.currentTime),o=[];for(m=0;m<e.length;m++){(l=e[m]).index=m;var u=null;for(o.length>0&&(u=o[o.length-1]);null!=u&&l.indentation<=u.indentation;)o.pop(),u=o[o.length-1];if(l.parent=u,l.children=[],u?.children.push(l),!l.hasChildren||typeof l.isSummaryEnabled!==t&&!l.isSummaryEnabled){d=l.start;var p=l.finish,f=l.completedFinish;typeof l.start===t&&(l.start=r,l.preferredStart=l.start),typeof l.finish===t&&(l.finish=typeof l.isMilestone!==t&&l.isMilestone?l.start:Q(r)),typeof l.isSetAsCompleted===t&&(l.isSetAsCompleted=typeof l.completedFinish!==t&&l.completedFinish.valueOf()==l.finish.valueOf()),typeof l.completedFinish===t&&(l.completedFinish=l.start),typeof l.isRelativeToTimezone===t||l.isRelativeToTimezone?(l.start=new Date(l.start.valueOf()-6e4*l.start.getTimezoneOffset()),l.preferredStart=l.start,l.finish=new Date(l.finish.valueOf()-6e4*l.finish.getTimezoneOffset()),l.completedFinish="number"==typeof l.completedFinish?$e(l.start,l.completedFinish*Ne(l.start,l.finish,n,ce(l)),n,ce(l)):new Date(l.completedFinish.valueOf()-6e4*l.completedFinish.getTimezoneOffset()),typeof l.baselineStart!==t&&(l.baselineStart=new Date(l.baselineStart.valueOf()-6e4*l.baselineStart.getTimezoneOffset())),typeof l.baselineFinish!==t&&(l.baselineFinish=new Date(l.baselineFinish.valueOf()-6e4*l.baselineFinish.getTimezoneOffset())),typeof l.minStart!==t&&(l.minStart=new Date(l.minStart.valueOf()-6e4*l.minStart.getTimezoneOffset())),typeof l.maxStart!==t&&(l.maxStart=new Date(l.maxStart.valueOf()-6e4*l.maxStart.getTimezoneOffset())),typeof l.minFinish!==t&&(l.minFinish=new Date(l.minFinish.valueOf()-6e4*l.minFinish.getTimezoneOffset())),typeof l.maxFinish!==t&&(l.maxFinish=new Date(l.maxFinish.valueOf()-6e4*l.maxFinish.getTimezoneOffset())),l.isRelativeToTimezone=!1):"number"==typeof l.completedFinish&&(l.completedFinish=$e(l.start,l.completedFinish*Ne(l.start,l.finish,n,ce(l)),n,ce(l))),typeof l.minStart!==t&&l.start<l.minStart?l.start=l.minStart:typeof l.maxStart!==t&&l.start>l.maxStart&&(l.start=l.maxStart),typeof l.maxFinish!==t&&l.finish>l.maxFinish?l.finish=l.maxFinish:typeof l.minFinish!==t&&l.finish<l.minFinish&&(l.finish=l.minFinish),l.finish<l.start&&(l.finish=l.start),l.completedFinish<l.start?l.completedFinish=l.start:l.completedFinish>l.finish&&(l.completedFinish=l.finish),typeof l.loadChartItem===t&&(l.start=_e(l.start,n,!0,typeof l.isMilestone!==t&&l.isMilestone,ce(l))),typeof l.dependsOf!==t&&delete l.dependsOf,l.preferredStart=l.start,typeof l.loadChartItem===t&&(l.finish=_e(l.finish,n,typeof l.isMilestone!==t&&l.isMilestone,!0,ce(l)),l.completedFinish=_e(l.completedFinish,n,typeof l.isMilestone!==t&&l.isMilestone,!0,ce(l))),l.finish<l.start&&(l.finish=l.start),l.completedFinish<l.start&&(l.completedFinish=l.start),l.completedFinish>l.finish&&(l.completedFinish=l.finish),(typeof d===t||l.start.valueOf()!=d.valueOf())&&le(l,"start",!1,!0),(typeof p===t||l.finish.valueOf()!=p.valueOf())&&le(l,"finish",!1,!0),(typeof f===t||l.completedFinish.valueOf()!=f.valueOf())&&le(l,"completedFinish",!1,!0)}for(d=0;d<o.length;d++)(typeof(p=o[d]).isSummaryEnabled===t||p.isSummaryEnabled)&&((typeof p.start===t||p.start>l.start)&&(p.start=l.start,le(p,"start",!1,!0)),(typeof p.finish===t||p.finish<l.finish)&&(p.finish=l.finish,le(p,"finish",!1,!0)),(typeof p.completedFinish===t||p.completedFinish.valueOf()!=p.start.valueOf())&&(p.completedFinish=p.start,le(p,"completedFinish",!1,!0)));(null==u||l.indentation>u.indentation)&&o.push(l)}for(s.isBasicTimingInformationInitialized=!0,m=e.length;m-- >0;)(l=e[m]).hasChildren&&(typeof l.isSummaryEnabled===t||l.isSummaryEnabled)&&c(l);if(n.areTaskDependencyConstraintsEnabled)for(m=0;m<e.length;m++)typeof(l=e[m]).predecessors!==t&&null!=l.predecessors&&l.predecessors.length>0&&Ft(l,e,n,s);else if(n.alwaysHandleInvalidDependencies)for(m=0;m<e.length;m++)typeof(l=e[m]).predecessors!==t&&null!=l.predecessors&&l.predecessors.length>0&&Ft(l,e,n,s,!0);for(m=0;m<e.length;m++)!(l=e[m]).hasChildren&&l.hasFixedEffort&&(l.fixedEffort=gt(l,n),l.fixedEffortAssignments=Ct(l));s.isTimingInformationInitialized=!0},c=function(e,n){if(!(e.children.length<=0||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)){typeof n===t&&(n=!0);var s=e.start,r=e.finish,o=e.completedFinish;delete e.start,delete e.finish,delete e.completedFinish;for(var l=0;l<=1;l++){for(var m=0;m<e.children.length;m++){var d=e.children[m];typeof d.isParentSummarizationEnabled!==t&&!d.isParentSummarizationEnabled&&l<1||((typeof e.start===t||e.start>d.start)&&(e.start=d.start),(typeof e.finish===t||e.finish<d.finish)&&(e.finish=d.finish))}if(typeof e.start!==t&&typeof e.finish!==t)break}e.completedFinish=e.start,(typeof s===t||e.start.valueOf()!=s.valueOf())&&le(e,"start",!1,n),(typeof r===t||e.finish.valueOf()!=r.valueOf())&&le(e,"finish",!1,n),(typeof o===t||e.completedFinish.valueOf()!=o.valueOf())&&le(e,"completedFinish",!1,n)}},w=function(e,n){return e==n||C(e,n)||C(n,e)},C=function(e,n){var s=e.parent;return null!=s&&(!(typeof s.isSummaryEnabled!==t&&!s.isSummaryEnabled||s!=n)||C(s,n))},b=function(e,n){if(typeof e.predecessors===t)return!1;for(var s=0;s<e.predecessors.length;s++)if(e.predecessors[s].item==n)return!0;return!1},S=function(e){return new Date(864e5*Math.floor(e.valueOf()/864e5))},L=function(e){return e.valueOf()-S(e).valueOf()},M=function(e){return(e=Math.floor((e.valueOf()-2592e5)/864e5)%7)<0&&(e+=7),e},U=function(e,n){return S(e),new Date(6048e5*Math.floor((e.valueOf()-2592e5)/6048e5)+2592e5+864e5*n)},J=function(e,n){var s=U(e,n);return Math.abs(s.valueOf()-e.valueOf())<=36e5?s:new Date(s.valueOf()+6048e5)},$=function(e){return e.hourWidth*(e.visibleDayFinish-e.visibleDayStart)/36e5},q=function(e,n){var o=$(n),s=$(n)*(n.visibleWeekFinish-n.visibleWeekStart+1),r=U(e,n.weekStartDay);return r=Math.floor((r-n.timelineStart)/6048e5)*s-Math.max(0,n.weekStartDay-n.visibleWeekStart)*o,r=(s=M(e))<=n.visibleWeekStart?r+0:s>n.visibleWeekFinish?r+(n.visibleWeekFinish-n.visibleWeekStart+1)*o:r+(s-n.visibleWeekStart)*o,o=L(e),s>=n.visibleWeekStart&&s<=n.visibleWeekFinish&&(r=o<=n.visibleDayStart?r+0:o>=n.visibleDayFinish?r+(n.visibleDayFinish-n.visibleDayStart)/36e5*n.hourWidth:r+(o-n.visibleDayStart)/36e5*n.hourWidth),r},te=function(e,n){for(var s=n.timelineStart.valueOf(),r=$(n),o=$(n)*(n.visibleWeekFinish-n.visibleWeekStart+1);e>o;)s+=6048e5,e-=o;for(s+=864e5*Math.max(0,n.visibleWeekStart-n.weekStartDay);e>r;)s+=864e5,e-=r;return s+=n.visibleDayStart,s+=e/n.hourWidth*36e5,new Date(s)},G=function(e){switch(e.theme){default:return[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 2.25px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 2.25px"},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: #8bbf8a; stroke-width: 0.5px"}];case"ModernBordered":return[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 2.25px; border-right: solid 1px White; border-bottom: solid 1px White",isSeparatorVisible:!0,separatorStyle:"stroke: #c8bfe7; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 2.25px; border-right: solid 1px White"},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: #8bbf8a; stroke-width: 1px"}];case"Aero":return[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 2.25px; border-right: solid 1px #c8bfe7; border-bottom: solid 1px #c8bfe7",isSeparatorVisible:!0,separatorStyle:"stroke: #c8bfe7; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 2.25px; border-right: solid 1px #c8bfe7"},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: Black; stroke-width: 1px"}]}},K=function(e,n){return new Date(Math.floor((e-2592e5).valueOf()/n.updateScale)*n.updateScale+2592e5)},ie=function(e,n,s,r,o){typeof o===t&&(o=!1);var d,u,l=e.ownerDocument,m=0;for(d=0;d<s.length;d++)(typeof(u=s[d]).isHeaderVisible===t||u.isHeaderVisible)&&m++;var p=r.headerHeight;for(m>0&&(p=r.headerHeight/m),d=0;d<s.length;d++)if(u=s[d],(!o||"CurrentTime"==u.scaleType||"FutureTime"==u.scaleType)&&typeof(m=ge(u,r))!==t){0==m.length&&m.push({start:r.timelineStart,finish:r.timelineFinish});var f=p;typeof u.headerHeight!==t&&(f=u.headerHeight);for(var v=r.timelineStart,g=0;g<m.length;g++){var I=m[g],A=I.start,V=I.finish;"CurrentTime"!=u.scaleType&&"FutureTime"!=u.scaleType&&"NonworkingTime"!=u.scaleType&&(A>v&&(typeof u.isHeaderVisible===t||u.isHeaderVisible)&&(A=v),A<v&&(A=v),A<r.timelineStart&&(A=r.timelineStart),V>r.timelineFinish&&(V=r.timelineFinish),V<A&&(V=A),g==m.length-1&&V<r.timelineFinish&&(typeof u.isHeaderVisible===t||u.isHeaderVisible)&&(V=r.timelineFinish),v=V);var W=q(A,r),R=q(V,r),j=R-W;if(!(j<=0)){if(typeof u.isHeaderVisible===t||u.isHeaderVisible){var z=Tn(u,I,r),Y=l.createElement("div");Y.setAttribute("style","float: left; overflow: hidden; width: "+j+"px; height: "+f+"px");var _=l.createElement("div");_.setAttribute("class",u.headerClass),_.setAttribute("style",u.headerStyle),_.appendChild(H(l,z)),Y.appendChild(_),e.appendChild(Y)}I.start=A,I.finish=V,I=!1,typeof u.isHighlightingVisible!==t&&(I=u.isHighlightingVisible),I&&((I=l.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",W-1),I.setAttribute("y",0),I.setAttribute("width",j),I.setAttribute("height",0),I.setAttribute("class",u.highlightingClass),I.setAttribute("style",u.highlightingStyle),I.tag="Scale-Highlighting"+("CurrentTime"!=u.scaleType&&"FutureTime"!=u.scaleType?"":"-CurrentTime"),n.appendChild(I)),W=!1,typeof u.isSeparatorVisible!==t&&(W=u.isSeparatorVisible),W&&((W=l.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",R-.75),W.setAttribute("y1",0),W.setAttribute("x2",R-.75),W.setAttribute("y2",0),W.setAttribute("class",u.separatorClass),W.setAttribute("style",u.separatorStyle),W.tag="Scale-Separator"+("CurrentTime"!=u.scaleType&&"FutureTime"!=u.scaleType?"":"-CurrentTime"),n.appendChild(W))}}}},ge=function(e,n){var r,o,s="Custom";switch(typeof e.scaleType!==t&&(s=e.scaleType),s){case"CurrentTime":return[{start:n.timelineStart,finish:n.currentTime}];case"FutureTime":return[{start:n.currentTime,finish:n.timelineFinish}];case"Years":s=[],o=(r=new Date(n.timelineStart.valueOf())).getTimezoneOffset(),r.setMonth(0,1);var l=r.getTimezoneOffset();for(r=new Date(r.valueOf()-6e4*(l-o)-(l>0?864e5:0));o=Ye(r),r<n.timelineFinish;r=o)s.push({start:r,finish:o});return s;case"Months":for(s=[],o=(r=new Date(n.timelineStart.valueOf())).getTimezoneOffset(),r.setDate(1),l=r.getTimezoneOffset(),r=new Date(r.valueOf()-6e4*(l-o)-(l>0?864e5:0));o=Ze(r),r<n.timelineFinish;r=o)s.push({start:r,finish:o});return s;case"Weeks":for(s=[],r=n.timelineStart,o=n.weekStartDay,l=n.visibleWeekStart;M(r)!=o;)r=we(r);for(;M(r)<l;)r=Q(r);for(r=new Date(r.valueOf());o=Xe(r),r<n.timelineFinish;r=o)s.push({start:r,finish:o});return s;case"Days":for(s=[],r=n.timelineStart;o=Q(r),r<n.timelineFinish;r=o)s.push({start:r,finish:o});return s;case"Hours":for(s=[],r=new Date(S(n.timelineStart).valueOf()+n.visibleDayStart);o=Z(new Date(r.valueOf()+36e5),n.visibleDayFinish,n.visibleDayStart),r<n.timelineFinish;r=o)s.push({start:r,finish:o});return s;case"NonworkingTime":for(s=[],r=wt(n.timelineStart,n.workingWeekFinish),o=ui(r,n.workingWeekStart);r<n.timelineFinish;r=Xe(r),o=Xe(o))s.push({start:r,finish:o});if(typeof n.specialNonworkingDays!==t)if("function"==typeof n.specialNonworkingDays)for(r=wt(n.timelineStart,n.workingWeekFinish),o=Q(r);r<n.timelineFinish;r=Q(r),o=Q(o))n.specialNonworkingDays(r)&&s.push({start:r,finish:o});else for(l=0;l<n.specialNonworkingDays.length;l++)o=Q(r=n.specialNonworkingDays[l]),s.push({start:r,finish:o});return s;default:return e.intervals}},Z=function(e,n,s){return L(e)>n?(e=Q(e),new Date(S(e).valueOf()+s)):new Date(e.valueOf())},Q=function(e){return new Date(e.valueOf()+864e5)},we=function(e){return new Date(e.valueOf()-864e5)},Xe=function(e){return new Date(e.valueOf()+6048e5)},Ze=function(s){var n=s.getTimezoneOffset(),r=(s=new Date(s.valueOf()+(n>0?864e5:0))).getMonth()+1;return r>=12&&(r=0,s.setFullYear(s.getFullYear()+1)),s.setMonth(r,1),r=s.getTimezoneOffset(),new Date(s.valueOf()-6e4*(r-n)-(r>0?864e5:0))},Ye=function(s){var n=s.getTimezoneOffset();(s=new Date(s.valueOf()+(n>0?864e5:0))).setFullYear(s.getFullYear()+1),s.setMonth(0,1);var r=s.getTimezoneOffset();return new Date(s.valueOf()-6e4*(r-n)-(r>0?864e5:0))},Xt=function(e,n){if(typeof n===t)return!1;if("function"==typeof n)return n(e);for(var s=e.valueOf(),r=0;r<n.length;r++)if(n[r].valueOf()==s)return!0;return!1},wt=function(e,n){for(;M(e)!=n;)e=we(e);return Q(e)},ui=function(e,n){for(;M(e)!=n;)e=Q(e);return new Date(e.valueOf())},Tn=function(e,n,s){var r="Date";if(typeof e.headerTextFormat!==t&&(r=e.headerTextFormat),(e=n.start)<s.timelineStart&&(e=s.timelineStart),"function"==typeof r)return r(e);switch(r){case"Localized":return e.toLocaleString();case"DateTime":return s.dateTimeFormatter(h(e));case"Date":return s.dateFormatter(h(e));case"Hour":return((e=new Date(e.valueOf()+6e4*e.getTimezoneOffset())).getHours()<10?"0":"")+e.getHours();case"DayOfWeek":return s.daysOfWeek[M(e)];case"DayOfWeekAbbreviation":return(n=s.daysOfWeek[M(e)]).length>0?n[0].toUpperCase():"";case"Day":return((e=new Date(e.valueOf()+6e4*e.getTimezoneOffset())).getDate()<10?"0":"")+e.getDate();case"Month":return s.months[new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getMonth()];case"MonthAbbreviation":return(n=s.months[new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getMonth()]).length<=0?"":n[0].toUpperCase()+(n.length>1?n.substr(1,Math.min(3,n.length)-1):"");case"Year":return new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getFullYear();case"MonthYear":return s.months[new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getMonth()]+" "+new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getFullYear();default:return typeof n.headerText!==t?n.headerText:e.toString()}},Sn=function(e,n,s){for(var r=0,o=0;o<n.length;o++){var l=n[o],m=r;typeof l.displayRowIndex!==t&&(m=l.displayRowIndex*s.itemHeight),e.appendChild(Ri(l,m,s)),l.isVisible&&(typeof l.isHidden===t||!l.isHidden)&&(r=Math.max(r,m+s.itemHeight))}},Dn=function(e,n,s,r,o,l,m,d){for(var u=0,p=0;p<r.length;p++){var f=r[p];m.isGridVisible&&typeof f.displayRowIndex===t&&e.appendChild(Ai(f,r,o,n,l,m,d));var v=u;typeof f.displayRowIndex!==t&&(v=f.displayRowIndex*m.itemHeight),s.appendChild(pi(f,v,m)),f.isVisible&&!(typeof f.isHidden!==t&&f.isHidden)&&(u=Math.max(u,v+m.itemHeight)),f.itemTop=v}Ht(n,u),setTimeout(function(){Yt(r,n,m)},0)},Et=function(e,n){for(var s=0,r=0,o=-1,l=0;l<e.length;l++){var m=e[l];(typeof m.scheduleChartItem===t||m.scheduleChartItem==m)&&m.isVisible&&(typeof m.isHidden===t||!m.isHidden)&&(typeof m.displayRowIndex===t&&r>o?(s+=n.itemHeight,o=r++):(s=Math.max(s,m.itemTop+n.itemHeight),o=m.displayRowIndex))}return s},Vt=function(e,n,s){if(e.isPart)return Vt(e.ganttChartItem,n,s);var r;if(typeof e.displayRowIndex!==t)return e.itemTop=e.displayRowIndex*s.itemHeight;for(var o=r=0;o<n.length;o++){var l=n[o];if(l==e)break;l.isVisible&&(typeof l.isHidden===t||!l.isHidden)&&typeof l.displayRowIndex===t&&(r+=s.itemHeight)}return e.itemTop=r},Yt=function(e,n,s){if(typeof s.alternativeItemClass!==t||typeof s.alternativeItemStyle!==t||typeof s.alternativeChartItemClass!==t||typeof s.alternativeChartItemStyle!==t){for(var r=n.chartAreaAlternativeRows;r.childNodes.length>0;)r.removeChild(r.childNodes[0]);var o,l=0,m=!1;for(r.count=l,o=0;o<e.length;o++){var d=e[o];if(d.isVisible&&typeof d.alternativeContentContainer!==t){var u=d.alternativeContentContainer;l%2==1?(typeof s.alternativeItemClass!==t&&u.setAttribute("class",s.alternativeItemClass),typeof s.alternativeItemStyle!==t&&u.setAttribute("style",s.alternativeItemStyle),(typeof s.alternativeChartItemClass!==t||typeof s.alternativeChartItemStyle!==t)&&(!s.isVirtualizing||d.isVirtuallyVisible||!m)&&(m=!0,(typeof r.count===t||l>r.count)&&((d=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",0),d.setAttribute("y",l*s.itemHeight),d.setAttribute("width",n.clientWidth),d.setAttribute("height",s.itemHeight),typeof s.alternativeChartItemClass!==t&&d.setAttribute("class",s.alternativeChartItemClass),typeof s.alternativeChartItemStyle!==t&&d.setAttribute("style",s.alternativeChartItemStyle),d.index=l,r.appendChild(d))),r.count=l):(u.setAttribute("class",""),u.setAttribute("style","")),l++}}for(o=r.childNodes.length;o-- >0;)(e=r.childNodes[o]).index>r.count&&r.removeChild(e)}},Ai=function(e,n,s,r,o,l,m){var d=e.ganttChartView.ownerDocument,u=d.createElement("div");typeof l.itemClass!==t&&u.setAttribute("class",l.itemClass),typeof l.itemStyle!==t&&u.setAttribute("style",l.itemStyle),u.style.display=e.isVisible?"block":"none";var p=d.createElement("div");e.alternativeContentContainer=p;var f=d.createElement("div");try{f.addEventListener("mousedown",se(m,f,"mousedown",function(A){A.target!=e.selectionInput&&ee(e,l)})),f.addEventListener("mouseup",se(m,f,"mouseup",function(A){A.target!=e.selectionInput&&ee(e,l)}))}catch{}e.isSelected&&(typeof l.selectedItemClass!==t&&f.setAttribute("class",l.selectedItemClass),typeof l.selectedItemStyle!==t&&f.setAttribute("style",l.selectedItemStyle));var v=d.createElement("div");typeof e.class!==t&&v.setAttribute("class",e.class),typeof e.style!==t&&v.setAttribute("style",e.style);var g=d.createElement("div");e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)?(typeof l.summaryItemClass!==t&&g.setAttribute("class",l.summaryItemClass),typeof l.summaryItemStyle!==t&&g.setAttribute("style",l.summaryItemStyle)):e.isMilestone?(typeof l.milestoneItemClass!==t&&g.setAttribute("class",l.milestoneItemClass),typeof l.milestoneItemStyle!==t&&g.setAttribute("style",l.milestoneItemStyle)):(typeof l.standardItemClass!==t&&g.setAttribute("class",l.standardItemClass),typeof l.standardItemStyle!==t&&g.setAttribute("style",l.standardItemStyle)),d=d.createElement("div"),e.gridItem=d,e.gridItemContent=g,e.gridItemSelectionContainer=f;var I=l.itemHeight;return(!e.isVisible||typeof e.isHidden!==t&&e.isHidden)&&(I=0),d.setAttribute("style","overflow: hidden; height: "+I+"px"),At(d,e,n,s,r,o,l),g.appendChild(d),v.appendChild(g),f.appendChild(v),p.appendChild(f),u.appendChild(p),e.gridItemContainer=u,(typeof l.isGridRowClickTimeScrollingEnabled===t||l.isGridRowClickTimeScrollingEnabled)&&u.addEventListener("mouseup",se(m,u,"mouseup",function(){var A;if(typeof e.ganttChartItems===t)A=e.start;else{A=null;for(var V=0;V<e.ganttChartItems.length;V++)(null==A||e.ganttChartItems[V].start<A)&&(A=e.ganttChartItems[V].start);A=A??e.start}(A=q(A,l))-(V=A-8*l.hourWidth)>=r.container.clientWidth/2.5&&(V=A),r.container.scrollLeft=Math.max(0,V)},!0),!0),u},At=function(e,n,s,r,o,l,m){var d=n.ganttChartView.ownerDocument;if(!m.isVirtualizing||typeof n.isVirtuallyVisible!==t&&n.isVirtuallyVisible){var u=function(){if(typeof n.gridItemSelectionContainer!==t){var p=n.gridItemSelectionContainer;typeof m.selectedItemClass!==t&&p.setAttribute("class",n.isSelected?m.selectedItemClass:null),typeof m.selectedItemStyle!==t&&p.setAttribute("style",n.isSelected?m.selectedItemStyle:null)}typeof n.gridItemContent!==t&&((p=n.gridItemContent).setAttribute("class",""),p.setAttribute("style",""),n.hasChildren&&(typeof n.isSummaryEnabled===t||n.isSummaryEnabled)?(typeof m.summaryItemClass!==t&&p.setAttribute("class",m.summaryItemClass),typeof m.summaryItemStyle!==t&&p.setAttribute("style",m.summaryItemStyle)):n.isMilestone?(typeof m.milestoneItemClass!==t&&p.setAttribute("class",m.milestoneItemClass),typeof m.milestoneItemStyle!==t&&p.setAttribute("style",m.milestoneItemStyle)):(typeof m.standardItemClass!==t&&p.setAttribute("class",m.standardItemClass),typeof m.standardItemStyle!==t&&p.setAttribute("style",m.standardItemStyle))),p=[];var f=null;try{f=d.activeElement}catch{}for(;null!=f&&f!=n.gridItem;)p.push(f),f=f.parentNode;var v=-1;for(f=e.childNodes.length;f-- >0;)if(p.indexOf(e.childNodes[f])>=0){v=f;break}for(f=e.childNodes.length;f-- >0;)e.removeChild(e.childNodes[f]);for(f=0;f<r.length;f++)e.appendChild(Hi(n,s,r[f],o,l,m));typeof n.ganttChartView.draggingItem===t&&v>=0&&setTimeout(function(){try{for(var g=e.childNodes[v];"input"!=g.nodeName&&"textarea"!=g.nodeName&&"label"!=g.nodeName&&"select"!=g.nodeName&&"button"!=g.nodeName&&g.childNodes.length>0;)g=g.childNodes[0];g&&g.dontAutoFocus?delete g.dontAutoFocus:setTimeout(function(){try{g.focus()}catch{}},0)}catch{}},0)};n.wasGridItemContentLoaded?setTimeout(u,0):(u(),n.wasGridItemContentLoaded=!0)}},Ut=function(e){typeof e.isWaitingToRefreshGridItem===t&&(e.isWaitingToRefreshGridItem=!0,setTimeout(function(){typeof e.gridItem!==t&&At(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings),delete e.isWaitingToRefreshGridItem},0))},Li=function(e){typeof e.gridItem!==t&&function(e,n,s,r,o,l,m){var d=n.ganttChartView.ownerDocument;(!m.isVirtualizing||typeof n.isVirtuallyVisible!==t&&n.isVirtuallyVisible)&&setTimeout(function(){if(typeof n.gridItemSelectionContainer!==t){var u=n.gridItemSelectionContainer;typeof m.selectedItemClass!==t&&u.setAttribute("class",n.isSelected?m.selectedItemClass:null),typeof m.selectedItemStyle!==t&&u.setAttribute("style",n.isSelected?m.selectedItemStyle:null)}u=[];var p=null;try{p=d.activeElement}catch{}for(;null!=p&&p!=n.gridItem;)u.push(p),p=p.parentNode;var f=-1;for(p=e.childNodes.length;p-- >0;)if(e.childNodes[p].isSelection&&u.indexOf(e.childNodes[p])>=0){f=p;break}for(p=e.childNodes.length;p-- >0;)e.childNodes[p].isSelection&&e.removeChild(e.childNodes[p]);for(p=0;p<r.length;p++)r[p].isSelection&&p<e.childNodes.length&&e.insertBefore(Hi(n,s,r[p],o,l,m),e.childNodes[p]);typeof n.ganttChartView.draggingItem===t&&f>=0&&setTimeout(function(){try{for(var v=e.childNodes[f];"input"!=v.nodeName&&"textarea"!=v.nodeName&&"label"!=v.nodeName&&"select"!=v.nodeName&&"button"!=v.nodeName&&v.childNodes.length>0;)v=v.childNodes[0];v&&v.dontAutoFocus?delete v.dontAutoFocus:setTimeout(function(){try{v.focus()}catch{}},0)}catch{}},0)},0)}(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings)},Hi=function(e,n,s,r,o,l){var m=e.ganttChartView.ownerDocument,d=m.createElement("div"),u=0;1==s.isTreeView&&(u=l.indentationLevelWidth*e.indentation),d.setAttribute("style","overflow: hidden; vertical-align: middle; display: table-cell; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 0px; padding: 0px; width: "+s.width+"px; height: "+l.itemHeight+"px; padding-left: "+u+"px");var p=m.createElement("div");typeof s.cellClass!==t?p.setAttribute("class",s.cellClass):typeof l.cellClass!==t&&p.setAttribute("class",l.cellClass),typeof s.cellStyle!==t?p.setAttribute("style",s.cellStyle):typeof l.cellStyle!==t&&p.setAttribute("style",l.cellStyle);var f=m.createElement("div");return f.setAttribute("style","white-space: nowrap; overflow: hidden; margin: 0px; padding: 0px; width: "+(s.width-u-16)+"px"),1==s.isTreeView&&((u=m.createElement("div")).setAttribute("style","display: inline-block; width: "+o+"px"),e.hasChildren&&((o=m.createElement("div")).setAttribute("style","cursor: default; padding-left: 1px; font-size: 12px; display: inline-block"),m=l.collapsedToggleButtonTemplate,e.isExpanded&&(m=l.expandedToggleButtonTemplate),m=m(),o.appendChild(m),Pi(o,e,n,m,r,null,null,l),u.appendChild(o)),f.appendChild(u)),e=s.cellTemplate(e),f.appendChild(e),p.appendChild(f),d.appendChild(p),d.isSelection=s.isSelection,d},Fi=function(e,n){return function(){var s=e.ownerDocument.createElementNS("http://www.w3.org/2000/svg","polygon");return s.setAttribute("points","3.5,2.5 3.5,11.5 10.5,6.5"),F(s,n)}},Oi=function(e,n){return function(){var s=e.ownerDocument.createElementNS("http://www.w3.org/2000/svg","polygon");return s.setAttribute("points","2.5,3.5 11.5,3.5 6.5,10.5"),F(s,n)}},Pi=function(e,n,s,r,o,l,m,d){(typeof l===t||null==l)&&(l=r.querySelector("#PART_Button")),null!=l&&Mi(l,l,d,n.ganttChartView),(typeof m===t||null==m)&&(m=r.querySelector("#PART_Border")),null!=m&&Mi(m,l,d,n.ganttChartView),s={toggleButton:e,item:n,items:s,content:r,chartContent:o,settings:d},null!=l&&(l.tag=s,(typeof d.isExport===t||!d.isExport)&&l.addEventListener("mouseup",se(n.ganttChartView,l,"mouseup",fi,!0),!0)),null!=m&&(m.tag=s,(typeof d.isExport===t||!d.isExport)&&m.addEventListener("mouseup",se(n.ganttChartView,m,"mouseup",fi,!0),!0)),e.tag=s,null==l&&null==m&&(typeof d.isExport===t||!d.isExport)&&e.addEventListener("mouseup",se(n.ganttChartView,e,"mouseup",fi,!0),!0),r.addEventListener("keypress",se(n.ganttChartView,r,"keypress",function(u){32==u.keyCode&&(u.preventDefault(),u.stopPropagation(),vt(n,!n.isExpanded,!0))},!0),!0),n.toggleButton=e},Mi=function(e,n,s,r){typeof s.isExport!==t&&s.isExport||(e.addEventListener("mouseover",se(r,e,"mouseover",function(){typeof s.toggleButtonHoveringClass!==t&&n.setAttribute("class",s.toggleButtonHoveringClass),typeof s.toggleButtonHoveringStyle!==t&&n.setAttribute("style",s.toggleButtonHoveringStyle)},!0),!0),e.addEventListener("mouseout",se(r,e,"mouseout",function(){n.setAttribute("class",s.toggleButtonClass),n.setAttribute("style",s.toggleButtonStyle)},!0),!0))},fi=function(e){e.stopPropagation(),vt(e=e.target.tag.item,!e.isExpanded,!0)},vt=function(e,n,s,r){e.isExpanded!=n&&(e.isExpanded=n,(typeof r===t||r)&&le(e,"isExpanded",s,!0),Bi(e))},Bi=function(e,n){if(typeof e.toggleButton===t)(typeof n===t||n)&&setTimeout(function(){Bi(e,!1)},0);else{var s=e.toggleButton,r=(u=s.tag).settings,o=r.expandedToggleButtonTemplate,l=r.collapsedToggleButtonTemplate;e.isExpanded&&(l=o),l=(o=l()).querySelector("#PART_Button");var m=o.querySelector("#PART_Border");s.replaceChild(o,u.content),u.content=o;var u,d=u.items;if(Pi(s,e,d,o,u=u.chartContent,l,m,r),e.isVisible&&!(typeof e.isHidden!==t&&e.isHidden)&&xn(d,e,u,r),bt(e),Yt(d,u,r),typeof(s=e.scheduleChartView)!==t)for(r=e.scheduleChartIndex;r<s.scheduleChartItems.length;r++)if(typeof(u=s.scheduleChartItems[r]).ganttChartItems!==t)for(o=0;o<u.ganttChartItems.length;o++)(l=u.ganttChartItems[o]).displayRowIndex=u.itemTop/s.settings.itemHeight,s.refreshChartItem(l)}},xn=function(e,n,s,r){var p,f,v,o=-1,l=!1,m=!1,d=!1,u=0,g=[];for(f=0;f<e.length;f++){(v=e[f])==n?(l=v.isExpanded,o=v.indentation):v.indentation<=o&&(d=!0);var I=v.chartItem,A=v.chartPredecessorItems;if(m&&!d){if(v.scheduleChartItem&&v.scheduleChartItem!=v)p=v.scheduleChartItem.isVisible;else if(l){p=!0;for(var V=v.parent;null!=V;){if(!V.isVisible||!V.isExpanded){p=!1;break}V=V.parent}}else p=!1;v.isVisible!=p&&(v.isVisible=l,le(v,"isVisible",!1,!0),p=r.itemHeight,(!v.isVisible||typeof v.isHidden!==t&&v.isHidden)&&(p=0),typeof v.gridItem!==t&&(v.gridItem.style.height=p+"px"),typeof v.gridItemContainer!==t&&(v.gridItemContainer.style.display=p>0?"block":"none"),p="visible",(!v.isVisible||typeof v.isHidden!==t&&v.isHidden)&&(p="hidden"),I.setAttribute("style","visibility: "+p),A.setAttribute("style","visibility: "+p))}if(typeof v.displayRowIndex===t&&(I.setAttribute("transform","translate(0, "+u+")"),A.setAttribute("transform","translate(0, "+u+")"),Lt(v,u)),v==n&&(m=!0),p=r.itemHeight,(!v.isVisible||typeof v.isHidden!==t&&v.isHidden)&&(p=0),v.itemTop!=u&&(v.itemTop=u),typeof v.displayRowIndex===t&&(u+=p),v.predecessors&&v.predecessors.length>0&&g.indexOf(v)<0)for(g.push(v),I=0;I<v.predecessors.length;I++)g.indexOf(A=v.predecessors[I].item)<0&&g.push(A)}if(Ht(s,u),Dt(e,n),r.areTaskDependenciesVisible)for(f=0;f<g.length;f++)Dt(e,g[f]);Pt(e,s.container,r)},Lt=function(e,n){typeof e.parts===t||e.parts.length<=0||setTimeout(function(){for(var s=0;s<e.parts.length;s++){var r=e.parts[s];r.itemTop=n,typeof r.chartItem!==t&&(r.chartItem.setAttribute("transform","translate(0, "+n+")"),r.chartPredecessorItems.setAttribute("transform","translate(0, "+n+")"),r.chartItem.style.visibility=e.chartItem.style.visibility,r.chartPredecessorItems.style.visibility=e.chartItem.style.visibility,typeof r.isInternallyHidden!==t&&(delete r.isInternallyHidden,r.chartItem.style.display="inline"))}},0)},Ht=function(e,n){n<e.availableHeight&&(n=e.availableHeight),e.style.height=n+"px";var s=e.chartArea;s.style.height=n+"px";for(var r=0;r<s.childNodes.length;r++){var o=s.childNodes[r];if(typeof o.tag!==t)switch(o.tag){case"Scale-Highlighting":case"Scale-Highlighting-CurrentTime":o.setAttribute("height",n);break;case"Scale-Separator":case"Scale-Separator-CurrentTime":o.setAttribute("y2",n)}}},Dt=function(e,n){var r,o,l,m,s=[];if(typeof n.successors===t)for(n.successors=[],o=0;o<e.length;o++)if((r=e[o])!=n&&typeof r.predecessors!==t&&0!=r.predecessors.length)for(l=0;l<r.predecessors.length;l++)if(r.predecessors[l].item==n){n.successors.push(r);break}for(o=0;o<n.successors.length;o++){var d=n.successors[o];if(typeof d.predecessors!==t&&d.predecessors.length>0)for(l=0;l<d.predecessors.length;l++){var u=d.predecessors[l].item;if(typeof u!==t){for(r=!0,m=0;m<s;m++)if(u==s[m]){r=!1;break}r&&(mt(u.chartPredecessorItems,u,u.ganttChartView.settings),yt(u.chartItem,u,u.ganttChartView.settings),s.push(u))}}if(typeof d.predecessors!==t&&d.predecessors.length>0){for(r=!0,m=0;m<s;m++)if(typeof d!==t&&d==s[m]){r=!1;break}r&&(mt(d.chartPredecessorItems,d,d.ganttChartView.settings),yt(d.chartItem,d,d.ganttChartView.settings),s.push(d))}}},Ri=function(e,n,s){var r=e.ganttChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");e.chartPredecessorItems=r;var o="visible";return(!e.isVisible||typeof e.isHidden!==t&&e.isHidden)&&(o="hidden"),r.setAttribute("style","visibility: "+o+"; -ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),r.setAttribute("transform","translate(0, "+n+")"),typeof e.isInternallyHidden!==t&&e.isInternallyHidden&&(r.style.display="none"),mt(r,e,s),r},pi=function(e,n,s){var r=e.ganttChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");e.chartItem=r;var o="visible";(!e.isVisible||typeof e.isHidden!==t&&e.isHidden)&&(o="hidden"),r.setAttribute("style","visibility: "+o+"; -ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),r.setAttribute("transform","translate(0, "+n+")"),typeof e.isInternallyHidden!==t&&e.isInternallyHidden&&(r.style.display="none"),Lt(e,n),yt(r,e,s);try{r.addEventListener("mousedown",se(e.ganttChartView,r,"mousedown",function(){ee(e,s)})),r.addEventListener("mouseup",se(e.ganttChartView,r,"mouseup",function(){ee(e,s)})),r.addEventListener("touchstart",se(e.ganttChartView,r,"touchstart",function(){ee(e,s)})),r.addEventListener("touchend",se(e.ganttChartView,r,"touchend",function(){ee(e,s)}))}catch{}return r},mt=function(e,n,s){for(var r=e.childNodes.length;r-- >0;)e.removeChild(e.childNodes[r]);if(n.predecessors)for(r=0;r<n.predecessors.length;r++)kn(r,e,n,n.predecessors[r],s)},kn=function(e,n,s,r,o){if((!o.isVirtualizing||typeof s.isVirtuallyVisible!==t&&s.isVirtuallyVisible)&&(typeof s.isBarVisible===t||s.isBarVisible)&&o.areTaskDependenciesVisible&&!((typeof s.ganttChartView===t||s.ganttChartView.items.indexOf(r.item))<0||!r.item.isVisible||typeof r.item.isHidden!==t&&r.item.isHidden||typeof r.item.isBarVisible!==t&&!r.item.isBarVisible)){var l=o.dependencyLineTemplate(s,r);l.predecessorIndex=e,l.addEventListener("click",se(s.ganttChartView,l,"click",function(m){o.dependencyLineClickHandler&&o.dependencyLineClickHandler(s.predecessors[this.predecessorIndex],s,m)})),l.addEventListener("dblclick",se(s.ganttChartView,l,"dblclick",function(m){o.dependencyLineDoubleClickHandler&&o.dependencyLineDoubleClickHandler(s.predecessors[this.predecessorIndex],s,m)})),typeof o.predecessorItemContextMenuHandler!==t?l.addEventListener("contextmenu",se(s.ganttChartView,l,"contextmenu",function(m){o.predecessorItemContextMenuHandler(m,s.predecessors[this.predecessorIndex],s)})):!o.isReadOnly&&!o.isChartReadOnly&&!o.areTaskPredecessorsReadOnly&&(typeof s.isReadOnly===t||!s.isReadOnly)&&l.addEventListener("contextmenu",se(s.ganttChartView,l,"contextmenu",function(m){if(confirm("Are you sure you want to remove the predecessor?")){for(var d=[],u=0;u<s.predecessors.length;u++)if(u!=this.predecessorIndex){var p=s.predecessors[u];delete p.item.successors,d.push(p)}s.predecessors=d,le(s,"predecessors",!0,!0),mt(s.chartPredecessorItems,s,o),yt(s.chartItem,s,o),Dt(s.ganttChartView.items,s)}m.preventDefault()})),n.appendChild(l),o.isDependencyToolTipVisible&&(!o.useInlineToolTips||!o.useInlineToolTipsForDependencies)&&(e=o.predecessorItemTemplate,typeof r.template!==t&&(e=r.template),l.appendChild(e(s,r)))}},yt=function(e,n,s){for(var r=e.childNodes.length;r-- >0;)e.removeChild(e.childNodes[r]);if((!s.isVirtualizing||typeof n.isVirtuallyVisible!==t&&n.isVirtuallyVisible)&&(typeof n.isBarVisible===t||n.isBarVisible)){if(r=s.standardTaskTemplate,typeof n.standardTaskTemplate!==t&&(r=n.standardTaskTemplate),n.hasChildren&&(typeof n.isSummaryEnabled===t||n.isSummaryEnabled)?(r=s.summaryTaskTemplate,typeof n.summaryTaskTemplate!==t&&(r=n.summaryTaskTemplate)):n.isMilestone&&(r=s.milestoneTaskTemplate,typeof n.milestoneTaskTemplate!==t&&(r=n.milestoneTaskTemplate)),typeof n.taskTemplate!==t&&(r=n.taskTemplate),typeof s.internalPreTaskTemplate!==t){var o=s.internalPreTaskTemplate(n);null!=o&&e.appendChild(o)}(r=r(n)).addEventListener("contextmenu",se(n.ganttChartView,r,"contextmenu",function(l){typeof s.itemContextMenuHandler!==t?s.itemContextMenuHandler(l,n):l.preventDefault()})),e.appendChild(r),typeof s.internalExtraTaskTemplate!==t&&null!=(o=s.internalExtraTaskTemplate(n))&&e.appendChild(o),typeof s.extraTaskTemplate!==t&&null!=(o=s.extraTaskTemplate(n))&&e.appendChild(o),s.areTaskAssignmentsVisible&&(e=s.assignmentsTemplate(n),r.appendChild(e)),s.isTaskToolTipVisible&&!s.useInlineToolTips&&(e=s.itemTemplate,typeof n.template!==t&&(e=n.template),r.appendChild(e(n)))}},Zt=function(e){for(var n=0;n<e.length;n++)Rt(e[n])},bt=function(e){(!e.ganttChartView.settings.isVirtualizing||typeof e.isVirtuallyVisible!==t&&e.isVirtuallyVisible)&&typeof e.isWaitingToRefreshChartItem===t&&(e.isWaitingToRefreshChartItem=!0,setTimeout(function(){mt(e.chartPredecessorItems,e,e.ganttChartView.settings),yt(e.chartItem,e,e.ganttChartView.settings);var n=Vt(e,e.ganttChartView.items,e.ganttChartView.settings);e.chartItem.setAttribute("transform","translate(0, "+n+")"),e.chartPredecessorItems.setAttribute("transform","translate(0, "+n+")"),Lt(e,n),delete e.isWaitingToRefreshChartItem},0))},xt=function(e){(!e.ganttChartView.settings.isVirtualizing||typeof e.isVirtuallyVisible!==t&&e.isVirtuallyVisible)&&(typeof e.isWaitingToRefreshGridItem!==t||typeof e.isWaitingToRefreshChartItem!==t?(typeof e.isWaitingToRefreshGridItem===t&&Ut(e),typeof e.isWaitingToRefreshChartItem===t&&bt(e)):(e.isWaitingToRefreshGridItem=!0,e.isWaitingToRefreshChartItem=!0,setTimeout(function(){typeof e.gridItem!==t&&At(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings),mt(e.chartPredecessorItems,e,e.ganttChartView.settings),yt(e.chartItem,e,e.ganttChartView.settings);var n=Vt(e,e.ganttChartView.items,e.ganttChartView.settings);e.chartItem.setAttribute("transform","translate(0, "+n+")"),e.chartPredecessorItems.setAttribute("transform","translate(0, "+n+")"),Lt(e,n),delete e.isWaitingToRefreshGridItem,delete e.isWaitingToRefreshChartItem},0)))},kt=function(e){(!e.ganttChartView.settings.isVirtualizing||typeof e.isVirtuallyVisible!==t&&e.isVirtuallyVisible)&&typeof e.isWaitingToRefreshPredecessorItems===t&&(e.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){Dt(e.ganttChartView.items,e),delete e.isWaitingToRefreshPredecessorItems},0))},Rt=function(e){(!e.ganttChartView.settings.isVirtualizing||typeof e.isVirtuallyVisible!==t&&e.isVirtuallyVisible)&&(typeof e.isWaitingToRefreshGridItem!==t||typeof e.isWaitingToRefreshChartItem!==t||typeof e.isWaitingToRefreshPredecessorItems!==t?(typeof e.isWaitingToRefreshGridItem===t&&Ut(e),typeof e.isWaitingToRefreshChartItem===t&&bt(e),typeof e.isWaitingToRefreshPredecessorItems===t&&kt(e)):(e.isWaitingToRefreshGridItem=!0,e.isWaitingToRefreshChartItem=!0,e.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){typeof e.gridItem!==t&&At(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings),mt(e.chartPredecessorItems,e,e.ganttChartView.settings),yt(e.chartItem,e,e.ganttChartView.settings);var n=Vt(e,e.ganttChartView.items,e.ganttChartView.settings);e.chartItem.setAttribute("transform","translate(0, "+n+")"),e.chartPredecessorItems.setAttribute("transform","translate(0, "+n+")"),Lt(e,n),Dt(e.ganttChartView.items,e),delete e.isWaitingToRefreshGridItem,delete e.isWaitingToRefreshChartItem,delete e.isWaitingToRefreshPredecessorItems},0)))},st=function(e){for(Rt(e),e=e.parent;null!=e;)c(e),Rt(e),e=e.parent},_t=function(e,n,s,r){Ce(n,r),B(n,s),O(n,r,s),(s=e.index-1)>=0&&st(n[s]),st(e),(s=e.index+1)<n.length&&st(n[s])},ei=function(e,n){var s=n.toggleButtonAreaWidth;return delete n.toggleButtonAreaWidth,ue(e,n),n.toggleButtonAreaWidth!=s},Wi=function(e,n,s,r,o){for(s.initializedItems.push(n),n.ganttChartView=s,n.isVirtuallyVisible=!0;e>0&&r[e-1].isPart;)e--;for(var l=0;l<r.length;l++)if(r[l].parts&&r[l].parts.indexOf(n)>=0){n.isPart=!0,n.ganttChartItem=r[l];break}var u,m=e<r.length?r[e]:null;if(null==m||m.isPart?n.indentation>(m=null!=(m=e>0?r[e-1]:null)?m.indentation+1:0)&&(n.indentation=m):(typeof n.indentation===t||n.indentation<m.indentation-1||n.indentation>m.indentation)&&(n.indentation=m.indentation),Ce([n],o),r.splice(e,0,n),B(r,s),typeof n.parts!==t)for(typeof n.isGroup===t&&(n.isGroup=!0,n.isSummaryEnabled=!1),Ce(n.parts,o),(n.isGroup||typeof n.isBarVisible===t)&&(n.isBarVisible=!1),l=0;l<n.parts.length;l++){var d=n.parts[l];d.ganttChartView=n.ganttChartView,d.ganttChartItem=n,d.isPart=!0,d.isVirtuallyVisible=!0,(n.isGroup||typeof d.indentation===t)&&(d.indentation=0),(n.isGroup||typeof d.displayRowIndex===t)&&(d.displayRowIndex=-1),d.isInternallyHidden=!0,r.indexOf(d)>=0||r.splice(r.length,0,d)}O(r,o,s),o.isGridVisible&&!n.isPart&&typeof n.displayRowIndex===t&&(l=null,e<r.length-1&&((m=r[e+1]).isPart||(u=m.itemTop,typeof m.gridItemContainer!==t&&(l=m.gridItemContainer))),s.gridContent.insertBefore(Ai(n,r,o.columns,s.chartContent,o.toggleButtonAreaWidth,o,s),l)),typeof u===t&&(u=Et(r,o)-o.itemHeight),m=u,typeof n.displayRowIndex!==t&&(m=n.displayRowIndex*o.itemHeight);var p=s.chartContent.chartArea;if(p.appendChild(pi(n,m,o)),n.isVisible&&!(typeof n.isHidden!==t&&n.isHidden)&&(u=Math.max(u,m+o.itemHeight)),n.itemTop=m,typeof n.parts!==t)for(l=0;l<n.parts.length;l++)p.appendChild(pi(d=n.parts[l],m,o));if(p.appendChild(Ri(n,m,o)),typeof n.displayRowIndex===t)for(l=e+1;l<r.length;l++)m=u,typeof(d=r[l]).displayRowIndex!==t&&(m=d.displayRowIndex*o.itemHeight),d.isVisible&&!(typeof d.isHidden!==t&&d.isHidden)&&(u=Math.max(u,m+o.itemHeight)),d.itemTop=m,bt(d),Dt(r,d);for(l=e+1;l<r.length;l++)Ut(r[l]);s.isContentHeightInitialized&&s.isContentHeightAuto&&(e=ae(s,r,o),s.gridContentContainer.style.height=e,s.chartContentContainer.style.height=e),Ht(s.chartContent,Et(r,o)),Yt(r,s.chartContent,o),ei(r,o)&&Zt(r),_t(n,r,s,o),Pt(r,s.chartContentContainer,o)},zi=function(e,n,s,r){if(typeof e.parts!==t)for(var o=0;o<e.parts.length;o++)zi(e.parts[o],n,s,r);var l=null,m=!1;if((o=e.index)>0){for(l=s[o-1];null!=l.parent;)l=l.parent;m=l.isExpanded,e.hasChildren&&vt(l,e.isExpanded,!1,!0),l.indentation>=e.indentation&&(l=null)}else s[0].isExpanded||vt(s[0],!0,!1,!0);var d=o+1<s.length?s[o+1]:null;null!=d&&!d.isExpanded&&d.indentation>e.indentation&&vt(d,!0,!1,!0);var p,f,v,u=null!=d?d.indentation:null;for(f=0;f<n.items.length;f++)if(null!=(p=n.items[f]).predecessors)for(v=p.predecessors.length;v-- >0;)p.predecessors[v].item==e&&(p.predecessors.splice(v,1),le(p,"predecessors",!1,!0),xt(p),kt(p));var g=e.itemTop;if(s.splice(o,1),B(s,n),O(s,r,n),r.isGridVisible&&typeof e.displayRowIndex===t&&typeof e.gridItemContainer!==t&&n.gridContent.removeChild(e.gridItemContainer),f=n.chartContent.chartArea,typeof e.chartItem!==t&&f.removeChild(e.chartItem),null!=(d=o<s.length?s[o]:null)&&d.indentation<u)for(le(d,"indentation",!1,!0),d.predecessors=[],le(d,"predecessors",!1,!0),f=0;f<s.length;f++)if((p=s[f])!=d&&typeof p.predecessors!==t&&0!=p.predecessors.length)for(v=0;v<p.predecessors.length;v++)p.predecessors[v].item==d&&(p.predecessors.splice(v--,1),le(p,"predecessors",!1,!0),xt(p),kt(p));for(null!=l&&vt(l,m,!1,!0),f=o;f<s.length;f++)e=s[f],actualItemTop=g,typeof e.displayRowIndex!==t&&(actualItemTop=e.displayRowIndex*r.itemHeight),e.isVisible&&!(typeof e.isHidden!==t&&e.isHidden)&&(g=Math.max(g,actualItemTop+r.itemHeight)),e.itemTop=actualItemTop,xt(e);if(Ht(n.chartContent,Et(s,r)),Yt(s,n.chartContent,r),ei(s,r)&&Zt(s),o>=s.length&&(o=s.length-1),o>=0){for(f=0;f<o;f++)bt(s[f]);_t(s[o],s,n,r)}Pt(s,n.chartContentContainer,r)},Ni=function(e,n){return function(o){typeof o===t&&(o=e);var r=o.ownerDocument,l=(o=r.createElementNS("http://www.w3.org/2000/svg","defs"),r.createElementNS("http://www.w3.org/2000/svg","linearGradient"));l.setAttribute("id","BlueGradient"),l.setAttribute("x1","0%"),l.setAttribute("y1","0%"),l.setAttribute("x2","0%"),l.setAttribute("y2","100%");var m=r.createElementNS("http://www.w3.org/2000/svg","stop");m.setAttribute("offset","0%"),m.setAttribute("style","stop-color: White");var d=r.createElementNS("http://www.w3.org/2000/svg","stop");d.setAttribute("offset","25%"),d.setAttribute("style","stop-color: LightBlue");var u=r.createElementNS("http://www.w3.org/2000/svg","stop");u.setAttribute("offset","100%"),u.setAttribute("style","stop-color: Blue"),l.appendChild(m),l.appendChild(d),l.appendChild(u),o.appendChild(l),(l=r.createElementNS("http://www.w3.org/2000/svg","linearGradient")).setAttribute("id","BlackGradient"),l.setAttribute("x1","0%"),l.setAttribute("y1","0%"),l.setAttribute("x2","0%"),l.setAttribute("y2","100%"),(m=r.createElementNS("http://www.w3.org/2000/svg","stop")).setAttribute("offset","0%"),m.setAttribute("style","stop-color: Black"),(d=r.createElementNS("http://www.w3.org/2000/svg","stop")).setAttribute("offset","10%"),d.setAttribute("style","stop-color: White"),(u=r.createElementNS("http://www.w3.org/2000/svg","stop")).setAttribute("offset","20%"),u.setAttribute("style","stop-color: Gray");var p=r.createElementNS("http://www.w3.org/2000/svg","stop");return"Aero"===(p.setAttribute("offset","60%"),p.setAttribute("style","stop-color: Black"),l.appendChild(m),l.appendChild(d),l.appendChild(u),l.appendChild(p),o.appendChild(l),(l=r.createElementNS("http://www.w3.org/2000/svg","marker")).setAttribute("id","ArrowMarker"),l.setAttribute("viewBox","0 0 10 10"),l.setAttribute("refX","0"),l.setAttribute("refY","5"),l.setAttribute("markerUnits","strokeWidth"),l.setAttribute("markerWidth",(4.5*(n.arrowSize?n.arrowSize:1)).toString()),l.setAttribute("markerHeight",(3.5*(n.arrowSize?n.arrowSize:1)).toString()),l.setAttribute("orient","auto"),r=r.createElementNS("http://www.w3.org/2000/svg","path"),n.theme)?r.setAttribute("fill","Blue"):r.setAttribute("fill","#3b87d9"),r.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),r.setAttribute("fill",n.arrowFill?n.arrowFill:"Aero"==n.theme?"Blue":"#3b87d9"),l.appendChild(r),o.appendChild(l),o}},Gi=function(e){return function(n){var s=n.ganttChartView,r=n.ganttChartView.ownerDocument,o=r.createElementNS("http://www.w3.org/2000/svg","title");if(o.appendChild(H(r,n.content)),typeof e.areToolTipsSimplified===t||!e.areToolTipsSimplified)if(typeof n.loadChartView===t){if(typeof n.scheduleChartView===t&&n.parent&&(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Parent: "+n.parent.content))),typeof n.scheduleChartView!==t&&n.scheduleChartItem&&(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Row: "+n.scheduleChartItem.content))),n.hasChildren&&(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Children: "+n.children.length))),o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode((n.isMilestone?"":"Start: ")+e.dateTimeFormatter(h(n.start)))),n.isMilestone||(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Finish: "+e.dateTimeFormatter(h(n.finish))))),e.areTaskAssignmentsVisible&&n.assignmentsContent&&(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Assignments: "+n.assignmentsContent))),n.isMilestone||(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Effort: "+s.getItemTotalEffort(n)/36e5+"h")),e.isTaskCompletedEffortVisible&&(s=s.getItemCompletion(n),isNaN(s)||(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Completed: "+Math.round(100*s*(e.integralCompletionPercents?1:100))/(e.integralCompletionPercents?1:100)+"%"))))),e.areTaskDependenciesVisible&&n.predecessors&&n.predecessors.length>0){o.appendChild(r.createTextNode("\n")),s="";for(var l=0;l<n.predecessors.length;l++){var m=n.predecessors[l];m.item&&(s.length>0&&(s+=", "),s+=m.item.content,m.dependencyType&&(s=s+" ("+Ki(m.dependencyType)+")"))}o.appendChild(r.createTextNode("Predecessors: "+s))}}else isNaN(n.units)||(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Allocation: "+Math.round(1e4*n.units)/100+"%")));return o}},Xi=function(e){return function(n){var s=n.ganttChartView,r=typeof e!==t?e:s.settings;if(r.areResourceImagesVisibleAsAssignments){var o=s.chartContent.childNodes[0].childNodes[0];if(!s.chartContent.hasClipPathForResourceImagesBeenInitialized){var l=document.createElementNS("http://www.w3.org/2000/svg","clipPath");l.setAttribute("id","resourceImageClipPath"),l.setAttribute("clipPathUnits","objectBoundingBox");var m=document.createElementNS("http://www.w3.org/2000/svg","circle");m.setAttribute("cx",.5),m.setAttribute("cy",.5),m.setAttribute("r",.5),l.appendChild(m),o.appendChild(l),s.chartContent.hasClipPathForResourceImagesBeenInitialized=!0}var d=document.createElementNS("http://www.w3.org/2000/svg","g");d.setAttribute("id","assignmentsGroup");var u=(u=q(n.finish,r))+(r.classic||n.hasChildren||n.isMilestone?0:12-Math.min(12,u-q(n.start,r)));(n.isMilestone||n.hasChildren&&(typeof n.isSummaryEnabled===t||n.isSummaryEnabled))&&(u+=r.barHeight/2),!n.isMilestone&&(!n.hasChildren||!(typeof n.isSummaryEnabled===t||n.isSummaryEnabled))&&(u+=r.itemHeight-10),n.isMilestone&&(u+=3);var p=0;return Ct(n).forEach(function(f){var g,v=f.key;if(typeof r.resourceImageUrls!==t&&(I=ot(r.resourceImageUrls,v))>=0&&(g=r.resourceImageUrls[I].value),g&&r.itemHeight>4){var I=r.itemHeight-4,A=document.createElementNS("http://www.w3.org/2000/svg","image");A.setAttribute("x",u+28*p),A.setAttribute("y",2),A.setAttribute("width",I+"px"),A.setAttribute("height",I+"px"),n.isExported&&0!=g.indexOf("://")&&(I=0!=g.indexOf("/")?window.location.pathname.substr(0,window.location.pathname.lastIndexOf("/")+1):"",g=window.location.protocol+"//"+window.location.host+I+g),A.setAttribute("href",g),A.setAttribute("clip-path","url(#resourceImageClipPath)"),d.appendChild(A);var V=1!=f.value?" "+Math.round(1e4*f.value)/100+"%":"";DlhSoft.Controls.ToolTip&&r.useInlineToolTips?(A.addEventListener("mouseover",se(s,A,"mouseover",function(R){1!=R.buttons&&((R=s.toolTip)&&(R.disable(),R.hide()),(R=DlhSoft.Controls.ToolTip.get(A))||(R=DlhSoft.Controls.ToolTip.initialize(void 0,A,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+r.border+"; background-color: White; color: Black; font-family: "+(r.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),R.setContent(v+V),R.show(),s.resourceToolTip=R)})),A.addEventListener("mouseout",se(s,A,"mouseout",function(){var R=s.resourceToolTip;R&&R.hide()}))):((f=document.createElementNS("http://www.w3.org/2000/svg","title")).appendChild(document.createTextNode(v+V)),A.appendChild(f))}p++}),d}return o=document.createElementNS("http://www.w3.org/2000/svg","text"),u=q(n.finish,r),u+=r.classic||n.hasChildren||n.isMilestone?0:12-Math.min(12,u-q(n.start,r)),(n.isMilestone||n.hasChildren&&(typeof n.isSummaryEnabled===t||n.isSummaryEnabled))&&(u+=r.barHeight/2),o.setAttribute("x",u+7),o.setAttribute("y",r.barMargin+r.barHeight/2),o.setAttribute("dominant-baseline","central"),typeof(l="Phone"!=r.target?n.assignmentsContent:n.content)===t&&(l=""),o.appendChild(document.createTextNode(l)),typeof r.assignmentsClass!==t?o.setAttribute("class",r.assignmentsClass):typeof r.assignmentsStyle!==t&&o.setAttribute("style",r.assignmentsStyle),o}},hi=function(e){var n=e.ganttChartView.ownerDocument;for(typeof e.chartItemArea===t&&(e.chartItemArea=n.createElementNS("http://www.w3.org/2000/svg","g")),n=e.chartItemArea.childNodes.length;n-- >0;)e.chartItemArea.removeChild(e.chartItemArea.childNodes[n]);return e.chartItemArea},ci=function(e,n,s,v,o){var l,m=(p=(l=e.ganttChartView).settings).barMargin,d=p.barHeight,u=p.barHeight,p=n.childNodes.length-6,f=null!=v?v-s-4-(e.hasChildren?4:0):200;return(v=(l=l.ownerDocument).createElementNS("http://www.w3.org/2000/svg","foreignObject")).setAttribute("width",f),v.setAttribute("height",u),e.isMilestone?(v.setAttribute("x",s-200-d),v.setAttribute("y",m),v.setAttribute("style","line-height: "+u+"px; text-overflow: ellipsis; white-space: nowrap; text-align: right; font-size: "+(d/2+1)+"px; color: "+o)):e.hasChildren?(v.setAttribute("x",s+4),v.setAttribute("y",m),v.setAttribute("style","line-height: "+2*u/3+"px; text-overflow: ellipsis; white-space: nowrap; font-size: "+d/2+"px; color: "+o)):(v.setAttribute("x",s+2),v.setAttribute("y",m),v.setAttribute("style","line-height: "+u+"px; text-overflow: ellipsis; white-space: nowrap; font-size: "+(d/2+1)+"px; color: "+o)),s=l.createElement("div"),e=l.createTextNode(e.label),s.appendChild(e),v.appendChild(s),n.insertBefore(v,n.childNodes[p]),s},Yi=function(e,n,s){return function(r){var o=typeof n!==t?n:r.ganttChartView,l=typeof s!==t?s:o.settings,m=typeof e!==t?e:o.items,d=o.ownerDocument,u=hi(r);if(l.isBaselineVisible&&typeof r.baselineStart!==t&&typeof r.baselineFinish!==t){var f=q(r.baselineStart,l),v=Math.max(q(r.baselineFinish,l),f+(l.classic?4:12));(p=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",f),p.setAttribute("y",l.barMargin/2),p.setAttribute("width",Math.max(0,v-f-1)),p.setAttribute("height",l.barHeight),p.setAttribute("rx",l.barCornerRadius),p.setAttribute("ry",l.barCornerRadius),f=l.baselineBarClass,typeof r.baselineBarClass!==t&&(f=r.baselineBarClass),typeof f!==t?p.setAttribute("class",f):(f=l.baselineBarStyle,typeof r.baselineBarStyle!==t&&(f=r.baselineBarStyle),typeof f!==t&&p.setAttribute("style",f)),u.appendChild(p)}var p=q(r.start,l),g=(f=Math.max(q(r.finish,l),p+(l.classic?4:12)),v=l.percentBasedCompletionBar&&r.finish.valueOf()!=r.start.valueOf()?p+o.getItemCompletion(r)*(f-p):q(r.completedFinish,l),d.createElementNS("http://www.w3.org/2000/svg","rect"));g.setAttribute("x",p),g.setAttribute("y",l.barMargin),g.setAttribute("width",Math.max(0,f-p-1)),g.setAttribute("height",l.barHeight),g.setAttribute("rx",l.barCornerRadius),g.setAttribute("ry",l.barCornerRadius);var I=l.standardBarClass;if(typeof r.standardBarClass!==t&&(I=r.standardBarClass),typeof r.barClass!==t&&(I=r.barClass),typeof I!==t?g.setAttribute("class",I):(I=l.standardBarStyle,typeof r.standardBarStyle!==t&&(I=r.standardBarStyle),typeof r.barStyle!==t&&(I=r.barStyle),typeof I!==t&&g.setAttribute("style",I)),l.isTaskToolTipVisible&&DlhSoft.Controls.ToolTip&&l.useInlineToolTips&&(u.addEventListener("mouseover",se(o,u,"mouseover",function(_){1!=_.buttons&&((_=o.toolTip)&&(_.disable(),_.hide()),(_=DlhSoft.Controls.ToolTip.get(g))||(_=DlhSoft.Controls.ToolTip.initialize(void 0,g,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: "+(l.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),_.setContent(l.itemTemplate(r).innerHTML.replaceAll("\n","<br/>")),_.show(),o.taskToolTip=_)})),u.addEventListener("mouseout",se(o,u,"mouseout",function(){var _=o.taskToolTip;_.disable(),_.hide()}))),u.appendChild(g),l.isTaskCompletedEffortVisible){(I=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",p+.65),I.setAttribute("y",l.barMargin+l.completedBarMargin-.65),I.setAttribute("width",Math.max(0,v-p-1-1.3)),I.setAttribute("height",l.completedBarHeight+1.3),I.setAttribute("rx",l.completedBarCornerRadius),I.setAttribute("ry",l.completedBarCornerRadius);var A=l.standardCompletedBarClass;typeof r.standardCompletedBarClass!==t&&(A=r.standardCompletedBarClass),typeof r.completedBarClass!==t&&(A=r.completedBarClass),typeof A!==t?I.setAttribute("class",A):(A=l.standardCompletedBarStyle,typeof r.standardCompletedBarStyle!==t&&(A=r.standardCompletedBarStyle),typeof r.completedBarStyle!==t&&(A=r.completedBarStyle),typeof A!==t&&I.setAttribute("style",A)),u.appendChild(I)}if(l.areStandardTaskLabelsVisible&&r.label&&(I=ci(r,u,p,f,r.labelColor?r.labelColor:l.standardLabelColor?l.standardLabelColor:"black"),A=l.standardLabelClass,typeof r.labelClass!==t&&(A=r.labelClass),typeof A!==t?I.setAttribute("class",A):(A=l.standardLabelStyle,typeof r.labelStyle!==t&&(A=r.labelStyle),typeof A!==t&&I.setAttribute("style",A))),!(l.isReadOnly||l.isChartReadOnly||typeof r.isReadOnly!==t&&r.isReadOnly||typeof r.isBarReadOnly!==t&&r.isBarReadOnly)){var V,W;if((I=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",p),I.setAttribute("y",l.barMargin),I.setAttribute("width",Math.max(0,f-p-1)),I.setAttribute("height",l.barHeight),I.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),l.isTaskStartReadOnly||u.appendChild(I),(A=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",p-4),A.setAttribute("y",l.barMargin),A.setAttribute("width",l.classic?4:8),A.setAttribute("height",l.barHeight),A.setAttribute("style","fill: White; fill-opacity: 0; cursor: "+(l.classic?"w-resize":"ew-resize")),l.isDraggingTaskStartEndsEnabled&&!l.isTaskStartReadOnly&&"TouchEnabled"!=l.interaction&&u.appendChild(A),(V=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",f-4),V.setAttribute("y",l.barMargin),V.setAttribute("width",8),V.setAttribute("height",l.barHeight),V.setAttribute("style","fill: White; fill-opacity: 0; cursor: "+(l.classic?"e-resize":"ew-resize")),!l.isTaskEffortReadOnly&&"TouchEnabled"!=l.interaction&&u.appendChild(V),l.classic)(W=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",v-2),W.setAttribute("y",l.barMargin),W.setAttribute("width",6),W.setAttribute("height",l.barHeight),W.setAttribute("style","fill: White; fill-opacity: 0; cursor: ew-resize");else{W=d.createElementNS("http://www.w3.org/2000/svg","g");var R=d.createElementNS("http://www.w3.org/2000/svg","polygon");W.appendChild(R);var z=Math.max(v-1-10,p),j=Math.min(v-1+10,f-1);R.setAttribute("points",z+","+(l.itemHeight-l.barMargin)+" "+j+","+(l.itemHeight-l.barMargin)+" "+(v-1<p+10?p:v-1>f-1-10?f-1:Math.min(Math.max(v-1,p),f-2))+","+(l.itemHeight-l.barMargin-l.barHeight/2)),R.setAttribute("style","fill: White; fill-opacity: 0; cursor: ew-resize"),R=d.createElementNS("http://www.w3.org/2000/svg","rect"),W.appendChild(R),z=Math.max(p,v-10),(j=Math.min(20,f-v))<20&&(z-=10-j,j=20),R.setAttribute("x",z),R.setAttribute("y",l.itemHeight/2),R.setAttribute("width",j),R.setAttribute("height",l.itemHeight/2),R.setAttribute("style","fill: White; fill-opacity: 0;")}z=typeof l.areToolTipsSimplified!==t&&l.areToolTipsSimplified?NaN:o.getItemCompletion(r);var Y=isNaN(z)?"":Math.round(100*z*(l.integralCompletionPercents?1:100))/(l.integralCompletionPercents?1:100)+"%";!l.isTaskCompletionReadOnly&&l.isTaskCompletedEffortVisible&&"TouchEnabled"!=l.interaction&&(u.appendChild(W),Y&&DlhSoft.Controls.ToolTip&&l.useInlineToolTips?(W.addEventListener("mouseover",se(o,W,"mouseover",function(ne){1==ne.buttons&&"CompletedFinish"!=o.dragType||((ne=o.toolTip)&&(ne.disable(),ne.hide()),(ne=DlhSoft.Controls.ToolTip.get(W))||(ne=DlhSoft.Controls.ToolTip.initialize(void 0,W,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: "+(l.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),ne.setContent(Y),ne.show(),o.taskCompletionToolTip=ne)})),W.addEventListener("mouseout",se(o,W,"mouseout",function(){var ne=o.taskCompletionToolTip;ne.disable(),ne.hide()}))):((z=d.createElementNS("http://www.w3.org/2000/svg","title")).appendChild(H(d,Y)),W.appendChild(z))),wi(I,A,V,W,r,p,f,v,m,o,l),l.areTaskDependenciesVisible&&!l.areTaskPredecessorsReadOnly&&!r.isPart&&(v=null,(typeof l.allowCreatingStartDependencies===t||l.allowCreatingStartDependencies)&&((v=d.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",p-(l.classic?0:8)),v.setAttribute("cy",l.barMargin+l.barHeight/2),v.setAttribute("r",l.barHeight/(l.classic?4:3)),v.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),u.appendChild(v)),(d=d.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",f-2+(l.classic?0:9)),d.setAttribute("cy",l.barMargin+l.barHeight/2),d.setAttribute("r",l.barHeight/(l.classic?4:3)),d.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer;"),u.appendChild(d),ii(d,v,u,r,l.barMargin+l.barHeight/2,f-2,p,m,o,l))}return u}},Ui=function(e,n,s){return function(r){var o=typeof n!==t?n:r.ganttChartView,l=typeof s!==t?s:o.settings,m=typeof e!==t?e:o.items,d=o.ownerDocument,u=hi(r),p=q(r.start,l),f=q(r.finish,l),z=2.15*l.barHeight/3,v=d.createElementNS("http://www.w3.org/2000/svg","rect");v.setAttribute("x",p),v.setAttribute("y",l.barMargin),v.setAttribute("width",Math.max(0,f-p-1)),v.setAttribute("height",z);var g=l.summaryBarClass;if(typeof r.summaryBarClass!==t&&(g=r.summaryBarClass),typeof r.barClass!==t&&(g=r.barClass),typeof g!==t)v.setAttribute("class",g);else{var I=l.summaryBarStyle;typeof r.summaryBarStyle!==t&&(I=r.summaryBarStyle),typeof r.barStyle!==t&&(I=r.barStyle),typeof I!==t&&v.setAttribute("style",I)}if(u.appendChild(v),l.isTaskToolTipVisible&&DlhSoft.Controls.ToolTip&&l.useInlineToolTips&&(u.addEventListener("mouseover",se(o,u,"mouseover",function(Y){1!=Y.buttons&&((Y=o.toolTip)&&(Y.disable(),Y.hide()),(Y=DlhSoft.Controls.ToolTip.get(v))||(Y=DlhSoft.Controls.ToolTip.initialize(void 0,v,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: "+(l.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),Y.setContent(l.itemTemplate(r).innerHTML.replaceAll("\n","<br/>")),Y.show(),o.taskToolTip=Y)})),u.addEventListener("mouseout",se(o,v,"mouseout",function(){var Y=o.taskToolTip;Y.disable(),Y.hide()}))),l.isTaskCompletedEffortVisible&&l.isSummaryTaskCompletedEffortVisible){(V=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",p),V.setAttribute("y",l.barMargin+2.15*l.completedBarMargin/3),V.setAttribute("width",Math.max(0,f-p-1)*o.getItemCompletion(r)),V.setAttribute("height",2.15*l.completedBarHeight/3),V.setAttribute("rx",l.completedBarCornerRadius),V.setAttribute("ry",l.completedBarCornerRadius);var A=l.summaryCompletedBarClass;typeof r.summaryCompletedBarClass!==t&&(A=r.summaryCompletedBarClass),typeof r.completedBarClass!==t&&(A=r.completedBarClass),typeof A!==t?V.setAttribute("class",A):(A=l.summaryCompletedBarStyle,typeof r.summaryCompletedBarStyle!==t&&(A=r.summaryCompletedBarStyle),typeof r.completedBarStyle!==t&&(A=r.completedBarStyle),typeof A!==t&&V.setAttribute("style",A)),u.appendChild(V)}r.isExpanded||((V=d.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",p),V.setAttribute("y1",l.barMargin+z+2.5),V.setAttribute("x2",f-1),V.setAttribute("y2",l.barMargin+z+2.5),A=l.collapsedSummaryLineClass,typeof r.collapsedSummaryLineClass!==t&&(A=r.collapsedSummaryLineClass),typeof A!==t?V.setAttribute("class",A):(A=l.collapsedSummaryLineStyle,typeof r.collapsedSummaryLineStyle!==t&&(A=r.collapsedSummaryLineStyle),typeof A!==t&&V.setAttribute("style",A)),u.appendChild(V)),A=d.createElementNS("http://www.w3.org/2000/svg","polygon");var V,W=z+1.5,R=3*l.barHeight/4,j=l.barHeight/4;return A.setAttribute("points",(z=p-1-l.barHeight/3)+","+(V=l.barMargin-.25)+" "+z+","+(V+W)+" "+(z+R/2)+","+(V+W+j)+" "+(z+R)+","+(V+W)+" "+(z+R)+","+V),typeof g!==t&&A.setAttribute("class",g),typeof I!==t&&A.setAttribute("style",I),u.appendChild(A),(A=d.createElementNS("http://www.w3.org/2000/svg","polygon")).setAttribute("points",(z=f+l.barHeight/3)+","+V+" "+z+","+(V+W)+" "+(z-R/2)+","+(V+W+j)+" "+(z-R)+","+(V+W)+" "+(z-R)+","+V),typeof g!==t&&A.setAttribute("class",g),typeof I!==t&&A.setAttribute("style",I),u.appendChild(A),l.areSummaryTaskLabelsVisible&&r.label&&(g=ci(r,u,p,f,r.labelColor?r.labelColor:l.summaryLabelColor?l.summaryLabelColor:"white"),I=l.summaryLabelClass,typeof r.labelClass!==t&&(I=r.labelClass),typeof I!==t?g.setAttribute("class",I):(I=l.summaryLabelStyle,typeof r.labelStyle!==t&&(I=r.labelStyle),typeof I!==t&&g.setAttribute("style",I))),!l.isReadOnly&&!l.isChartReadOnly&&(typeof r.isReadOnly===t||!r.isReadOnly)&&(typeof r.isBarReadOnly===t||!r.isBarReadOnly)&&l.areTaskDependenciesVisible&&!l.areTaskPredecessorsReadOnly&&!r.isPart&&(g=null,(typeof l.allowCreatingStartDependencies===t||l.allowCreatingStartDependencies)&&((g=d.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",p-.5),g.setAttribute("cy",l.barMargin+l.barHeight/2),g.setAttribute("r",l.barHeight/(l.classic?4:3)),g.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),u.appendChild(g)),(d=d.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",f-.5),d.setAttribute("cy",l.barMargin+l.barHeight/2),d.setAttribute("r",l.barHeight/(l.classic?4:3)),d.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),u.appendChild(d),ii(d,g,u,r,l.barMargin+l.barHeight/2,f-1.5,p,m,o,l)),u}},Zi=function(e,n,s){return function(r){var o=typeof n!==t?n:r.ganttChartView,l=typeof s!==t?s:o.settings,m=typeof e!==t?e:o.items,d=o.ownerDocument,u=hi(r);if(l.isBaselineVisible&&typeof r.baselineStart!==t){var f=q(r.baselineStart,l),g=d.createElementNS("http://www.w3.org/2000/svg","polygon"),p=l.barHeight+1;if(g.setAttribute("points",f+","+(I=l.barMargin-1)+" "+(f-p/2)+","+(I+p/2)+" "+f+","+(I+p)+" "+(f+p/2)+","+(I+p/2)),f=l.baselineBarClass,typeof r.baselineBarClass!==t&&(f=r.baselineBarClass),typeof f!==t)g.setAttribute("class",f);else{var A=l.baselineBarStyle;typeof r.baselineBarStyle!==t&&(A=r.baselineBarStyle)}g.setAttribute("style",A),u.appendChild(g)}f=q(r.start,l);var I,v=d.createElementNS("http://www.w3.org/2000/svg","polygon");return v.setAttribute("points",(g=f-1)+","+(I=l.barMargin)+" "+(g-(A=l.barHeight+1)/2)+","+(I+A/2)+" "+g+","+(I+A)+" "+(g+A/2)+","+(I+A/2)),I=l.milestoneBarClass,typeof r.milestoneBarClass!==t&&(I=r.milestoneBarClass),typeof r.barClass!==t&&(I=r.barClass),typeof I!==t?v.setAttribute("class",I):(I=l.milestoneBarStyle,typeof r.milestoneBarStyle!==t&&(I=r.milestoneBarStyle),typeof r.barStyle!==t&&(I=r.barStyle),typeof I!==t&&v.setAttribute("style",I)),u.appendChild(v),l.isTaskToolTipVisible&&DlhSoft.Controls.ToolTip&&l.useInlineToolTips&&(u.addEventListener("mouseover",se(o,u,"mouseover",function(V){1!=V.buttons&&((V=o.toolTip)&&(V.disable(),V.hide()),(V=DlhSoft.Controls.ToolTip.get(v))||(V=DlhSoft.Controls.ToolTip.initialize(void 0,v,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: "+(l.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),V.setContent(l.itemTemplate(r).innerHTML.replaceAll("\n","<br/>")),V.show(),o.taskToolTip=V)})),u.addEventListener("mouseout",se(o,u,"mouseout",function(){var V=o.taskToolTip;V.disable(),V.hide()}))),l.areMilestoneTaskLabelsVisible&&r.label&&(f=ci(r,u,f,null,r.labelColor?r.labelColor:l.milestoneLabelColor?l.milestoneLabelColor:"black"),I=l.milestoneLabelClass,typeof r.labelClass!==t&&(I=r.labelClass),typeof I!==t?f.setAttribute("class",I):(I=l.milestoneLabelStyle,typeof r.labelStyle!==t&&(I=r.labelStyle),typeof I!==t&&f.setAttribute("style",I))),!l.isReadOnly&&!l.isChartReadOnly&&(typeof r.isReadOnly===t||!r.isReadOnly)&&(typeof r.isBarReadOnly===t||!r.isBarReadOnly)&&((f=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",g-A/2),f.setAttribute("y",l.barMargin),f.setAttribute("width",A),f.setAttribute("height",A),f.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),u.appendChild(f),wi(f,null,null,null,r,g,g,g,m,o,l),l.areTaskDependenciesVisible&&!l.areTaskPredecessorsReadOnly&&!r.isPart&&((d=d.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",g),d.setAttribute("cy",l.barMargin+l.barHeight/2+(l.classic?0:.5)),d.setAttribute("r",l.barHeight/(l.classic?4:3)),d.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),u.appendChild(d),ii(d,null,u,r,l.barMargin+l.barHeight/2,g,g,m,o,l))),u}},_i=function(e,n){return function(s,r){var o=s.ganttChartView,l=typeof n!==t?n:o.settings,u=typeof e!==t?e:o.items,m=o.ownerDocument,d=m.createElementNS("http://www.w3.org/2000/svg","g"),p=(u=In(s,r,u,l),m.createElementNS("http://www.w3.org/2000/svg","path"));p.setAttribute("d",u),typeof l.dependencyLineZoneClass!==t&&p.setAttribute("class",l.dependencyLineZoneClass),typeof l.dependencyLineZoneStyle!==t&&p.setAttribute("style",l.dependencyLineZoneStyle),d.appendChild(p);var f=m.createElementNS("http://www.w3.org/2000/svg","path");return f.setAttribute("d",u),m=l.dependencyLineClass,typeof r.dependencyLineClass!==t&&(m=r.dependencyLineClass),typeof m!==t?f.setAttribute("class",m):(m=l.dependencyLineStyle,typeof r.dependencyLineStyle!==t&&(m=r.dependencyLineStyle),typeof m!==t&&f.setAttribute("style",m)),d.appendChild(f),l.isDependencyToolTipVisible&&DlhSoft.Controls.ToolTip&&l.useInlineToolTips&&l.useInlineToolTipsForDependencies&&(d.addEventListener("mouseover",se(o,d,"mouseover",function(v){var g=o.dependencyToolTip;g&&(g.disable(),g.hide()),(g=DlhSoft.Controls.ToolTip.get(f))||(g=DlhSoft.Controls.ToolTip.initialize(void 0,f,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: "+(l.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),g.setContent(l.predecessorItemTemplate(s,r).innerHTML.replaceAll("\n","<br/>")),g.show();var I=d.getBoundingClientRect();g.setHorizontalPosition(g.x+v.clientX-I.left),g.setVerticalPosition(g.y+v.clientY-I.bottom+10),o.dependencyToolTip=g})),d.addEventListener("mouseout",se(o,d,"mouseout",function(){var v=o.dependencyToolTip;v.disable(),v.hide()}))),d}},$i=function(e){return function(n,s){var r=n.ganttChartView.ownerDocument,o=r.createElementNS("http://www.w3.org/2000/svg","title");return o.appendChild(H(r,s.item.content+" - "+n.content)),(typeof e.areToolTipsSimplified===t||!e.areToolTipsSimplified)&&(s.dependencyType&&(o.appendChild(r.createTextNode("\n")),o.appendChild(H(r,"Type: "+Ki(s.dependencyType)))),s.lag&&(o.appendChild(r.createTextNode("\n")),o.appendChild(H(r,"Lag: "+s.lag/36e5+"h")))),o}},Ki=function(e){switch(e){case"StartStart":case"SS":return"SS";case"FinishFinish":case"FF":return"FF";case"StartFinish":case"SF":return"SF";default:return"FS"}},In=function(e,n,m,r){var d,u,A,o=Vt(n.item,m,r),l=Vt(e,m,r),p=(m="M ",r.itemHeight),f=p/2,v=p/3.5,g=2,I=!1;return o!=l||typeof n.dependencyType!==t&&"FinishStart"!=n.dependencyType&&"FS"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?(typeof n.dependencyType===t||"StartStart"!=n.dependencyType&&"SS"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?(d=q(n.item.finish,r)-1,n.item.hasChildren&&(typeof n.item.isSummaryEnabled===t||n.item.isSummaryEnabled)?d+=r.barHeight/3+.25:n.item.isMilestone?d+=p/4:d<(A=q(n.item.start,r)+(r.classic?4:12)-1)&&(d=A),u=d+v):(d=q(n.item.start,r),n.item.hasChildren&&(typeof n.item.isSummaryEnabled===t||n.item.isSummaryEnabled)?d-=r.barHeight/3+.25:n.item.isMilestone&&(d-=p/4),u=d-v),m=m+(d+" ")+((o=o-l+.5)+f)+" L "+u+" "+(o+f),typeof n.dependencyType===t||"FinishFinish"!=n.dependencyType&&"FF"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?(d=q(e.start,r),typeof n.dependencyType===t||"StartStart"!=n.dependencyType&&"SS"!=n.dependencyType?e.isMilestone?l=d-1:(l=d+1.5,A=q(e.finish,r),l<u&&A-u>2*v&&e.start>=n.item.finish&&(l=u)):(I=!0,e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)?d-=r.barHeight/3+1:e.isMilestone&&(d-=p/4+1),l=d-v)):(d=q(e.finish,r)-1,typeof n.dependencyType===t||"FinishFinish"!=n.dependencyType&&"FF"!=n.dependencyType?e.isMilestone?l=d:(d<(A=q(e.start,r)+(r.classic?4:12))&&(d=A),l=d-2.5):(I=!0,e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)?d+=r.barHeight/3+1:e.isMilestone?d+=p/4+1:d<(A=q(e.start,r)+(r.classic?4:12)-1)&&(d=A),l=d+v)),typeof n.dependencyType===t||"StartStart"!=n.dependencyType&&"SS"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?l<u&&(m=m+" "+u+" "+((o=(o-=v/6)<=0?o+f:o-f)+f)):l>u&&(m=m+" "+u+" "+((o=(o-=v/6)<=0?o+f:o-f)+f)),m=m+" "+l+" "+(o+f),o=I?f+.5:o<=0?r.barMargin-1-g:p-r.barMargin+1+g,I&&(l>d-g&&(g=-g),d-=g),m=m+" "+l+" "+o,I&&(m=m+" "+d+" "+o)):(typeof n.dependencyType===t||"FinishStart"==n.dependencyType||"FS"==n.dependencyType?(d=q(n.item.finish,r),n.item.isMilestone&&(d+=r.barHeight/3+.25),u=q(e.start,r),e.isMilestone&&(u-=r.barHeight/3+.25)):(d=q(n.item.start,r),n.item.isMilestone&&(d-=r.barHeight/3+.25),u=q(e.finish,r),e.isMilestone&&(u+=r.barHeight/3+.25)),m=m+(d+" ")+((o=o-l+.5)+f)+" L "+(u+(u>d?-1:1)*(p/5-1))+" "+(o+f)),m},le=function(e,n,s,r){if(typeof e.ganttChartView!==t){var o=e.ganttChartView,l=o.settings;if("start"==n||"minStart"==n||"maxStart"==n?(typeof e.minStart!==t&&e.start<e.minStart?(e.start=e.minStart,typeof e.loadChartItem===t&&(e.start=_e(e.start,l,!0,typeof e.isMilestone!==t&&e.isMilestone,ce(e))),s&&(e.preferredStart=e.start)):typeof e.maxStart!==t&&e.start>e.maxStart&&(e.start=e.maxStart,typeof e.loadChartItem===t&&(e.start=_e(e.start,l,!0,typeof e.isMilestone!==t&&e.isMilestone,ce(e))),s&&(e.preferredStart=e.start)),e.finish<e.start&&(e.finish=e.start,le(e,"finish",!1,!0)),e.completedFinish<e.start?(e.completedFinish=e.start,le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,le(e,"completedFinish",!1,!0))):("finish"==n||"minFinish"==n||"maxFinish"==n)&&(typeof e.maxFinish!==t&&e.finish>e.maxFinish?(e.finish=e.maxFinish,typeof e.loadChartItem===t&&(e.finish=_e(e.finish,l,typeof e.isMilestone!==t&&e.isMilestone,!0,ce(e)))):typeof e.minFinish!==t&&e.finish<e.minFinish&&(e.finish=e.minFinish,typeof e.loadChartItem===t&&(e.finish=_e(e.finish,l,typeof e.isMilestone!==t&&e.isMilestone,!0,ce(e)))),e.finish<e.start&&(e.finish=e.start,le(e,"finish",!1,!0)),e.completedFinish<e.start?(e.completedFinish=e.start,le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,le(e,"completedFinish",!1,!0))),o.isTimingInformationInitialized){var d,u,m=o.items;if("indentation"==n||"predecessors"==n)for(d=0;d<m.length;d++)typeof(u=m[d]).dependsOf!==t&&delete u.dependsOf;if("predecessors"==n&&l.alwaysHandleInvalidDependencies)typeof(u=e).predecessors!==t&&u.predecessors.length>0&&Ft(u,m,l,o,!0);else if(("predecessors"==n||"start"==n||"finish"==n)&&typeof e.isDuringPropertyChangeTaskDependencyConstraintsEnsuring===t&&l.areTaskDependencyConstraintsEnabled&&(l.areTaskDependencyConstraintsEnabledWhileDragging||typeof o.isDuringTimeDragOperation===t)){for(e.isDuringPropertyChangeTaskDependencyConstraintsEnsuring=!0,u=e.parent;null!=u;)typeof u.predecessors!==t&&u.predecessors.length>0&&Ft(u,m,l,o),u=u.parent;for(typeof(u=e).predecessors!==t&&u.predecessors.length>0?Ft(u,m,l,o):mi(u,l);null!=u;){if(typeof u.successors===t)for(u.successors=[],d=0;d<m.length;d++){var p=m[d];if(p!=u&&typeof p.predecessors!==t&&0!=p.predecessors.length)for(var f=0;f<p.predecessors.length;f++)if(p.predecessors[f].item==u){u.successors.push(p);break}}for(d=0;d<u.successors.length;d++)Ft(u.successors[d],m,l,o);u=u.parent}delete e.isDuringPropertyChangeTaskDependencyConstraintsEnsuring}e.isPart&&e.ganttChartItem&&le(e.ganttChartItem,"parts",!1,!0)}if("assignmentsContent"==n&&!e.hasChildren&&e.hasFixedEffort&&typeof e.fixedEffortAssignments!==t&&e.fixedEffortUpdatesFinish){for(p=u=0,m=o.getItemAssignments(e),d=0;d<m.length;d++)u+=m[d].value;for(d=0;d<e.fixedEffortAssignments.length;d++)p+=e.fixedEffortAssignments[d].value;u<=0&&(u=1),p<=0&&(p=1),o.setItemEffort(e,o.getItemEffort(e)*p/u)}if(("start"==n||"finish"==n)&&!e.hasChildren&&e.hasFixedEffort&&typeof e.fixedEffort!==t&&!e.fixedEffortUpdatesFinish){for(u=o.getItemEffort(e)/e.fixedEffort,m="",d=0;d<e.fixedEffortAssignments.length;d++)p=e.fixedEffortAssignments[d],m.length>0&&(m+=", "),f=Math.floor(p.value/u*1e6)/1e6,m+=p.key+(1!=f?" ["+100*f+"%]":"");o.setItemAssignmentsContent(e,m)}l.itemPropertyChangeHandler(e,n,s,r),"isExpanded"==n?typeof e.ganttChartView!==t&&typeof e.ganttChartView.settings.itemExpansionChangeHandler!==t&&e.ganttChartView.settings.itemExpansionChangeHandler(e,e.isExpanded):"isSelected"==n&&typeof e.ganttChartView!==t&&typeof e.ganttChartView.settings.itemSelectionChangeHandler!==t&&e.ganttChartView.settings.itemSelectionChangeHandler(e,e.isSelected,s),typeof e.scheduleChartView!==t&&"content"==n&&e.scheduleChartView.refreshScheduleChartItem(e)}},mi=function(e,n){if(typeof e.isAwaitingPreferredStartUpdates===t)if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled))for(var s=0;s<e.children.length;s++)mi(e.children[s],n);else if(typeof e.preferredStart!==t&&e.preferredStart<e.start){e.isAwaitingPreferredStartUpdates=!0;var r=e.start.valueOf(),o=e.finish.valueOf(),l=e.completedFinish.valueOf();effort=Ne(e.start,e.finish,n,ce(e)),completedEffort=Ne(e.start,e.completedFinish,n,ce(e)),e.start=e.preferredStart,e.finish=$e(e.start,effort,n,ce(e)),e.completedFinish=$e(e.start,completedEffort,n,ce(e)),e.start.valueOf()!=r&&le(e,"start",!1,!1),e.finish.valueOf()!=o&&le(e,"finish",!1,!1),e.completedFinish.valueOf()!=l&&le(e,"completedFinish",!1,!1),setTimeout(function(){e.start.valueOf()!=r&&le(e,"start",!1,!0),e.finish.valueOf()!=o&&le(e,"finish",!1,!0),e.completedFinish.valueOf()!=l&&le(e,"completedFinish",!1,!0),(e.start.valueOf()!=r||e.finish.valueOf()!=o||e.completedFinish.valueOf()!=l)&&st(e),delete e.isAwaitingPreferredStartUpdates},1)}},Ft=function(e,n,s,r,o){if(o){if(r.isBasicTimingInformationInitialized){o=[];var l,m=!1;for(r=0;r<e.predecessors.length;r++)typeof(l=e.predecessors[r]).item===t||n.indexOf(l.item)<0||Ot(l.item,e)?(s.invalidPredecessorDetectionHandler&&s.invalidPredecessorDetectionHandler(l,e,l.item),m=!0):o.push(l);e.predecessors=o,m&&(le(e,"predecessors",!1,!0),typeof e.ganttChartView!==t&&Rt(e))}}else if(r.isBasicTimingInformationInitialized&&(typeof e.areDependencyConstraintsEnabled===t||e.areDependencyConstraintsEnabled)){for(mi(e,s),o=[],m=!1,r=0;r<e.predecessors.length;r++)typeof(l=e.predecessors[r]).item===t||n.indexOf(l.item)<0||Ot(l.item,e)?(s.invalidPredecessorDetectionHandler&&s.invalidPredecessorDetectionHandler(l,e,l.item),m=!0):o.push(l);for(e.predecessors=o,m&&(le(e,"predecessors",!1,!0),typeof e.ganttChartView!==t&&Rt(e)),r=0;r<e.predecessors.length;r++)Ji(e,l=e.predecessors[r],n,s)}},Ji=function(e,n,s,r){if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled))for(var o=0;o<e.children.length;o++)Ji(e.children[o],n,s,r);else if(!(typeof r.areDependencyConstraintsAppliedOnMilestones!==t&&!r.areDependencyConstraintsAppliedOnMilestones&&e.isMilestone||typeof r.areDependencyConstraintsAppliedOnStartedTasks!==t&&!r.areDependencyConstraintsAppliedOnStartedTasks&&zt(e))){var m,l=n.item;if(s=!1,typeof n.dependencyType===t||""==n.dependencyType||"FinishStart"==n.dependencyType||"FS"==n.dependencyType){if(l=l.finish,typeof n.lag!==t&&0!=n.lag&&(l=$e(l,n.lag,r,ce(e))),e.start<l&&(!e.isMilestone&&(!e.hasChildren||!(typeof e.isSummaryEnabled===t||e.isSummaryEnabled))&&(o=Ne(e.start,e.finish,r,ce(e)),m=Ne(e.start,e.completedFinish,r,ce(e))),!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)){var d=e.start.valueOf(),u=(n=e.finish.valueOf(),e.completedFinish.valueOf());e.start=_e(K(l,r),r,!0,e.isMilestone,ce(e)),e.start.valueOf()!=d&&le(e,"start",!1,!0),e.isMilestone?(e.finish=e.start,e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.completedFinish=e.start):(e.finish=$e(e.start,o,r,ce(e)),e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.completedFinish=$e(e.start,m,r,ce(e))),e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0),s=!0}}else"StartStart"==n.dependencyType||"SS"==n.dependencyType?(l=l.start,typeof n.lag!==t&&0!=n.lag&&(l=$e(l,n.lag,r,ce(e))),e.start<l&&(!e.isMilestone&&(!e.hasChildren||!(typeof e.isSummaryEnabled===t||e.isSummaryEnabled))&&(o=Ne(e.start,e.finish,r,ce(e)),m=Ne(e.start,e.completedFinish,r,ce(e))),(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)&&(d=e.start.valueOf(),n=e.finish.valueOf(),u=e.completedFinish.valueOf(),e.start=_e(K(l,r),r,!0,e.isMilestone,ce(e)),e.start.valueOf()!=d&&le(e,"start",!1,!0),e.isMilestone?(e.finish=e.start,e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.completedFinish=e.start):(e.finish=$e(e.start,o,r,ce(e)),e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.completedFinish=$e(e.start,m,r,ce(e))),e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0),s=!0))):"FinishFinish"==n.dependencyType||"FF"==n.dependencyType?(l=l.finish,typeof n.lag!==t&&0!=n.lag&&(l=$e(l,n.lag,r,ce(e))),e.finish>l&&(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)&&(n=e.finish.valueOf(),u=e.completedFinish.valueOf(),e.finish=_e(K(l,r),r,e.isMilestone,!0,ce(e)),e.finish<e.start&&(e.finish=e.start),e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.isMilestone?e.completedFinish!=e.start&&(e.completedFinish=e.start,e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0)),s=!0)):("StartFinish"==n.dependencyType||"SF"==n.dependencyType)&&(l=l.start,typeof n.lag!==t&&0!=n.lag&&(l=$e(l,n.lag,r,ce(e))),e.finish>l&&(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)&&(n=e.finish.valueOf(),u=e.completedFinish.valueOf(),e.finish=_e(K(l,r),r,e.isMilestone,!0,ce(e)),e.finish<e.start&&(e.finish=e.start),e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.isMilestone?e.completedFinish!=e.start&&(e.completedFinish=e.start,e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0)),(e.start.valueOf()!=d||e.finish.valueOf()!=n||e.completedFinish.valueOf()!=u)&&(s=!0)));s&&typeof e.ganttChartView!==t&&typeof e.isAwaitingEnsureItemDependencyConstraintsUpdates===t&&(typeof e.ganttChartView===t||e.ganttChartView.isTimingInformationInitialized?(e.isAwaitingEnsureItemDependencyConstraintsUpdates=!0,setTimeout(function(){st(e),delete e.isAwaitingEnsureItemDependencyConstraintsUpdates},0)):st(e))}},Ot=function(e,n){if(typeof e.dependsOf!==t&&typeof e.dependsOf[n.index]!==t)return e.dependsOf[n.index];if(typeof e.dependsOf===t&&(e.dependsOf={}),e==n)return!0;var s=Qi(e);if(s.indexOf(n)>=0)return e.dependsOf[n.index]=!0;var r=Qi(n);if(r.indexOf(e)>=0)return e.dependsOf[n.index]=!0;var l,m,o=yi(e);for(l=0;l<o.length;l++)if((m=o[l])==n||m==e||s.indexOf(m)>=0||r.indexOf(m)>=0||Ot(m,n))return e.dependsOf[n.index]=!0;for(o=0;o<s.length;o++){var d=yi(s[o]);for(l=0;l<d.length;l++)if((m=d[l])==n||m==e||s.indexOf(m)>=0||r.indexOf(m)>=0||Ot(m,n))return e.dependsOf[n.index]=!0}for(s=e.children,l=0;l<s.length;l++)if(typeof(r=s[l]).predecessors!==t&&r.predecessors.length>0&&Ot(r,n))return e.dependsOf[n.index]=!0;return e.dependsOf[n.index]=!1},Qi=function(e){for(var n=[];typeof e.parent!==t&&null!=e.parent;)(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&n.push(e.parent),e=e.parent;return n},yi=function(e){var n=[];if(typeof e.predecessors!==t&&null!=e.predecessors)for(var s=0;s<e.predecessors.length;s++)typeof e.predecessors[s].item!==t&&n.push(e.predecessors[s].item);return n},En=function(e,n){for(var s=0;s<e.length;s++){var r=e[s],o=null==n||n(r);if(r.isHidden=!o,o)for(r=r.parent;null!=r;)r.isHidden=!1,r=r.parent}},qi=function(e,n,s){return _e(e,n,!0,!0,s)},It=function(e,n,s){return _e(e,n,!0,!1,s)},_e=function(v,p,s,r,f){var l=typeof f!==t&&typeof f.workingDayStart!==t?f.workingDayStart:p.visibleDayStart,m=typeof f!==t&&typeof f.workingDayFinish!==t?f.workingDayFinish:p.visibleDayFinish,d=typeof f!==t&&typeof f.workingWeekStart!==t?f.workingWeekStart:p.workingWeekStart,u=typeof f!==t&&typeof f.workingWeekFinish!==t?f.workingWeekFinish:p.workingWeekFinish;for(p=typeof f!==t&&typeof f.specialNonworkingDays!==t?f.specialNonworkingDays:p.specialNonworkingDays,f=S(v),((v=L(v))<l||!s&&v==l)&&(s?v=l:(f=we(f),v=m)),(v>m||!r&&v==m)&&(r?v=m:(f=Q(f),v=l)),r=M(f);r<d||r>u||Xt(f,p);){for(s?(r++,f=Q(f),v=l):(r--,f=we(f),v=m);r<0;)r+=7;for(;r>=7;)r-=7}return new Date(f.valueOf()+v)},Ne=function(v,n,p,u){if(n.valueOf()<v.valueOf())return-Ne(n,v,p,u);if(n.valueOf()==v.valueOf())return 0;var o=typeof u!==t&&typeof u.workingDayStart!==t?u.workingDayStart:p.visibleDayStart,l=typeof u!==t&&typeof u.workingDayFinish!==t?u.workingDayFinish:p.visibleDayFinish,m=typeof u!==t&&typeof u.workingWeekStart!==t?u.workingWeekStart:p.workingWeekStart,d=typeof u!==t&&typeof u.workingWeekFinish!==t?u.workingWeekFinish:p.workingWeekFinish,f=(u=typeof u!==t&&typeof u.specialNonworkingDays!==t?u.specialNonworkingDays:p.specialNonworkingDays,p=0,S(v));(v=L(v))<o?v=o:v>=l&&(f=Q(f),v=o);for(var g=S(n);f<g;){var I=M(f);I>=m&&I<=d&&!Xt(f,u)&&(p+=l-v),f=Q(f),v=o}return(n=L(n))<o?n=o:n>l&&(n=l),n>v&&(p+=n-v),p},$e=function(e,n,s,r){if(n<0)return $t(-n,e,s,r);if(e=_e(e,s,!0,!1,r),0==n)return e;var o=typeof r!==t&&typeof r.workingDayStart!==t?r.workingDayStart:s.visibleDayStart,l=typeof r!==t&&typeof r.workingDayFinish!==t?r.workingDayFinish:s.visibleDayFinish,m=L(e);if(m+n<l)return new Date(e.valueOf()+n);for(m=l-m,e=new Date(e.valueOf()+m),n-=m;n>0;){if(e=L(e)>0?_e(Q(S(e)),s,!0,!1,r):_e(S(e),s,!0,!1,r),o+n<l)return new Date(e.valueOf()+n);m=l-o,e=new Date(e.valueOf()+m),n-=m}return new Date(e.valueOf())},$t=function(e,n,s,r){if(e<0)return $e(n,-e,s,r);if(n=_e(n,s,!1,!0,r),0==e)return n;var o=typeof r!==t&&typeof r.workingDayStart!==t?r.workingDayStart:s.visibleDayStart,l=typeof r!==t&&typeof r.workingDayFinish!==t?r.workingDayFinish:s.visibleDayFinish,m=L(n);if(m-e>o)return new Date(n.valueOf()-e);for(m-=o,n=new Date(n.valueOf()-m),e-=m;e>0;){if(n=L(n)<864e5?_e(S(n),s,!1,!0,r):_e(we(S(n)),s,!1,!0,r),l-e>o)return new Date(n.valueOf()-e);m=l-o,n=new Date(n.valueOf()-m),e-=m}return new Date(n.valueOf())},ti=function(e,n,s,r,o){return Ne(e,n,r,o)/Ne(e,s,r,o)},gi=function(e,n,s,r,o){return $e(e,n*Ne(e,s,r,o),r,o)},Kt=function(e){for(var n=0,s=(e=Ct(e),0);s<e.length;s++)n+=e[s].value;return 0==n&&(n=1),n},Ci=function(e){if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)){for(var n=0,s=(e=e.children,0);s<e.length;s++)n+=Ci(e[s]);return n}return e.ganttChartView.getItemEffort(e)*Kt(e)},vi=function(e){if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)){for(var n=0,s=(e=e.children,0);s<e.length;s++)n+=vi(e[s]);return n}return e.ganttChartView.getItemCompletedEffort(e)*Kt(e)},ce=function(e){if(e.schedule)return e.schedule;if(e.scheduleChartItem)return e.scheduleChartItem.schedule;var n=Ct(e);if(n){for(var r,s=-1/0,o=0;o<n.length;o++){var l=n[o];l.value>s&&(r=l.key,s=l.value)}if((e=e.ganttChartView)&&e.settings&&e.settings.resourceSchedules)return(r=ot(e.settings.resourceSchedules,r))<0||!e.settings.resourceSchedules[r]?void 0:e.settings.resourceSchedules[r].value}},wi=function(e,n,s,r,o,l,m,d,u,p,f){function v(Y,_){p.isDuringTimeDragOperation=!0,p.draggingItem=o,p.dragType="Start",p.style.cursor=e.style.cursor,p.draggingInitialX=Y.clientX,p.draggingInitialStartPosition=l,p.draggingInitialFinishPosition=m,p.draggingInitialCompletedFinishPosition=d,DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((g=DlhSoft.Controls.ToolTip.get(e))||(g=DlhSoft.Controls.ToolTip.initialize(void 0,e,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+f.border+"; background-color: White; color: Black; font-family: "+(f.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),g.setContent(f.dateTimeFormatter(h(o.start))+" \u2013 "+f.dateTimeFormatter(h(o.finish))),g.show(),g.originalX=g.x,p.toolTip=g)}var g;if(e.addEventListener("mousedown",se(p,e,"mousedown",function(Y){0==Y.button&&(v(Y),Y.preventDefault())},!0),!0),e.addEventListener("touchstart",se(p,e,"touchstart",function(Y){v(Y.touches[0],!0),Y.preventDefault(),Y.target.addEventListener("touchmove",se(p,Y.target,"touchmove",o.touchMoveHandler)),Y.target.addEventListener("touchend",se(p,Y.target,"touchend",o.touchEndHandler))},!0),!0),e.addEventListener("touchend",se(p,e,"touchend",function(){De(e,"mouseover"),De(e,"mousedown"),setTimeout(function(){De(e,"mouseout")},2e3)},!0),!0),null!=n){var I=function(Y,_){p.isDuringTimeDragOperation=!0,p.draggingItem=o,p.dragType="StartOnly",p.style.cursor=e.style.cursor,p.draggingInitialX=Y.clientX,p.draggingInitialStartPosition=l,DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((g=DlhSoft.Controls.ToolTip.get(n))||(g=DlhSoft.Controls.ToolTip.initialize(void 0,n,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+f.border+"; background-color: White; color: Black; font-family: "+(f.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),g.setContent(f.dateTimeFormatter(h(o.start))+" \u2013"),g.show(),g.setHorizontalPosition(g.x+4),g.originalX=g.x,p.toolTip=g)};n.addEventListener("mousedown",se(p,n,"mousedown",function(Y){0==Y.button&&(I(Y),Y.preventDefault())},!0),!0),n.addEventListener("touchstart",se(p,n,"touchstart",function(Y){I(Y.touches[0],!0),Y.preventDefault(),Y.target.addEventListener("touchmove",se(p,Y.target,"touchmove",o.touchMoveHandler)),Y.target.addEventListener("touchend",se(p,Y.target,"touchend",o.touchEndHandler))},!0),!0)}if(null!=s){var A=function(Y,_){p.isDuringTimeDragOperation=!0,p.draggingItem=o,p.dragType="Finish",p.style.cursor=s.style.cursor,p.draggingInitialX=Y.clientX,p.draggingInitialFinishPosition=m,DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((g=DlhSoft.Controls.ToolTip.get(s))||(g=DlhSoft.Controls.ToolTip.initialize(void 0,s,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+f.border+"; background-color: White; color: Black; font-family: "+(f.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),g.setContent("\u2013 "+f.dateTimeFormatter(h(o.finish))),g.show(),g.setHorizontalPosition(g.x-g.contentContainer.clientWidth),g.originalX=g.x,p.toolTip=g)};s.addEventListener("mousedown",se(p,s,"mousedown",function(Y){0==Y.button&&(A(Y),Y.preventDefault())},!0),!0),s.addEventListener("touchstart",se(p,s,"touchstart",function(Y){A(Y.touches[0],!0),Y.preventDefault(),Y.target.addEventListener("touchmove",se(p,Y.target,"touchmove",o.touchMoveHandler)),Y.target.addEventListener("touchend",se(p,Y.target,"touchend",o.touchEndHandler))},!0),!0)}if(null!=r){var V=function(Y,_){if(p.isDuringTimeDragOperation=!0,p.draggingItem=o,p.dragType="CompletedFinish",p.style.cursor=r.style.cursor,p.draggingInitialX=Y.clientX,p.draggingInitialCompletedFinishPosition=d,DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_){(g=DlhSoft.Controls.ToolTip.get(r))||(g=DlhSoft.Controls.ToolTip.initialize(void 0,r,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+f.border+"; background-color: White; color: Black; font-family: "+(f.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."));var ne=ti(o.start,o.completedFinish,o.finish,f,ce(o));isNaN(ne)||(g.setContent(Math.round(100*ne*(f.integralCompletionPercents?1:100))/(f.integralCompletionPercents?1:100)+"%"),g.show(),g.setHorizontalPosition(g.x+2),g.originalX=g.x,p.toolTip=g)}};if(!f.classic){var W=function(){if(typeof p.temporaryHoveringCompletedFinishThumb!==t){var Y=p.temporaryHoveringCompletedFinishThumb;if(delete p.temporaryHoveringCompletedFinishThumb,typeof Y.childNodes[0].originalClass===t&&typeof Y.childNodes[0].originalStyle===t)return;Y.childNodes[0].setAttribute("class",Y.childNodes[0].originalClass),Y.childNodes[0].setAttribute("style",Y.childNodes[0].originalStyle),delete Y.childNodes[0].originalClass,delete Y.childNodes[0].originalStyle}p.draggingItem||o.finish.valueOf()==o.start.valueOf()||(o.temporaryThumb=r,p.temporaryHoveringCompletedFinishThumb=r,r.childNodes[0].originalClass=r.childNodes[0].getAttribute("class"),r.childNodes[0].originalStyle=r.childNodes[0].getAttribute("style"),typeof f.completedBarThumbClass!==t&&r.childNodes[0].setAttribute("class",f.completedBarThumbClass),(typeof f.completedBarThumbClass!==t||typeof f.completedBarThumbStyle!==t)&&r.childNodes[0].setAttribute("style",f.completedBarThumbStyle),r.style.cursor="ew-resize")},R=function(){if(typeof p.temporaryHoveringCompletedFinishThumb!==t){var Y=p.temporaryHoveringCompletedFinishThumb;Y==o.temporaryThumb&&(delete p.temporaryHoveringCompletedFinishThumb,typeof Y.childNodes[0].originalClass===t&&typeof Y.childNodes[0].originalStyle===t||(Y.childNodes[0].setAttribute("class",Y.childNodes[0].originalClass),Y.childNodes[0].setAttribute("style",Y.childNodes[0].originalStyle),delete Y.childNodes[0].originalClass,delete Y.childNodes[0].originalStyle))}};e.addEventListener("mouseover",se(p,e,"mouseover",W,!0),!0),r.addEventListener("mouseover",se(p,r,"mouseover",W,!0),!0),e.addEventListener("mouseout",se(p,e,"mouseout",R,!0),!0),r.addEventListener("mouseout",se(p,r,"mouseout",R,!0),!0)}r.addEventListener("mousedown",se(p,r,"mousedown",function(Y){0==Y.button&&(V(Y),Y.preventDefault())},!0),!0),r.addEventListener("touchstart",se(p,r,"touchstart",function(Y){V(Y.touches[0],!0),Y.preventDefault(),Y.target.addEventListener("touchmove",se(p,Y.target,"touchmove",o.touchMoveHandler)),Y.target.addEventListener("touchend",se(p,Y.target,"touchend",o.touchEndHandler))},!0),!0)}for(typeof p.draggableItems===t&&(p.draggableItems=[]),W=!1,R=0;R<p.draggableItems.length;R++)if(p.draggableItems[R]==o){W=!0;break}if(!W){var j=function(Y,_){if(typeof p.draggingItem!==t&&p.draggingItem==o&&("Start"==p.dragType||"StartOnly"==p.dragType||"Finish"==p.dragType||"CompletedFinish"==p.dragType)){var de,Te,ne=Y.clientX-p.draggingInitialX;ji(Y.clientX,p),delete p.draggingItem,p.draggingInitialStartPosition+ne<0&&(ne=-p.draggingInitialStartPosition),"Start"==p.dragType||"StartOnly"==p.dragType?("StartOnly"!=p.dragType&&(de=Ne(o.start,o.finish,f,ce(o))),Te=Ne(o.start,o.completedFinish,f,ce(o)),ne=_e(K(te(p.draggingInitialStartPosition+ne,f),f),f,!0,o.isMilestone,ce(o)),"StartOnly"==p.dragType&&ne>o.finish&&(ne=o.finish),o.start=ne,o.preferredStart=o.start,le(o,"start",!0,!1),"StartOnly"!=p.dragType?(o.isMilestone?(o.finish=o.start,le(o,"finish",!1,!1),o.completedFinish=o.start):(o.finish=$e(o.start,de,f,ce(o)),le(o,"finish",!1,!1),o.completedFinish=$e(o.start,Te,f,ce(o))),le(o,"completedFinish",!1,!1),DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((g=p.toolTip).setContent(f.dateTimeFormatter(h(o.start))+" \u2013 "+f.dateTimeFormatter(h(o.finish))),g.setHorizontalPosition(g.originalX+(q(o.start,f)-p.draggingInitialStartPosition)))):(o.finish<o.start&&(o.finish=o.start,le(o,"finish",!1,!1)),(o.completedFinish<o.start||Te<=0)&&(o.completedFinish=o.start,le(o,"completedFinish",!1,!1)),DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((g=p.toolTip).setContent(f.dateTimeFormatter(h(o.start))+" \u2013"),g.setHorizontalPosition(g.originalX+(q(o.start,f)-p.draggingInitialStartPosition)))),Jt(o,u,p.chartContent,f)):"Finish"==p.dragType?((ne=_e(K(te(p.draggingInitialFinishPosition+ne,f),f),f,o.isMilestone,!0,ce(o)))<o.start&&(ne=o.start),ne.valueOf()!=o.finish.valueOf()&&(o.finish=ne,le(o,"finish",!0,!1)),o.completedFinish>ne&&(o.completedFinish=ne,le(o,"completedFinish",!1,!1)),DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((g=p.toolTip).setContent("\u2013 "+f.dateTimeFormatter(h(o.finish))),g.setHorizontalPosition(g.originalX+(q(o.finish,f)-p.draggingInitialFinishPosition))),Jt(o,u,p.chartContent,f)):"CompletedFinish"==p.dragType&&(f.percentBasedCompletionBar?o.start.valueOf()!=o.finish.valueOf()&&(de=q(o.start,f),Te=Math.max(q(o.finish,f),de+(f.classic?4:12)),ne=Math.max(0,Math.min(1,(p.draggingInitialCompletedFinishPosition+ne-de)/(Te-de))),(ne=gi(o.start,ne,o.finish,f)).valueOf()!=o.completedFinish.valueOf()&&(o.completedFinish=ne,le(o,"completedFinish",!0,!1))):((ne=_e(K(te(p.draggingInitialCompletedFinishPosition+ne,f),f),f,o.isMilestone,!0,ce(o)))<o.start&&(ne=o.start),ne>o.finish&&(ne=o.finish),ne.valueOf()!=o.completedFinish.valueOf()&&(o.completedFinish=ne,le(o,"completedFinish",!0,!1))),DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&(g=p.toolTip,ne=ti(o.start,o.completedFinish,o.finish,f,ce(o)),isNaN(ne)||(g.setContent(Math.round(100*ne*(f.integralCompletionPercents?1:100))/(f.integralCompletionPercents?1:100)+"%"),g.setHorizontalPosition(g.originalX+(q(o.completedFinish,f)-p.draggingInitialCompletedFinishPosition)))),Jt(o,u,p.chartContent,f)),p.draggingItem=o,p.draggingPerformed=!0}};p.addEventListener("mousemove",se(p,p,"mousemove",function(Y){j(Y)},!0),!0),p.addEventListener("touchmove",se(p,p,"touchmove",function(Y){j(Y.touches[0],!0)},!0),!0),o.touchMoveHandler=function(Y){j(Y.touches[0],!0)};var z=function(){if(typeof p.draggingItem!==t&&p.draggingItem==o&&("Start"==p.dragType||"StartOnly"==p.dragType||"Finish"==p.dragType||"CompletedFinish"==p.dragType)){delete p.isDuringTimeDragOperation;var Y=p.draggingItem;p.style.cursor="default",p.draggingPerformed&&("Start"==p.dragType||"StartOnly"==p.dragType?(le(Y,"start",!0,!0),le(Y,"finish",!1,!0),le(Y,"completedFinish",!1,!0)):"Finish"==p.dragType?(le(Y,"finish",!0,!0),le(Y,"completedFinish",!1,!0)):"CompletedFinish"==p.dragType&&le(Y,"completedFinish",!0,!0),delete p.draggingPerformed),delete p.draggingItem}};document.addEventListener("mouseup",se(p,document,"mouseup",function(Y){0==Y.button&&z()},!0),!0),document.addEventListener("touchend",se(p,document,"touchend",function(){z()},!0),!0),o.touchEndHandler=function(){z()},p.draggableItems.push(o)}},ii=function(e,n,s,r,o,l,m,d,u,p){function f(R,j){delete u.cancelDrag,u.draggingItem=r,u.dragType="Dependency",u.dragDependencyType="Finish",u.style.cursor=e.style.cursor,u.draggingInitialX=R.clientX,u.draggingInitialY=R.clientY,u.draggingInitialRightPosition=l,u.draggingInitialTopPosition=o,u.draggingInitialFinishPosition=l,u.draggingInitialThumbPosition=o,DlhSoft.Controls.ToolTip&&p.useUpdatingToolTips&&!j&&((toolTip=DlhSoft.Controls.ToolTip.get(e))||(toolTip=DlhSoft.Controls.ToolTip.initialize(void 0,e,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+p.border+"; background-color: White; color: Black; font-family: "+(p.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),toolTip.setContent(r.content+" \u2013"),toolTip.show(),toolTip.setPosition(toolTip.x+16,toolTip.y-8),toolTip.originalX=toolTip.x,toolTip.originalY=toolTip.y,u.toolTip=toolTip)}var v=r.ganttChartView.ownerDocument;if(u.temporaryHoveringThumb&&(u.temporaryHoveringThumb.originalClass||u.temporaryHoveringThumb.originalStyle)&&(u.temporaryHoveringThumb.setAttribute("class",u.temporaryHoveringThumb.originalClass),u.temporaryHoveringThumb.setAttribute("style",u.temporaryHoveringThumb.originalStyle),delete u.temporaryHoveringThumb.originalClass,delete u.temporaryHoveringThumb.originalStyle),null!=e&&(e.addEventListener("mousedown",se(u,e,"mousedown",function(R){0==R.button&&(f(R),R.preventDefault())},!0),!0),e.addEventListener("touchstart",se(u,e,"touchstart",function(R){f(R.touches[0],!0),R.preventDefault()},!0),!0)),null!=n){var g=function(R,j){delete u.cancelDrag,u.draggingItem=r,u.dragType="Dependency",u.dragDependencyType="Start",u.style.cursor=e.style.cursor,u.draggingInitialX=R.clientX,u.draggingInitialY=R.clientY,u.draggingInitialRightPosition=m,u.draggingInitialTopPosition=o,u.draggingInitialFinishPosition=m,u.draggingInitialThumbPosition=o,R.preventDefault(),DlhSoft.Controls.ToolTip&&p.useUpdatingToolTips&&!j&&((toolTip=DlhSoft.Controls.ToolTip.get(n))||(toolTip=DlhSoft.Controls.ToolTip.initialize(void 0,n,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+p.border+"; background-color: White; color: Black; font-family: "+(p.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),toolTip.setContent(r.content+" \u2013"),toolTip.show(),toolTip.setPosition(toolTip.x+16,toolTip.y-8),toolTip.originalX=toolTip.x,toolTip.originalY=toolTip.y,u.toolTip=toolTip)};n.addEventListener("mousedown",se(u,n,"mousedown",function(R){0==R.button&&(g(R),R.preventDefault())},!0),!0),n.addEventListener("touchstart",se(u,n,"touchstart",function(R){g(R.touches[0],!0),R.preventDefault()},!0),!0)}e?.addEventListener("mouseover",se(u,e,"mouseover",function(){if(p.classic&&typeof u.temporaryHoveringThumb!==t){var R=u.temporaryHoveringThumb;if(delete u.temporaryHoveringThumb,typeof R.originalClass===t&&typeof R.originalStyle===t)return;R.setAttribute("class",R.originalClass),R.setAttribute("style",R.originalStyle),delete R.originalClass,delete R.originalStyle}typeof u.temporaryDependencyLine!==t||e.originalStyle||(e.mouseOver=!0,u.temporaryHoveringThumb=e,e.originalClass=e.getAttribute("class"),e.originalStyle=e.getAttribute("style"),typeof p.dependencyPointerClass!==t&&e.setAttribute("class",p.dependencyPointerClass),(typeof p.dependencyPointerClass!==t||typeof p.dependencyPointerStyle!==t)&&e.setAttribute("style",p.dependencyPointerStyle),e.style.cursor="pointer",setTimeout(function(){De(e,"mouseout")},4e3))},!0),!0),n?.addEventListener("mouseover",se(u,n,"mouseover",function(){if(p.classic&&typeof u.temporaryHoveringThumb!==t){var R=u.temporaryHoveringThumb;if(delete u.temporaryHoveringThumb,typeof R.originalClass===t&&typeof R.originalStyle===t)return;R.setAttribute("class",R.originalClass),R.setAttribute("style",R.originalStyle),delete R.originalClass,delete R.originalStyle}typeof u.temporaryDependencyLine!==t||n.originalStyle||(n.mouseOver=!0,u.temporaryHoveringThumb=n,n.originalClass=n.getAttribute("class"),n.originalStyle=n.getAttribute("style"),typeof p.dependencyPointerClass!==t&&n.setAttribute("class",p.dependencyPointerClass),(typeof p.dependencyPointerClass!==t||typeof p.dependencyPointerStyle!==t)&&n.setAttribute("style",p.dependencyPointerStyle),n.style.cursor="pointer",setTimeout(function(){De(n,"mouseout")},4e3))},!0),!0),e?.addEventListener("mouseout",se(u,e,"mouseout",function(){delete e.mouseOver,setTimeout(function(){typeof e.originalClass===t&&typeof e.originalStyle===t||e.mouseOver||(e.setAttribute("class",e.originalClass),e.setAttribute("style",e.originalStyle),delete e.originalClass,delete e.originalStyle)},p.classic?250:0)},!0),!0),n?.addEventListener("mouseout",se(u,n,"mouseout",function(){delete n.mouseOver,setTimeout(function(){typeof n.originalClass===t&&typeof n.originalStyle===t||n.mouseOver||(n.setAttribute("class",n.originalClass),n.setAttribute("style",n.originalStyle),delete n.originalClass,delete n.originalStyle)},p.classic?250:0)},!0),!0),e?.addEventListener("touchend",se(u,e,"touchend",function(){De(e,"mouseover"),setTimeout(function(){De(e,"mouseout")},2e3)},!0),!0),n?.addEventListener("touchend",se(u,n,"touchend",function(){De(n,"mouseover"),setTimeout(function(){De(n,"mouseout")},2e3)},!0),!0),typeof u.draggableDependencyItems===t&&(u.draggableDependencyItems=[]);for(var I=!1,A=0;A<u.draggableDependencyItems.length;A++)if(u.draggableDependencyItems[A]==r){I=!0;break}if(!I){var V=function(R,j){if(typeof u.draggingItem!==t&&u.draggingItem==r&&"Dependency"==u.dragType){var z=R.clientX-u.draggingInitialX,Y=R.clientY-u.draggingInitialY;if(ji(R.clientX,u),en(R.clientY,u),delete u.draggingItem,u.draggingInitialFinishPosition+z<0&&(z=-u.draggingInitialFinishPosition),typeof u.temporaryInitDependencyLine!==t){try{s.removeChild(u.temporaryInitDependencyLine)}catch{}delete u.temporaryInitDependencyLine}if(typeof u.temporaryDependencyLine!==t){try{s.removeChild(u.temporaryDependencyLine)}catch{}delete u.temporaryDependencyLine}if(u.cancelDrag)delete u.cancelDrag,delete u.draggingItem,u.style.cursor="default";else if(p.classic||((_=v.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",u.draggingInitialRightPosition+("Start"==u.dragDependencyType?-8:8)*(r.isMilestone||r.hasChildren?2:1)),_.setAttribute("y1",u.draggingInitialTopPosition),_.setAttribute("x2",u.draggingInitialRightPosition),_.setAttribute("y2",u.draggingInitialTopPosition),typeof p.temporaryDependencyLineClass!==t&&_.setAttribute("class",p.temporaryDependencyLineClass),typeof p.temporaryDependencyLineStyle!==t&&_.setAttribute("style",p.temporaryDependencyLineStyle),_.style.markerEnd="none",u.temporaryInitDependencyLine=_,s.appendChild(_)),(_=v.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",u.draggingInitialRightPosition+(p.classic?0:("Start"==u.dragDependencyType?-8:8)*(r.isMilestone||r.hasChildren?2:1))),_.setAttribute("y1",u.draggingInitialTopPosition),_.setAttribute("x2",u.draggingInitialFinishPosition+z),_.setAttribute("y2",u.draggingInitialThumbPosition+Y),typeof p.temporaryDependencyLineClass!==t&&_.setAttribute("class",p.temporaryDependencyLineClass),typeof p.temporaryDependencyLineStyle!==t&&_.setAttribute("style",p.temporaryDependencyLineStyle),u.temporaryDependencyLine=_,s.appendChild(_),u.draggingItem=r,DlhSoft.Controls.ToolTip&&p.useUpdatingToolTips&&!j){toolTip=u.toolTip;for(var ne=Math.floor((r.itemTop+u.draggingInitialThumbPosition+Y)/p.itemHeight),_=null,de=0,Te=0;Te<d.length;Te++){var Se=d[Te];if(Se.isVisible&&(typeof Se.isHidden===t||!Se.isHidden)&&typeof Se.displayRowIndex===t){if(de==ne){_=Se;break}de++}}ne="Start",null!=_&&(de=u.draggingInitialFinishPosition+z,Te=q(_.start,p),Se=q(_.finish,p),(_.isMilestone||_.hasChildren&&(typeof _.isSummaryEnabled===t||_.isSummaryEnabled))&&(Te-=p.itemHeight/2,Se+=p.itemHeight/2),Se<Te+(p.classic?4:12)&&(Se=Te+(p.classic?4:12)),(de<Te||de>Se||w(_,r)||b(_,r)||b(r,_))&&(_=null),null!=_&&(typeof p.allowCreatingToFinishDependencies===t||p.allowCreatingToFinishDependencies)&&!_.isMilestone&&de>Te+3*(Se-Te)/4&&(ne="Finish")),null==r.scheduleChartView&&(toolTip.setContent(r.content+" \u2013"+(null!=_?" "+_.content+("Finish"!=ne?"":" \u2022"):"")),toolTip.setPosition(toolTip.originalX+z,toolTip.originalY+Y))}}};u.addEventListener("mousemove",se(u,u,"mousemove",function(R){V(R)},!0),!0),u.addEventListener("touchmove",se(u,u,"touchmove",function(R){V(R.touches[0],!0)},!0),!0);var W=function(R){if(typeof u.draggingItem!==t&&u.draggingItem==r&&"Dependency"==u.dragType){if(typeof u.temporaryInitDependencyLine!==t){try{s.removeChild(u.temporaryInitDependencyLine)}catch{}delete u.temporaryInitDependencyLine}if(typeof u.temporaryDependencyLine!==t){try{s.removeChild(u.temporaryDependencyLine)}catch{}delete u.temporaryDependencyLine}for(var j=Math.floor((r.itemTop+u.draggingInitialThumbPosition+(R.clientY-u.draggingInitialY))/p.itemHeight),z=null,Y=0,_=0;_<d.length;_++){var ne=d[_];if(ne.isVisible&&(typeof ne.isHidden===t||!ne.isHidden)&&typeof ne.displayRowIndex===t){if(Y==j){z=ne;break}Y++}}if(null!=z){if(R=u.draggingInitialFinishPosition+(R.clientX-u.draggingInitialX),z.scheduleChartView)for(_=0;_<z.ganttChartItems.length;_++)if(j=u.getChartPosition((ne=z.ganttChartItems[_]).start),Y=u.getChartPosition(ne.finish),ne.isMilestone&&(j-=p.itemHeight/2,Y+=p.itemHeight/2),R>=j&&R<=Y){z=ne;break}if(j=q(z.start,p),Y=q(z.finish,p),(z.isMilestone||z.hasChildren&&(typeof z.isSummaryEnabled===t||z.isSummaryEnabled))&&(j-=p.itemHeight/2,Y+=p.itemHeight/2),Y<j+(p.classic?4:12)&&(Y=j+(p.classic?4:12)),R>=j&&R<=Y)if(_=null==z||typeof p.allowCreatingToFinishDependencies!==t&&!p.allowCreatingToFinishDependencies||z.isMilestone||R<=j+3*(Y-j)/4?"Start":"Finish",w(z,r)||b(z,r)||b(r,z)||p.alwaysHandleInvalidDependencies&&Ot(r,z))p.invalidPredecessorDetectionHandler&&(ne={item:r},"Start"!=u.dragDependencyType?"Finish"==_&&(ne.dependencyType="FF"):ne.dependencyType="Finish"!=_?"SS":"SF",p.invalidPredecessorDetectionHandler(ne,z,r));else{var de,Te;delete r.successors,typeof z.predecessors===t&&(z.predecessors=[]),ne={item:r},"Start"!=u.dragDependencyType?"Finish"==_&&(ne.dependencyType="FF"):ne.dependencyType="Finish"!=_?"SS":"SF",z.predecessors.push(ne),le(z,"predecessors",!0,!0),z.start<r.finish&&!p.areTaskDependencyConstraintsEnabled&&!p.areTaskDependencyConstraintsDisabledWhenDropping&&(!z.isMilestone&&(!z.hasChildren||!(typeof z.isSummaryEnabled===t||z.isSummaryEnabled))&&(de=Ne(z.start,z.finish,p,ce(z)),Te=Ne(z.start,z.completedFinish,p,ce(z))),(!z.hasChildren||typeof z.isSummaryEnabled!==t&&!z.isSummaryEnabled)&&"Start"==_&&(z.start=_e(K("Start"!=u.dragDependencyType?r.finish:r.start,p),p,!0,z.isMilestone,ce(r)),le(z,"start",!1,!0),z.isMilestone?(z.finish=z.start,le(z,"finish",!1,!0),z.completedFinish=z.start):(z.finish=$e(z.start,de,p,ce(z)),le(z,"finish",!1,!0),z.completedFinish=$e(z.start,Te,p,ce(z))),le(z,"completedFinish",!1,!0))),Jt(z,d,u.chartContent,p),Jt(r,d,u.chartContent,p)}}delete u.draggingItem,u.style.cursor="default"}};v.addEventListener("mouseup",se(u,v,"mouseup",function(R){0==R.button&&W(R)},!0),!0),v.addEventListener("touchend",se(u,v,"touchend",function(R){W(R.changedTouches[0])},!0),!0),u.draggableDependencyItems.push(r)}},ji=function(e,n){var s=n.settings;if(typeof n.draggingItem!==t&&s.enableHorizontalScrollingDuringDragging){var r=new Date;if(!n.lastXDraggingTime||!(r>n.lastXDraggingTime&&r-n.lastXDraggingTime<50)){n.lastXDraggingTime=r;var o=0;if((r=n).offsetParent)do{o+=r.offsetLeft,r=r.offsetParent}while(r);(e-=o)<n.gridContentContainer.offsetWidth+s.horizontalScrollingDragAreaWidth?(r=n.chartContentContainer.scrollLeft,n.chartContentContainer.scrollLeft=n.chartContentContainer.scrollLeft-s.horizontalScrollingDragAmount,s=r-n.chartContentContainer.scrollLeft,typeof n.draggingInitialStartPosition!==t&&(n.draggingInitialStartPosition=n.draggingInitialStartPosition-s),typeof n.draggingInitialFinishPosition!==t&&(n.draggingInitialFinishPosition=n.draggingInitialFinishPosition-s),typeof n.draggingInitialCompletedFinishPosition!==t&&(n.draggingInitialCompletedFinishPosition=n.draggingInitialCompletedFinishPosition-s)):e>=n.gridContentContainer.offsetWidth+n.chartContentContainer.clientWidth-s.horizontalScrollingDragAreaWidth&&(r=n.chartContentContainer.scrollLeft,n.chartContentContainer.scrollLeft=n.chartContentContainer.scrollLeft+s.horizontalScrollingDragAmount,s=n.chartContentContainer.scrollLeft-r,typeof n.draggingInitialStartPosition!==t&&(n.draggingInitialStartPosition=n.draggingInitialStartPosition+s),typeof n.draggingInitialFinishPosition!==t&&(n.draggingInitialFinishPosition=n.draggingInitialFinishPosition+s),typeof n.draggingInitialCompletedFinishPosition!==t&&(n.draggingInitialCompletedFinishPosition=n.draggingInitialCompletedFinishPosition+s))}}},en=function(e,n){var s=n.settings;if(typeof n.draggingItem!==t&&s.enableVerticalScrollingDuringDragging){var o,r=new Date;if(!n.lastYDraggingTime||!(r>n.lastYDraggingTime&&r-n.lastYDraggingTime<50))n.lastYDraggingTime=r,e-=function(e){var n=0;if(e.offsetParent)do{n+=e.offsetTop,e=e.offsetParent}while(e);return n}(n),e>=n.chartHeaderContainer.clientHeight&&e<n.chartHeaderContainer.clientHeight+s.verticalScrollingDragAreaHeight?(o=n.chartContentContainer.scrollTop,n.chartContentContainer.scrollTop=n.chartContentContainer.scrollTop-s.verticalScrollingDragAmount,typeof n.isDuringVerticalScrolling===t&&(n.isDuringVerticalScrolling=!0,setTimeout(function(){n.draggingInitialThumbPosition=n.draggingInitialThumbPosition-(o-n.chartContentContainer.scrollTop),delete n.isDuringVerticalScrolling},0))):e>=n.chartHeaderContainer.clientHeight+n.chartContentContainer.clientHeight-s.verticalScrollingDragAreaHeight&&(o=n.chartContentContainer.scrollTop,n.chartContentContainer.scrollTop=n.chartContentContainer.scrollTop+s.verticalScrollingDragAmount,typeof n.isDuringVerticalScrolling===t&&(n.isDuringVerticalScrolling=!0,setTimeout(function(){n.draggingInitialThumbPosition=n.draggingInitialThumbPosition+(n.chartContentContainer.scrollTop-o),delete n.isDuringVerticalScrolling},0)))}},Jt=function(e,n,s,r){mt(e.chartPredecessorItems,e,r),yt(e.chartItem,e,r),Dt(n,e),setTimeout(function(){if(typeof e.gridItem!==t){if(typeof e.completedInput!==t){var o=e.completedInput;typeof o.changeEventListener!==t&&o.removeEventListener("change",o.changeEventListener,!0),delete e.completedInput}At(e.gridItem,e,n,r.columns,s,r.toggleButtonAreaWidth,r)}for(o=e.parent;null!=o;)c(o,!1),mt((e=o).chartPredecessorItems,e,r),yt(e.chartItem,e,r),Dt(n,e),typeof e.gridItem!==t&&At(e.gridItem,e,n,r.columns,s,r.toggleButtonAreaWidth,r),o=e.parent},0)},tn=function(e){var n=e.itemTop-e.ganttChartView.chartContentContainer.scrollTop;n<0?e.ganttChartView.chartContentContainer.scrollTop=e.itemTop:n>e.ganttChartView.chartContentContainer.clientHeight-e.ganttChartView.settings.itemHeight&&(e.ganttChartView.chartContentContainer.scrollTop=e.itemTop-(e.ganttChartView.chartContentContainer.clientHeight-e.ganttChartView.settings.itemHeight))},An=function(e,n,s,r,o,l,m,d,u,p,f,v,g,I){var A,V;n.addEventListener("scroll",se(e,n,"scroll",function(){m.scrollTop!=n.scrollTop&&!V&&(A=!0,setTimeout(function(){m.scrollTop=n.scrollTop,setTimeout(function(){A=!1},100)},200)),r.scrollLeft!=n.scrollLeft&&(r.scrollLeft=n.scrollLeft)},!0),!0),ni(n,s,o,I),typeof e.updateGridHeaderTimer!==t&&clearInterval(e.updateGridHeaderTimer),e.updateGridHeaderTimer=setInterval(function(){try{ni(n,s,o,I)}catch{try{clearInterval(e.updateGridHeaderTimer)}catch{}}},100),m.addEventListener("scroll",se(e,m,"scroll",function(){n.scrollTop!=m.scrollTop&&!A&&(V=!0,setTimeout(function(){n.scrollTop=m.scrollTop,setTimeout(function(){V=!1},100)},200)),d.scrollLeft!=m.scrollLeft&&(d.scrollLeft=m.scrollLeft),Pt(g,m,I),Yt(g,f,I),I.displayedTime=te(m.scrollLeft,I),(typeof e.isDuringScrollToDateTime===t||!e.isDuringScrollToDateTime)&&typeof I.displayedTimeChangeHandler!==t&&setTimeout(function(){I.displayedTimeChangeHandler(I.displayedTime)},0),typeof e.isDuringScrollToDateTime!==t&&delete e.isDuringScrollToDateTime},!0),!0),setTimeout(function(){d.scrollLeft!=m.scrollLeft&&(d.scrollLeft=m.scrollLeft),Pt(g,m,I)},1),ni(m,u,p,I),typeof e.updateChartHeaderTimer!==t&&clearInterval(e.updateChartHeaderTimer),e.updateChartHeaderTimer=setInterval(function(){try{ni(m,u,p,I)}catch{try{clearInterval(e.updateChartHeaderTimer)}catch{}}},100),window.addEventListener("mousewheel",se(e,window,"mousewheel",function(){try{e.cancelDrag=!0}catch{}},!0),!0)},ni=function(e,n,s,r){setTimeout(function(){try{var o=n.clientWidth-e.clientWidth;o<0&&(o=0);var l=o+"px";s.style.width!=l&&(s.style.width=l,o>0?(s.style.boxSizing="border-box",s.style.MozBoxSizing="border-box",s.style.border="solid 1px "+r.border,s.style.borderTop="none",s.style.borderRight="none"):(s.style.border="",s.style.borderTop="",s.style.borderRight="",s.style.boxSizing="",s.style.MozBoxSizing=""))}catch{}},0)},Wt=function(e,n,s){s.isSplitterEnabled&&(e.style.height=n.clientHeight+"px",e.style.left=Math.max(0,n.offsetWidth-1)+"px")},Pt=function(e,n,s){if((typeof n.isInitializing===t||!n.isInitializing)&&s.isVirtualizing)for(var r=n.scrollTop-s.itemHeight,o=(n=r+n.clientHeight+2*s.itemHeight,0);o<e.length;o++){var l=e[o];l.isPart||(l.scheduleChartItem&&l.scheduleChartItem!=l?(l.itemTop!=l.scheduleChartItem.itemTop||l.isVirtuallyVisible!=l.scheduleChartItem.isVirtuallyVisible)&&(l.itemTop=l.scheduleChartItem.itemTop,l.isVirtuallyVisible=l.scheduleChartItem.isVirtuallyVisible,l.isVirtuallyVisible&&(mt(l.chartPredecessorItems,l,s),yt(l.chartItem,l,s),l.chartItem.setAttribute("transform","translate(0, "+l.itemTop+")"),l.chartPredecessorItems.setAttribute("transform","translate(0, "+l.itemTop+")"),Lt(l,l.itemTop))):typeof l.isVirtuallyVisible===t&&(typeof l.isVisible===t||l.isVisible)&&(typeof l.isHidden===t||!l.isHidden)&&typeof l.itemTop!==t&&l.itemTop>=r&&l.itemTop<n?(l.isVirtuallyVisible=!0,le(l,"isVirtuallyVisible",!1,!0),typeof l.gridItem!==t&&At(l.gridItem,l,e,s.columns,l.ganttChartView.chartContent,s.toggleButtonAreaWidth,s),mt(l.chartPredecessorItems,l,s),yt(l.chartItem,l,s),l.chartItem.setAttribute("transform","translate(0, "+l.itemTop+")"),l.chartPredecessorItems.setAttribute("transform","translate(0, "+l.itemTop+")"),Lt(l,l.itemTop)):typeof l.isVirtuallyVisible!==t&&(typeof l.isVisible===t||l.isVisible)&&(typeof l.isHidden===t||!l.isHidden)&&typeof l.itemTop!==t&&(l.itemTop<r||l.itemTop>=n)&&delete l.isVirtuallyVisible)}},Ln=function(e,n){for(var s=e.childNodes.length;s-- >0;)e.removeChild(e.childNodes[s]);e.appendChild(n)},Ti=function(e,n,s,r){var o=r.indexOf(e);o<0||n<0||n==o||n>=r.length||(r.splice(o,1),r.splice(n,0,e),nn(r),ke(s),typeof s.settings.itemMoveHandler!==t&&s.settings.itemMoveHandler(e,o,n))},ri=function(e,n,s,r,o){if(!(e<0||s<0||s==e||s>o.length-n)){var m,l=[];for(m=e;m<e+n;m++)l.push(o[m]);for(o.splice(e,n),m=0;m<l.length;m++)o.splice(s+m,0,l[m]);if(nn(o),ke(r),typeof r.settings.itemMoveHandler!==t)for(m=0;m<l.length;m++)r.settings.itemMoveHandler(l[m],e+m,s+m)}},nn=function(e){for(var n=0,s=0;s<e.length;s++){var r=e[s];r.indentation>n&&(r.indentation=n,le(r,"indentation",!1,!0)),n=r.indentation+1}},Fn=function(e,n){for(var s in n)0!=s.indexOf("custom")&&0!=s.indexOf("description")||typeof e[s]===t&&(e[s]=n[s])},rn=function(e,n,s,r,o,l,m,d,u,p,f,v,g,I,A,V){var W,j,R=[];if(typeof r!==t)for(W=0;W<r.length;W++)R.push({isTreeView:(j=V.columns[r[W]]).isTreeView,header:j.header,width:j.width,headerClass:j.headerClass,headerStyle:j.headerStyle,cellClass:j.cellClass,cellStyle:j.cellStyle,cellTemplate:typeof j.exportCellTemplate!==t?j.exportCellTemplate:j.cellTemplate});else for(W=0;W<V.columns.length;W++)(j=V.columns[W]).isSelection||R.push({isTreeView:j.isTreeView,header:j.header,width:j.width,headerClass:j.headerClass,headerStyle:j.headerStyle,cellClass:j.cellClass,cellStyle:j.cellStyle,cellTemplate:typeof j.exportCellTemplate!==t?j.exportCellTemplate:j.cellTemplate});typeof s===t&&(s=V.isGridVisible),W=s?ft(R)+1:0,typeof o!==t?(typeof m===t||!m)&&(o=new Date(o.valueOf()-6e4*o.getTimezoneOffset())):o=V.timelineStart,typeof l!==t?(typeof m===t||!m)&&(l=new Date(l.valueOf()-6e4*l.getTimezoneOffset())):l=V.timelineFinish,(o={isExport:!0,isReadOnly:!0,selectionMode:"None",isVirtualizing:!1,isGridVisible:s,isSplitterEnabled:!1,gridWidth:W+"px",columns:R,allowUserToResizeColumns:!1,isGridRowClickTimeScrollingEnabled:!1,isMouseWheelZoomEnabled:!1,timelineStart:o,timelineFinish:l,extendTimelineToEntireWeeks:V.extendTimelineToEntireWeeks,hourWidth:typeof d!==t?d:V.hourWidth,displayedTime:typeof o!==t?o:V.timelineStart,currentTime:V.currentTime,isTaskToolTipVisible:!1,isDependencyToolTipVisible:!1,containerClass:V.containerClass,containerStyle:V.containerStyle,border:V.border,theme:V.theme,headerBackground:V.headerBackground,headerHeight:V.headerHeight,itemHeight:V.itemHeight,itemClass:V.itemClass,itemStyle:V.itemStyle,standardItemClass:V.standardItemClass,summaryItemClass:V.summaryItemClass,milestoneItemClass:V.milestoneItemClass,standardItemStyle:V.standardItemStyle,summaryItemStyle:V.summaryItemStyle,milestoneItemStyle:V.milestoneItemStyle,indentationLevelWidth:V.indentationLevelWidth,toggleButtonClass:V.toggleButtonClass,toggleButtonStyle:V.toggleButtonStyle,scales:[],visibleWeekStart:V.visibleWeekStart,visibleWeekFinish:V.visibleWeekFinish,workingWeekStart:V.workingWeekStart,workingWeekFinish:V.workingWeekFinish,visibleDayStart:V.visibleDayStart,visibleDayFinish:V.visibleDayFinish,specialNonworkingDays:V.specialNonworkingDays,barMargin:V.barMargin,barHeight:V.barHeight,barCornerRadius:V.barCornerRadius,completedBarMargin:V.completedBarMargin,completedBarHeight:V.completedBarHeight,completedBarCornerRadius:V.completedBarCornerRadius,standardBarClass:V.standardBarClass,summaryBarClass:V.summaryBarClass,milestoneBarClass:V.milestoneBarClass,standardBarStyle:V.standardBarStyle,summaryBarStyle:V.summaryBarStyle,milestoneBarStyle:V.milestoneBarStyle,standardCompletedBarClass:V.standardCompletedBarClass,standardCompletedBarStyle:V.standardCompletedBarStyle,summaryCompletedBarClass:V.summaryCompletedBarClass,summaryCompletedBarStyle:V.summaryCompletedBarStyle,dependencyLineClass:V.dependencyLineClass,dependencyLineStyle:V.dependencyLineStyle,assignmentsClass:V.assignmentsClass,assignmentsStyle:V.assignmentsStyle,areTaskAssignmentsVisible:V.areTaskAssignmentsVisible,isTaskCompletedEffortVisible:V.isTaskCompletedEffortVisible,areTaskDependenciesVisible:V.areTaskDependenciesVisible,areDependencyConstraintsAppliedOnStartedTasks:V.areDependencyConstraintsAppliedOnMilestones,areDependencyConstraintsAppliedOnMilestones:V.areDependencyConstraintsAppliedOnMilestones,isBaselineVisible:V.isBaselineVisible,areStandardTaskLabelsVisible:V.areStandardTaskLabelsVisible,areSummaryTaskLabelsVisible:V.areSummaryTaskLabelsVisible,areMilestoneTaskLabelsVisible:V.areMilestoneTaskLabelsVisible,areResourceImagesVisibleAsAssignments:V.areResourceImagesVisibleAsAssignments,resourceImageUrls:V.resourceImageUrls,standardLabelColor:V.standardLabelColor,summaryLabelColor:V.summaryLabelColor,milestoneLabelColor:V.milestoneLabelColor,standardLabelClass:V.standardLabelClass,standardLabelStyle:V.standardLabelStyle,summaryLabelClass:V.summaryLabelClass,summaryLabelStyle:V.summaryLabelStyle,milestoneLabelClass:V.milestoneLabelClass,milestoneLabelStyle:V.milestoneLabelStyle,arrowSize:V.arrowSize,arrowFill:V.arrowFill,alternativeItemClass:V.alternativeItemClass,alternativeChartItemClass:V.alternativeChartItemClass,alternativeItemStyle:V.alternativeItemStyle,alternativeChartItemStyle:V.alternativeChartItemStyle,gridLines:V.gridLines,horizontalGridLines:V.horizontalGridLines,verticalGridLines:V.verticalGridLines,verticalGridHeaderLines:V.verticalGridHeaderLines,horizontalChartLines:V.horizontalChartLines,isIndividualItemNonworkingTimeHighlighted:V.isIndividualItemNonworkingTimeHighlighted,areTaskInterruptionsHighlighted:V.areTaskInterruptionsHighlighted,isBaselineVisible:V.isBaselineVisible,taskInitiationCost:V.taskInitiationCost,defaultResourceUsageCost:V.defaultResourceUsageCost,specificResourceUsageCosts:V.specificResourceUsageCosts,defaultResourceHourCost:V.defaultResourceHourCost,specificResourceHourCosts:V.specificResourceHourCosts,target:V.target,months:V.months,daysOfWeek:V.daysOfWeek,weekStartDay:V.weekStartDay,dateFormatter:V.dateFormatter,dateTimeFormatter:V.dateTimeFormatter,isRelativeToTimezone:V.isRelativeToTimezone,standardTaskTemplate:V.standardTaskTemplate,summaryTaskTemplate:V.summaryTaskTemplate,milestoneTaskTemplate:V.milestoneTaskTemplate,assignmentsTemplate:V.assignmentsTemplate,dependencyLineTemplate:V.dependencyLineTemplate,styleDefinitionTemplate:V.styleDefinitionTemplate,classic:V.classic}).extendTimelineToEntireWeeks&&(o.timelineStart=U(o.timelineStart,o.weekStartDay),o.timelineFinish=J(o.timelineFinish,o.weekStartDay)),l=q(o.timelineFinish,o),o.chartWidth=l+"px";var z=W+l+2+(s?1:0);for(W=0;W<V.scales.length;W++)o.scales.push({scaleType:(s=V.scales[W]).scaleType,isHeaderVisible:s.isHeaderVisible,headerHeight:s.headerHeight,headerTextFormat:s.headerTextFormat,headerClass:s.headerClass,headerStyle:s.headerStyle,isHighlightingVisible:s.isHighlightingVisible,highlightingClass:s.highlightingClass,highlightingStyle:s.highlightingStyle,isSeparatorVisible:s.isSeparatorVisible,separatorClass:s.separatorClass,separatorStyle:s.separatorStyle,intervals:s.intervals});var Y,_,ne=!1;if(null!=f&&typeof f.createElement!==t)Y=f;else{null!=f&&typeof f.focus!==t?_=f:(_=window.open("",f??"_blank",typeof v!==t&&v&&(typeof I===t||I)?"width=800,height=480,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),ne=!0),Y=_.document;try{var de=document.head.getElementsByTagName("link");for(W=0;W<de.length;W++){var Te=de[W],Se=Y.adoptNode(Te.cloneNode(!0));Se.href=Te.href,Y.head.appendChild(Se)}}catch{}}for(Y.title=typeof e!==t?e:"Exported chart"+(typeof v!==t&&v?" (printable)":""),typeof u===t&&(u=0),typeof p===t&&(p=A.length-1),e=[],W=de=0;W<A.length;W++)typeof(f=A[W]).displayRowIndex!==t&&(f.displayRowIndex<u||f.displayRowIndex>p)||typeof f.displayRowIndex===t&&(de++<u||de>p+1)||(V={content:f.content,label:f.label,indentation:f.indentation,start:f.start,finish:f.finish,completedFinish:f.completedFinish,isMilestone:f.isMilestone,schedule:ce(f),assignmentsContent:f.assignmentsContent,baselineStart:f.baselineStart,baselineFinish:f.baselineFinish,isBarVisible:f.isBarVisible,isRelativeToTimezone:f.isRelativeToTimezone,class:f.class,style:f.style,barClass:f.barClass,standardBarClass:f.standardBarClass,standardCompletedBarClass:f.standardCompletedBarClass,summaryBarClass:f.summaryBarClass,milestoneBarClass:f.milestoneBarClass,baselineBarClass:f.baselineBarClass,barStyle:f.barStyle,standardBarStyle:f.standardBarStyle,standardCompletedBarStyle:f.standardCompletedBarStyle,summaryBarStyle:f.summaryBarStyle,milestoneBarStyle:f.milestoneBarStyle,baselineBarStyle:f.baselineBarStyle,labelColor:f.labelColor,labelClass:f.labelClass,labelStyle:f.labelStyle,isSummaryEnabled:f.isSummaryEnabled,isParentSummarizationEnabled:f.isParentSummarizationEnabled,isHidden:f.isHidden,isExported:!0,tag:f},typeof f.displayRowIndex!==t&&(V.displayRowIndex=f.displayRowIndex-u),Fn(V,f),e.push(V),f.exportItem=V);for(W=0;W<A.length;W++)if((typeof(f=A[W]).displayRowIndex===t||!(f.displayRowIndex<u||f.displayRowIndex>p))&&(V=f.exportItem)&&typeof f.predecessors!==t)for(V.predecessors=[],de=0;de<f.predecessors.length;de++)typeof(Te=f.predecessors[de]).item.displayRowIndex!==t&&(Te.item.displayRowIndex<u||Te.item.displayRowIndex>p)||V.predecessors.push({item:Te.item.exportItem,dependencyType:Te.dependencyType,lag:Te.lag,dependencyLineClass:Te.dependencyLineClass,dependencyLineStyle:Te.dependencyLineStyle});var Re=Y.createElement("p");Re.innerHTML=typeof n!==t?n:"",Y.body.appendChild(Re);var it=Y.createElement("div");it.setAttribute("style","width: "+z+"px");try{DlhSoft.Controls.GanttChartView.initialize(it,e,o,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch{}setTimeout(function(){ne&&Y.body.setAttribute("style","margin: 0px");var Oe=Y.createElement("div");Oe.appendChild(it),Y.body.replaceChild(Oe,Re),g&&(Oe.setAttribute("style","width: "+it.offsetHeight+"px; height: "+z+"px; overflow: hidden"),Oe=Math.round((it.offsetWidth-it.offsetHeight)/2),it.setAttribute("style","width: "+z+"px; transform: rotate(90deg) translateX("+Oe+"px) translateY("+Oe+"px); -webkit-transform: rotate(90deg) translateX("+Oe+"px) translateY("+Oe+"px)")),Y.close(),void 0!==typeof _&&(_.focus(),typeof v!==t&&v&&setTimeout(function(){_.print(),(typeof I===t||I)&&setTimeout(function(){_.close()})}))},0)},sn=function(e){var n=Je;if(typeof e===t)return n;for(var s=0;s<e.length;s++){var r=e[s];(!r.hasChildren||typeof r.isSummaryEnabled!==t&&!r.isSummaryEnabled)&&r.start<n&&(n=r.start)}return new Date(n.valueOf())},Si=function(e){var n=Ge;if(typeof e===t)return n;for(var s=0;s<e.length;s++){var r=e[s];(!r.hasChildren||typeof r.isSummaryEnabled!==t&&!r.isSummaryEnabled)&&(typeof r.isMilestone!==t&&r.isMilestone?r.start>n&&(n=r.start):r.finish>n&&(n=r.finish))}return new Date(n.valueOf())},on=function(e,n){for(var s=0,r=0;r<e.length;r++){var o=e[r];null==o.parent&&(s+=gt(o,n))}return s},ln=function(e,n){for(var s=0,r=0;r<e.length;r++){var o=e[r];null==o.parent&&(s+=Mt(o,n))}return s},an=function(e,n){for(var s=[],r=0;r<n.length;r++){var o=n[r];if(o!=e&&typeof o.predecessors!==t&&0!=o.predecessors.length)for(var l=0;l<o.predecessors.length;l++)if(o.predecessors[l].item==e){s.push(o);break}}return s},si=function(e,n){for(var s=[],r=an(e,n),o=0;o<r.length;o++){var l=r[o];if(typeof l.predecessors!==t&&0!=l.predecessors.length)for(var m=0;m<l.predecessors.length;m++)l.predecessors[m].item==e&&s.push({successor:l,predecessor:l.predecessors[m]})}return s},oi=function(e,n,s,r,o){if(typeof n===t&&(n=0),o=o||Si(s),e.finish>=o)return!0;var l;if(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled){var m=e.successorPredecessors?e.successorPredecessors:si(e,s);for(l=0;l<m.length;l++){var d=m[l].successor;if(!r.areTaskDependencyConstraintsEnabled){for(var u=e,p=!0;u;){if(b(u,d)){p=!1;break}u=u.parent}if(!p)continue}if(((typeof(u=m[l].predecessor).dependencyType===t||""==u.dependencyType||"FinishStart"==u.dependencyType||"FS"==u.dependencyType)&&Ne(e.finish,d.start,r,ce(e))<=(u.lag?u.lag:0)+n||("StartStart"==u.dependencyType||"SS"==u.dependencyType)&&Ne(e.start,d.start,r,ce(e))<=(u.lag?u.lag:0)+n)&&oi(d,n,s,r,o))return!0}}else for(e=e.children,l=0;l<e.length;l++)if(oi(e[l],n,s,r,o))return!0;return!1},Di=function(e,n,s){for(var r=0;r<e.length;r++){var o=e[r];(!o.hasChildren||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled)&&typeof o.predecessors!==t&&null!=o.predecessors&&o.predecessors.length>0&&Ft(o,e,n,s)}},dn=function(e,o,l,r){o=new Date(o.valueOf()-6e4*o.getTimezoneOffset()),o=It(o,r,ce(e)),l=gt(e,r);var m=Mt(e,r);ki(e,o),li(e,l,r),ai(e,m,r),st(e)},un=function(e,n){for(var s=0,r=Ct(e),o=0;o<r.length;o++){var d,l=r[o],m=l.key;if(typeof n.specificResourceUsageCosts!==t&&(d=ot(n.specificResourceUsageCosts,m))>=0?s+=n.specificResourceUsageCosts[d].value*l.value:typeof n.defaultResourceUsageCost!==t&&(s+=n.defaultResourceUsageCost*l.value),!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled){var u=gt(e,n)/36e5;typeof n.specificResourceHourCosts!==t&&(d=ot(n.specificResourceHourCosts,m))>=0?s+=n.specificResourceHourCosts[d].value*u*l.value:typeof n.defaultResourceHourCost!==t&&(s+=n.defaultResourceHourCost*u*l.value)}}return s},bi=function(e,n){var s=(s=typeof n.taskInitiationCost!==t?n.taskInitiationCost:0)+un(e,n);if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled))for(var r=0;r<e.children.length;r++)s+=xi(e.children[r],n);return s},xi=function(e,n){return(typeof e.executionCost!==t?e.executionCost:0)+bi(e,n)},fn=function(e,n,s,r,o,l,m){if(typeof s!==t){typeof e===t&&(e=!1),typeof n===t&&(n=new Date),typeof l===t&&(l=!1),typeof m===t&&(m=!1),Di(s,r,o),o=[];var u,p,f,d=[],v=[];for(p=0;p<s.length;p++)if(!(u=s[p]).hasChildren||typeof u.isSummaryEnabled!==t&&!u.isSummaryEnabled){if(m){f=!1;for(var g=u;null!=g;){if(typeof g.predecessors!==t&&g.predecessors.length>0){f=!0;break}g=g.parent}if(!f)continue}o.push({key:u,value:Pn(u)}),g=l?[]:Ct(u);var I=[];for(f=0;f<g.length;f++){var A=g[f];A.value>0&&I.push(A)}d.push({key:u,value:I}),v.push(u)}for(s=[],l=o.length;l>0;){for(m=[],p=0;p<o.length;p++){for(u=o[p].key,f=!0,g=o[p].value,I=0;I<g.length;I++)if(ot(o,A=g[I])>=0&&m.indexOf(A)<0){f=!1;break}if(f){if(f=n,g=r,typeof(I=u).minStart!==t&&f<I.minStart&&(f=I.minStart),e||!zt(I))for(;null!=I;){if(typeof I.predecessors!==t)for(A=0;A<I.predecessors.length;A++){var V=I.predecessors[A];if(typeof V!==t)switch(typeof(W=V.dependencyType)===t&&(W="FinishStart"),W){case"":case"FinishStart":case"FS":(V=$e(V.item.finish,typeof V.lag===t?0:V.lag,g,ce(V.item)))>f&&(f=V);break;case"StartStart":case"SS":(V=$e(V.item.start,typeof V.lag===t?0:V.lag,g,ce(V.item)))>f&&(f=V)}}for(I=I.parent;null!=I&&typeof I.isSummaryEnabled!==t&&!I.isSummaryEnabled;)I=I.parent}var R;for(g=f,I=d[f=ot(d,u)].value,f=0;f<I.length;f++)if(A=I[f].value,(W=ot(s,R=I[f].key))>=0){if(V=1,typeof r.resourceQuantities!==t){var j=ot(r.resourceQuantities,R);j>=0&&(V=r.resourceQuantities[j].value)}for(previousAllocations=s[W].value,W=0;W<previousAllocations.length;W++)(R=previousAllocations[W].key)+A<=V||(j=previousAllocations[W].value)>g&&(g=j)}for((e||!zt(u))&&(g=It(g,r,ce(u)))!=u.start&&(f=gt(u,r),A=Mt(u,r),ki(u,g),li(u,f,r),ai(u,A,r)),V=u.finish,f=0;f<I.length;f++){A=I[f].value,(W=ot(s,R=I[f].key))<0?s.push({key:R,value:j=[]}):j=s[W].value;for(var Y,_,ne,z=[{key:A,value:V}],W=0;W<j.length;W++){R=j[W].key;var de=j[W].value;de>g&&(ne=de<V?de:V,(Y=ot(z,_=R+A))<0?z.push({key:_,value:ne}):ne>z[_]&&(z[Y].value=ne),z.push(de<V?{key:R+A,value:de}:{key:R+A,value:V}))}for(A=0;A<z.length;A++)ne=z[A].value,(Y=ot(j,_=z[A].key))<0?j.push({key:_,value:ne}):ne>j[Y].value&&(j[Y].value=ne)}m.push(u)}}for(p=0;p<m.length;p++)o.splice(ot(o,m[p]),1);if(o.length==l)break;l=o.length}for(p=0;p<v.length;p++)le(u=v[p],"start",!0,!0),le(u,"finish",!0,!0),le(u,"completedFinish",!0,!0),st(u)}},Pn=function(e){for(var n=[],s=(e=yi(e),0);s<e.length;s++)pn(e[s],n);return n},pn=function(e,n){if(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)n.indexOf(e)<0&&n.push(e);else for(var s=0;s<e.children.length;s++)pn(e.children[s],n)},zt=function(e){return!e.isMilestone&&e.completedFinish>e.start},gt=function(e,n){if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)){for(var s=0,r=e.children,o=0;o<r.length;o++)s+=gt(r[o],n);return s}return Ne(e.start,e.finish,n,ce(e))},Mt=function(e,n){if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)){for(var s=0,r=e.children,o=0;o<r.length;o++)s+=Mt(r[o],n);return s}return Ne(e.start,e.completedFinish,n,ce(e))},li=function(e,n,s){n=$e(e.start,n,s,ce(e)),e.finish=n,le(e,"finish",!1,!1),hn(e,!1)},ai=function(e,n,s){e.completedFinish=$e(e.start,n,s,ce(e)),le(e,"completedFinish",!1,!1)},ki=function(e,n){e.start=n,e.preferredStart=n,le(e,"start",!1,!1),hn(e,!1)},hn=function(e,n){for(var s=e.parent;null!=s;)c(s,n),s=(e=s).parent},cn=function(e,n,s){typeof s===t&&(s=!1);var r=e.parent,o=e.index;if(null==r){for(r=0;o-- >0;)0==(e=n[o]).indentation&&r++;return r+(s?0:1)}return cn(r,n)+"."+(r.children.indexOf(e)+(s?0:1))},Ct=function(e){var n;if(typeof(e=e.assignmentsContent)===t)n=[];else{e=e.split(",");for(var s=[],r=0;r<e.length;r++){var o=jt(e[r]),l=1,m=o.indexOf("["),d=o.lastIndexOf("]");if(m>=0&&d>=0){d=jt(o.substr(m+1,d-m-1)),o=jt(o.substr(0,m)),(m=d.indexOf("%"))>=0&&(d=jt(d.substr(0,m)));try{l=(n=parseFloat(d))/100}catch{l=1}}o.length<=0||((m=ot(s,o))<0?s.push({key:o,value:l}):s[m].value=s[m].value+l)}n=s}return n},mn=function(e){for(var n=[],s=(e=Ct(e),0);s<e.length;s++)n.push(e[s].key);return n},Nt=function(e,n){if(typeof n===t)return[];for(var s=[],r=0;r<n.length;r++){var o=n[r];if(!o.hasChildren||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled)for(var l=Ct(o),m=0;m<l.length;m++){var d=l[m];if(d.key==e){s.push({key:o,value:d.value});break}}}return s},Qt=function(e){if(typeof e===t)return[];for(var n=[],s=0;s<e.length;s++)if(!(r=e[s]).hasChildren||typeof r.isSummaryEnabled!==t&&!r.isSummaryEnabled)for(var r=mn(r),o=0;o<r.length;o++){var l=r[o];n.indexOf(l)<0&&n.push(l)}return n},yn=function(e,n){for(var s=[],r=Nt(e,n),o=0;o<r.length;o++){var l=r[o],m=l.key;if(!m.hasChildren||typeof m.isSummaryEnabled!==t&&!m.isSummaryEnabled)for(m=[{start:m.start,finish:m.finish}];m.length>0;){var d;if(d=m[0],m.splice(0,1),!(d.finish<=d.start))if(0==s.length)s.push({key:d,value:l.value});else{sn(n);for(var u=!1,p=0;p<s.length;p++){var f=s[p].key,v=s[p].value;if(!(d.start>=f.finish)){if(d.finish<=f.start){for(u=0;u<=p;u++)if(s[u].key.start>=d.start){s.splice(u,0,{key:d,value:l.value});break}u=!0;break}if(d.start<=f.start&&d.finish>=f.finish){s[p].value=v+l.value,d.start<f.start&&m.push({start:d.start,finish:f.start}),d.finish>f.finish&&m.push({start:f.finish,finish:d.finish}),u=!0;break}if(d.start>=f.start&&d.finish<=f.finish){s.splice(p,1),d.start>f.start&&s.splice(p++,0,{key:{start:f.start,finish:d.start},value:v}),s.splice(p++,0,{key:d,value:v+l.value}),d.finish<f.finish&&s.splice(p++,0,{key:{start:d.finish,finish:f.finish},value:v}),u=!0;break}if(d.start>=f.start&&d.finish>=f.finish){s.splice(p,1),d.start>f.start&&s.splice(p++,0,{key:{start:f.start,finish:d.start},value:v}),s.splice(p++,0,{key:{start:d.start,finish:f.finish},value:v+l.value}),d.finish>f.finish&&m.push({start:f.finish,finish:d.finish}),u=!0;break}if(d.start<=f.start&&d.finish<=f.finish){s.splice(p,1),d.start<f.start&&m.push({start:d.start,finish:f.start}),s.splice(p++,0,{key:{start:f.start,finish:d.finish},value:v+l.value}),d.finish<f.finish&&s.splice(p++,0,{key:{start:d.finish,finish:f.finish},value:v}),u=!0;break}}}u||s.push({key:d,value:l.value})}}}return s},Ii=function(e,n,s){for(var r=0;r<e.length;r++){var o=e[r];if(o.key==n){if((n=o.value).indexOf(s)>=0)return!0;for(r=0;r<n.length;r++)if(Ii(e,n[r],s))return!0;break}}return!1},Bt=function(e){var n=e.content;return null==e.parent?n:n+" ("+Bt(e.parent)+")"},qt=function(e,n){return e==n||null!=e.parent&&qt(e.parent,n)},jt=function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},ot=function(e,n){for(var s=0;s<e.length;s++)if(e[s].key==n)return s;return-1},gn=function(e){return typeof e!==t?new Date(e.valueOf()+6e4*e.getTimezoneOffset()):e},Cn=function(e){return typeof e!==t?new Date(e.valueOf()-6e4*e.getTimezoneOffset()):e},Mn=function(e,n,s){var r;for(r=0;r<n.length;r++)n[r].ganttChartView=e;for(r=0;r<n.length;r++){var o=n[r];if(typeof o.parts!==t){typeof o.isGroup===t&&(o.isGroup=!0,o.isSummaryEnabled=!1),Ce(o.parts,s),(o.isGroup||typeof o.isBarVisible===t)&&(o.isBarVisible=!1);for(var l=0;l<o.parts.length;l++){var m=o.parts[l];m.ganttChartView=o.ganttChartView,m.ganttChartItem=o,m.isPart=!0,m.isVirtuallyVisible=!0,(o.isGroup||typeof m.indentation===t)&&(m.indentation=0),(o.isGroup||typeof m.displayRowIndex===t)&&(m.displayRowIndex=-1),m.isInternallyHidden=!0,n.indexOf(m)>=0||n.splice(n.length,0,m)}}}e.items=n,e.settings=s,e.refresh=function(){ke(e)},e.refreshItems=function(){Zt(n)},e.refreshGridItems=function(){for(var d=0;d<n.length;d++)Ut(n[d])},e.refreshChartItems=function(){for(var d=0;d<n.length;d++)bt(n[d])},e.refreshGridItem=Ut,e.refreshChartItem=bt,e.refreshItem=xt,e.refreshPredecessorItems=kt,e.refreshItemGraph=Rt,e.refreshItemPath=st,e.refreshItemNeighbourhood=function(d){_t(d,n,e,s)},e.refreshCurrentTimeLine=function(){var f,d=e.chartHeader,u=e.chartContent,p=u.chartArea,v=[];for(f=p.childNodes.length;f-- >1;){var g=p.childNodes[f];"Scale-Highlighting-CurrentTime"!=g.tag&&"Scale-Separator-CurrentTime"!=g.tag&&v.push(g),p.removeChild(g)}for(ie(d,p,s.scales,s,!0),f=v.length;f-- >0;)p.appendChild(v[f]);Ht(u,Et(n,s))},e.setCurrentTime=function(d){s.currentTime=d,e.refreshCurrentTimeLine()},e.updateCurrentTime=function(){var d=new Date;d=new Date(d.valueOf()-6e4*d.getTimezoneOffset()),e.setCurrentTime(d)},e.getCurrentItem=function(){return e.currentItem},e.getSelectedItem=function(){return e.selectedItem},e.getSelectedItems=function(){return e.selectedItems},e.selectItem=function(d){X(d,!0,s.selectionMode)},e.unselectItem=function(d){X(d,!1,s.selectionMode)},e.expandItem=function(d){vt(d,!0,!0)},e.collapseItem=function(d){vt(d,!1,!0)},e.scrollToItem=tn,e.scrollToBottom=function(){e.chartContentContainer.scrollTop=e.chartContent.clientHeight},e.scrollToDateTime=function(d){e.isDuringScrollToDateTime=!0,e.chartContentContainer.scrollLeft=q(d,e.settings)},e.increaseTimelinePage=function(d){s.timelineStart=new Date(s.timelineStart.valueOf()+d),s.timelineFinish=new Date(s.timelineFinish.valueOf()+d),ke(e)},e.decreaseTimelinePage=function(d){s.timelineStart=new Date(s.timelineStart.valueOf()-d),s.timelineFinish=new Date(s.timelineFinish.valueOf()-d),ke(e)},e.setSplitterPosition=function(v){var u=e.gridContainer,p=e.chartContainer,f=e.splitter;v=Math.ceil(1e6*v/e.offsetWidth)/1e4,typeof u.percent!==t&&delete u.percent,u.style.width=v+"%",p.style.width=100-v+"%",Wt(f,u,s)},e.getChartPosition=function(d){return q(d,s)},e.getChartWidth=function(){return q(s.timelineFinish,s)},e.getDateTime=function(d){return te(d,s)},e.getWorkingTime=function(d){return qi(d,s)},e.getStartWorkingTime=function(d){return It(d,s)},e.getFinishWorkingTime=function(d){return _e(d,s,!1,!0,void 0)},e.getEffort=function(d,u){return Ne(d,u,s)},e.getFinish=function(d,u){return $e(d,u,s)},e.getStart=function(d,u){return $t(d,u,s)},e.getCompletion=function(d,u,p){return ti(d,u,p,s)},e.getCompletedFinish=function(d,u,p){return gi(d,u,p,s)},e.getItemsHeight=function(){return Et(n,s)},e.getItemTop=function(d){return Vt(d,n,s)},e.onItemPropertyChanged=le,e.initializeTaskDraggingThumbs=function(d,u,p,f,v,g,I,A){wi(d,u,p,f,v,g,I,A,e.items,e,e.settings)},e.initializeDependencyDraggingThumbs=function(d,u,p,f,v,g,I){ii(d,u,p,f,v,g,I,e.items,e,e.settings)},e.insertItem=function(d,u){Wi(d,u,e,n,s)},e.addItem=function(d){e.insertItem(n.length,d)},e.insertItems=function(d,u){for(var p=0;p<u.length;p++)e.insertItem(d++,u[p])},e.addItems=function(d){for(var u=0;u<d.length;u++)e.addItem(d[u])},e.removeItem=function(d){zi(d,e,n,s)},e.removeItems=function(d){for(var u=0;u<d.length;u++)e.removeItem(d[u])},e.increaseItemIndentation=function(d){var u=d.index>0?e.items[d.index-1]:null;if(!(null==u||d.indentation>u.indentation)){if(vt(d,!0,!1,!0),d.indentation++,le(d,"indentation",!0,!0),d.predecessors&&d.predecessors.length>0){for(var p=!1,f=0;f<d.predecessors.length;f++)d.predecessors[f].item==u&&d.indentation>u.indentation&&(d.predecessors.splice(f--,1),p=!0);p&&le(d,"predecessors",!1,!0)}for(p=0;p<n.length;p++)if((f=n[p])==u&&typeof f.predecessors!==t&&0!=f.predecessors.length)for(var v=0;v<f.predecessors.length;v++)f.predecessors[v].item==d&&u.indentation>f.predecessors[v].item.indentation&&(f.predecessors.splice(v--,1),le(f,"predecessors",!1,!0),xt(f),kt(f));for(ei(n,s)&&Zt(n),_t(d,n,e,s);null!=d;)d.isExpanded||vt(d,!0,!1),d=d.parent}},e.decreaseItemIndentation=function(d){var u=d.index<e.items.length-1?e.items[d.index+1]:null;if(!(d.indentation<=0||null!=u&&d.indentation<u.indentation)){if(d.indentation--,le(d,"indentation",!0,!0),u&&d.predecessors&&d.predecessors.length>0){for(var p=!1,f=0;f<d.predecessors.length;f++)d.predecessors[f].item==u&&d.indentation<u.indentation&&(d.predecessors.splice(f--,1),p=!0);p&&le(d,"predecessors",!1,!0)}for(p=0;p<n.length;p++)if((f=n[p])==u&&typeof f.predecessors!==t&&0!=f.predecessors.length)for(var v=0;v<f.predecessors.length;v++)f.predecessors[v].item==d&&u.indentation<f.predecessors[v].item.indentation&&(f.predecessors.splice(v--,1),le(f,"predecessors",!1,!0),xt(f),kt(f));for(ei(n,s)&&Zt(n),_t(d,n,e,s);null!=d;)d.isExpanded||vt(d,!0,!1),d=d.parent}},e.setItemContent=function(d,u){d.content=u,le(d,"content",!0,!0)},e.setItemStart=function(d,u){d.start=It(u,s,ce(d)),d.preferredStart=d.start,le(d,"start",!0,!0),d.completedFinish<d.start&&(d.completedFinish=d.start,le(d,"completedFinish",!1,!0))},e.setItemFinish=function(d,u){var p;p=ce(d),p=_e(u,s,!1,!0,p),d.finish=p,le(d,"finish",!0,!0),d.completedFinish>d.finish&&(d.completedFinish=d.finish,le(d,"completedFinish",!1,!0))},e.setItemIsMilestone=function(d,u){d.isMilestone=u,le(d,"isMilestone",!0,!0)},e.getItemEffort=function(d){return gt(d,s)},e.setItemEffort=function(d,u){d.finish=$e(d.start,u,s,ce(d)),le(d,"finish",!0,!0),d.completedFinish>d.finish&&(d.completedFinish=d.finish,le(d,"completedFinish",!1,!0))},e.getItemTotalEffort=function(d){return Ci(d)},e.setItemTotalEffort=function(d,u){d.ganttChartView.setItemEffort(d,u/Kt(d))},e.setItemHasFixedEffort=function(d,u){d.hasFixedEffort=u,!d.hasChildren&&d.hasFixedEffort&&(d.fixedEffort=gt(d,s),d.fixedEffortAssignments=Ct(d))},e.getItemDuration=function(d){return Ne(d.start,d.finish,s,ce(d))},e.setItemDuration=e.setItemEffort,e.getItemCompletedEffort=function(d){return Mt(d,s)},e.setItemCompletedEffort=function(d,u){d.completedFinish=$e(d.start,u,s,ce(d)),d.completedFinish>d.finish&&(d.completedFinish=d.finish),le(d,"completedFinish",!0,!0)},e.getItemTotalCompletedEffort=function(d){return vi(d)},e.setItemTotalCompletedEffort=function(d,u){d.ganttChartView.setItemCompletedEffort(d,u/Kt(d))},e.getItemCompletion=function(d){return e.getItemCompletedEffort(d)/e.getItemEffort(d)},e.setItemCompletion=function(d,u){e.setItemCompletedEffort(d,u*e.getItemEffort(d))},e.isItemCompleted=function(d){return e.getItemCompletion(d)>=1||(d.isMilestone||d.finish.valueOf()<=d.start.valueOf())&&typeof d.isSetAsCompleted!==t&&d.isSetAsCompleted},e.setItemAsCompleted=function(d){(d.isMilestone||d.finish.valueOf()<=d.start.valueOf())&&(d.isSetAsCompleted=!0),e.setItemCompletion(d,1)},e.hasItemStarted=function(d){return zt(d)},e.setItemAsNotStarted=function(d){(d.isMilestone||d.finish.valueOf()<=d.start.valueOf())&&(d.isSetAsCompleted=!1),e.setItemCompletion(d,0)},e.isItemOnSchedule=function(d){var u=new Date;return u=new Date(u.valueOf()-6e4*u.getTimezoneOffset()),d.completedFinish>=u},e.setItemAssignmentsContent=function(d,u){d.assignmentsContent=u,le(d,"assignmentsContent",!0,!0)},e.getItemPredecessorsString=function(d,u){var p=u;typeof p===t&&(p=!1);var f="";if(typeof d.predecessors!==t&&0!=d.predecessors.length)for(var v=0;v<d.predecessors.length;v++){var g=d.predecessors[v],I=n.indexOf(g.item);I<0||(f.length>0&&(f+=", "),f+=I+(p?0:1),typeof g.dependencyType!==t&&""!=g.dependencyType&&"FinishStart"!=g.dependencyType&&"FS"!=g.dependencyType&&("StartStart"==g.dependencyType||"SS"==g.dependencyType?f+="SS":"FinishFinish"==g.dependencyType||"FF"==g.dependencyType?f+="FF":("StartFinish"==g.dependencyType||"SF"==g.dependencyType)&&(f+="SF")),typeof g.lag!==t&&0!=g.lag&&(g.lag>0&&(f+="+"),f+=g.lag/36e5))}return f},e.setItemPredecessorsString=function(d,u,p){typeof p===t&&(p=!1);var f=[];d.predecessors=f,u=u.split(",");for(var v=0;v<u.length;v++)if(!((g=jt(u[v])).length<=0)){for(var I=0;I<g.length&&g.charCodeAt(I)>=48&&g.charCodeAt(I)<=57;)I++;var A=g.substr(0,I);if(A=parseInt(A)-(p?0:1),!(isNaN(A)||A<0||A>=n.length||(A=n[A],w(d,A)||b(d,A)||b(A,d)))){I=(g=g.substr(I)).indexOf("+");var g,W=g.indexOf("-"),V=I>=0?I:W>=0?W:-1;if(W=0,V>=0){var R=parseFloat(g.substr(V+1));isNaN(R)||(W=R*(I>=0?1:-1)*36e5)}g=(V<0?g:g.substr(0,V)).toUpperCase(),f.push({item:A,dependencyType:g,lag:W})}}for(p=0;p<n.length;p++)delete n[p].successors;le(d,"predecessors",!0,!0)},e.getItemIndexString=function(d,u){return typeof u===t&&(u=!1),typeof d.index!==t?(d.index+(u?0:1)).toString():""},e.getItemWbsIndexString=function(d,u){return cn(d,n,u).toString()},e.moveRange=function(d,u,p){ri(d,u,p,e,n)},e.moveItem=function(d,u){Ti(d,u,e,n)},e.moveItemUp=function(d){var u=n.indexOf(d);u<=0||Ti(d,u-1,e,n)},e.moveItemDown=function(d){var u=n.indexOf(d);u<0||u>=n.length-1||Ti(d,u+1,e,n)},e.moveItemHierarchy=function(d,u){for(var p=n.indexOf(d),f=p+1;f<n.length&&!(n[f].indentation<=d.indentation);f++);ri(p,f-p,u,e,n)},e.moveItemHierarchyUp=function(d){for(var u=n.indexOf(d),p=u+1;p<n.length&&!(n[p].indentation<=d.indentation);p++);for(var f=u;f-- >0;){if(n[f].indentation<d.indentation)return;if(n[f].indentation==d.indentation)break}ri(u,p-u,f,e,n)},e.moveItemHierarchyDown=function(d){for(var u=n.indexOf(d),p=u+1;p<n.length&&!(n[p].indentation<=d.indentation);p++);for(var f=u+(p-=u);f++<n.length-1&&!(n[f].indentation<=d.indentation););n[f-1].indentation<d.indentation||ri(u,p,f-p,e,n)},e.exportContent=function(d,u){typeof d===t&&(d={}),rn(d.title,d.preparingMessage,d.isGridVisible,d.columnIndexes,d.timelineStart,d.timelineFinish,d.isRelativeToTimezone,d.hourWidth,d.startRowIndex,d.endRowIndex,u,!1,d.rotate,!1,n,s)},e.print=function(d){typeof d===t&&(d={}),rn(d.title,d.preparingMessage,d.isGridVisible,d.columnIndexes,d.timelineStart,d.timelineFinish,d.isRelativeToTimezone,d.hourWidth,d.startRowIndex,d.endRowIndex,null,!0,d.rotate,d.autoClose,n,s)},e.getRootItems=function(){for(var d=[],u=0;u<n.length;u++){var p=n[u];null==p.parent&&d.push(p)}return d},e.getLeafItems=function(){for(var d=[],u=0;u<n.length;u++){var p=n[u];null!=p.parent&&d.push(p)}return d},e.getSummaryItems=function(){for(var d=[],u=0;u<n.length;u++){var p=n[u];p.hasChildren&&d.push(p)}return d},e.getProjectStart=function(){return sn(n)},e.getProjectFinish=function(){return Si(n)},e.getProjectEffort=function(){return on(n,s)},e.getProjectTotalEffort=function(){for(var d=0,u=0;u<n.length;u++){var p=n[u];null==p.parent&&(d+=Ci(p))}return d},e.getProjectCompletedEffort=function(){return ln(n,s)},e.getProjectTotalCompletedEffort=function(){for(var d=0,u=0;u<n.length;u++){var p=n[u];null==p.parent&&(d+=vi(p))}return d},e.getProjectCompletion=function(){return ln(n,s)/on(n,s)},e.isItemCritical=function(d,u){return oi(d,u,n,s)},e.getCriticalItems=function(d,u){var p,f=u||n;if(typeof(p=d)===t&&(p=0),typeof f===t)p=void 0;else{for(var v=Si(f),g=0;g<f.length;g++){var I=f[g];I.successorPredecessors=si(I,f)}var A=[];for(g=0;g<f.length;g++)(!(I=f[g]).hasChildren||typeof I.isSummaryEnabled!==t&&!I.isSummaryEnabled)&&oi(I,p,f,s,v)&&A.push(I);for(g=0;g<f.length;g++)delete(I=f[g]).successorPredecessors;p=A}return p},e.getPertCriticalItems=function(d,u){return function(e,n,s,r){if(typeof n!==t)return n=e.getNetworkDiagramItems(r,void 0,void 0,n),e=e.ownerDocument.createElement("div"),DlhSoft.Controls.Pert.NetworkDiagramView.initialize(e,n,void 0,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),e.getCriticalItems().filter(function(o){return o.tag}).map(function(o){return o.tag})}(e,u||n,0,d)},e.ensureDependencyConstraints=function(){Di(n,s,e)},e.setupBaseline=function(){for(var d=0;d<n.length;d++){var u=n[d];!u.hasChildren||typeof u.isSummaryEnabled!==t&&!u.isSummaryEnabled?(u.baselineStart=u.start,u.isMilestone?delete u.baselineFinish:u.baselineFinish=u.finish):(delete u.baselineFinish,delete u.baselineStart),xt(u)}},e.rescheduleItemToStart=function(d,u){dn(d,u,n,s)},e.rescheduleItemToFinish=function(d,u){var v=u,p=(v=new Date(v.valueOf()-6e4*v.getTimezoneOffset()),gt(d,s)),f=Mt(d,s);v=$t(p,v,s,ce(d)),v=It(v,s,ce(d)),ki(d,v),li(d,p,s),ai(d,f,s),st(d)},e.splitRemainingWork=function(d,u,p){if(typeof n===t||d.hasChildren||d.isMilestone||!zt(d)||!d.isMilestone&&d.completedFinish>=d.finish)d=null;else{var f=n.indexOf(d);if(f<0)d=null;else{for(u={content:typeof u===t?d.content:d.content+u,indentation:d.indentation,isExpanded:d.isExpanded,start:d.completedFinish,finish:d.finish,assignmentsContent:d.assignmentsContent,isReadOnly:d.isReadOnly,isHidden:d.isHidden,isBarVisible:d.isBarVisible,isBarReadOnly:d.isBarReadOnly,isSummaryEnabled:d.isSummaryEnabled,isParentSummarizationEnabled:d.isParentSummarizationEnabled,displayRowIndex:d.displayRowIndex,class:d.class,style:d.style,barClass:d.barClass,standardBarClass:d.standardBarClass,summaryBarClass:d.summaryBarClass,milestoneBarClass:d.milestoneBarClass,baselineBarClass:d.baselineBarClass,barStyle:d.barStyle,standardBarStyle:d.standardBarStyle,summaryBarStyle:d.summaryBarStyle,milestoneBarStyle:d.milestoneBarStyle,baselineBarStyle:d.baselineBarStyle,taskTemplate:d.taskTemplate,template:d.template,tag:d.tag},typeof p!==t&&(d.content=d.content+p),d.finish=d.completedFinish,Wi(f+1,u,e,n,s),p=si(d,n),f=0;f<p.length;f++){var v=p[f].predecessor;(typeof v.dependencyType===t||""==v.dependencyType||"FinishStart"==v.dependencyType||"FS"==v.dependencyType||"FinishFinish"==v.dependencyType||"FF"==v.dependencyType)&&(v.item=u)}u.predecessors=[{item:d}],kt(d),kt(u),d=u}}return d},e.optimizeWork=function(d,u,p,f){var v;if(typeof d===t&&(d=!1),typeof u===t&&(u=!1),typeof p===t&&(p=new Date),f)fn(u,p,n,s,e,!0,d);else{for(p=new Date(p.valueOf()+6e4*p.getTimezoneOffset()),v=[],f=0;f<n.length;f++){var g=n[f];if((!g.hasChildren||typeof g.isSummaryEnabled!==t&&!g.isSummaryEnabled)&&!(g.start<=p||!u&&zt(g))){if(d){for(var I=!1,A=g;null!=A;){if(typeof A.predecessors!==t&&A.predecessors.length>0){I=!0;break}A=A.parent}if(!I)continue}dn(g,p,n,s),v.push(g)}}for(Di(n,s,e),f=0;f<v.length;f++)le(d=v[f],"start",!0,!0),le(d,"finish",!0,!0),le(d,"completedFinish",!0,!0),st(d);v=void 0}return v},e.levelAllocations=function(d){d||(d=e.items),d.length||(d=[d]);for(var u=0;u<d.length;u++){var f,p=d[u],v="",g=Ct(p);if(g&&g.length>0){var I=0;for(f=0;f<g.length;f++)I+=g[f].value;if(I>0){for(f=0;f<g.length;f++)v.length>0&&(v+=", "),v+=g[f].key+(g.length>1?" ["+Math.round(g[f].value/I*1e4)/100+"%]":"");p.assignmentsContent=v,le(p,"assignmentsContent",!1,!0),st(p)}}}},e.levelResources=function(d,u){return fn(d,u,n,s,e)},e.getItemSuccessors=function(d){return an(d,n)},e.getItemSuccessorPredecessorItems=function(d){return si(d,n)},e.getItemAllocationUnits=Kt,e.getItemAssignments=Ct,e.getItemAssignedResources=mn,e.getResourceAssignments=function(d){return Nt(d,n)},e.getResourceAssignedItems=function(d){for(var u=[],p=(d=Nt(d,n),0);p<d.length;p++)u.push(d[p].key);return u},e.getAssignedResources=function(){return Qt(n)},e.getItemAssignmentsCost=function(d){return un(d,s)},e.getItemExtraCost=function(d){return bi(d,s)},e.getItemCost=function(d){return xi(d,s)},e.setItemCost=function(d,u){d.executionCost=u-bi(d,s),le(d,"executionCost",!0,!0)},e.getResourceCost=function(d){for(var u=0,p=(d=Nt(d,n),0);p<d.length;p++){var v,f=d[p];typeof s.specificResourceUsageCosts!==t&&(v=ot(s.specificResourceUsageCosts,resource))>=0?u+=s.specificResourceUsageCosts[v].value*f.value:typeof s.defaultResourceUsageCost!==t&&(u+=s.defaultResourceUsageCost*f.value);var g=f.key;(!g.hasChildren||typeof g.isSummaryEnabled!==t&&!g.isSummaryEnabled)&&(g=gt(g,s)/36e5,typeof s.specificResourceHourCosts!==t&&(v=ot(s.specificResourceHourCosts,resource))>=0?u+=s.specificResourceHourCosts[v].value*g*f.value:typeof s.defaultResourceHourCost!==t&&(u+=s.defaultResourceHourCost*g*f.value))}return u},e.getProjectCost=function(){for(var d=0,u=0;u<n.length;u++){var p=n[u];null==p.parent&&(d+=xi(p,s))}return d},e.getScheduleChartItems=function(p){var f,g,u=[],v=(p=typeof p!==t?"array"==typeof p?p:[p]:typeof s.assignableResources!==t?s.assignableResources:[],Qt(n));for(g=0;g<v.length;g++)p.indexOf(f=v[g])<0&&p.push(f);for(g=0;g<p.length;g++){v={tag:f=p[g],content:f,ganttChartItems:[]},f=Nt(f,n);for(var I=0;I<f.length;I++){var A=(V=f[I]).key,V={tag:A,content:A.content,start:A.start,finish:A.finish,completedFinish:A.completedFinish,isMilestone:A.isMilestone,schedule:ce(A),assignmentsContent:1!=V.value?Math.round(1e4*V.value)/100+"%":"",minStart:A.minStart,maxStart:A.maxStart,minFinish:A.minFinish,maxFinish:A.maxFinish,isHidden:A.isHidden,isBarVisible:A.isBarVisible,isBarReadOnly:A.isBarReadOnly,isReadOnly:A.isReadOnly,isRelativeToTimezone:A.isRelativeToTimezone};v.ganttChartItems.push(V)}u.push(v)}return u},e.getAllocations=function(d){return yn(d,n)},e.getLoadChartItems=function(d){var u=[];typeof d===t?d=Qt(n):"array"!=typeof d&&(d=[d]);for(var p=0;p<d.length;p++){for(var f=d[p],v={tag:f,content:f,ganttChartItems:[]},g=yn(f,n),I=0;I<g.length;I++){var A=g[I],V=1;if(typeof s.resourceQuantities!==t){var W=ot(s.resourceQuantities,f);W>=0&&(V=s.resourceQuantities[W].value)}typeof(W=s.maxLoadChartDisplayedResourceQuantity)===t&&(W=100),V>W&&(V=W),v.ganttChartItems.push({start:A.key.start,finish:A.key.finish,units:A.value/V,content:Math.round(1e4*A.value)/100+"%",isRelativeToTimezone:!1})}u.push(v)}return u},e.getFilteredGanttChartItems=function(d){d=[d];for(var u=[],p=0;p<d.length;p++){var f=d[p],v=[];if(typeof d===t)d=Qt(n);else if("array"!=typeof d)var g=Nt(f,n);for(f=0;f<g.length;f++){var I=g[f].key;(!I.hasChildren||typeof I.isSummaryEnabled!==t&&!I.isSummaryEnabled)&&!(u.indexOf(I)>=0)&&(v.push({tag:I,content:I.content,start:I.start,finish:I.finish,completedFinish:I.completedFinish,isMilestone:I.isMilestone,assignmentsContent:d.length>1?I.assignmentsContent:1!=g[f].value?Math.round(1e4*g[f].value)/100+"%":"",minStart:I.minStart,maxStart:I.maxStart,minFinish:I.minFinish,maxFinish:I.maxFinish,isHidden:I.isHidden,isBarVisible:I.isBarVisible,isBarReadOnly:I.isBarReadOnly,isReadOnly:!0,isRelativeToTimezone:I.isRelativeToTimezone}),u.push(I))}}return v},e.copyCommonSettings=function(d){typeof d!==t&&(d.target=s.target,d.theme=s.theme,d.border=s.border,d.containerClass=s.containerClass,d.containerStyle=s.containerStyle,d.isGridVisible=s.isGridVisible,d.gridWidth=s.gridWidth,d.chartWidth=s.chartWidth,d.isSplitterEnabled=s.isSplitterEnabled,d.splitterWidth=s.splitterWidth,d.splitterBackground=s.splitterBackground,d.minGridWidth=s.minGridWidth,d.minChartWidth=s.minChartWidth,d.headerBackground=s.headerBackground,d.headerHeight=s.headerHeight,d.indentationLevelWidth=s.indentationLevelWidth,d.gridLines=s.gridLines,d.horizontalGridLines=s.horizontalGridLines,d.verticalGridLines=s.verticalGridLines,d.verticalGridHeaderLines=s.verticalGridHeaderLines,d.horizontalChartLines=s.horizontalChartLines,d.displayedTime=s.displayedTime,d.currentTime=s.currentTime,d.timelineStart=s.timelineStart,d.timelineFinish=s.timelineFinish,d.scales=s.scales,d.updateScale=s.updateScale,d.hourWidth=s.hourWidth,d.workingWeekStart=s.workingWeekStart,d.workingWeekFinish=s.workingWeekFinish,d.visibleDayStart=s.visibleDayStart,d.visibleDayFinish=s.visibleDayFinish,d.visibleWeekStart=s.visibleWeekStart,d.visibleWeekFinish=s.visibleWeekFinish,d.specialNonworkingDays=s.specialNonworkingDays,d.months=s.months,d.daysOfWeek=s.daysOfWeek,d.weekStartDay=s.weekStartDay,d.dateFormatter=s.dateFormatter,d.dateTimeFormatter=s.dateTimeFormatter,d.dateTimeParser=s.dateTimeParser,d.isRelativeToTimezone=s.isRelativeToTimezone,d.classic=s.classic)},e.getPertChartItems=function(W,u,p,f,j,g,I){var A=W,V=u,R=(W=p,j),z=(j=g,I||n);(typeof A===t||A<0)&&(A=Number.MAX_VALUE),typeof V===t&&(V="Start"),typeof W===t&&(W="Finish"),typeof R===t&&(R=" completed"),typeof j===t&&(j=" starting");var _,ne,de,Te,Y=new Date(new Date(1e4,0,1).valueOf()-1);for(I=[],g=[],u=0;u<z.length;u++)(p=z[u]).indentation<=A&&(!p.hasChildren||typeof p.isSummaryEnabled!==t&&!p.isSummaryEnabled&&(typeof p.isBarVisible===t||p.isBarVisible)||p.indentation==A)&&g.push({key:p,value:[]});for(u=0;u<g.length;u++){var Se=[p=g[u].key];if(p.indentation==A&&p.hasChildren&&(typeof p.isSummaryEnabled===t||p.isSummaryEnabled||typeof p.isBarVisible!==t&&!p.isBarVisible))for(_=0;_<z.length;_++)qt(ne=z[_],p)&&Se.push(ne);var Re=g[u].value;for(_=0;_<Se.length;_++)for(var it=Se[_];null!=it;){if(typeof it.predecessors!==t)for(de=0;de<it.predecessors.length;de++)if(typeof it.predecessors[de].item!==t&&(typeof it.predecessors[de].dependencyType===t||""==it.predecessors[de].dependencyType||"FinishStart"==it.predecessors[de].dependencyType||"FS"==it.predecessors[de].dependencyType)){for(var Oe=Te=it.predecessors[de].item;null!=Oe&&ot(g,Oe)<0;)Oe=Oe.parent;if(Oe!=p){var Tt=[];if(null!=Oe)Tt.push(Oe);else for(Oe=0;Oe<g.length;Oe++)qt(ne=g[Oe].key,Te)&&Tt.push(ne);for(Oe=0;Oe<Tt.length;Oe++)Re.indexOf(Te=Tt[Oe])<0&&(A<Number.MAX_VALUE&&Ii(g,Te,p)||Re.push(Te))}}it=it.parent}}for(Oe=0,de=_=null,u=0;u<z.length;u++)p=z[u],(null==_||p.start<_)&&(_=p.start),(null==de||p.finish>de)&&(de=p.finish);for(null==_&&(_=Y),V={content:V,displayedText:(Oe++).toString(),displayedRowIndex:0,displayedColumnIndex:0},I.push(V),z=[V],A=[],u=0;u<g.length;u++)0==g[u].value.length&&A.push(g[u].key);if(A.length>0){for(z=[],u=0;u<A.length;u++)p=A[u],de=V,Y=(Oe++).toString(),p.start>_&&(de={content:null!=p.content?p.content.toString()+j:null,displayedText:Y,predecessors:[]},I.push(de),de.predecessors.push({item:V,content:f,isEffortVirtual:!0})),z.push(Y={content:p.content+R,displayedText:Y+(de!=V?"'":""),predecessors:[],tag:p}),I.push(Y),Y.predecessors.push({item:de,content:Bt(p),displayedText:null!=p.content?p.content.toString():null,effort:Ne(p.start,p.finish,s,ce(p)),tag:p});do{for(Se=[],u=0;u<z.length;u++)Se.push(z[u]);for(p=!1,u=0;u<z.length;u++){for(Y=(A=z[u]).tag,Re=[],_=0;_<g.length;_++)g[_].value.indexOf(Y)>=0&&Re.push(g[_].key);if(Re.length>0){for(Se.splice(Se.indexOf(A),1),_=0;_<Re.length;_++){for(p=Re[_],Y=null,de=0;de<I.length;de++)if(I[de].tag==p){Y=I[de];break}null==Y&&(Y={content:p.content+R,displayedText:(Oe++).toString(),predecessors:[],tag:p},Se.push(Y),I.push(Y)),Y.predecessors.push({item:A,content:Bt(p),displayedText:null!=p.content?p.content.toString():null,effort:Ne(p.start,p.finish,s,ce(p)),tag:p})}p=!0}}z=Se}while(p)}for(p={content:W,displayedText:(Oe++).toString(),predecessors:[],displayedRowIndex:0},I.push(p),p=p.predecessors,u=0;u<z.length;u++)p.push({item:z[u]});for(_=0;_<g.length;_++){for(p=g[_].key,A=null,de=0;de<I.length;de++)if(I[de].tag==p){A=I[de];break}if(null!=A){if(u=[],typeof A.predecessors!==t)for(de=0;de<A.predecessors.length;de++)A.predecessors[de].tag==p&&u.push(A.predecessors[de]);if(u.length>1){for(R={content:null!=p.content?p.content.toString()+j:null,displayedText:A.displayedText,predecessors:[]},I.splice(I.indexOf(A),0,R),Oe=R.predecessors,de=0;de<u.length;de++)A.predecessors.splice(A.predecessors.indexOf(W=u[de]),1),Oe.push({item:W.item,content:f,isEffortVirtual:!0});A.predecessors.push({item:R,content:Bt(p),displayedText:null!=p.content?p.content.toString():null,effort:Ne(p.start,p.finish,s,ce(p)),tag:p}),A.displayedText=A.displayedText+"'"}else 1==u.length&&null!=(u=(W=u[0]).item.tag)&&p.start>It(u.finish,s)&&(de={content:null!=p.content?p.content.toString()+j:null,displayedText:A.displayedText,predecessors:[]},I.splice(I.indexOf(A),0,de),de.predecessors.push({item:W.item,content:f,isEffortVirtual:!0}),A.predecessors.splice(0,A.predecessors.length),A.predecessors.push({item:de,content:Bt(p),displayedText:null!=p.content?p.content.toString():null,effort:Ne(p.start,p.finish,s,ce(p)),tag:p}),A.displayedText=A.displayedText+"'")}}for(u=0;u<g.length;u++)if(g[u].key.isMilestone){for(p=g[u].key,A=null,de=0;de<I.length;de++)if(I[de].tag==p){A=I[de];break}if(null!=A&&typeof A.predecessors!==t&&1==A.predecessors.length&&(W=A.predecessors[0]).item!=V&&W.tag==p){for(A.predecessors.splice(0,1),Y=W.item,de=0;de<Y.predecessors.length;de++)W.item.predecessors.splice(W.item.predecessors.indexOf(f=Y.predecessors[de]),1),A.predecessors.push(f);for(de=0;de<I.length;de++)if((f=I[de]).predecessors)for(Oe=0;Oe<f.predecessors.length;Oe++)(j=f.predecessors[Oe]).item==Y&&(j.item=A);A.content=null!=p.content?p.content.toString():null,A.displayedText=A.displayedText.replace("'",""),I.splice(I.indexOf(Y),1)}}return I},e.getNetworkDiagramItems=function(d,u,p,f){var v=d,g=u,I=p,A=f||n;(typeof v===t||v<0)&&(v=Number.MAX_VALUE),typeof g===t&&(g="Start"),typeof I===t&&(I="Finish"),f=new Date(1900,0,1),p=new Date(new Date(1e4,0,1).valueOf()-1),u=[];var V,W,R,j,z,Y,_=[];for(d=0;d<A.length;d++)(V=A[d]).indentation<=v&&(!V.hasChildren||typeof V.isSummaryEnabled!==t&&!V.isSummaryEnabled&&(typeof V.isBarVisible===t||V.isBarVisible)||V.indentation==v)&&_.push({key:V,value:[]});for(d=0;d<_.length;d++){if(z=[V=_[d].key],V.indentation==v&&V.hasChildren&&(typeof V.isSummaryEnabled===t||V.isSummaryEnabled||typeof V.isBarVisible!==t&&!V.isBarVisible))for(W=0;W<A.length;W++)qt(R=A[W],V)&&z.push(R);var ne=_[d].value;for(W=0;W<z.length;W++)for(var de=z[W];null!=de;){if(typeof de.predecessors!==t)for(j=0;j<de.predecessors.length;j++)if(typeof de.predecessors[j].item!==t&&(typeof de.predecessors[j].dependencyType===t||""==de.predecessors[j].dependencyType||"FinishStart"==de.predecessors[j].dependencyType||"FS"==de.predecessors[j].dependencyType)){for(R=Y=de.predecessors[j].item;null!=R&&ot(_,R)<0;)R=R.parent;if(R!=V){var Te=[];if(null!=R)Te.push(R);else for(var Se=0;Se<_.length;Se++)qt(R=_[Se].key,Y)&&Te.push(R);for(Y=0;Y<Te.length;Y++)ne.indexOf(R=Te[Y])<0&&(v<Number.MAX_VALUE&&Ii(_,R,V)||ne.push(R))}}de=de.parent}}for(Y=W=null,d=0;d<A.length;d++)V=A[d],(null==W||V.start<W)&&(W=V.start),(null==Y||V.finish>Y)&&(Y=V.finish);for(null==W&&(W=p),null==Y&&(Y=f),u.push(g={content:g,displayedText:g,earlyStart:W,earlyFinish:W,lateStart:p,lateFinish:p,isMilestone:!0,effort:0,displayedRowIndex:0,displayedColumnIndex:0}),v=[g],W=[],d=0;d<_.length;d++)0==_[d].value.length&&W.push(_[d].key);if(W.length>0){for(v=[],d=0;d<W.length;d++)j={content:Bt(V=W[d]),displayedText:V.content,earlyStart:f,earlyFinish:f,lateStart:p,lateFinish:p,effort:Ne(V.start,V.finish,s,ce(V)),isMilestone:V.isMilestone,predecessors:[],tag:V},v.push(j),u.push(j),j.earlyStart=It(g.earlyFinish,s),j.earlyFinish=$e(j.earlyStart,j.effort,s),j.predecessors.push({item:g,tag:V});do{for(ne=[],d=0;d<v.length;d++)ne.push(v[d]);for(j=!1,d=0;d<v.length;d++){for(V=(A=v[d]).tag,de=[],W=0;W<_.length;W++)_[W].value.indexOf(V)>=0&&de.push(_[W].key);if(de.length>0){for(ne.splice(ne.indexOf(A),1),W=0;W<de.length;W++){for(V=de[W],z=null,j=0;j<u.length;j++)if(u[j].tag==V){z=u[j];break}null==z&&(z={content:Bt(V),displayedText:V.content,earlyStart:f,earlyFinish:f,lateStart:p,lateFinish:p,effort:Ne(V.start,V.finish,s,ce(V)),isMilestone:V.isMilestone,predecessors:[],tag:V},ne.push(z),u.push(z)),(j=It(A.earlyFinish,s))>z.earlyStart&&(z.earlyStart=j,z.earlyFinish=$e(z.earlyStart,z.effort,s)),z.predecessors.push({item:A,tag:V})}j=!0}}v=ne}while(j)}for(u.push(I={content:I,displayedText:I,earlyStart:f,earlyFinish:f,lateStart:Y,lateFinish:Y,isMilestone:!0,effort:0,predecessors:[],displayedRowIndex:0}),W=I.predecessors,d=0;d<v.length;d++)(j=(_=v[d]).earlyFinish)>I.earlyStart&&(I.earlyStart=j,I.earlyFinish=I.earlyStart),W.push({item:_});for(v=[I];v.length>0;){for(_=[],d=0;d<v.length;d++)if(typeof(A=v[d]).predecessors!==t)for(W=0;W<A.predecessors.length;W++){for(z=(Y=A.predecessors[W]).item,V=!1,j=0;j<_.length;j++)if(_[j]==z){V=!0;break}V||_.push(z),(V=A.lateStart)<z.lateFinish&&(z.lateFinish=z.effort>0?_e(V,s,!1,!0,void 0):V,z.lateStart=$t(z.effort,z.lateFinish,s))}v=_}if(u.length>2)for(d=0;d<u.length;d++)(V=u[d]).slack=Ne(V.earlyStart,V.lateStart,s);else g.earlyStart=f,g.earlyFinish=f,g.lateStart=f,g.lateFinish=f,I.earlyStart=p,I.earlyFinish=p,I.lateStart=p,I.lateFinish=p;for(d=0;d<u.length;d++)u[d].isRelativeToTimezone=!1;return u},e.getOutputDate=gn,e.getInputDate=Cn,e.itemDependsOf=function(d,u){return Ot(d,u)}};return{initialize:ye,initializeItems:Ce,refresh:ke,getDefaultColumns:x,getDefaultCollapsedToggleButtonTemplate:Fi,getDefaultExpandedToggleButtonTemplate:Oi,getDefaultScales:G,getDefaultStyleDefinitionTemplate:Ni,getDefaultStandardTaskTemplate:Yi,getDefaultSummaryTaskTemplate:Ui,getDefaultMilestoneTaskTemplate:Zi,getDefaultItemTemplate:Gi,getDefaultAssignmentsTemplate:Xi,getDefaultDependencyLineTemplate:_i,getDefaultPredecessorItemTemplate:$i,initializeTaskDraggingThumbs:function(e,n,s,r,o,l,m,d){o.ganttChartView.initializeTaskDraggingThumbs(e,n,s,r,o,l,m,d)},initializeDependencyDraggingThumb:function(e,n,s,r,o){s.ganttChartView.initializeDependencyDraggingThumb(e,n,s,r,o)},getWorkingTime:qi,getEffort:Ne,getFinish:$e,getStart:$t,getCompletion:ti,getCompletedFinish:gi,getWeekStart:function(e,n){return U(e,n)},getWeekFinish:J,defaultDateTimeFormatter:function(e){return k(h(e))},defaultDateFormatter:function(e){return D(h(e))},defaultDateTimeParser:function(e){return y(T(e))},textColumnTemplateBase:function(e,n,s){return(typeof(n=n())===t||typeof s!==t&&!s())&&(n=""),e.createTextNode(n)},textInputColumnTemplateBase:function(e,n,s,r,o,l,m,d){var u=e.createElement("input");return u.setAttribute("type","text"),typeof(e=s())===t&&(e=""),u.setAttribute("value",e),e="",typeof l!==t&&!l()&&(e="; display: none"),l="",typeof m!==t&&m()&&(l="; font-weight: bold"),u.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+e+l+(d?"":"; padding: 1px; font-size: inherit;")),typeof o!==t&&!o()&&u.setAttribute("disabled","true"),u.addEventListener("change",function(){r(u.value)},!0),u.addEventListener("keypress",function(p){13==p.keyCode&&(p.preventDefault(),p.stopPropagation(),r(u.value))},!0),u.addEventListener("focus",function(){u.style.backgroundColor="White"},!0),u.addEventListener("blur",function(){u.style.backgroundColor="Transparent"},!0),u},optionSelectColumnTemplateBase:function(e,n,s,v,o,l,m,d,u){var p=e.createElement("select"),f=function(I,A){var V=e.createElement("option");V.appendChild(e.createTextNode(I)),I==A&&V.setAttribute("selected",!0),p.appendChild(V)};typeof(v=v())===t&&(v=""),f("",v),s=s();for(var g=0;g<s.length;g++)f(s[g],v);return f="",typeof m!==t&&!m()&&(f="; display: none"),m="",typeof d!==t&&d()&&(m="; font-weight: bold"),p.setAttribute("style","background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+f+m+(u?"":"; padding: 1px; font-size: inherit;")),typeof l!==t&&!l()&&p.setAttribute("disabled","true"),p.addEventListener("change",function(){o(p.value)},!0),p.addEventListener("keypress",function(I){13==I.keyCode&&(I.preventDefault(),I.stopPropagation(),o(p.value))},!0),p.addEventListener("focus",function(){p.style.backgroundColor="White"},!0),p.addEventListener("blur",function(){p.style.backgroundColor="Transparent"},!0),p},numberInputColumnTemplateBase:function(e,n,s,r,o,l,m,d){return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(e,n,function(){var u=s();return isNaN(u)?"":u},function(u){u=parseFloat(u),isNaN(u)&&(u=0),r(u)},o,l,m,d)},percentInputColumnTemplateBase:function(e,n,s,r,o,l,m,d){return DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(e,n,s,function(u){u<0&&(u=0),u>100&&(u=100),r(u)},o,l,m,d)},timeSpanInputColumnTemplateBase:function(e,n,s,r,o,l,m,d,u){return typeof o===t&&(o=1),DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(e,n,function(){var p=s()/(36e5*o);return Math.round(100*p)/100},function(p){(p=parseFloat(p))<0&&(p=0),r(36e5*p*o)},l,m,d,u)},datePickerInputColumnTemplateBase:function(e,n,s,r,o,l,m,d,u,p,f,v,g,I,A){f||(f=["Su","Mo","Tu","We","Th","Fr","Sa"]);var V=v,W=g;v||(v=DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter),g||(g=DlhSoft.Controls.GanttChartView.defaultDateTimeParser);var R=e.createElement("input");R.setAttribute("type","text"),typeof(s=s())===t?s="":null!=s&&(s=v(s)),R.setAttribute("value",s),DlhSoft.Controls.DatePicker&&R.addEventListener("focus",function(){var z=DlhSoft.Controls.DatePicker.get(R);if(!z||!z.isOpen){var Y=0,_=0;try{Y=R.selectionStart,_=R.selectionEnd}catch{}(z=DlhSoft.Controls.DatePicker.initialize(R,void 0,{inputStyle:null,defaultTimeOfDay:d,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid #e0e0e0",calendarSelectorLevels:u,months:p,daysOfWeek:Pe(f),weekStart:I,dateTimeFormatter:V,dateTimeParser:W},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{R.selectionStart=Y,R.selectionEnd=_}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{R.focus()}catch{}},100):e.createEvent&&setTimeout(function(){var ne=e.createEvent("MouseEvents");ne.initEvent("blur",!0,!1),R.dispatchEvent(ne)})}},!0),v="",typeof l!==t&&!l()&&(v="; display: none"),l="",typeof m!==t&&m()&&(l="; font-weight: bold"),R.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+v+l+(A?"":"; padding: 1px; font-size: inherit;")),typeof o!==t&&!o()&&R.setAttribute("disabled","true");var j=function(){var z=""!=(z=R.value)?g(z):null;r(z)};return R.addEventListener("change",function(){j()},!0),R.addEventListener("keypress",function(z){13==z.keyCode&&(z.preventDefault(),z.stopPropagation(),j())},!0),R.addEventListener("focus",function(){R.style.backgroundColor="White"},!0),R.addEventListener("blur",function(){R.style.backgroundColor="Transparent"},!0),R},dateTimePickerInputColumnTemplateBase:function(e,n,s,r,o,l,m,d,u,p,f,v,g,I,A){f||(f=["Su","Mo","Tu","We","Th","Fr","Sa"]);var V=v,W=g;v||(v=DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter),g||(g=DlhSoft.Controls.GanttChartView.defaultDateTimeParser);var R=e.createElement("input");R.setAttribute("type","text"),typeof(s=s())===t?s="":null!=s&&(s=v(s)),R.setAttribute("value",s),(DlhSoft.Controls.DateTimePicker||DlhSoft.Controls.DatePicker)&&R.addEventListener("focus",function(){var z=(DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).get(R);if(!z||!z.isOpen){var Y=0,_=0;try{Y=R.selectionStart,_=R.selectionEnd}catch{}(z=(DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).initialize(R,void 0,{inputStyle:null,defaultTimeOfDay:d,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid #e0e0e0",calendarSelectorLevels:u,months:p,daysOfWeek:Pe(f),weekStart:I,dateTimeFormatter:V,dateTimeParser:W},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{R.selectionStart=Y,R.selectionEnd=_}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{R.focus()}catch{}},100):e.createEvent&&setTimeout(function(){var ne=e.createEvent("MouseEvents");ne.initEvent("blur",!0,!1),R.dispatchEvent(ne)})}},!0),v="",typeof l!==t&&!l()&&(v="; display: none"),l="",typeof m!==t&&m()&&(l="; font-weight: bold"),R.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+v+l+(A?"":"; padding: 1px; font-size: inherit;")),typeof o!==t&&!o()&&R.setAttribute("disabled","true");var j=function(){var z=""!=(z=R.value)?g(z):null;r(z)};return R.addEventListener("change",function(){j()},!0),R.addEventListener("keypress",function(z){13==z.keyCode&&(z.preventDefault(),z.stopPropagation(),j())},!0),R.addEventListener("focus",function(){R.style.backgroundColor="White"},!0),R.addEventListener("blur",function(){R.style.backgroundColor="Transparent"},!0),R},multiSelectorComboBoxInputColumnTemplateBase:function(e,n,s,r,o,l,m,d,u){var p=e.createElement("input");return p.setAttribute("type","text"),typeof(r=r())===t&&(r=""),p.setAttribute("value",r),DlhSoft.Controls.MultiSelectorComboBox&&p.addEventListener("focus",function(){if(!(f=DlhSoft.Controls.MultiSelectorComboBox.get(p))||!f.isOpen&&f.availableChoices.length>0){var f=s(),v=0,g=0;try{v=p.selectionStart,g=p.selectionEnd}catch{}(f=DlhSoft.Controls.MultiSelectorComboBox.initialize(p,f,void 0,{inputStyle:null,autoAppendAvailableChoices:!1,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid #e0e0e0; color: Black; font-size: small; max-height: 188px; overflow-y: auto"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{p.selectionStart=v,p.selectionEnd=g}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{p.focus()}catch{}},100):e.createEvent&&setTimeout(function(){var A=e.createEvent("MouseEvents");A.initEvent("blur",!0,!1),p.dispatchEvent(A)})}},!0),r="",typeof m!==t&&!m()&&(r="; display: none"),m="",typeof d!==t&&d()&&(m="; font-weight: bold"),p.setAttribute("style","boutline: none; ackground-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+r+m+(u?"":"; padding: 1px; font-size: inherit;")),typeof l!==t&&!l()&&p.setAttribute("disabled","true"),p.addEventListener("change",function(){o(p.value)},!0),p.addEventListener("keypress",function(f){13==f.keyCode&&(f.preventDefault(),f.stopPropagation(),o(p.value))},!0),p.addEventListener("focus",function(){p.style.backgroundColor="White"},!0),p.addEventListener("blur",function(){p.style.backgroundColor="Transparent"},!0),p},dateTimeInputColumnTemplateBase:function(e,n,s,r,o,l,m,d){return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(e,n,function(){var u=s();return null!=u?DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter(u):""},function(u){u=""!=u?DlhSoft.Controls.GanttChartView.defaultDateTimeParser(u):null,r(u)},o,l,m,d)},getIndexColumnTemplate:function(){return function(e){var n=e.ganttChartView;return DlhSoft.Controls.GanttChartView.textColumnTemplateBase(n.ownerDocument,function(){return n.getItemIndexString(e)})}},getWbsColumnTemplate:function(e){return function(n){var s=n.ganttChartView;return DlhSoft.Controls.GanttChartView.textColumnTemplateBase(s.ownerDocument,function(){return s.getItemWbsIndexString(n,e)})}},getEffortColumnTemplate:function(e,n,s,r){return typeof n===t&&(n=1),function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemEffort(o)},function(m){l.setItemEffort(o,m),l.refreshItemPath(o)},n,function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly)||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled))},function(){return!(o.isMilestone||typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getDurationColumnTemplate:function(e,n,s,r){return typeof n===t&&(n=1),function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemDuration(o)},function(m){l.setItemDuration(o,m),l.refreshItemPath(o)},n,function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly)||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled))},function(){return!(o.isMilestone||typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getTotalEffortColumnTemplate:function(e,n,s,r){return typeof n===t&&(n=1),function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemTotalEffort(o)},function(m){l.setItemTotalEffort(o,m),l.refreshItemPath(o)},n,function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly)||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled))},function(){return!(o.isMilestone||typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getCompletedEffortColumnTemplate:function(e,n,s,r){return typeof n===t&&(n=1),function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemCompletedEffort(o)},function(m){l.setItemCompletedEffort(o,m),l.refreshItemPath(o)},n,function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly)||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled))},function(){return!(o.isMilestone||typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getTotalCompletedEffortColumnTemplate:function(e,n,s,r){return typeof n===t&&(n=1),function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemTotalCompletedEffort(o)},function(m){l.setItemTotalCompletedEffort(o,m),l.refreshItemPath(o)},n,function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly)||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled))},function(){return!(o.isMilestone||typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getCompletionColumnTemplate:function(e,n,s){return function(r){var o=r.ganttChartView,l=o.settings;return DlhSoft.Controls.GanttChartView.percentInputColumnTemplateBase(o.ownerDocument,e,function(){var m=100*o.getItemCompletion(r);return Math.round(m*(l.integralCompletionPercents?1:100))/(l.integralCompletionPercents?1:100)},function(m){if(typeof r.gridItem!==t&&typeof r.completedInput!==t){var d=r.completedInput;typeof d.changeEventListener!==t&&d.removeEventListener("change",d.changeEventListener,!0),delete r.completedInput}m=parseFloat(m)/100,o.setItemCompletion(r,m),o.refreshItemPath(r)},function(){return!(r.isReadOnly||n||typeof r.ganttChartView!==t&&typeof r.ganttChartView.settings!==t&&(r.ganttChartView.settings.isReadOnly||r.ganttChartView.settings.isGridReadOnly)||r.hasChildren&&(typeof r.isSummaryEnabled===t||r.isSummaryEnabled))},function(){return!(r.isMilestone||typeof r.isBarVisible!==t&&!r.isBarVisible)},function(){return r.hasChildren&&(typeof r.isSummaryEnabled===t||r.isSummaryEnabled)},s)}},getCostColumnTemplate:function(e,n,s){return function(r){var o=r.ganttChartView;return DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(o.ownerDocument,e,function(){return o.getItemCost(r)},function(l){o.setItemCost(r,l),o.refreshItemPath(r)},function(){return!(r.isReadOnly||n||typeof r.ganttChartView!==t&&typeof r.ganttChartView.settings!==t&&(r.ganttChartView.settings.isReadOnly||r.ganttChartView.settings.isGridReadOnly))},void 0,function(){return r.hasChildren&&(typeof r.isSummaryEnabled===t||r.isSummaryEnabled)},s)}},getPredecessorsColumnTemplate:function(e,n,s,r){return function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemPredecessorsString(o,s)},function(m){l.setItemPredecessorsString(o,m,s),l.refreshItemGraph(o)},function(){return!(o.isReadOnly||n||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly))},function(){return!(typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getAssignmentSelectorColumnTemplate:function(e,n,s,r){return function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.optionSelectColumnTemplateBase(l.ownerDocument,e,function(){return"array"==typeof n?n:n(o)},function(){return o.assignmentsContent},function(m){o.assignmentsContent=m,l.onItemPropertyChanged(o,"assignmentsContent",!0,!0),l.refreshItem(o)},function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly))},function(){return!(typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getBaselineStartColumnTemplate:function(e,n,s,r,o,l,m,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var v=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(v.ownerDocument,e,function(){return null!=f.baselineStart?h(f.baselineStart):void 0},function(g){null!=g?f.baselineStart=y(g):delete f.baselineStart,v.onItemPropertyChanged(f,"baselineStart",!0,!0),v.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly))},function(){return!(typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r,o,l,m,function(g){return null==g?"":v.settings.dateTimeFormatter(g)},function(g){return""==g?null:v.settings.dateTimeParser(g)},u,p)}},getBaselineFinishColumnTemplate:function(e,n,s,r,o,l,m,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var v=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(v.ownerDocument,e,function(){return null!=f.baselineFinish?h(f.baselineFinish):void 0},function(g){null!=g?f.baselineFinish=y(g):delete f.baselineFinish,v.onItemPropertyChanged(f,"baselineFinish",!0,!0),v.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly))},function(){return!(f.isMilestone||typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r||864e5,o,l,m,function(g){return null==g?"":v.settings.dateTimeFormatter(g)},function(g){return""==g?null:v.settings.dateTimeParser(g)},u,p)}},getMinStartColumnTemplate:function(e,n,s,r,o,l,m,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var v=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(v.ownerDocument,e,function(){return null!=f.minStart?h(f.minStart):void 0},function(g){null!=g?f.minStart=y(g):delete f.minStart,v.onItemPropertyChanged(f,"minStart",!0,!0),v.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly)||f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled))},function(){return!(typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r,o,l,m,function(g){return null==g?"":v.settings.dateTimeFormatter(g)},function(g){return""==g?null:v.settings.dateTimeParser(g)},u,p)}},getMaxStartColumnTemplate:function(e,n,s,r,o,l,m,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var v=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(v.ownerDocument,e,function(){return null!=f.maxStart?h(f.maxStart):void 0},function(g){null!=g?f.maxStart=y(g):delete f.maxStart,v.onItemPropertyChanged(f,"maxStart",!0,!0),v.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly)||f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled))},function(){return!(typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r||864e5,o,l,m,function(g){return null==g?"":v.settings.dateTimeFormatter(g)},function(g){return""==g?null:v.settings.dateTimeParser(g)},u,p)}},getMinFinishColumnTemplate:function(e,n,s,r,o,l,m,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var v=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(v.ownerDocument,e,function(){return null!=f.minFinish?h(f.minFinish):void 0},function(g){null!=g?f.minFinish=y(g):delete f.minFinish,v.onItemPropertyChanged(f,"minFinish",!0,!0),v.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly)||f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled))},function(){return!(f.isMilestone||typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r,o,l,m,function(g){return null==g?"":v.settings.dateTimeFormatter(g)},function(g){return""==g?null:v.settings.dateTimeParser(g)},u,p)}},getMaxFinishColumnTemplate:function(e,n,s,r,o,l,m,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var v=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(v.ownerDocument,e,function(){return null!=f.maxFinish?h(f.maxFinish):void 0},function(g){null!=g?f.maxFinish=y(g):delete f.maxFinish,v.onItemPropertyChanged(f,"maxFinish",!0,!0),v.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly)||f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled))},function(){return!(f.isMilestone||typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r||864e5,o,l,m,function(g){return null==g?"":v.settings.dateTimeFormatter(g)},function(g){return""==g?null:v.settings.dateTimeParser(g)},u,p)}},getIconColumnTemplate:function(f,n,s,r,o,l,m,d,u){if("string"==typeof f){var p=f;f=function(){return p}}return typeof r===t||0==r?r=function(){return!1}:1==r&&(r=function(){return!0}),function(v){var g=v.ganttChartView,I=g.ownerDocument.createElement("img");return I.setAttribute("src",f(v)),typeof n!==t&&I.setAttribute("class",n),typeof s!==t&&I.setAttribute("style",s),!g.settings.isReadOnly&&!g.settings.isGridReadOnly&&r(v)&&(I.style.cursor="move",function(e,n,s,r,o,l,m,d,u,p){function f(V){delete r.cancelDrag,r.draggingItem=n,r.dragType="Ordering",r.style.cursor=e.style.cursor,r.draggingInitialY=V.clientY,r.draggingInitialThumbPosition=0,r.resetChartAreaDefinitions()}e.addEventListener("mousedown",se(r,e,"mousedown",function(V){0==V.button&&(f(V),V.preventDefault())},!0),!0),e.addEventListener("touchstart",se(r,e,"touchstart",function(V){f(V.touches[0]),V.preventDefault()},!0),!0),typeof r.draggableOrderingItems===t&&(r.draggableOrderingItems=[]);for(var v=!1,g=0;g<r.draggableOrderingItems.length;g++)if(r.draggableOrderingItems[g]==n){v=!0;break}if(!v){var I=function(V){if(typeof r.draggingItem!==t&&r.draggingItem==n&&"Ordering"==r.dragType){typeof r.temporaryHoveredGridItemSelectionContainer!==t&&(r.temporaryHoveredGridItemSelectionContainer.setAttribute("class",r.temporaryHoveredGridItemClass),r.temporaryHoveredGridItemSelectionContainer.setAttribute("style",r.temporaryHoveredGridItemStyle),delete r.temporaryHoveredGridItemSelectionContainer,delete r.temporaryHoveredGridItemClass,delete r.temporaryHoveredGridItemStyle);var W=V.clientY-r.draggingInitialY;if(en(V.clientY,r),delete r.draggingItem,r.cancelDrag)ee(n,o),delete r.cancelDrag,delete r.draggingItem,r.style.cursor="default";else{V=Math.floor((n.itemTop+r.draggingInitialThumbPosition+W)/o.itemHeight),W=null;for(var R=0,j=0;j<s.length;j++){var z=s[j];if(z.isVisible&&(typeof z.isHidden===t||!z.isHidden)&&typeof z.displayRowIndex===t){if(R==V){W=z;break}R++}}null!=W&&W!=n&&null!=W.gridItemSelectionContainer&&(r.temporaryHoveredGridItemSelectionContainer=W.gridItemSelectionContainer,r.temporaryHoveredGridItemClass=W.gridItemSelectionContainer.getAttribute("class"),r.temporaryHoveredGridItemStyle=W.gridItemSelectionContainer.getAttribute("style"),typeof l===t||l(V,W)?typeof m!==t?W.gridItemSelectionContainer.setAttribute("class",m):typeof d!==t&&W.gridItemSelectionContainer.setAttribute("style",d):typeof u!==t?W.gridItemSelectionContainer.setAttribute("class",u):typeof p!==t&&W.gridItemSelectionContainer.setAttribute("style",p)),r.draggingItem=n}}};r.addEventListener("mousemove",se(r,r,"mousemove",function(V){I(V)},!0),!0),r.addEventListener("touchmove",se(r,r,"touchmove",function(V){I(V.touches[0])},!0),!0);var A=function(V){if(typeof r.draggingItem!==t&&r.draggingItem==n&&"Ordering"==r.dragType){typeof r.temporaryHoveredGridItemSelectionContainer!==t&&(r.temporaryHoveredGridItemSelectionContainer.setAttribute("class",r.temporaryHoveredGridItemClass),r.temporaryHoveredGridItemSelectionContainer.setAttribute("style",r.temporaryHoveredGridItemStyle),delete r.temporaryHoveredGridItemSelectionContainer,delete r.temporaryHoveredGridItemClass,delete r.temporaryHoveredGridItemStyle),V=Math.floor((n.itemTop+r.draggingInitialThumbPosition+(V.clientY-r.draggingInitialY))/o.itemHeight);for(var W=null,R=0,j=0;j<s.length;j++){var z=s[j];if(z.isVisible&&(typeof z.isHidden===t||!z.isHidden)&&typeof z.displayRowIndex===t){if(R==V){W=z;break}R++}}null!=W&&(typeof l===t||l(V,W))&&r.moveItemHierarchy(r.draggingItem,W.index),setTimeout(function(){ee(n,o),tn(n)},0),r.resetChartAreaDefinitions(),delete r.draggingItem,r.style.cursor="default"}};document.addEventListener("mouseup",se(r,document,"mouseup",function(V){0==V.button&&A(V)},!0),!0),document.addEventListener("touchend",se(r,document,"touchend",function(V){A(V.changedTouches[0])},!0),!0),r.draggableOrderingItems.push(n)}}(I,v,g.items,g,g.settings,o,l,m,d,u)),I}},getOutputDate:gn,getInputDate:Cn}}()),null==DlhSoft.Controls.ScheduleChartView&&(DlhSoft.Controls.ScheduleChartView=function(){var t=function(h,T,y,F,x){return h.internalEventListeners&&h.internalEventListeners.push({object:T,event:y,handler:F,useCapture:x}),F},fe=function(h,T,y,F){var x=["DlhSoft.Controls","ScheduleChartView","DlhSoft.ProjectData.GanttChart.HTML.Controls","5","validate","Licensing"];DlhSoft[x[5]][x[4]](h,x[0],x[1],x[2],x[3],F,y),h.isScheduleChartInitializing=!0,F=T,T=[];for(var N=x=0,P=0;P<F.length;P++){var X=F[P];if(!(typeof X.scheduleChartItem<"u"&&X.scheduleChartItem!=X)&&(X.scheduleChartIndex=x++,X.isHidden||(X.scheduleChartVisibilityIndex=N++),X.isBarVisible=!1,T.push(X),typeof X.ganttChartItems<"u"))for(var ee=0;ee<X.ganttChartItems.length;ee++){var oe=X.ganttChartItems[ee];oe.scheduleChartItem=X,X.isHidden&&(oe.isHidden=!0),oe.displayRowIndex=X.scheduleChartVisibilityIndex,oe.indentation=(X.indentation?X.indentation:0)+1,T.push(oe)}}return"object"!=typeof y&&(y={}),DlhSoft.Controls.GanttChartView.initializeItems(T,y),N=T,We(x=y),typeof x.gridWidth>"u"&&(x.gridWidth="15%"),typeof x.chartWidth>"u"&&(x.chartWidth=x.isGridVisible?"85%":"100%"),typeof x.columns>"u"&&(x.columns=Ge(N,x)),typeof x.areTaskDependenciesVisible>"u"&&(x.areTaskDependenciesVisible=!1),typeof x.isBaselineVisible>"u"&&(x.isBaselineVisible=!1),typeof x.areStandardTaskLabelsVisible>"u"&&(x.areStandardTaskLabelsVisible=!1),typeof x.areMilestoneTaskLabelsVisible>"u"&&(x.areMilestoneTaskLabelsVisible=!1),typeof x.areAssignmentsReadOnly>"u"&&(x.areAssignmentsReadOnly=!1),typeof x.assignmentThumbStyle>"u"&&(x.assignmentThumbStyle="Aero"===x.theme?"fill: none; stroke: Blue; stroke-dasharray: 2, 2":"fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2"),typeof x.temporaryAssignmentThumbStyle>"u"&&(x.temporaryAssignmentThumbStyle="Aero"===x.theme?"fill: none; stroke: Blue; stroke-width: 0.65px; stroke-dasharray: 2, 2":"fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2"),typeof x.assignmentThumbTemplate>"u"&&(x.assignmentThumbTemplate=he(N,h,x)),x.internalExtraTaskTemplate=x.assignmentThumbTemplate,D(h,T,F,y),DlhSoft.Controls.GanttChartView.initialize(h,T,y,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),k(h,T),h.isScheduleChartInitializing=!1,h.isScheduleChartInitialized=!0,h},Ee=function(h){fe(h,h.scheduleChartItems,h.settings,h.license)},We=function(h){typeof h.useUpdatingToolTips>"u"&&(h.useUpdatingToolTips=!0),typeof h.target>"u"&&(h.target="Standard"),typeof h.theme>"u"&&(h.theme="Modern"),typeof h.isGridVisible>"u"&&(h.isGridVisible="Phone"!==h.target),typeof h.interaction>"u"&&(h.interaction="Phone"!=h.target?"Standard":"TouchEnabled"),typeof h.isReadOnly>"u"&&(h.isReadOnly=!1),typeof h.isGridReadOnly>"u"&&(h.isGridReadOnly=!1),typeof h.isContentReadOnly>"u"&&(h.isContentReadOnly=!1),typeof h.selectionMode>"u"&&(h.selectionMode="Focus"),typeof h.isVirtualizing>"u"&&(h.isVirtualizing=!0),"Phone"==h.target&&typeof h.areTaskAssignmentsVisible>"u"&&(h.areTaskAssignmentsVisible=!1)},Ge=function(h,T){"object"!=typeof T&&(T={}),We(T);var y=[{header:"",width:32,isSelection:!0},{header:"Resource",width:120,isTreeView:!0}];return y[0].cellTemplate=Je(T,y[0],h),y[1].cellTemplate=ke(T,y[1],h),y[1].exportCellTemplate=ke(T,y[1],h,!1),"Single"!=T.selectionMode&&"Extended"!=T.selectionMode&&"ExtendedFocus"!=T.selectionMode&&y.splice(0,1),y},Je=function(h,T){return function(y){return T.isReadOnly?getBooleanNode(y.ganttChartView.ownerDocument,y.isSelected):se(y)}},se=function(h){var y,T=h.ganttChartView.ownerDocument;typeof h.selectionInput>"u"?(y=T.createElement("input"),h.selectionInput=y,y.type="checkbox",y.setAttribute("style","margin: 0px")):y=h.selectionInput,h.isSelected?(y.setAttribute("checked","checked"),y.checked||(y.checked=!0)):y.checked&&(y.checked=!1);var F=function(){y.checked?De(h):typeof h.scheduleChartView<"u"&&h.scheduleChartView.unselectItem(h)};return typeof y.changeEventListener<"u"&&y.removeEventListener("change",y.changeEventListener,!0),y.addEventListener("change",t(h.ganttChartView,y,"change",F,!0),!0),y.changeEventListener=F,T=function(x){13==x.keyCode&&(x.preventDefault(),x.stopPropagation(),F())},typeof y.keyPressEventListener<"u"&&y.removeEventListener("keypress",y.keyPressEventListener,!0),y.addEventListener("keypress",t(h.ganttChartView,y,"keypress",T,!0),!0),y.keyPressEventListener=T,y},De=function(h){typeof h.scheduleChartView<"u"&&h.scheduleChartView.selectItem(h)},ye=function(h,T){typeof h.scheduleChartView<"u"&&(h.scheduleChartView.currentItem=h),("Focus"==T.selectionMode||"ExtendedFocus"==T.selectionMode)&&!h.isSelected&&De(h)},ke=function(h,T,y,F){var x=function(X){var P=X.content;return(X=X.ganttChartView.ownerDocument.createElement("span")).innerHTML=P,X};return!(typeof F>"u"||F)||h.isReadOnly||h.isGridReadOnly||h.isContentReadOnly?x:function(N){return T.isReadOnly||!(typeof N.isReadOnly>"u")&&N.isReadOnly?x(N):xe(N,Math.max(0,T.width-N.indentation*N.ganttChartView.settings.indentationLevelWidth-N.ganttChartView.settings.toggleButtonAreaWidth-16),h)}},xe=function(h,T,y){var x,F=h.ganttChartView.ownerDocument;if(typeof h.contentInput>"u"){x=F.createElement("input"),h.contentInput=x,x.type="text",x.addEventListener("focus",t(h.ganttChartView,x,"focus",function(){ye(h,y)}));var N=function(){h.content=x.value,h.scheduleChartView.onItemPropertyChanged(h,"content",!0,!0),h.scheduleChartView.refreshItem(h)};typeof x.changeEventListener<"u"&&x.removeEventListener("change",x.changeEventListener,!0),x.addEventListener("change",t(h.ganttChartView,x,"change",N,!0),!0),x.changeEventListener=N,F=function(P){13==P.keyCode&&(P.preventDefault(),P.stopPropagation(),N())},typeof x.keyPressEventListener<"u"&&x.removeEventListener("keypress",x.keyPressEventListener,!0),x.addEventListener("keypress",t(h.ganttChartView,x,"keypress",F,!0),!0),x.keyPressEventListener=F,x.addEventListener("focus",t(h.ganttChartView,x,"focus",function(){x.style.backgroundColor="White"})),x.addEventListener("blur",t(h.ganttChartView,x,"blur",function(){x.style.backgroundColor="Transparent"}))}else x=h.contentInput;return x.value=h.content,F="",h.hasChildren&&(typeof h.isSummaryEnabled>"u"||h.isSummaryEnabled)&&(F="; font-weight: bold"),x.setAttribute("style","outline: none; background-color: Transparent; width: "+T+"px; border-width: 0px; padding: 0px"+F+(y.classic?"":"; font-size: 12px; padding: 1px;")),x},he=function(h,T,y){return function(F){var x=F.ganttChartView.ownerDocument,N=x.createElementNS("http://www.w3.org/2000/svg","g");if(!y.isReadOnly&&!y.isChartReadOnly&&(typeof F.isReadOnly>"u"||!F.isReadOnly)&&!y.areAssignmentsReadOnly){var P=T.getChartPosition(F.start,y),X=Math.max(T.getChartPosition(F.finish,y),P+4),ee=x.createElementNS("http://www.w3.org/2000/svg","line");ee.setAttribute("x1",P),ee.setAttribute("y1",y.barMargin+y.barHeight+2),ee.setAttribute("x2",X-1),ee.setAttribute("y2",y.barMargin+y.barHeight+2);var oe=y.assignmentThumbClass;typeof oe<"u"&&ee.setAttribute("class",oe),ee.setAttribute("style",y.assignmentThumbStyle),ee.style.visibility="hidden",N.appendChild(ee),(x=x.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",P),x.setAttribute("y",y.barMargin+y.barHeight-2),x.setAttribute("width",Math.max(0,X-P-1)),x.setAttribute("height",7),x.setAttribute("style","fill: White; fill-opacity: 0; cursor: move"),x.addEventListener("mouseover",t(T,x,"mouseover",function(){typeof T.draggingItem>"u"&&(ee.style.visibility="visible")},!0),!0),x.addEventListener("mouseout",t(T,x,"mouseout",function(){ee.style.visibility="hidden"},!0),!0),N.appendChild(x),ae(x,N,F,P,X,h,T,y)}return N}},Ce=function(h){var T=h.scheduleChartView;if(h.itemTop=h.scheduleChartVisibilityIndex*T.settings.itemHeight,T.refreshGridItem(h),typeof h.ganttChartItems<"u")for(var y=0;y<h.ganttChartItems.length;y++){var F=h.ganttChartItems[y];F.itemTop=h.itemTop,T.refreshChartItem(F)}},ae=function(h,T,y,F,x,N,P,X){function ee(be,Le){delete y.assignmentThumbParentNode,delete P.cancelDrag,P.draggingItem=y,P.dragType="Assignment",P.style.cursor=h.style.cursor,P.draggingInitialY=be.clientY,P.draggingInitialThumbPosition=X.barMargin,T.itemLeft=F,T.itemRight=x,y.assignmentThumb=T,DlhSoft.Controls.ToolTip&&X.useUpdatingToolTips&&!Le&&((toolTip=DlhSoft.Controls.ToolTip.get(h))||(toolTip=DlhSoft.Controls.ToolTip.initialize(void 0,h,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+X.border+"; background-color: White; color: Black; font-family: "+(X.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),toolTip.setContent(y.content+" \u2013"),toolTip.show(),toolTip.setPosition(toolTip.x+(x-F)+4,toolTip.y-X.itemHeight-1),toolTip.originalY=toolTip.y,P.toolTip=toolTip)}var oe=y.ganttChartView.ownerDocument;h.addEventListener("mousedown",t(P,h,"mousedown",function(be){0==be.button&&(ee(be),be.preventDefault())},!0),!0),h.addEventListener("touchstart",t(P,h,"touchstart",function(be){ee(be.touches[0],!0),be.preventDefault()},!0),!0),typeof P.draggableAssignmentItems>"u"&&(P.draggableAssignmentItems=[]);for(var ve=!1,He=0;He<P.draggableAssignmentItems.length;He++)if(P.draggableAssignmentItems[He]==y){ve=!0;break}if(!ve){var Ae=function(be,Le){if(!(typeof P.draggingItem>"u"||P.draggingItem!=y||"Assignment"!=P.dragType)){var me,pe=Math.ceil((be.clientY-P.draggingInitialY)/X.itemHeight)*X.itemHeight;if(H(be.clientY,P),delete P.draggingItem,(T=y.assignmentThumb).parentNode?y.assignmentThumbParentNode=T.parentNode:y.assignmentThumbParentNode&&y.assignmentThumbParentNode.appendChild(T),F=T.itemLeft,x=T.itemRight,typeof P.temporaryAssignmentThumb<"u"){try{T.removeChild(P.temporaryAssignmentThumb)}catch{}delete P.temporaryAssignmentThumb}if(P.cancelDrag)delete P.cancelDrag,delete P.draggingItem,P.style.cursor="default";else if(X.temporaryAssignmentThumbTemplate?me=X.temporaryAssignmentThumbTemplate(P,F,P.draggingInitialThumbPosition+pe,Math.max(X.classic?4:12,x-F-1),X.barHeight):((me=oe.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",F),me.setAttribute("y",P.draggingInitialThumbPosition+pe),me.setAttribute("width",Math.max(X.classic?4:12,x-F-1)),me.setAttribute("height",X.barHeight),typeof X.temporaryAssignmentThumbClass<"u"&&me.setAttribute("class",X.temporaryAssignmentThumbClass),me.setAttribute("style",X.temporaryAssignmentThumbStyle)),P.temporaryAssignmentThumb=me,T.appendChild(me),P.draggingItem=y,DlhSoft.Controls.ToolTip&&X.useUpdatingToolTips&&!Le){toolTip=P.toolTip,me=Math.floor((y.itemTop+P.draggingInitialThumbPosition+pe)/X.itemHeight);var rt,Pe=null,Fe=0;for(rt=0;rt<N.length;rt++){var Me=N[rt];if(Me.isVisible&&!(typeof Me.isHidden<"u"&&Me.isHidden)&&typeof Me.displayRowIndex>"u"){if(Fe==me){Me.hasChildren||(Pe=Me);break}Fe++}}toolTip.setContent(y.content+" \u2013"+(null!=Pe?" "+Pe.content:"")),toolTip.setVerticalPosition(Math.max(ue(P)+P.chartHeaderContainer.clientHeight,toolTip.originalY+pe)),typeof toolTip.originalX>"u"&&(toolTip.originalX=toolTip.x),toolTip.setHorizontalPosition(toolTip.originalX)}}};P.addEventListener("mousemove",t(P,P,"mousemove",function(be){Ae(be)},!0),!0),P.addEventListener("touchmove",t(P,P,"touchmove",function(be){Ae(be.touches[0],!0)},!0),!0);var Ie=function(be){if(!(typeof P.draggingItem>"u"||P.draggingItem!=y||"Assignment"!=P.dragType)){if(delete y.assignmentThumbParentNode,T=y.assignmentThumb,typeof P.temporaryAssignmentThumb<"u"){try{T.removeChild(P.temporaryAssignmentThumb)}catch{}delete P.temporaryAssignmentThumb}be=Math.ceil((be.clientY-P.draggingInitialY)/X.itemHeight)*X.itemHeight,be=Math.floor((y.itemTop+P.draggingInitialThumbPosition+be)/X.itemHeight);var me,Le=null,pe=0;for(me=0;me<N.length;me++)if((Pe=N[me]).isVisible&&!(typeof Pe.isHidden<"u"&&Pe.isHidden)&&typeof Pe.displayRowIndex>"u"){if(pe==be){Pe.hasChildren||(Le=Pe);break}pe++}if(null!=Le){var Pe=(pe=y.scheduleChartItem).ganttChartItems,Fe=[];for(me=0;me<Pe.length;me++)Pe[me]!=y&&Fe.push(Pe[me]);pe.ganttChartItems=Fe,P.onItemPropertyChanged(pe,"ganttChartItems",!0,!0),typeof Le.ganttChartItems>"u"&&(Le.ganttChartItems=[]),Le.ganttChartItems.push(y),P.onItemPropertyChanged(Le,"ganttChartItems",!0,!0),y.scheduleChartItem=Le,P.onItemPropertyChanged(y,"scheduleChartItem",!0,!0),y.displayRowIndex=be,y.isVirtuallyVisible=!0,P.refreshChartItem(y),P.refreshPredecessorItems(y),ye(Le,X)}delete P.draggingItem,P.style.cursor="default"}};oe.addEventListener("mouseup",t(P,oe,"mouseup",function(be){0==be.button&&Ie(be)},!0),!0),oe.addEventListener("touchend",t(P,oe,"touchend",function(be){Ie(be.changedTouches[0])},!0),!0),P.draggableAssignmentItems.push(y)}},ue=function(h){var T=0;if(h.offsetParent)do{T+=h.offsetTop,h=h.offsetParent}while(h);return T},H=function(h,T){var y=T.settings;if(typeof T.draggingItem<"u"&&y.enableVerticalScrollingDuringDragging){var x,N,F=new Date;T.lastDraggingTime&&F>T.lastDraggingTime&&F-T.lastDraggingTime<50||(T.lastDraggingTime=F,(h-=ue(T))>=T.chartHeaderContainer.clientHeight&&h<T.chartHeaderContainer.clientHeight+y.verticalScrollingDragAreaHeight?(x=T.chartContentContainer.scrollTop,T.chartContentContainer.scrollTop=T.chartContentContainer.scrollTop-y.itemHeight,typeof T.isDuringVerticalScrolling>"u"&&(T.isDuringVerticalScrolling=!0,setTimeout(function(){N=x-T.chartContentContainer.scrollTop,T.draggingInitialThumbPosition=T.draggingInitialThumbPosition-Math.ceil(N/y.itemHeight)*y.itemHeight,delete T.isDuringVerticalScrolling},0))):h>=T.chartHeaderContainer.clientHeight+T.chartContentContainer.clientHeight-y.verticalScrollingDragAreaHeight&&(x=T.chartContentContainer.scrollTop,T.chartContentContainer.scrollTop=T.chartContentContainer.scrollTop+y.itemHeight,typeof T.isDuringVerticalScrolling>"u"&&(T.isDuringVerticalScrolling=!0,setTimeout(function(){N=T.chartContentContainer.scrollTop-x,T.draggingInitialThumbPosition=T.draggingInitialThumbPosition+Math.ceil(N/y.itemHeight)*y.itemHeight,delete T.isDuringVerticalScrolling},0))))}},a=function(h,T,y,F){var x=F.indexOf(h);x<0||T<0||T==x||T>=F.length||(F.splice(x,1),F.splice(T,0,h),Ee(y),typeof y.settings.itemMoveHandler<"u"&&y.settings.itemMoveHandler(h,x,T))},D=function(h,T,y,F){for(var x=0;x<T.length;x++)T[x].scheduleChartView=h;h.scheduleChartItems=y,h.settings=F,h.refreshScheduleChartItem=Ce,h.initializeAssignmentDraggingThumb=function(N,P,X,ee,oe){ae(N,P,X,ee,oe,h.items,h,h.settings)},h.insertScheduleChartItem=function(N,P){var X=N;P.scheduleChartView=h,P.isVirtuallyVisible=!0,P.scheduleChartIndex=X;var oe,ee=0;for(oe=0;oe<X;oe++)y[oe].isHidden||ee++;if(P.scheduleChartVisibilityIndex=ee,P.isBarVisible=!1,X=X<y.length?y[X].index:T.length,y.splice(P.scheduleChartIndex,0,P),h.insertItem(X++,P),typeof P.ganttChartItems<"u")for(oe=0;oe<P.ganttChartItems.length;oe++)(ee=P.ganttChartItems[oe]).scheduleChartView=h,ee.scheduleChartItem=P,ee.isHidden=P.isHidden,ee.displayRowIndex=P.scheduleChartVisibilityIndex,ee.indentation=P.indentation,h.insertItem(X++,ee);for(oe=P.scheduleChartIndex+1;oe<y.length;oe++){if((X=y[oe]).scheduleChartIndex=oe,typeof X.scheduleChartVisibilityIndex<"u"&&X.scheduleChartVisibilityIndex++,typeof X.ganttChartItems<"u")for(ee=0;ee<X.ganttChartItems.length;ee++)X.ganttChartItems[ee].displayRowIndex=X.scheduleChartVisibilityIndex;Ce(X)}},h.addScheduleChartItem=function(N){h.insertScheduleChartItem(y.length,N)},h.insertScheduleChartItems=function(N,P){for(var X=0;X<P.length;X++)h.insertScheduleChartItem(N++,P[X])},h.addScheduleChartItems=function(N){for(var P=0;P<N.length;P++)h.addScheduleChartItem(N[P])},h.removeScheduleChartItem=function(N){if(typeof N.ganttChartItems<"u")for(var P=0;P<N.ganttChartItems.length;P++)h.removeItem(N.ganttChartItems[P]);for(y.splice(N.scheduleChartIndex,1),P=N.scheduleChartIndex;P<y.length;P++){var X=y[P];if(X.scheduleChartIndex=P,typeof X.scheduleChartVisibilityIndex<"u"&&X.scheduleChartVisibilityIndex--,typeof X.ganttChartItems<"u")for(var ee=0;ee<X.ganttChartItems.length;ee++)X.ganttChartItems[ee].displayRowIndex=X.scheduleChartVisibilityIndex;Ce(X)}h.removeItem(N)},h.removeScheduleChartItems=function(N){for(var P=0;P<N.length;P++)h.removeScheduleChartItem(N[P])},h.moveScheduleChartRange=function(N,P,X){if(!(N<0||X<0||X==N||X>y.length-P)){var oe,ee=[];for(oe=N;oe<N+P;oe++)ee.push(y[oe]);for(y.splice(N,P),oe=0;oe<ee.length;oe++)y.splice(X+oe,0,ee[oe]);if(Ee(h),typeof h.settings.itemMoveHandler<"u")for(oe=0;oe<ee.length;oe++)h.settings.itemMoveHandler(ee[oe],N+oe,X+oe)}},h.moveScheduleChartItem=function(N,P){a(N,P,h,y)},h.moveScheduleChartItemUp=function(N){var P=y.indexOf(N);P<=0||a(N,P-1,h,y)},h.moveScheduleChartItemDown=function(N){var P=y.indexOf(N);P<0||P>=y.length-1||a(N,P+1,h,y)},h.moveGanttChartItem=function(N,P){var X=N.scheduleChartItem,ee=X.ganttChartItems.indexOf(N);X.ganttChartItems.splice(ee,1),P.ganttChartItems.push(N),N.scheduleChartItem=P,N.displayRowIndex=P.scheduleChartVisibilityIndex,h.refreshChartItem(N)}},k=function(h,T){h.items=T,h.refresh=function(){Ee(h)}};return{initialize:fe,refresh:Ee,getDefaultColumns:Ge,getDefaultScales:DlhSoft.Controls.GanttChartView.getDefaultScales,getDefaultStyleDefinitionTemplate:DlhSoft.Controls.GanttChartView.getDefaultStyleDefinitionTemplate,getDefaultStandardTaskTemplate:DlhSoft.Controls.GanttChartView.getDefaultStandardTaskTemplate,getDefaultMilestoneTaskTemplate:DlhSoft.Controls.GanttChartView.getDefaultMilestoneTaskTemplate,getDefaultItemTemplate:DlhSoft.Controls.GanttChartView.getDefaultItemTemplate,getDefaultAssignmentsTemplate:DlhSoft.Controls.GanttChartView.getDefaultAssignmentsTemplate,initializeTaskDraggingThumbs:DlhSoft.Controls.GanttChartView.initializeTaskDraggingThumbs,initializeDependencyDraggingThumb:DlhSoft.Controls.GanttChartView.initializeDependencyDraggingThumb,initializeAssignmentDraggingThumb:function(h,T,y,F,x){y.scheduleChartView.initializeAssignmentDraggingThumb(h,T,y,F,x)},getWorkingTime:DlhSoft.Controls.GanttChartView.getWorkingTime,getEffort:DlhSoft.Controls.GanttChartView.getEffort,getFinish:DlhSoft.Controls.GanttChartView.getFinish,getStart:DlhSoft.Controls.GanttChartView.getStart,getCompletion:DlhSoft.Controls.GanttChartView.getCompletion,getCompletedFinish:DlhSoft.Controls.GanttChartView.getCompletedFinish,textColumnTemplateBase:DlhSoft.Controls.GanttChartView.textColumnTemplateBase,textInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase,getOutputDate:DlhSoft.Controls.GanttChartView.getOutputDate,getInputDate:DlhSoft.Controls.GanttChartView.getInputDate}}()),null==DlhSoft.Controls.LoadChartView&&(DlhSoft.Controls.LoadChartView=function(){var t=function(h,T,y,F,x){return h.internalEventListeners&&h.internalEventListeners.push({object:T,event:y,handler:F,useCapture:x}),F},fe=function(h,T,y,F){var x=["DlhSoft.Controls","LoadChartView","DlhSoft.ProjectData.GanttChart.HTML.Controls","5","validate","Licensing"];DlhSoft[x[5]][x[4]](h,x[0],x[1],x[2],x[3],F,y),h.isLoadChartInitializing=!0,F=T,T=[];for(var N=x=0,P=0;P<F.length;P++){var X=F[P];if(typeof X.isExported<"u"&&X.isExported)T.push(X);else if(!(typeof X.loadChartItem<"u"&&X.loadChartItem!=X)&&(X.loadChartIndex=X.scheduleChartIndex=x++,X.isHidden||(X.scheduleChartVisibilityIndex=N++),X.isBarVisible=!1,T.push(X),typeof X.ganttChartItems<"u"))for(var ee=0;ee<X.ganttChartItems.length;ee++){var oe=X.ganttChartItems[ee];oe.loadChartItem=oe.scheduleChartItem=X,X.isHidden&&(oe.isHidden=!0),oe.displayRowIndex=X.scheduleChartVisibilityIndex,oe.indentation=X.indentation+(X.indentation?X.indentation:0),T.push(oe)}}return"object"!=typeof y&&(y={}),DlhSoft.Controls.GanttChartView.initializeItems(T,y),N=T,We(x=y),typeof x.gridWidth>"u"&&(x.gridWidth="15%"),typeof x.chartWidth>"u"&&(x.chartWidth=x.isGridVisible?"85%":"100%"),typeof x.columns>"u"&&(x.columns=Ge(N,x)),typeof x.normalAllocationBarStyle>"u"&&null==x.normalAllocationBarClass&&(x.normalAllocationBarStyle=x.classic?"Aero"===x.theme?"fill: Blue; stroke: Blue":"fill: Blue; fill-opacity: 0.8; stroke: Blue; stroke-width: 0.65px":"fill: #8abbed; fill-opacity: 0.8;"),typeof x.underAllocationBarStyle>"u"&&null==x.underAllocationBarClass&&(x.underAllocationBarStyle=x.normalAllocationBarStyle),typeof x.overAllocationBarStyle>"u"&&null==x.overAllocationBarClass&&(x.overAllocationBarStyle=x.classic?"Aero"===x.theme?"fill: Red; stroke: Red":"fill: Red; fill-opacity: 0.8; stroke: Red; stroke-width: 0.65px":"fill: #D03642; fill-opacity: 0.8; stroke-width: 0.65px;"),typeof x.maxDisplayedUnits>"u"&&(x.maxDisplayedUnits=1.5),typeof x.allocationTemplate>"u"&&(x.allocationTemplate=ae()),x.standardTaskTemplate=x.allocationTemplate,x.milestoneTaskTemplate=x.allocationTemplate,x.areTaskDependenciesVisible=!1,x.isBaselineVisible=!1,x.isTaskCompletedEffortVisible=!1,x.areTaskAssignmentsVisible=!1,D(h,T,F,y),DlhSoft.Controls.GanttChartView.initialize(h,T,y,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),k(h,T,y),h.isLoadChartInitializing=!1,h.isLoadChartInitialized=!0,h},Ee=function(h){fe(h,h.loadChartItems,h.settings,h.license)},We=function(h){typeof h.target>"u"&&(h.target="Standard"),typeof h.theme>"u"&&(h.theme="Modern"),typeof h.isGridVisible>"u"&&(h.isGridVisible="Phone"!==h.target),typeof h.isReadOnly>"u"&&(h.isReadOnly=!0),typeof h.selectionMode>"u"&&(h.selectionMode="Focus"),typeof h.isVirtualizing>"u"&&(h.isVirtualizing=!0)},Ge=function(h,T){"object"!=typeof T&&(T={}),We(T);var y=[{header:"",width:32,isSelection:!0},{header:"Resource",width:120,isTreeView:!0}];return y[0].cellTemplate=Je(T,y[0],h),y[1].cellTemplate=ye(T,y[1]),y[1].exportCellTemplate=ye(T,y[1],!1),"Single"!=T.selectionMode&&"Extended"!=T.selectionMode&&"ExtendedFocus"!=T.selectionMode&&y.splice(0,1),y},Je=function(h,T){return function(y){return T.isReadOnly?getBooleanNode(y.ganttChartView.ownerDocument,y.isSelected):se(y)}},se=function(h){var y,T=h.ganttChartView.ownerDocument;typeof h.selectionInput>"u"?(y=T.createElement("input"),h.selectionInput=y,y.type="checkbox",y.setAttribute("style","margin: 0px")):y=h.selectionInput,h.isSelected?(y.setAttribute("checked","checked"),y.checked||(y.checked=!0)):y.checked&&(y.checked=!1);var F=function(){y.checked?De(h):typeof h.loadChartView<"u"&&h.loadChartView.unselectItem(h)};return typeof y.changeEventListener<"u"&&y.removeEventListener("change",y.changeEventListener,!0),y.addEventListener("change",t(h.ganttChartView,y,"change",F,!0),!0),y.changeEventListener=F,T=function(x){13==x.keyCode&&(x.preventDefault(),x.stopPropagation(),F())},typeof y.keyPressEventListener<"u"&&y.removeEventListener("keypress",y.keyPressEventListener,!0),y.addEventListener("keypress",t(h.ganttChartView,y,"keypress",T,!0),!0),y.keyPressEventListener=T,y},De=function(h){typeof h.loadChartView<"u"&&h.loadChartView.selectItem(h)},ye=function(h,T,y){var F=function(P){var N=P.content;return(P=P.ganttChartView.ownerDocument.createElement("span")).innerHTML=N,P};return!(typeof y>"u"||y)||h.isReadOnly||h.isGridReadOnly||h.isContentReadOnly?F:function(x){return T.isReadOnly||!(typeof x.isReadOnly>"u")&&x.isReadOnly?F(x):ke(x,Math.max(0,T.width-2),h)}},ke=function(h,T,y){var x,F=h.ganttChartView.ownerDocument;if(typeof h.contentInput>"u"){x=F.createElement("input"),h.contentInput=x,x.type="text",x.addEventListener("focus",t(h.ganttChartView,x,"focus",function(){typeof h.loadChartView<"u"&&(h.loadChartView.currentItem=h),("Focus"==y.selectionMode||"ExtendedFocus"==y.selectionMode)&&!h.isSelected&&De(h)}));var N=function(){h.content=x.value,h.loadChartView.onItemPropertyChanged(h,"content",!0,!0),h.loadChartView.refreshItem(h)};typeof x.changeEventListener<"u"&&x.removeEventListener("change",x.changeEventListener,!0),x.addEventListener("change",t(h.ganttChartView,x,"change",N,!0),!0),x.changeEventListener=N,F=function(P){13==P.keyCode&&(P.preventDefault(),P.stopPropagation(),N())},typeof x.keyPressEventListener<"u"&&x.removeEventListener("keypress",x.keyPressEventListener,!0),x.addEventListener("keypress",t(h.ganttChartView,x,"keypress",F,!0),!0),x.keyPressEventListener=F,x.addEventListener("focus",t(h.ganttChartView,x,"focus",function(){x.style.backgroundColor="White"})),x.addEventListener("blur",t(h.ganttChartView,x,"blur",function(){x.style.backgroundColor="Transparent"}))}else x=h.contentInput;return x.value=h.content,x.setAttribute("style","outline: none; background-color: Transparent; width: "+T+"px; border-width: 0px; padding: 0px"+(y.classic?"":"; font-size: 12px; padding: 1px;")),x},he=function(h){var T=h.loadChartView;if(h.itemTop=h.scheduleChartVisibilityIndex*T.settings.itemHeight,T.refreshGridItem(h),typeof h.ganttChartItems<"u")for(var y=0;y<h.ganttChartItems.length;y++){var F=h.ganttChartItems[y];F.itemTop=h.itemTop,T.refreshChartItem(F)}},ae=function(h,T,y){return function(F){var x=typeof T<"u"?T:F.loadChartView,N=typeof y<"u"?y:x.settings,ve=x.ownerDocument,P=function(h,T){var y=T.ownerDocument;for(typeof h.chartItemArea>"u"&&(h.chartItemArea=y.createElementNS("http://www.w3.org/2000/svg","g")),y=h.chartItemArea.childNodes.length;y-- >0;)h.chartItemArea.removeChild(h.chartItemArea.childNodes[y]);return h.chartItemArea}(F,x),X=x.getChartPosition(F.start,N),ee=Math.max(x.getChartPosition(F.finish,N),X+4),oe=ve.createElementNS("http://www.w3.org/2000/svg","rect"),He=(ve=typeof F.units<"u"?F.units:1,Math.min(ve,N.maxDisplayedUnits)/N.maxDisplayedUnits*N.barHeight);return oe.setAttribute("x",X),oe.setAttribute("y",N.barMargin+(N.barHeight-He)),oe.setAttribute("width",Math.max(0,ee-X-1)),oe.setAttribute("height",He),X=1==ve?N.normalAllocationBarClass:ve<1?N.underAllocationBarClass:N.overAllocationBarClass,typeof F.allocationBarClass<"u"&&(X=F.allocationBarClass),typeof X<"u"?oe.setAttribute("class",X):(X=1==ve?N.normalAllocationBarStyle:ve<1?N.underAllocationBarStyle:N.overAllocationBarStyle,typeof F.allocationBarStyle<"u"&&(X=F.allocationBarStyle),typeof X<"u"&&oe.setAttribute("style",X)),N.isTaskToolTipVisible&&DlhSoft.Controls.ToolTip&&N.useInlineToolTips&&(P.addEventListener("mouseover",t(x,P,"mouseover",function(Ae){1!=Ae.buttons&&((Ae=x.toolTip)&&(Ae.disable(),Ae.hide()),(Ae=DlhSoft.Controls.ToolTip.get(oe))||(Ae=DlhSoft.Controls.ToolTip.initialize(void 0,oe,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+N.border+"; background-color: White; color: Black; font-family: "+(N.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),Ae.setContent(N.itemTemplate(F).innerHTML.replaceAll("\n","<br/>")),Ae.show(),x.taskToolTip=Ae)})),P.addEventListener("mouseout",t(x,P,"mouseout",function(){var Ae=x.taskToolTip;Ae.disable(),Ae.hide()}))),P.appendChild(oe),P}},ue=function(h,T,y,F){var x=F.indexOf(h);x<0||T<0||T==x||T>=F.length||(F.splice(x,1),F.splice(T,0,h),Ee(y),typeof y.settings.itemMoveHandler<"u"&&y.settings.itemMoveHandler(h,x,T))},H=function(h,T){for(var y in T)0!=y.indexOf("custom")&&0!=y.indexOf("description")||typeof h[y]>"u"&&(h[y]=T[y])},a=function(h,T,y,F,x,N,P,X,ee,oe,ve,He,Ae,Ie,be,Le,pe){var me,Fe,Pe=[];if(typeof F<"u")for(me=0;me<F.length;me++)Pe.push({isTreeView:(Fe=pe.columns[F[me]]).isTreeView,header:Fe.header,width:Fe.width,headerClass:Fe.headerClass,headerStyle:Fe.headerStyle,cellClass:Fe.cellClass,cellStyle:Fe.cellStyle,cellTemplate:typeof Fe.exportCellTemplate<"u"?Fe.exportCellTemplate:Fe.cellTemplate});else for(me=0;me<pe.columns.length;me++)(Fe=pe.columns[me]).isSelection||Pe.push({isTreeView:Fe.isTreeView,header:Fe.header,width:Fe.width,headerClass:Fe.headerClass,headerStyle:Fe.headerStyle,cellClass:Fe.cellClass,cellStyle:Fe.cellStyle,cellTemplate:typeof Fe.exportCellTemplate<"u"?Fe.exportCellTemplate:Fe.cellTemplate});typeof y>"u"&&(y=pe.isGridVisible),me=y?function(h){for(var T=0,y=0;y<h.length;y++)T+=h[y].width;return T}(Pe)+1:0,typeof x<"u"?(typeof P>"u"||!P)&&(x=new Date(x.valueOf()-6e4*x.getTimezoneOffset())):x=pe.timelineStart,typeof N<"u"?(typeof P>"u"||!P)&&(N=new Date(N.valueOf()-6e4*N.getTimezoneOffset())):N=pe.timelineFinish,(x={isExport:!0,isReadOnly:!0,selectionMode:"None",isVirtualizing:!1,isGridVisible:y,isSplitterEnabled:!1,gridWidth:me+"px",columns:Pe,allowUserToResizeColumns:!1,isGridRowClickTimeScrollingEnabled:!1,isMouseWheelZoomEnabled:!1,timelineStart:x,timelineFinish:N,extendTimelineToEntireWeeks:pe.extendTimelineToEntireWeeks,hourWidth:typeof X<"u"?X:pe.hourWidth,displayedTime:typeof x<"u"?x:pe.timelineStart,currentTime:pe.currentTime,isTaskToolTipVisible:!1,isDependencyToolTipVisible:!1,areTaskDependenciesVisible:!1,isBaselineVisible:!1,isTaskCompletedEffortVisible:!1,areTaskAssignmentsVisible:!1,containerClass:pe.containerClass,containerStyle:pe.containerStyle,border:pe.border,theme:pe.theme,headerBackground:pe.headerBackground,headerHeight:pe.headerHeight,itemHeight:pe.itemHeight,itemClass:pe.itemClass,itemStyle:pe.itemStyle,indentationLevelWidth:pe.indentationLevelWidth,toggleButtonClass:pe.toggleButtonClass,toggleButtonStyle:pe.toggleButtonStyle,scales:[],visibleWeekStart:pe.visibleWeekStart,visibleWeekFinish:pe.visibleWeekFinish,workingWeekStart:pe.workingWeekStart,workingWeekFinish:pe.workingWeekFinish,visibleDayStart:pe.visibleDayStart,visibleDayFinish:pe.visibleDayFinish,specialNonworkingDays:pe.specialNonworkingDays,barMargin:pe.barMargin,barHeight:pe.barHeight,normalAllocationBarClass:pe.normalAllocationBarClass,underAllocationBarClass:pe.underAllocationBarClass,overAllocationBarClass:pe.overAllocationBarClass,normalAllocationBarStyle:pe.normalAllocationBarStyle,underAllocationBarStyle:pe.underAllocationBarStyle,overAllocationBarStyle:pe.overAllocationBarStyle,alternativeItemClass:pe.alternativeItemClass,alternativeChartItemClass:pe.alternativeChartItemClass,alternativeItemStyle:pe.alternativeItemStyle,alternativeChartItemStyle:pe.alternativeChartItemStyle,gridLines:pe.gridLines,horizontalGridLines:pe.horizontalGridLines,verticalGridLines:pe.verticalGridLines,verticalGridHeaderLines:pe.verticalGridHeaderLines,horizontalChartLines:pe.horizontalChartLines,target:pe.target,months:pe.months,daysOfWeek:pe.daysOfWeek,weekStartDay:pe.weekStartDay,dateFormatter:pe.dateFormatter,dateTimeFormatter:pe.dateTimeFormatter,isRelativeToTimezone:pe.isRelativeToTimezone,allocationTemplate:pe.allocationTemplate,classic:pe.classic}).extendTimelineToEntireWeeks&&(x.timelineStart=DlhSoft.Controls.GanttChartView.getWeekStart(x.timelineStart,x.weekStartDay),x.timelineFinish=DlhSoft.Controls.GanttChartView.getWeekFinish(x.timelineFinish,x.weekStartDay)),be=(be.getChartPosition(x.timelineFinish)-be.getChartPosition(x.timelineStart))/be.settings.hourWidth*x.hourWidth,x.chartWidth=be+"px";var rt=me+be+2+(y?1:0);for(me=0;me<pe.scales.length;me++)x.scales.push({scaleType:(y=pe.scales[me]).scaleType,isHeaderVisible:y.isHeaderVisible,headerHeight:y.headerHeight,headerTextFormat:y.headerTextFormat,headerClass:y.headerClass,headerStyle:y.headerStyle,isHighlightingVisible:y.isHighlightingVisible,highlightingClass:y.highlightingClass,highlightingStyle:y.highlightingStyle,isSeparatorVisible:y.isSeparatorVisible,separatorClass:y.separatorClass,separatorStyle:y.separatorStyle,intervals:y.intervals});var Me,Qe,Be=!1;if(null!=ve&&typeof ve.createElement<"u")Me=ve;else{null!=ve&&typeof ve.focus<"u"?Qe=ve:(Qe=window.open("",ve??"_blank",typeof He<"u"&&He&&(typeof Ie>"u"||Ie)?"width=800,height=640,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),Be=!0),Me=Qe.document;try{var qe=document.head.getElementsByTagName("link");for(me=0;me<qe.length;me++){var ft=qe[me],je=Me.adoptNode(ft.cloneNode(!0));je.href=ft.href,Me.head.appendChild(je)}}catch{}}for(Me.title=typeof h<"u"?h:"Exported chart"+(typeof He<"u"&&He?" (printable)":""),typeof ee>"u"&&(ee=0),typeof oe>"u"&&(oe=Le.length-1),h=[],me=qe=0;me<Le.length;me++)typeof(ve=Le[me]).displayRowIndex<"u"&&(ve.displayRowIndex<ee||ve.displayRowIndex>oe)||typeof ve.displayRowIndex>"u"&&(qe++<ee||qe>oe+1)||(pe={content:ve.content,indentation:ve.indentation,start:ve.start,finish:ve.finish,units:ve.units,isBarVisible:ve.isBarVisible,isRelativeToTimezone:ve.isRelativeToTimezone,class:ve.class,style:ve.style,barClass:ve.barClass,barStyle:ve.barStyle,isSummaryEnabled:ve.isSummaryEnabled,isParentSummarizationEnabled:ve.isParentSummarizationEnabled,isHidden:ve.isHidden,isExported:!0,tag:ve},typeof ve.displayRowIndex<"u"&&(pe.displayRowIndex=ve.displayRowIndex-ee),H(pe,ve),h.push(pe),ve.exportItem=pe);var at=Me.createElement("p");at.innerHTML=typeof T<"u"?T:"",Me.body.appendChild(at);var E=Me.createElement("div");E.setAttribute("style","width: "+rt+"px");try{DlhSoft.Controls.LoadChartView.initialize(E,h,x,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch{}setTimeout(function(){Be&&Me.body.setAttribute("style","margin: 0px");var B=Me.createElement("div");B.appendChild(E),Me.body.replaceChild(B,at),Ae&&(B.setAttribute("style","width: "+E.offsetHeight+"px; height: "+rt+"px; overflow: hidden"),B=Math.round((E.offsetWidth-E.offsetHeight)/2),E.setAttribute("style","width: "+rt+"px; transform: rotate(90deg) translateX("+B+"px) translateY("+B+"px); -webkit-transform: rotate(90deg) translateX("+B+"px) translateY("+B+"px)")),Me.close(),void 0!==typeof Qe&&(Qe.focus(),typeof He<"u"&&He&&(Qe.print(),(typeof Ie>"u"||Ie)&&setTimeout(function(){Qe.close()})))},0)},D=function(h,T,y,F){for(var x=0;x<T.length;x++)T[x].loadChartView=T[x].scheduleChartView=h;h.loadChartItems=h.scheduleChartItems=y,h.settings=F,h.refreshLoadChartItem=he,h.insertLoadChartItem=function(N,P){var X=N;P.loadChartView=P.scheduleChartView=h,P.isVirtuallyVisible=!0,P.loadChartIndex=P.scheduleChartIndex=X;var oe,ee=0;for(oe=0;oe<X;oe++)y[oe].isHidden||ee++;if(P.scheduleChartVisibilityIndex=ee,P.isBarVisible=!1,X=X<y.length?y[X].index:T.length,y.splice(P.loadChartIndex,0,P),h.insertItem(X++,P),typeof P.ganttChartItems<"u")for(oe=0;oe<P.ganttChartItems.length;oe++)(ee=P.ganttChartItems[oe]).loadChartView=ee.scheduleChartView=h,ee.loadChartItem=ee.scheduleChartItem=P,ee.isHidden=P.isHidden,ee.displayRowIndex=P.scheduleChartVisibilityIndex,ee.indentation=P.indentation,h.insertItem(X++,ee);for(oe=P.loadChartIndex+1;oe<y.length;oe++){if((X=y[oe]).loadChartIndex=X.scheduleChartIndex=oe,typeof X.scheduleChartVisibilityIndex<"u"&&X.scheduleChartVisibilityIndex++,typeof X.ganttChartItems<"u")for(ee=0;ee<X.ganttChartItems.length;ee++)X.ganttChartItems[ee].displayRowIndex=X.scheduleChartVisibilityIndex;he(X)}},h.addLoadChartItem=function(N){h.insertLoadChartItem(y.length,N)},h.insertLoadChartItems=function(N,P){for(var X=0;X<P.length;X++)h.insertLoadChartItem(N++,P[X])},h.addLoadChartItems=function(N){for(var P=0;P<N.length;P++)h.addLoadChartItem(N[P])},h.removeLoadChartItem=function(N){if(typeof N.ganttChartItems<"u")for(var P=0;P<N.ganttChartItems.length;P++)h.removeItem(N.ganttChartItems[P]);for(h.removeItem(N),y.splice(N.loadChartIndex,1),N=N.loadChartIndex;N<y.length;N++){if((P=y[N]).loadChartIndex=P.scheduleChartIndex=N,typeof P.scheduleChartVisibilityIndex<"u"&&P.scheduleChartVisibilityIndex--,typeof P.ganttChartItems<"u")for(var X=0;X<P.ganttChartItems.length;X++)P.ganttChartItems[X].displayRowIndex=P.scheduleChartVisibilityIndex;he(P)}},h.removeLoadChartItems=function(N){for(var P=0;P<N.length;P++)h.removeLoadChartItem(N[P])},h.moveLoadChartRange=function(N,P,X){if(!(N<0||X<0||X==N||X>y.length-P)){var oe,ee=[];for(oe=N;oe<N+P;oe++)ee.push(y[oe]);for(y.splice(N,P),oe=0;oe<ee.length;oe++)y.splice(X+oe,0,ee[oe]);if(Ee(h),typeof h.settings.itemMoveHandler<"u")for(oe=0;oe<ee.length;oe++)h.settings.itemMoveHandler(ee[oe],N+oe,X+oe)}},h.moveLoadChartItem=function(N,P){ue(N,P,h,y)},h.moveLoadChartItemUp=function(N){var P=y.indexOf(N);P<=0||ue(N,P-1,h,y)},h.moveLoadChartItemDown=function(N){var P=y.indexOf(N);P<0||P>=y.length-1||ue(N,P+1,h,y)}},k=function(h,T,y){h.items=T,h.refresh=function(){Ee(h)},h.exportContent=function(F,x){typeof F>"u"&&(F={}),a(F.title,F.preparingMessage,F.isGridVisible,F.columnIndexes,F.timelineStart,F.timelineFinish,F.isRelativeToTimezone,F.hourWidth,F.startRowIndex,F.endRowIndex,x,!1,F.rotate,!1,h,T,y)},h.print=function(F){typeof F>"u"&&(F={}),a(F.title,F.preparingMessage,F.isGridVisible,F.columnIndexes,F.timelineStart,F.timelineFinish,F.isRelativeToTimezone,F.hourWidth,F.startRowIndex,F.endRowIndex,null,!0,F.rotate,F.autoClose,h,T,y)}};return{initialize:fe,refresh:Ee,getDefaultColumns:Ge,getDefaultScales:DlhSoft.Controls.GanttChartView.getDefaultScales,getDefaultAllocationTemplate:ae,getDefaultItemTemplate:DlhSoft.Controls.GanttChartView.getDefaultItemTemplate,getWorkingTime:DlhSoft.Controls.GanttChartView.getWorkingTime,textColumnTemplateBase:DlhSoft.Controls.GanttChartView.textColumnTemplateBase,textInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase,getOutputDate:DlhSoft.Controls.GanttChartView.getOutputDate,getInputDate:DlhSoft.Controls.GanttChartView.getInputDate}}()),typeof DlhSoft>"u"&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)}),DlhSoft.assemblies.push({assembly:"DlhSoft.ProjectData.PertChart.HTML.Controls",company:"DlhSoft",product:"Project Data Modern Library",version:"5.3.20.10",copyright:"Copyright \xa9 2012-2023 DlhSoft",title:"Project Data PERT Chart HTML Controls",description:"Project Data PERT Chart related HTML client components"}),DlhSoft.buildReleaseDate=function(t,fe,Ee){return(t=new Date(t,10,25))>DlhSoft.buildReleaseDate?t:DlhSoft.buildReleaseDate}(2023),_0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{"),null==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var t=_0x5c25[1],fe=_0x5c25[2],Ee=[],We=[],Ge=_0x5c25[3];return{setLicense:function(De,ye){Ee[_0x5c25[7]]({type:De,content:ye})},validate:function(De,ye,ke,xe,he,Ce,ae){ye=ye+_0x5c25[4]+ke;for(var ue=0;ue<We[_0x5c25[5]];ue++)if(We[ue]==ye)return;e:if(typeof Ce!==fe&&typeof ae!==t&&(ae[_0x5c25[6]]!==t&&(Ce=ae[_0x5c25[6]]),typeof ae===fe&&(Ce=ae)),typeof Ce!==fe)for(ae=0;ae<Ee[_0x5c25[5]];ae++)if((ue=Ee[ae])[_0x5c25[8]]==ye&&typeof ue[_0x5c25[9]]===fe){Ce=ue[_0x5c25[9]];break e}!function(De,ye){if(typeof De!==fe||typeof ye!==fe)return!1;if(ye==Ge)return!0;var ke=ye[_0x5c25[11]](_0x5c25[10]);if(0<=ke){var he,xe=ye[_0x5c25[12]](0,ke),Ce=xe[_0x5c25[11]](_0x5c25[10]);if(0<=Ce)try{he=new Date(parseInt(xe[_0x5c25[12]](Ce+1)))}catch{}if(typeof he===t&&(he=new Date(2013,11,31)),DlhSoft[_0x5c25[13]]>he)return!1;for(xe=xe+_0x5c25[10]+De,i=he=0;i<xe[_0x5c25[5]];i++)he=(he<<5)-he+(Ce=xe[_0x5c25[14]](i)),he&=he;if(0>he&&(he=Math[_0x5c25[15]](2,32)-he),(xe=he.toString(16)[_0x5c25[16]]())==(ke=ye[_0x5c25[12]](ke+1)))return!0}return!1}(ye,Ce)?function(De,ye,ke,xe,he){var Ce=_0x5c25[17],ue=typeof ComponentSource!==t&&ComponentSource?_0x5c25[21]:_0x5c25[18]+_0x5c25[19]+xe+_0x5c25[20]+he,H=xe+_0x5c25[22]+he+_0x5c25[23],a=_0x5c25[24],D=_0x5c25[25],k=_0x5c25[26];setTimeout(function(){var h=De[_0x5c25[27]],T=h[_0x5c25[29]](_0x5c25[28]);T[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var y=h[_0x5c25[29]](_0x5c25[28]);y[_0x5c25[32]](_0x5c25[30],_0x5c25[33]);var F=h[_0x5c25[29]](_0x5c25[28]);F[_0x5c25[32]](_0x5c25[30],_0x5c25[34]),y[_0x5c25[35]](F),F[_0x5c25[35]](h[_0x5c25[36]](Ce)),y[_0x5c25[35]](h[_0x5c25[36]](a+_0x5c25[10])),(F=h[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),F[_0x5c25[35]](h[_0x5c25[36]](ye)),y[_0x5c25[35]](F),y[_0x5c25[35]](h[_0x5c25[36]](D+_0x5c25[10])),(F=h[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),F[_0x5c25[35]](h[_0x5c25[36]](H)),y[_0x5c25[35]](F),y[_0x5c25[35]](h[_0x5c25[36]](k+_0x5c25[10])),(F=h[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var x=h[_0x5c25[29]](_0x5c25[39]);x[_0x5c25[32]](_0x5c25[30],_0x5c25[40]),x[_0x5c25[32]](_0x5c25[41],ue),x[_0x5c25[32]](_0x5c25[42],_0x5c25[43]),x[_0x5c25[35]](h[_0x5c25[36]](_0x5c25[44])),F[_0x5c25[35]](x),(x=h[_0x5c25[29]](_0x5c25[39]))[_0x5c25[32]](_0x5c25[30],_0x5c25[45]),x[_0x5c25[32]](_0x5c25[41],_0x5c25[46]),x[_0x5c25[35]](h[_0x5c25[36]](_0x5c25[47])),x[_0x5c25[50]](_0x5c25[48],function(){De[_0x5c25[49]](T),We[_0x5c25[7]](ke)},!1),F[_0x5c25[35]](x),y[_0x5c25[35]](F),T[_0x5c25[35]](y),De[_0x5c25[35]](T)},0),setTimeout(function(){alert(Ce+_0x5c25[51]+a+_0x5c25[52]+ye+_0x5c25[51]+D+_0x5c25[53]+H+_0x5c25[51]+k+_0x5c25[4])},6e5)}(De,ke,ye,xe,he):De[_0x5c25[6]]=Ce}}}()),null==DlhSoft.Controls&&(DlhSoft.Controls={}),null==DlhSoft.Controls.Pert&&(DlhSoft.Controls.Pert={}),null==DlhSoft.Controls.Pert.PertChartView&&(DlhSoft.Controls.Pert.PertChartView=function(){var t=function(E,B,O,c,w){return E.internalEventListeners&&E.internalEventListeners.push({object:B,event:O,handler:c,useCapture:w}),c},fe=function(E,B,O,S){var w=["DlhSoft.Controls.Pert","PertChartView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];if(DlhSoft[w[5]][w[4]](E,w[0],w[1],w[2],w[3],S,O),E.isInitializing=!0,typeof E.initializedItems<"u"&&(E.initializedItems.forEach(function(te){te.chartItemArea&&te.chartItemArea.parentNode&&te.chartItemArea.parentNode.removeChild(te.chartItemArea),delete te.pertChartView,delete te.chartItem,delete te.chartItemArea}),typeof E.draggableItems<"u"&&delete E.draggableItems),E.initializedItems=B.slice(),E.internalEventListeners&&E.internalEventListeners.forEach(function(te){te.object.removeEventListener(te.event,te.handler,te.useCapture)}),E.internalEventListeners=[],typeof E.items<"u")for(S=0;S<E.items.length;S++)delete E.items[S].successors;"object"!=typeof O&&(O={}),Je(B,O),Ge(O,B,E),at(E,B,O),se(B);var C=xe(E,B,O),b=E.ownerDocument;(S=b.createElement("div")).setAttribute("style","font-family: "+(O.classic?"Arial":"system-ui, Arial")+"; font-size: "+(O.classic?"small":"12px")+"; overflow: auto"),w=b.createElement("div"),typeof O.containerClass<"u"&&w.setAttribute("class",O.containerClass),typeof O.containerStyle<"u"&&w.setAttribute("style",O.containerStyle),S.appendChild(w),(M=b.createElement("div")).setAttribute("style","border: solid 1px "+O.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden"),w.appendChild(M),(w=b.createElement("div")).setAttribute("style","overflow: auto"),M.appendChild(w);var L=b.createElement("div");L.setAttribute("style","overflow: "+(typeof O.isExport>"u"||!O.isExport?"auto":"hidden")+"; height: "+C),w.appendChild(L);var $,M=ae(B,O),U=ue(B,O),J=b.createElement("div");J.setAttribute("style","float: left; overflow: hidden; width: "+M+"px; height: "+U+"px"),L.appendChild(J),(C=b.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("style","width: "+M+"px; height: "+U+"px"),M=O.styleDefinitionTemplate(),C.appendChild(M),C.chartAreaDefinitions=M,C.addEventListener("mousedown",t(E,C,"mousedown",M=function(){setTimeout(function(){try{var te=J.chartArea,G=te.chartAreaDefinitions;te.removeChild(G),te.childNodes.length>0?te.insertBefore(G,te.childNodes[0]):te.appendChild(G)}catch{}},0)},!0),!0),b.addEventListener("mouseup",t(E,b,"mouseup",M,!0),!0),J.appendChild(C),J.chartArea=C,setTimeout(function(){$=E.clientHeight},0),typeof E.heightUpdateTimer<"u"&&clearInterval(E.heightUpdateTimer),E.heightUpdateTimer=setInterval(function(){try{if(!(E.clientHeight<=0)){var te=E.clientHeight;if(te!=$){var G=xe(E,B,O);L.style.height=G,$=te}}}catch{try{clearInterval(E.heightUpdateTimer)}catch{}}},100);var q=function(te,G,K,ie){var ge;if(O.mouseHandler||O.mouseMoveHandler&&"mousemove"==ie||O.mouseDownHandler&&"mousedown"==ie||O.clickHandler&&"click"==ie||O.doubleClickHandler&&"dblclick"==ie){var Z=te.which;!Z&&te.button&&(1&te.button?Z=1:4&te.button?Z=2:2&te.button&&(Z=3)),ge=K.getBoundingClientRect();var Q=b.body,we=b.documentElement;for(K=ge.left+(window.pageXOffset||we.scrollLeft||Q.scrollLeft)-(we.clientLeft||Q.clientLeft||0),ge=Math.round(ge.top+(window.pageYOffset||we.scrollTop||Q.scrollTop)-(we.clientTop||Q.clientTop||0)),K=Math.round(K),K=te.pageX-K,ge=te.pageY-ge,Q=0;Q<B.length;Q++){var Xe=a(we=B[Q],O),Ze=D(we,O);K>=Xe&&K<Xe+O.itemWidth&&ge>=Ze&&ge<Ze+O.itemHeight&&(O.mouseHandler&&O.mouseHandler(ie,we,Z,G,te),O.mouseMoveHandler&&"mousemove"==ie&&O.mouseMoveHandler(we),O.mouseDownHandler&&"mousedown"==ie&&O.mouseDownHandler(we,Z),O.itemClickHandler&&"click"==ie&&O.itemClickHandler(we),O.itemDoubleClickHandler&&"dblclick"==ie&&O.itemDoubleClickHandler(we))}}};return J.addEventListener("mousemove",t(E,J,"mousemove",function(te){q(te,0,J,"mousemove")})),J.addEventListener("mousedown",t(E,J,"mousedown",function(te){q(te,1,J,"mousedown")})),J.addEventListener("click",t(E,J,"click",function(te){q(te,1,J,"click")})),J.addEventListener("dblclick",t(E,J,"dblclick",function(te){q(te,2,J,"dblclick")})),J.addEventListener("click",t(E,J,"click",function(te){te.srcElement&&"rect"!=te.srcElement.nodeName&&te.stopPropagation()},!0),!0),J.addEventListener("touchmove",t(E,J,"touchmove",function(te){E.draggingItem&&te.preventDefault()},!0),!0),J.container=L,E.chartContainer=w,E.chartContent=J,E.chartContentContainer=L,L.isInitializing=!0,me(E,S),H(J,C,B,O),L.isInitializing=!1,E.isInitializing=!1,E.isInitialized=!0,E},Ee=function(E){fe(E,E.items,E.settings,E.license)},Ge=function(E,B,O){if(function(E){typeof E.timeSpanFormatter>"u"&&(E.timeSpanFormatter=Ce),typeof E.itemPropertyChangeHandler>"u"&&(E.itemPropertyChangeHandler=function(){}),typeof E.target>"u"&&(E.target="Standard"),typeof E.theme>"u"&&(E.theme="Modern")}(E),typeof E.border>"u")switch(E.theme){default:E.border="#e0e0e0";break;case"ModernBordered":case"Aero":E.border="#9a9a9a"}typeof E.canUserRearrangeItems>"u"&&(E.canUserRearrangeItems=!0),typeof E.snapRearrangedItemsToGuidelines>"u"&&(E.snapRearrangedItemsToGuidelines=!0),typeof E.itemWidth>"u"&&(E.itemWidth=40),typeof E.itemHeight>"u"&&(E.itemHeight=40),typeof E.aspectRatio>"u"&&(E.aspectRatio=1),typeof E.shapeWidth>"u"&&(E.shapeWidth=32),typeof E.shapeHeight>"u"&&(E.shapeHeight=32),typeof E.styleDefinitionTemplate>"u"&&(E.styleDefinitionTemplate=P(O,E)),typeof E.dependencyTextBlockWidth>"u"&&(E.dependencyTextBlockWidth=120),typeof E.shapeStyle>"u"&&null==E.shapeClass&&(E.shapeStyle="fill: White; stroke: #606060; stroke-width: 0.75px"),typeof E.temporaryThumbStyle>"u"&&null==E.temporaryThumbClass&&(E.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; "),typeof E.dependencyLineStyle>"u"&&null==E.dependencyLineClass&&(E.dependencyLineStyle="stroke: "+(E.classic?"#8080FF":"#3b87d9")+"; stroke-width: 0.65px; fill: none; marker-end: url(#PertArrowMarker)"),typeof E.virtualEffortDependencyLineStyle>"u"&&null==E.virtualEffortDependencyLineClass&&(E.virtualEffortDependencyLineStyle="stroke: "+(E.classic?"#8080FF":"#3b87d9")+"; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#PertArrowMarker)"),typeof E.dependencyLineZoneStyle>"u"&&null==E.dependencyLineZoneClass&&(E.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none"),typeof E.taskEventTemplate>"u"&&(E.taskEventTemplate=oe()),typeof E.dependencyTextStyle>"u"&&(E.dependencyTextStyle="color: #606060; text-anchor: middle"),typeof E.chartMargin>"u"&&(E.chartMargin=16),typeof E.isTaskEventToolTipVisible>"u"&&(E.isTaskEventToolTipVisible="Phone"!==E.target),typeof E.itemTemplate>"u"&&(E.itemTemplate=X(E)),typeof E.dependencyLineTemplate>"u"&&(E.dependencyLineTemplate=ve()),typeof E.isDependencyToolTipVisible>"u"&&(E.isDependencyToolTipVisible=E.isTaskEventToolTipVisible),typeof E.predecessorItemTemplate>"u"&&(E.predecessorItemTemplate=He(E)),typeof E.useInlineToolTips>"u"&&(E.useInlineToolTips=!0),typeof E.useInlineToolTipsForDependencies>"u"&&(E.useInlineToolTipsForDependencies=!0)},Je=function(E){for(var B=0;B<E.length;B++){var O=E[B];if("string"==typeof O&&(E[B]=O={content:O}),typeof O.predecessors<"u"){"string"==typeof O.predecessors&&(O.predecessors=O.predecessors.split(","));for(var c=0;c<O.predecessors.length;c++){var w=O.predecessors[c];if("string"==typeof w&&(O.predecessors[c]=w={item:w}),"string"==typeof w.item){var C=parseInt(w.item)-1;w.item=C>=0&&C<E.length?E[C]:null}"string"==typeof w.effort&&(w.effort=parseFloat(w.effort))}}typeof O.displayedRowIndex<"u"&&(O.actualRowIndex=O.displayedRowIndex),typeof O.displayedColumnIndex<"u"&&(O.actualColumnIndex=O.displayedColumnIndex),typeof O.actualRowIndex>"u"&&(O.actualRowIndex=0),typeof O.actualColumnIndex>"u"&&(O.actualColumnIndex=0)}},se=function(E){E.positionedItems=[],E.maxRowIndex=null;for(var B=0;B<E.length;B++){var O=E[B],c=E;if(typeof O.displayedRowIndex>"u"){var w;if(typeof O.predecessors<"u"){w=c.positionedItems;for(var C=[],b=O.predecessors,S=0;S<w.length;S++)for(var L=w[S],M=0;M<b.length;M++)if(b[M].item==L){C.push(L);break}w=C}else w=null;if(null!=w){for(C=w,b=[],S=0;S<C.length;S++)b.indexOf(L=C[S].actualRowIndex)<0&&b.push(L);C=b}else C=null;if(C=null!=C&&C.length>0?je(C):null!=c.maxRowIndex?c.maxRowIndex+1:0,b=b=void 0,typeof O.displayedColumnIndex>"u"){if(b=(b=De(c.positionedItems,C)).length>0?je(b)+1:0,null!=(S=null!=w?De(w,C):null)&&S.length>0){for(L=null,M=0;M<S.length;M++)(null==L||S[M]<L)&&(L=S[M]);S=L+1}else S=null;for(null!=S&&S!=b&&(C++,b=null!=(w=null!=w?ye(w):null)&&w.length>0?je(w)+1:0),O.actualColumnIndex=b;ke(c.positionedItems,C,b);)C++}else for(;!((b=(b=De(c.positionedItems,C)).length>0?je(b)+1:0)<=O.actualColumnIndex);C++);O.actualRowIndex=C}else typeof O.displayedColumnIndex>"u"&&(w=ye(c.positionedItems),O.actualColumnIndex=w.length>0?je(w)+1:0);c.positionedItems.push(O),(null==c.maxRowIndex||O.actualRowIndex>c.maxRowIndex)&&(c.maxRowIndex=O.actualRowIndex)}},De=function(E,B){for(var O=[],c=0;c<E.length;c++){var w=E[c];w.actualRowIndex==B&&O.indexOf(w=w.actualColumnIndex)<0&&O.push(w)}return O},ye=function(E){for(var B=[],O=0;O<E.length;O++){var c=E[O].actualColumnIndex;B.indexOf(c)<0&&B.push(c)}return B},ke=function(E,B,O){for(var c=0;c<E.length;c++){var w=E[c];if(w.actualRowIndex==B&&w.actualColumnIndex==O)return!0}return!1},xe=function(E,B,O){var c;if(E.isContentHeightInitialized&&E.isContentHeightAuto)c=B.length>0?"auto":O.itemHeight+"px";else{var w=E.clientHeight-2;w<0&&(w=0),c=w+"px",w<O.itemHeight&&(E.isContentHeightInitialized||(E.isContentHeightAuto=!0),c=B.length>0?"auto":O.itemHeight+"px"),E.isContentHeightInitialized=!0}return c},he=function(E,B){var O=E.createElement("span");return O.innerHTML=B,O},Ce=function(E){return Math.ceil(E/36e5*1e4/100)/100+"h"},ae=function(E,B){for(var O=0,c=0;c<E.length;c++)O=Math.max(O,E[c].actualColumnIndex);return B.itemWidth+O*(B.itemWidth+B.dependencyTextBlockWidth)+2*B.chartMargin},ue=function(E,B){for(var O=0,c=0;c<E.length;c++)O=Math.max(O,E[c].actualRowIndex);return B.itemHeight+O*(B.itemHeight+B.dependencyTextBlockWidth/B.aspectRatio)+2*B.chartMargin},H=function(E,B,O,c){for(E=0;E<O.length;E++){var w=O[E],C=a(w,c),b=D(w,c);B.appendChild(h(w,C,b,c))}},a=function(E,B){return typeof E.displayedColumnIndex<"u"&&(E.actualColumnIndex=E.displayedColumnIndex),Math.max(0,B.chartMargin+E.actualColumnIndex*(B.itemWidth+B.dependencyTextBlockWidth))},D=function(E,B){return typeof E.displayedRowIndex<"u"&&(E.actualRowIndex=E.displayedRowIndex),Math.max(0,B.chartMargin+E.actualRowIndex*(B.itemHeight+B.dependencyTextBlockWidth/B.aspectRatio))},k=function(E){for(var O,c,B=[],w=0;w<E.length;w++){var C=E[w];if(typeof C.predecessors<"u"&&C.predecessors.length>0)for(var b=0;b<C.predecessors.length;b++){var S=C.predecessors[b].item;if(typeof S<"u"){for(O=!0,c=0;c<B;c++)if(S==B[c]){O=!1;break}O&&(T(S.chartItem,S,S.pertChartView.settings),O=a(S,S.pertChartView.settings),c=D(S,S.pertChartView.settings),S.chartItem.setAttribute("transform","translate("+O+", "+c+")"),B.push(S))}}if(typeof C.predecessors<"u"&&C.predecessors.length>0){for(O=!0,c=0;c<B;c++)if(typeof C<"u"&&C==B[c]){O=!1;break}O&&(T(C.chartItem,C,C.pertChartView.settings),O=a(C,C.pertChartView.settings),c=D(C,C.pertChartView.settings),C.chartItem.setAttribute("transform","translate("+O+", "+c+")"),B.push(C))}}},h=function(E,B,O,c){var w=E.pertChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");return E.chartItem=w,w.setAttribute("style","-ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),w.setAttribute("transform","translate("+B+", "+O+")"),T(w,E,c),w},T=function(E,B,O){for(var c=E.childNodes.length;c-- >0;)E.removeChild(E.childNodes[c]);if(typeof B.isShapeVisible>"u"||B.isShapeVisible){if(c=O.taskEventTemplate,typeof B.taskEventTemplate<"u"&&(c=B.taskEventTemplate),c=c(B),E.appendChild(c),typeof O.internalExtraTaskTemplate<"u"){var w=O.internalExtraTaskTemplate(B);null!=w&&E.appendChild(w)}if(typeof O.extraTaskEventTemplate<"u"&&null!=(w=O.extraTaskEventTemplate(B))&&E.appendChild(w),O.isTaskEventToolTipVisible&&!O.useInlineToolTips&&(w=O.itemTemplate,typeof B.template<"u"&&(w=B.template),c.appendChild(w(B))),typeof B.predecessors<"u")for(c=0;c<B.predecessors.length;c++)if(w=B.predecessors[c],!((typeof B.pertChartView>"u"||B.pertChartView.items.indexOf(w.item))<0)){var C=O.dependencyLineTemplate(B,w);if(C.predecessorIndex=c,function(S){C.addEventListener("click",t(B.pertChartView,C,"click",function(L){O.dependencyLineClickHandler&&O.dependencyLineClickHandler(S,B,L)})),C.addEventListener("dblclick",t(B.pertChartView,C,"dblclick",function(L){O.dependencyLineDoubleClickHandler&&O.dependencyLineDoubleClickHandler(S,B,L)}))}(w),E.appendChild(C),O.isDependencyToolTipVisible&&(!O.useInlineToolTips||!O.useInlineToolTipsForDependencies)){var b=O.predecessorItemTemplate;typeof w.template<"u"&&(b=w.template),C.appendChild(b(B,w))}}}},y=function(E){typeof E.isWaitingToRefreshChartItem>"u"&&(E.isWaitingToRefreshChartItem=!0,setTimeout(function(){T(E.chartItem,E,E.pertChartView.settings);var B=a(E,E.pertChartView.settings),O=D(E,E.pertChartView.settings);E.chartItem.setAttribute("transform","translate("+B+", "+O+")"),delete E.isWaitingToRefreshChartItem},0))},F=function(E){y(E)},x=function(E){typeof E.isWaitingToRefreshPredecessorItems>"u"&&(E.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){k(E.pertChartView.items),delete E.isWaitingToRefreshPredecessorItems},0))},N=function(E){typeof E.isWaitingToRefreshChartItem<"u"||typeof E.isWaitingToRefreshPredecessorItems<"u"?(typeof E.isWaitingToRefreshChartItem>"u"&&y(E),typeof E.isWaitingToRefreshPredecessorItems>"u"&&x(E)):(E.isWaitingToRefreshChartItem=!0,E.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){T(E.chartItem,E,E.pertChartView.settings);var B=a(E,E.pertChartView.settings),O=D(E,E.pertChartView.settings);E.chartItem.setAttribute("transform","translate("+B+", "+O+")"),k(E.pertChartView.items),delete E.isWaitingToRefreshChartItem,delete E.isWaitingToRefreshPredecessorItems},0))},P=function(E,B){return function(){var O=E.ownerDocument,c=O.createElementNS("http://www.w3.org/2000/svg","defs"),w=O.createElementNS("http://www.w3.org/2000/svg","marker");return w.setAttribute("id","PertArrowMarker"),w.setAttribute("viewBox","0 0 10 10"),w.setAttribute("refX","0"),w.setAttribute("refY","5"),w.setAttribute("markerUnits","strokeWidth"),w.setAttribute("markerWidth","5"),w.setAttribute("markerHeight","4"),w.setAttribute("orient","auto"),(O=O.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M 0 0 L 10 5 L 0 10 z"),O.setAttribute("fill",B.arrowFill?B.arrowFill:"Aero"==B.theme?"Blue":"#8080ff"),w.appendChild(O),c.appendChild(w),c}},X=function(){return function(E){var B=E.pertChartView.ownerDocument,O=B.createElementNS("http://www.w3.org/2000/svg","title");return O.appendChild(he(B,typeof E.content<"u"?E.content:"")),O}},oe=function(E,B,O){return function(c){var te,w=typeof B<"u"?B:c.pertChartView,C=typeof O<"u"?O:w.settings,b=typeof E<"u"?E:w.items,S=w.ownerDocument,L=function(E){var B=E.pertChartView.ownerDocument;for(typeof E.chartItemArea>"u"&&(E.chartItemArea=B.createElementNS("http://www.w3.org/2000/svg","g")),B=E.chartItemArea.childNodes.length;B-- >0;)E.chartItemArea.removeChild(E.chartItemArea.childNodes[B]);return E.chartItemArea}(c),M=(C.itemWidth-C.shapeWidth)/2,U=M+C.shapeWidth,J=(C.itemHeight-C.shapeHeight)/2,$=J+C.shapeHeight,q=C.shapeHeight,G=S.createElementNS("http://www.w3.org/2000/svg","rect");return G.setAttribute("x",M),G.setAttribute("y",J),G.setAttribute("width",Math.max(0,U-M-1)),G.setAttribute("height",Math.max(0,$-J-1)),G.setAttribute("rx",C.shapeWidth/10),G.setAttribute("ry",C.shapeHeight/10),te=C.shapeClass,typeof c.shapeClass<"u"&&(te=c.shapeClass),typeof te<"u"?G.setAttribute("class",te):(te=C.shapeStyle,typeof c.shapeStyle<"u"&&(te=c.shapeStyle),typeof te<"u"&&G.setAttribute("style",te)),L.appendChild(G),L.addEventListener("mouseover",t(w,L,"mouseover",function(){var K=DlhSoft.Controls.ToolTip.get(G);K||(K=DlhSoft.Controls.ToolTip.initialize(void 0,G,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+C.border+"; background-color: White; color: Black; font-family: "+(C.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),K.setContent(C.itemTemplate(c).innerHTML.replaceAll("\n","<br/>")),K.show(),w.toolTip=K})),L.addEventListener("mouseout",t(w,L,"mouseout",function(){var K=w.toolTip;K.disable(),K.hide()})),(te=S.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",(M+U)/2),te.setAttribute("y",$-1.5*q/8-6),te.setAttribute("style","font-weight: bold; text-anchor: middle"),typeof(q=c.displayedText)>"u"&&(q=""),te.appendChild(S.createTextNode(q)),L.appendChild(te),C.canUserRearrangeItems&&((S=S.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",M),S.setAttribute("y",J),S.setAttribute("width",Math.max(0,U-M-1)),S.setAttribute("height",Math.max(0,$-J-1)),S.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),L.appendChild(S),be(S,c,b,a(c,C),D(c,C),w,C)),L}},ve=function(E,B){return function(O,c){var w=O.pertChartView,C=typeof B<"u"?B:w.settings,M=typeof E<"u"?E:w.items,b=w.ownerDocument,S=b.createElementNS("http://www.w3.org/2000/svg","g"),L={x:void 0,y:void 0},U=(M=Ae(O,c,M,C,L),b.createElementNS("http://www.w3.org/2000/svg","path"));U.setAttribute("d",M),typeof C.dependencyLineZoneClass<"u"&&U.setAttribute("class",C.dependencyLineZoneClass),typeof C.dependencyLineZoneStyle<"u"&&U.setAttribute("style",C.dependencyLineZoneStyle),S.appendChild(U);var J=b.createElementNS("http://www.w3.org/2000/svg","path");return J.setAttribute("d",M),(typeof c.isEffortVirtual<"u"?!c.isEffortVirtual:typeof c.effort<"u"&&c.effort>0)?(M=C.dependencyLineClass,typeof c.dependencyLineClass<"u"&&(M=c.dependencyLineClass),typeof M<"u"&&J.setAttribute("class",M),M=C.dependencyLineStyle,typeof c.dependencyLineStyle<"u"&&(M=c.dependencyLineStyle)):(M=C.virtualEffortDependencyLineClass,typeof c.virtualEffortDependencyLineClass<"u"&&(M=c.virtualEffortDependencyLineClass),typeof M<"u"&&J.setAttribute("class",M),M=C.virtualEffortDependencyLineStyle,typeof c.virtualEffortDependencyLineStyle<"u"&&(M=c.virtualEffortDependencyLineStyle)),typeof M<"u"&&J.setAttribute("style",M),S.appendChild(J),C.isDependencyToolTipVisible&&C.useInlineToolTips&&C.useInlineToolTipsForDependencies&&(S.addEventListener("mouseover",t(w,S,"mouseover",function($){var q=C.predecessorItemTemplate(O,c).innerHTML.replaceAll("\n","<br/>");if(""!=q&&"<span></span>"!=q){(q=DlhSoft.Controls.ToolTip.get(J))||(q=DlhSoft.Controls.ToolTip.initialize(void 0,J,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+C.border+"; background-color: White; color: Black; font-family: "+(C.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),q.setContent(C.predecessorItemTemplate(O,c).innerHTML.replaceAll("\n","<br/>")),q.show();var te=S.getBoundingClientRect();q.setHorizontalPosition(q.x+$.clientX-te.left),q.setVerticalPosition(q.y+$.clientY-te.bottom+10),w.toolTip=q}})),S.addEventListener("mouseout",t(w,S,"mouseout",function(){var $=w.toolTip;$.disable(),$.hide()}))),(M=b.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",L.x),M.setAttribute("y",L.y-6),L=C.dependencyTextClass,typeof c.dependencyTextClass<"u"&&(L=c.dependencyTextClass),typeof L<"u"&&M.setAttribute("class",L),L=C.dependencyTextStyle,typeof c.dependencyTextStyle<"u"&&(L=c.dependencyTextStyle),M.setAttribute("style",L),typeof(L=c.displayedText)>"u"&&(L=""),M.appendChild(b.createTextNode(L)),S.appendChild(M),S}},He=function(){return function(E,B){var O=E.pertChartView.ownerDocument,c=O.createElementNS("http://www.w3.org/2000/svg","title");return c.appendChild(he(O,typeof B.content<"u"?B.content:"")),c}},Ae=function(J,M,C,G,w){C="M ";var b=a(J,G)-2,S=D(J,G)-2,L=a(M.item,G),U=(M=D(M.item,G),a(J,G)),$=(J=D(J,G),Math.abs(U-L)),q=Math.abs(J-M),te=G.shapeWidth+2,K=te/2,ie=(G=G.shapeHeight+2)/2,ge=Math.max(te,G);return $<ge?C=M<=J?C+(L+K-b+",")+(M+G-S)+" L "+(U+K-b)+","+(J-S):C+(L+K-b+",")+(M-S)+" L "+(U+K-b)+","+(J+G-S):(C=L<=U?C+(L+te-b+",")+(M+ie-S):C+(L-b+",")+(M+ie-S),C=q<4*ge?L<=U?C+" L "+(U-b)+","+(J+ie-S):C+" L "+(U+te-b)+","+(J+ie-S):M<=J?C+" L "+(U+K-b)+","+(J-S):C+" L "+(U+K-b)+","+(J+G-S)),w.x=((L<=U?L:U)+(L>=U?L:U))/2+K-b,w.y=((M<=J?M:J)+(M>=J?M:J))/2+ie-S,C},Ie=function(E,B,O,c){typeof E.pertChartView<"u"&&E.pertChartView.settings.itemPropertyChangeHandler(E,B,O,c)},be=function(E,B,O,c,w,C,b){function S($){C.draggingItem=B,C.dragType="Position",C.style.cursor=E.style.cursor,C.draggingInitialX=$.clientX,C.draggingInitialY=$.clientY,C.draggingInitialThumbXPosition=c,C.draggingInitialThumbYPosition=w}E.addEventListener("mousedown",t(C,E,"mousedown",function($){0==$.button&&(S($),$.preventDefault())},!0),!0),E.addEventListener("touchstart",t(C,E,"touchstart",function($){S($.touches[0]),$.preventDefault()},!0),!0),typeof C.draggableItems>"u"&&(C.draggableItems=[]);for(var L=!1,M=0;M<C.draggableItems.length;M++)if(C.draggableItems[M]==B){L=!0;break}if(!L){var U=function($){if(!(typeof C.draggingItem>"u"||C.draggingItem!=B||"Position"!=C.dragType)){var q=$.clientX-C.draggingInitialX,te=$.clientY-C.draggingInitialY,G=$.clientX,K=C;if(typeof K.draggingItem<"u"){var ie=new Date;if(!K.lastXDraggingTime||!(ie>K.lastXDraggingTime&&ie-K.lastXDraggingTime<200)){K.lastXDraggingTime=ie;var ge=0;if((ie=K).offsetParent)do{ge+=ie.offsetLeft,ie=ie.offsetParent}while(ie);(G-=ge)<24?(G=K.chartContentContainer.scrollLeft,K.chartContentContainer.scrollLeft=K.chartContentContainer.scrollLeft-48,G-=K.chartContentContainer.scrollLeft,typeof K.draggingInitialThumbXPosition<"u"&&(K.draggingInitialThumbXPosition=K.draggingInitialThumbXPosition-G)):G>=K.chartContentContainer.clientWidth-24&&(G=K.chartContentContainer.scrollLeft,K.chartContentContainer.scrollLeft=K.chartContentContainer.scrollLeft+48,G=K.chartContentContainer.scrollLeft-G,typeof K.draggingInitialThumbXPosition<"u"&&(K.draggingInitialThumbXPosition=K.draggingInitialThumbXPosition+G))}}if(K=$.clientY,typeof($=C).draggingItem<"u"&&(G=new Date,!$.lastYDraggingTime||!(G>$.lastYDraggingTime&&G-$.lastYDraggingTime<200))){if($.lastYDraggingTime=G,ie=0,(G=$).offsetParent)do{ie+=G.offsetTop,G=G.offsetParent}while(G);(K-=ie)<24?(K=$.chartContentContainer.scrollTop,$.chartContentContainer.scrollTop=$.chartContentContainer.scrollTop-48,K-=$.chartContentContainer.scrollTop,typeof $.draggingInitialThumbYPosition<"u"&&($.draggingInitialThumbYPosition=$.draggingInitialThumbYPosition-K)):K>=$.chartContentContainer.clientHeight-24&&(K=$.chartContentContainer.scrollTop,$.chartContentContainer.scrollTop=$.chartContentContainer.scrollTop+48,K=$.chartContentContainer.scrollTop-K,typeof $.draggingInitialThumbYPosition<"u"&&($.draggingInitialThumbYPosition=$.draggingInitialThumbYPosition+K))}delete C.draggingItem,C.draggingInitialThumbXPosition+q<0&&(q=-C.draggingInitialThumbXPosition),C.draggingInitialThumbYPosition+te<0&&(te=-C.draggingInitialThumbYPosition),$=B,te=(C.draggingInitialThumbYPosition+te-b.chartMargin)/(b.itemHeight+b.dependencyTextBlockWidth/b.aspectRatio),b.snapRearrangedItemsToGuidelines&&(te=Math.round(te)),$.actualRowIndex=te,te=B,q=(C.draggingInitialThumbXPosition+q-b.chartMargin)/(b.itemWidth+b.dependencyTextBlockWidth),b.snapRearrangedItemsToGuidelines&&(q=Math.round(q)),te.actualColumnIndex=q,Ie(B,"actualRowIndex",!0,!1),Ie(B,"actualColumnIndex",!0,!1),typeof B.displayedColumnIndex<"u"&&delete B.displayedColumnIndex,typeof B.displayedRowIndex<"u"&&delete B.displayedRowIndex,Le(B,O,C.chartContent,b,!1),C.draggingItem=B,C.draggingPerformed=!0}};C.addEventListener("mousemove",t(C,C,"mousemove",function($){U($)},!0),!0),C.addEventListener("touchmove",t(C,C,"touchmove",function($){U($.touches[0])},!0),!0);var J=function(){if(!(typeof C.draggingItem>"u"||C.draggingItem!=B||"Position"!=C.dragType)){Le(B,O,C.chartContent,b,!0);var $=C.draggingItem;delete C.draggingItem,C.style.cursor="default",C.draggingPerformed&&(Ie($,"actualColumnIndex",!0,!0),Ie($,"actualRowIndex",!0,!0),delete C.draggingPerformed)}};document.addEventListener("mouseup",t(C,document,"mouseup",function($){0==$.button&&J()},!0),!0),document.addEventListener("touchend",t(C,document,"touchend",function(){J()},!0),!0),C.draggableItems.push(B)}},Le=function(E,B,O,c,w){var C=E.pertChartView.ownerDocument;if(w)typeof O.temporaryRectangle<"u"&&((w=O.chartArea).removeChild(O.temporaryRectangle),delete O.temporaryRectangle),setTimeout(function(){T(E.chartItem,E,c),b=a(E,c),S=D(E,c),E.chartItem.setAttribute("transform","translate("+b+", "+S+")"),k(B),setTimeout(function(){pe(O,B,c,!0)},0)});else{typeof O.temporaryRectangle<"u"?C=O.temporaryRectangle:((C=C.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",0),C.setAttribute("y",0),C.setAttribute("width",c.shapeWidth),C.setAttribute("height",c.shapeHeight),C.setAttribute("rx",c.shapeWidth/10),C.setAttribute("ry",c.shapeHeight/10),typeof c.temporaryThumbClass<"u"&&C.setAttribute("class",c.temporaryThumbClass),C.setAttribute("style",c.temporaryThumbStyle),O.temporaryRectangle=C,(w=O.chartArea).appendChild(C));var b=a(E,c)+(c.itemWidth-c.shapeWidth)/2,S=D(E,c)+(c.itemHeight-c.shapeHeight)/2;C.setAttribute("transform","translate("+b+", "+S+")"),setTimeout(function(){pe(O,B,c,!1)},0)}},pe=function(E,C,O,c){var w=ae(C,O);C=ue(C,O),(c||w>E.clientWidth)&&(E.style.width=w+"px"),(c||C>E.clientHeight)&&(E.style.height=C+"px"),(E=E.chartArea).setAttribute("style",c?"width: "+w+"px; height: "+C+"px":"width: "+Math.max(E.clientWidth,w)+"px; height: "+Math.max(E.clientHeight,C)+"px")},me=function(E,B){for(var O=E.childNodes.length;O-- >0;)E.removeChild(E.childNodes[O]);E.appendChild(B)},Pe=function(E,B){for(var O in B)0!=O.indexOf("custom")&&0!=O.indexOf("description")||typeof E[O]>"u"&&(E[O]=B[O])},Fe=function(E,B,O,c,w,C,b,L){var J=ae(b,L={isExport:!0,canUserRearrangeItems:!1,isTaskEventToolTipVisible:!1,isDependencyToolTipVisible:!1,containerClass:L.containerClass,containerStyle:L.containerStyle,border:L.border,theme:L.theme,itemWidth:L.itemWidth,itemHeight:L.itemHeight,aspectRatio:L.aspectRatio,shapeWidth:L.shapeWidth,shapeHeight:L.shapeHeight,shapeClass:L.shapeClass,shapeStyle:L.shapeStyle,shapeCornerRadius:L.shapeCornerRadius,dependencyTextStyle:L.dependencyTextStyle,dependencyLineClass:L.dependencyLineClass,dependencyLineStyle:L.dependencyLineStyle,virtualEffortDependencyLineClass:L.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:L.virtualEffortDependencyLineStyle,dependencyTextBlockWidth:L.dependencyTextBlockWidth,chartMargin:0,target:L.target,timeSpanFormatter:L.timeSpanFormatter,taskEventTemplate:L.taskEventTemplate,dependencyLineTemplate:L.dependencyLineTemplate,classic:L.classic}),M=ue(b,L);L.chartWidth=J+"px",L.chartHeight=M+"px";var $,q,U=J+2,te=(J=M+2,!1);if(null!=O&&typeof O.createElement<"u")$=O;else{null!=O&&typeof O.focus<"u"?q=O:(q=window.open("",O??"_blank",typeof c<"u"&&c&&(typeof C>"u"||C)?"width=800,height=480,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),te=!0),$=q.document;try{var G=document.head.getElementsByTagName("link");for(O=0;O<G.length;O++){var K=G[O],ie=$.adoptNode(K.cloneNode(!0));ie.href=K.href,$.head.appendChild(ie)}}catch{}}for($.title=typeof E<"u"?E:"Exported chart"+(typeof c<"u"&&c?" (printable)":""),E=[],O=0;O<b.length;O++)Pe(K={content:(G=b[O]).content,displayedText:G.displayedText,isShapeVisible:G.isShapeVisible,shapeClass:G.shapeClass,shapeStyle:G.shapeStyle,dependencyTextStyle:G.dependencyTextStyle,displayedRowIndex:G.actualRowIndex,displayedColumnIndex:G.actualColumnIndex,isExported:!0},G),E.push(K),G.exportItem=K;for(O=0;O<b.length;O++)if(K=(G=b[O]).exportItem,typeof G.predecessors<"u")for(K.predecessors=[],ie=0;ie<G.predecessors.length;ie++)K.predecessors.push({item:(M=G.predecessors[ie]).item.exportItem,content:M.content,displayedText:M.displayedText,effort:M.effort,isEffortVirtual:M.isEffortVirtual,dependencyLineClass:M.dependencyLineClass,dependencyLineStyle:M.dependencyLineStyle,virtualEffortDependencyLineClass:M.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:M.virtualEffortDependencyLineStyle,dependencyTextStyle:M.dependencyTextStyle});var ge=$.createElement("p");ge.innerHTML=typeof B<"u"?B:"",$.body.appendChild(ge);var Z=$.createElement("div");Z.setAttribute("style","width: "+U+"px; height: "+J+"px");try{DlhSoft.Controls.Pert.PertChartView.initialize(Z,E,L,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch{}setTimeout(function(){te&&$.body.setAttribute("style","margin: 0px");var Q=$.createElement("div");Q.appendChild(Z),$.body.replaceChild(Q,ge),w&&(Q.setAttribute("style","width: "+Z.offsetHeight+"px; height: "+U+"px; overflow: hidden"),Q=Math.round((Z.offsetWidth-Z.offsetHeight)/2),Z.setAttribute("style","width: "+U+"px; transform: rotate(90deg) translateX("+Q+"px) translateY("+Q+"px); -webkit-transform: rotate(90deg) translateX("+Q+"px) translateY("+Q+"px)")),$.close(),void 0!==typeof q&&(q.focus(),typeof c<"u"&&c&&setTimeout(function(){q.print(),(typeof C>"u"||C)&&setTimeout(function(){q.close()})}))},0)},rt=function(E,B){for(var O=0;O<B.length;O++)delete(c=B[O]).successorInfo,delete c.effortInfo;if(typeof E>"u"&&(E=0),null==(O=Be(B)))return[];O=[O];for(var c=Me(E,B),w=0;w<c.length;w++)O.push(c[w].dependentItem);return O},Me=function(E,B){for(var O=0;O<B.length;O++){var c=B[O];delete c.successorInfo,delete c.effortInfo}var w=Be(B);if(null==w)return[];e:{for(O=B.length;O-- >0;)if(0==ft(c=B[O]).length){O=c;break e}O=null}if(null==O)return[];for(O=Qe(w,O),w=[],c=0;c<O.length;c++)w.push(O[c]);for(O=0;O<B.length;O++)delete(c=B[O]).successorInfo,delete c.effortInfo;return w},Qe=function(E,B){if(null==E||null==B||E==B||typeof B.predecessors>"u")return[];var w,O=[],c=[],C=null;for(w=0;w<B.predecessors.length;w++)predecessorItem=B.predecessors[w],predecessorItem.dependentItem=B,typeof predecessorItem.item<"u"&&null!=(b=qe(E,predecessorItem.item))&&((typeof predecessorItem.isEffortVirtual>"u"||!predecessorItem.isEffortVirtual)&&predecessorItem.effort>0&&(b+=predecessorItem.effort),(null==C||b>=C)&&((null==C||b>C)&&(C=b,c=[]),c.push(predecessorItem)));for(w=0;w<c.length;w++){for(var b=Qe(E,(C=c[w]).item),S=0;S<b.length;S++)O.push(b[S]);O.push(C)}return O},Be=function(E){for(var B=0;B<E.length;B++){var O=E[B];if(typeof O.predecessors>"u"||0==O.predecessors.length)return O}return null},qe=function(E,B){if(null==E||null==B)return null;if(E==B)return 0;E.effortInfo||(E.effortInfo={});var O=B.index.toString();if(typeof E.effortInfo[O]<"u")return E.effortInfo[O];for(var c=null,w=ft(E),C=0;C<w.length;C++){var b=w[C],S=qe(b.dependentItem,B);null!=S&&((S+=(typeof predecessorItem.isEffortVirtual>"u"||!predecessorItem.isEffortVirtual)&&b.predecessorItem.effort>0?b.predecessorItem.effort:0)<0&&(S=0),(null==c||S>c)&&(c=S))}return null!=c&&(E.effortInfo[O]=c),c},ft=function(E){if(E.successorInfo)return E.successorInfo;for(var B=[],O=E.pertChartView.items,c=0;c<O.length;c++){var w=O[c];if(typeof w.predecessors<"u")for(var C=0;C<w.predecessors.length;C++){var b=w.predecessors[C];typeof b.item<"u"&&b.item==E&&B.push({dependentItem:w,predecessorItem:b})}}return E.successorInfo=B},je=function(E){for(var B=null,O=0;O<E.length;O++)(null==B||E[O]>B)&&(B=E[O]);return B},at=function(E,B,O){for(var c=0;c<B.length;c++)B[c].pertChartView=E,B[c].index=c;E.items=B,E.settings=O,E.refresh=function(){Ee(E)},E.refreshItems=function(){for(var w=0;w<B.length;w++){var C=B[w];y(C),x(C)}},E.refreshChartItems=function(){for(var w=0;w<B.length;w++)y(B[w])},E.refreshItem=F,E.refreshChartItem=y,E.refreshPredecessorItems=x,E.refreshItemGraph=N,E.scrollToItem=function(w){var C=a(w,O),b=C-w.pertChartView.chartContentContainer.scrollLeft;b<0?w.pertChartView.chartContentContainer.scrollLeft=C:b>w.pertChartView.chartContentContainer.clientWidth-w.pertChartView.settings.itemWidth&&(w.pertChartView.chartContentContainer.scrollLeft=C-(w.pertChartView.chartContentContainer.clientWidth-w.pertChartView.settings.itemWidth)),(b=(C=D(w,O))-w.pertChartView.chartContentContainer.scrollTop)<0?w.pertChartView.chartContentContainer.scrollTop=C:b>w.pertChartView.chartContentContainer.clientHeight-w.pertChartView.settings.itemHeight&&(w.pertChartView.chartContentContainer.scrollTop=C-(w.pertChartView.chartContentContainer.clientHeight-w.pertChartView.settings.itemHeight))},E.scrollToLeft=function(){E.chartContentContainer.scrollLeft=0},E.scrollToRight=function(){E.chartContentContainer.scrollLeft=E.chartContent.clientWidth},E.scrollToTop=function(){E.chartContentContainer.scrollTop=0},E.scrollToBottom=function(){E.chartContentContainer.scrollTop=E.chartContent.clientHeight},E.getChartWidth=function(){return ae(B,O)},E.getChartHeight=function(){return ue(B,O)},E.getItemTop=function(w){return D(w,O)},E.getItemLeft=function(w){return a(w,O)},E.onItemPropertyChanged=Ie,E.initializeTasEventkDraggingThumbs=function(w,C,b,S){be(w,C,E.items,b,S,E,E.settings)},E.exportContent=function(w,C){typeof w>"u"&&(w={}),Fe(w.title,w.preparingMessage,C,!1,w.rotate,!1,B,O)},E.print=function(w){typeof w>"u"&&(w={}),Fe(w.title,w.preparingMessage,null,!0,w.rotate,w.autoClose,B,O)},E.isItemCritical=function(w,C){return rt(C,B).indexOf(w)>=0},E.isDependencyCritical=function(w,C){return Me(C,B).indexOf(w)>=0},E.getCriticalItems=function(w){return rt(w,B)},E.getCriticalDependencies=function(w){return Me(w,B)},E.repositionEnds=function(){if(0!=B.length){for(var w=!1,C=0;C<B.length;C++){for(var b=B[C],S=0,L=0;L<B.length;L++){var M=B[L];if(typeof M.predecessors<"u"){for(var U=0;U<M.predecessors.length&&!(typeof M.predecessors[U].item<"u"&&M.predecessors[U].item==b&&(S++,S>1));U++);if(S>1)break}}S>1&&(w=!0)}(C=B[0]).displayedRowIndex=w?.5:0,(b=B[B.length-1]).displayedRowIndex=w?.5:0,N(C),N(b)}}};return{initialize:fe,initializeItems:Je,refresh:Ee,getDefaultStyleDefinitionTemplate:P,getDefaultTaskEventTemplate:oe,getDefaultItemTemplate:X,getDefaultDependencyLineTemplate:ve,getDefaultPredecessorItemTemplate:He,initializeTaskEventDraggingThumbs:function(E,B,O,c){B.pertChartView.initializeTaskEventDraggingThumbs(E,B,O,c)},defaultTimeSpanFormatter:Ce}}()),null==DlhSoft.Controls.Pert.NetworkDiagramView&&(DlhSoft.Controls.Pert.NetworkDiagramView=function(){var t=function(c,w,C,b,S){return c.internalEventListeners&&c.internalEventListeners.push({object:w,event:C,handler:b,useCapture:S}),b},fe=function(c,w,C,U){var S=["DlhSoft.Controls.Pert","NetworkDiagramView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];if(DlhSoft[S[5]][S[4]](c,S[0],S[1],S[2],S[3],U,C),c.isInitializing=!0,typeof c.initializedItems<"u"&&(c.initializedItems.forEach(function(ie){ie.chartItemArea&&ie.chartItemArea.parentNode&&ie.chartItemArea.parentNode.removeChild(ie.chartItemArea),delete ie.networkDiagramView,delete ie.chartItem,delete ie.chartItemArea}),typeof c.draggableItems<"u"&&delete c.draggableItems),c.initializedItems=w.slice(),c.internalEventListeners&&c.internalEventListeners.forEach(function(ie){ie.object.removeEventListener(ie.event,ie.handler,ie.useCapture)}),c.internalEventListeners=[],typeof c.items<"u")for(U=0;U<c.items.length;U++)delete c.items[U].successors;"object"!=typeof C&&(C={}),Je(w,C),Ge(C,w,c),O(c,w,C),ue(w,C),se(w);var L=xe(c,w,C),M=c.ownerDocument;(U=M.createElement("div")).setAttribute("style","font-family: "+(C.classic?"Arial":"system-ui, Arial")+"; font-size: "+(C.classic?"small":"12px")+"; overflow: auto"),S=M.createElement("div"),typeof C.containerClass<"u"&&S.setAttribute("class",C.containerClass),typeof C.containerStyle<"u"&&S.setAttribute("style",C.containerStyle),U.appendChild(S),($=M.createElement("div")).setAttribute("style","border: solid 1px "+C.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden"),S.appendChild($),(S=M.createElement("div")).setAttribute("style","overflow: auto"),$.appendChild(S);var J=M.createElement("div");J.setAttribute("style","overflow: "+(typeof C.isExport>"u"||!C.isExport?"auto":"hidden")+"; height: "+L),S.appendChild(J);var G,$=H(w,C),q=a(w,C),te=M.createElement("div");te.setAttribute("style","float: left; overflow: hidden; width: "+$+"px; height: "+q+"px"),J.appendChild(te),(L=M.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("style","width: "+$+"px; height: "+q+"px"),$=C.styleDefinitionTemplate(),L.appendChild($),L.chartAreaDefinitions=$,L.addEventListener("mousedown",t(c,L,"mousedown",$=function(){setTimeout(function(){try{var ie=te.chartArea,ge=ie.chartAreaDefinitions;ie.removeChild(ge),ie.childNodes.length>0?ie.insertBefore(ge,ie.childNodes[0]):ie.appendChild(ge)}catch{}},0)},!0),!0),M.addEventListener("mouseup",t(c,M,"mouseup",$,!0),!0),te.appendChild(L),te.chartArea=L,setTimeout(function(){G=c.clientHeight},0),typeof c.heightUpdateTimer<"u"&&clearInterval(c.heightUpdateTimer),c.heightUpdateTimer=setInterval(function(){try{if(!(c.clientHeight<=0)){var ie=c.clientHeight;if(ie!=G){var ge=xe(c,w,C);J.style.height=ge,G=ie}}}catch{try{clearInterval(c.heightUpdateTimer)}catch{}}},100);var K=function(ie,ge,Z,Q){var we;if(C.mouseHandler||C.mouseMoveHandler&&"mousemove"==Q||C.mouseDownHandler&&"mousedown"==Q||C.clickHandler&&"click"==Q||C.doubleClickHandler&&"dblclick"==Q){var Xe=ie.which;!Xe&&ie.button&&(1&ie.button?Xe=1:4&ie.button?Xe=2:2&ie.button&&(Xe=3)),we=Z.getBoundingClientRect();var Ze=M.body,Ye=M.documentElement;for(Z=we.left+(window.pageXOffset||Ye.scrollLeft||Ze.scrollLeft)-(Ye.clientLeft||Ze.clientLeft||0),we=Math.round(we.top+(window.pageYOffset||Ye.scrollTop||Ze.scrollTop)-(Ye.clientTop||Ze.clientTop||0)),Z=Math.round(Z),Z=ie.pageX-Z,we=ie.pageY-we,Ze=0;Ze<w.length;Ze++){var Xt=k(Ye=w[Ze],C),wt=h(Ye,C);Z>=Xt&&Z<Xt+C.itemWidth&&we>=wt&&we<wt+C.itemHeight&&(C.mouseHandler&&C.mouseHandler(Q,Ye,Xe,ge,ie),C.mouseMoveHandler&&"mousemove"==Q&&C.mouseMoveHandler(Ye),C.mouseDownHandler&&"mousedown"==Q&&C.mouseDownHandler(Ye,Xe),C.itemClickHandler&&"click"==Q&&C.itemClickHandler(Ye),C.itemDoubleClickHandler&&"dblclick"==Q&&C.itemDoubleClickHandler(Ye))}}};return te.addEventListener("mousemove",t(c,te,"mousemove",function(ie){K(ie,0,te,"mousemove")})),te.addEventListener("mousedown",t(c,te,"mousedown",function(ie){K(ie,1,te,"mousedown")})),te.addEventListener("click",t(c,te,"click",function(ie){K(ie,1,te,"click")})),te.addEventListener("dblclick",t(c,te,"dblclick",function(ie){K(ie,2,te,"dblclick")})),te.addEventListener("click",t(c,te,"click",function(ie){ie.srcElement&&"rect"!=ie.srcElement.nodeName&&ie.stopPropagation()},!0),!0),te.addEventListener("touchmove",t(c,te,"touchmove",function(ie){c.draggingItem&&ie.preventDefault()},!0),!0),te.container=J,c.chartContainer=S,c.chartContent=te,c.chartContentContainer=J,J.isInitializing=!0,Fe(c,U),D(te,L,w,C),J.isInitializing=!1,c.isInitializing=!1,c.isInitialized=!0,c},Ee=function(c){fe(c,c.items,c.settings,c.license)},Ge=function(c,w,C){if(function(c){typeof c.dateTimeFormatter>"u"&&(c.dateTimeFormatter=Ce),typeof c.timeSpanFormatter>"u"&&(c.timeSpanFormatter=ae),typeof c.itemPropertyChangeHandler>"u"&&(c.itemPropertyChangeHandler=function(){}),typeof c.target>"u"&&(c.target="Standard"),typeof c.theme>"u"&&(c.theme="Modern")}(c),typeof c.border>"u")switch(c.theme){default:c.border="#e0e0e0";break;case"ModernBordered":case"Aero":c.border="#9a9a9a"}typeof c.canUserRearrangeItems>"u"&&(c.canUserRearrangeItems=!0),typeof c.snapRearrangedItemsToGuidelines>"u"&&(c.snapRearrangedItemsToGuidelines=!0),typeof c.itemWidth>"u"&&(c.itemWidth=220),typeof c.itemHeight>"u"&&(c.itemHeight=100),typeof c.aspectRatio>"u"&&(c.aspectRatio=1),typeof c.shapeWidth>"u"&&(c.shapeWidth=212),typeof c.shapeHeight>"u"&&(c.shapeHeight=92),typeof c.styleDefinitionTemplate>"u"&&(c.styleDefinitionTemplate=ee(C,c)),typeof c.shapeStyle>"u"&&null==c.shapeClass&&(c.shapeStyle="fill: White; stroke: "+(c.classic?"#0000ff":"#3b87d9")+"; stroke-width: 1px"),typeof c.milestoneStyle>"u"&&null==c.milestoneClass&&(c.milestoneStyle="fill: White; stroke: "+(c.classic?"#000000":"#3b87d9")+"; stroke-width: 1px"),typeof c.temporaryThumbStyle>"u"&&null==c.temporaryThumbClass&&(c.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; "),typeof c.dependencyLineStyle>"u"&&null==c.dependencyLineClass&&(c.dependencyLineStyle="stroke: "+(c.classic?"#8080FF":"#3b87d9")+"; stroke-width: 0.65px; fill: none; marker-end: url(#PertArrowMarker)"),typeof c.dependencyLineZoneStyle>"u"&&null==c.dependencyLineZoneClass&&(c.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none"),typeof c.taskTemplate>"u"&&(c.taskTemplate=He()),typeof c.minDependencyLineLength>"u"&&(c.minDependencyLineLength=48),typeof c.diagramMargin>"u"&&(c.diagramMargin=16),typeof c.isTaskToolTipVisible>"u"&&(c.isTaskToolTipVisible="Phone"!==c.target),typeof c.itemTemplate>"u"&&(c.itemTemplate=oe(c)),typeof c.dependencyLineTemplate>"u"&&(c.dependencyLineTemplate=Ae()),typeof c.isDependencyToolTipVisible>"u"&&(c.isDependencyToolTipVisible=c.isTaskToolTipVisible),typeof c.predecessorItemTemplate>"u"&&(c.predecessorItemTemplate=Ie(c)),typeof c.useInlineToolTips>"u"&&(c.useInlineToolTips=!0),typeof c.useInlineToolTipsForDependencies>"u"&&(c.useInlineToolTipsForDependencies=!0)},Je=function(c,w){for(var C=new Date,b=0;b<c.length;b++){var S=c[b];if("string"==typeof S&&(c[b]=S={content:S}),"string"==typeof S.earlyStart){try{S.earlyStart=Date.parse(S.earlyStart)}catch{S.earlyStart=new Date(parseInt(S.earlyStart))}(typeof w.isRelativeToTimezone>"u"||w.isRelativeToTimezone)&&(S.earlyStart=new Date(S.earlyStart.valueOf()+6e4*C.getTimezoneOffset()))}if("string"==typeof S.earlyFinish){try{S.earlyFinish=Date.parse(S.earlyFinish)}catch{S.earlyFinish=new Date(parseInt(S.earlyFinish))}(typeof w.isRelativeToTimezone>"u"||w.isRelativeToTimezone)&&(S.earlyFinish=new Date(S.earlyFinish.valueOf()+6e4*C.getTimezoneOffset()))}if("string"==typeof S.lateStart){try{S.lateStart=Date.parse(S.lateStart)}catch{S.lateStart=new Date(parseInt(S.lateStart))}(typeof w.isRelativeToTimezone>"u"||w.isRelativeToTimezone)&&(S.lateStart=new Date(S.lateStart.valueOf()+6e4*C.getTimezoneOffset()))}if("string"==typeof S.lateFinish){try{S.lateFinish=Date.parse(S.lateFinish)}catch{S.lateFinish=new Date(parseInt(S.lateFinish))}(typeof w.isRelativeToTimezone>"u"||w.isRelativeToTimezone)&&(S.earlyFinish=new Date(S.earlyFinish.valueOf()+6e4*C.getTimezoneOffset()))}if("string"==typeof S.effort)try{S.effort=parseInt(S.effort)}catch{}if("string"==typeof S.isMilestone&&(S.isMilestone=S.isMilestone.toLowerCase()==trueStringValue),"string"==typeof S.slack)try{S.slack=parseInt(S.slack)}catch{}if(typeof S.predecessors<"u"){"string"==typeof S.predecessors&&(S.predecessors=S.predecessors.split(","));for(var L=0;L<S.predecessors.length;L++){var M=S.predecessors[L];if("string"==typeof M&&(S.predecessors[L]=M={item:M}),"string"==typeof M.item){var U=parseInt(M.item)-1;M.item=U>=0&&U<c.length?c[U]:null}"string"==typeof M.lag&&(M.lag=parseFloat(M.lag))}}typeof S.displayedRowIndex<"u"&&(S.actualRowIndex=S.displayedRowIndex),typeof S.displayedColumnIndex<"u"&&(S.actualColumnIndex=S.displayedColumnIndex),typeof S.actualRowIndex>"u"&&(S.actualRowIndex=0),typeof S.actualColumnIndex>"u"&&(S.actualColumnIndex=0)}},se=function(c){c.positionedItems=[],c.maxRowIndex=null;for(var w=0;w<c.length;w++){var C=c[w],b=c;if(typeof C.displayedRowIndex>"u"){var S;if(typeof C.predecessors<"u"){S=b.positionedItems;for(var L=[],M=C.predecessors,U=0;U<S.length;U++)for(var J=S[U],$=0;$<M.length;$++)if(M[$].item==J){L.push(J);break}S=L}else S=null;if(null!=S){for(L=S,M=[],U=0;U<L.length;U++)M.indexOf(J=L[U].actualRowIndex)<0&&M.push(J);L=M}else L=null;if(L=null!=L&&L.length>0?at(L):null!=b.maxRowIndex?b.maxRowIndex+1:0,M=M=void 0,typeof C.displayedColumnIndex>"u"){if(M=(M=De(b.positionedItems,L)).length>0?at(M)+1:0,null!=(U=null!=S?De(S,L):null)&&U.length>0){for(J=null,$=0;$<U.length;$++)(null==J||U[$]<J)&&(J=U[$]);U=J+1}else U=null;for(null!=U&&U!=M&&(L++,M=null!=(S=null!=S?ye(S):null)&&S.length>0?at(S)+1:0),C.actualColumnIndex=M;ke(b.positionedItems,L,M);)L++}else for(;!((M=(M=De(b.positionedItems,L)).length>0?at(M)+1:0)<=C.actualColumnIndex);L++);C.actualRowIndex=L}else typeof C.displayedColumnIndex>"u"&&(S=ye(b.positionedItems),C.actualColumnIndex=S.length>0?at(S)+1:0);b.positionedItems.push(C),(null==b.maxRowIndex||C.actualRowIndex>b.maxRowIndex)&&(b.maxRowIndex=C.actualRowIndex)}},De=function(c,w){for(var C=[],b=0;b<c.length;b++){var S=c[b];S.actualRowIndex==w&&C.indexOf(S=S.actualColumnIndex)<0&&C.push(S)}return C},ye=function(c){for(var w=[],C=0;C<c.length;C++){var b=c[C].actualColumnIndex;w.indexOf(b)<0&&w.push(b)}return w},ke=function(c,w,C){for(var b=0;b<c.length;b++){var S=c[b];if(S.actualRowIndex==w&&S.actualColumnIndex==C)return!0}return!1},xe=function(c,w,C){var b;if(c.isContentHeightInitialized&&c.isContentHeightAuto)b=w.length>0?"auto":C.itemHeight+"px";else{var S=c.clientHeight-2;S<0&&(S=0),b=S+"px",S<C.itemHeight&&(c.isContentHeightInitialized||(c.isContentHeightAuto=!0),b=w.length>0?"auto":C.itemHeight+"px"),c.isContentHeightInitialized=!0}return b},he=function(c,w){var C=c.createElement("span");return C.innerHTML=w,C},Ce=function(c){var w;w=c.getFullYear();var C=c.getMonth()+1;C<10&&(C="0"+C);var b=c.getDate();return b<10&&(b="0"+b),w=C+"/"+b+"/"+w,(C=c.getHours())<10&&(C="0"+C.toString()),(c=c.getMinutes())<10&&(c="0"+c.toString()),w+" "+C+":"+c},ae=function(c){return Math.ceil(c/36e5*1e4/100)/100+"h"},ue=function(c){var b,S,w=new Date(864e5*Math.floor((new Date).valueOf()/864e5)),C=new Date;for(S=0;S<c.length;S++){var L=(b=c[S]).earlyStart,M=b.earlyFinish,U=b.lateStart,J=b.lateFinish;typeof b.earlyStart>"u"&&(b.earlyStart=w),typeof b.earlyFinish>"u"&&(b.earlyFinish=typeof b.isMilestone>"u"||!b.isMilestone?new Date(w.valueOf()+864e5):b.earlyStart),typeof b.lateStart>"u"&&(b.lateStart=w),typeof b.lateFinish>"u"&&(b.lateFinish=typeof b.isMilestone>"u"||!b.isMilestone?new Date(w.valueOf()+864e5):b.lateStart),(typeof b.isRelativeToTimezone>"u"||b.isRelativeToTimezone)&&(b.earlyStart=new Date(b.earlyStart.valueOf()-6e4*C.getTimezoneOffset()),b.earlyFinish=new Date(b.earlyFinish.valueOf()-6e4*C.getTimezoneOffset()),b.lateStart=new Date(b.lateStart.valueOf()-6e4*C.getTimezoneOffset()),b.lateFinish=new Date(b.lateFinish.valueOf()-6e4*C.getTimezoneOffset()),b.isRelativeToTimezone=!1),typeof b.effort>"u"&&(b.effort=0),typeof b.slack>"u"&&(b.slack=0),typeof b.isMilestone>"u"&&(b.isMilestone=!1),(typeof L>"u"||b.earlyStart.valueOf()!=L.valueOf())&&Le(b,"earlyStart",!1,!0),(typeof M>"u"||b.earlyFinish.valueOf()!=M.valueOf())&&Le(b,"earlyFinish",!1,!0),(typeof U>"u"||b.lateStart.valueOf()!=U.valueOf())&&Le(b,"lateStart",!1,!0),(typeof J>"u"||b.lateFinish.valueOf()!=J.valueOf())&&Le(b,"lateFinish",!1,!0)}},H=function(c,w){for(var C=0,b=0;b<c.length;b++)C=Math.max(C,c[b].actualColumnIndex);return w.itemWidth+C*(w.itemWidth+w.minDependencyLineLength)+2*w.diagramMargin},a=function(c,w){for(var C=0,b=0;b<c.length;b++)C=Math.max(C,c[b].actualRowIndex);return w.itemHeight+C*(w.itemHeight+w.minDependencyLineLength/w.aspectRatio)+2*w.diagramMargin},D=function(c,w,C,b){for(c=0;c<C.length;c++){var S=C[c],L=k(S,b),M=h(S,b);w.appendChild(y(S,L,M,b))}},k=function(c,w){return typeof c.displayedColumnIndex<"u"&&(c.actualColumnIndex=c.displayedColumnIndex),Math.max(0,w.diagramMargin+c.actualColumnIndex*(w.itemWidth+w.minDependencyLineLength))},h=function(c,w){return typeof c.displayedRowIndex<"u"&&(c.actualRowIndex=c.displayedRowIndex),Math.max(0,w.diagramMargin+c.actualRowIndex*(w.itemHeight+w.minDependencyLineLength/w.aspectRatio))},T=function(c){for(var C,b,w=[],S=0;S<c.length;S++){var L=c[S];if(typeof L.predecessors<"u"&&L.predecessors.length>0)for(var M=0;M<L.predecessors.length;M++){var U=L.predecessors[M].item;if(typeof U<"u"){for(C=!0,b=0;b<w;b++)if(U==w[b]){C=!1;break}C&&(F(U.chartItem,U,U.networkDiagramView.settings),C=k(U,U.networkDiagramView.settings),b=h(U,U.networkDiagramView.settings),U.chartItem.setAttribute("transform","translate("+C+", "+b+")"),w.push(U))}}if(typeof L.predecessors<"u"&&L.predecessors.length>0){for(C=!0,b=0;b<w;b++)if(typeof L<"u"&&L==w[b]){C=!1;break}C&&(F(L.chartItem,L,L.networkDiagramView.settings),C=k(L,L.networkDiagramView.settings),b=h(L,L.networkDiagramView.settings),L.chartItem.setAttribute("transform","translate("+C+", "+b+")"),w.push(L))}}},y=function(c,w,C,b){var S=c.networkDiagramView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");return c.chartItem=S,S.setAttribute("style","-ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),S.setAttribute("transform","translate("+w+", "+C+")"),F(S,c,b),S},F=function(c,w,C){for(var b=c.childNodes.length;b-- >0;)c.removeChild(c.childNodes[b]);if(typeof w.isShapeVisible>"u"||w.isShapeVisible){if(b=C.taskTemplate,typeof w.taskTemplate<"u"&&(b=w.taskTemplate),b=b(w),c.appendChild(b),typeof C.internalExtraTaskTemplate<"u"){var S=C.internalExtraTaskTemplate(w);null!=S&&c.appendChild(S)}if(typeof C.extraTaskTemplate<"u"&&null!=(S=C.extraTaskTemplate(w))&&c.appendChild(S),C.isTaskToolTipVisible&&!C.useInlineToolTips&&(S=C.itemTemplate,typeof w.template<"u"&&(S=w.template),b.appendChild(S(w))),typeof w.predecessors<"u")for(b=0;b<w.predecessors.length;b++)if(S=w.predecessors[b],!((typeof w.networkDiagramView>"u"||w.networkDiagramView.items.indexOf(S.item))<0||typeof S.item.isShapeVisible<"u"&&!S.item.isShapeVisible)){var L=C.dependencyLineTemplate(w,S);if(L.predecessorIndex=b,function(U){L.addEventListener("click",t(w.networkDiagramView,L,"click",function(J){C.dependencyLineClickHandler&&C.dependencyLineClickHandler(U,w,J)})),L.addEventListener("dblclick",t(w.networkDiagramView,L,"dblclick",function(J){C.dependencyLineDoubleClickHandler&&C.dependencyLineDoubleClickHandler(U,w,J)}))}(S),c.appendChild(L),C.isDependencyToolTipVisible&&(!C.useInlineToolTips||!C.useInlineToolTipsForDependencies)){var M=C.predecessorItemTemplate;typeof S.template<"u"&&(M=S.template),L.appendChild(M(w,S))}}}},x=function(c){typeof c.isWaitingToRefreshChartItem>"u"&&(c.isWaitingToRefreshChartItem=!0,setTimeout(function(){F(c.chartItem,c,c.networkDiagramView.settings);var w=k(c,c.networkDiagramView.settings),C=h(c,c.networkDiagramView.settings);c.chartItem.setAttribute("transform","translate("+w+", "+C+")"),delete c.isWaitingToRefreshChartItem},0))},N=function(c){x(c)},P=function(c){typeof c.isWaitingToRefreshPredecessorItems>"u"&&(c.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){T(c.networkDiagramView.items),delete c.isWaitingToRefreshPredecessorItems},0))},X=function(c){typeof c.isWaitingToRefreshChartItem<"u"||typeof c.isWaitingToRefreshPredecessorItems<"u"?(typeof c.isWaitingToRefreshChartItem>"u"&&x(c),typeof c.isWaitingToRefreshPredecessorItems>"u"&&P(c)):(c.isWaitingToRefreshChartItem=!0,c.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){F(c.chartItem,c,c.networkDiagramView.settings);var w=k(c,c.networkDiagramView.settings),C=h(c,c.networkDiagramView.settings);c.chartItem.setAttribute("transform","translate("+w+", "+C+")"),T(c.networkDiagramView.items),delete c.isWaitingToRefreshChartItem,delete c.isWaitingToRefreshPredecessorItems},0))},ee=function(c,w){return function(){var C=c.ownerDocument,b=C.createElementNS("http://www.w3.org/2000/svg","defs"),S=C.createElementNS("http://www.w3.org/2000/svg","marker");return S.setAttribute("id","PertArrowMarker"),S.setAttribute("viewBox","0 0 10 10"),S.setAttribute("refX","0"),S.setAttribute("refY","5"),S.setAttribute("markerUnits","strokeWidth"),S.setAttribute("markerWidth",(4.5*(w.arrowSize?w.arrowSize:1)).toString()),S.setAttribute("markerHeight",(3.5*(w.arrowSize?w.arrowSize:1)).toString()),S.setAttribute("orient","auto"),(C=C.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M 0 0 L 10 5 L 0 10 z"),C.setAttribute("fill",w.arrowFill?w.arrowFill:"Aero"==w.theme?"Blue":"#8080ff"),S.appendChild(C),b.appendChild(S),b}},oe=function(){return function(c){var w=c.networkDiagramView.ownerDocument,C=w.createElementNS("http://www.w3.org/2000/svg","title");return C.appendChild(he(w,c.content)),C}},He=function(c,w,C){return function(b){var S=typeof w<"u"?w:b.networkDiagramView,L=typeof C<"u"?C:S.settings,M=typeof c<"u"?c:S.items,U=S.ownerDocument,J=function(c){var w=c.networkDiagramView.ownerDocument;for(typeof c.chartItemArea>"u"&&(c.chartItemArea=w.createElementNS("http://www.w3.org/2000/svg","g")),w=c.chartItemArea.childNodes.length;w-- >0;)c.chartItemArea.removeChild(c.chartItemArea.childNodes[w]);return c.chartItemArea}(b),$=(L.itemWidth-L.shapeWidth)/2,q=$+L.shapeWidth,te=(L.itemHeight-L.shapeHeight)/2,G=te+L.shapeHeight,Z=0,K=L.shapeHeight,ie=L.shapeWidth;b.isMilestone&&($+=Z=ie/16,q-=Z,ie-=2*Z),b.isMilestone&&((Q=U.createElementNS("http://www.w3.org/2000/svg","polygon")).setAttribute("points",$+","+te+" "+($-Z)+","+(te+G)/2+" "+$+","+G+" "+q+","+G+" "+(q+Z)+","+(te+G)/2+" "+q+","+te),Z=L.milestoneClass,typeof b.milestoneClass<"u"&&(Z=b.milestoneClass),typeof Z<"u"?Q.setAttribute("class",Z):(Z=L.milestoneStyle,typeof b.milestoneStyle<"u"&&(Z=b.milestoneStyle),typeof Z<"u"&&Q.setAttribute("style",Z)),J.appendChild(Q));var ge=U.createElementNS("http://www.w3.org/2000/svg","rect");ge.setAttribute("x",$),ge.setAttribute("y",te),ge.setAttribute("width",Math.max(0,q-$-1)),ge.setAttribute("height",Math.max(0,G-te-1)),Z=L.shapeClass,typeof b.shapeClass<"u"&&(Z=b.shapeClass),typeof Z<"u"?ge.setAttribute("class",Z):(Z=L.shapeStyle,typeof b.shapeStyle<"u"&&(Z=b.shapeStyle),typeof Z<"u"&&ge.setAttribute("style",Z)),J.appendChild(ge),J.addEventListener("mouseover",t(S,J,"mouseover",function(){var Xe=DlhSoft.Controls.ToolTip.get(ge);Xe||(Xe=DlhSoft.Controls.ToolTip.initialize(void 0,ge,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+L.border+"; background-color: White; color: Black; font-family: "+(L.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),Xe.setContent(L.itemTemplate(b).innerHTML.replaceAll("\n","<br/>")),Xe.show(),S.toolTip=Xe})),J.addEventListener("mouseout",t(S,J,"mouseout",function(){var Xe=S.toolTip;Xe.disable(),Xe.hide()})),(Z=U.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",$),Z.setAttribute("y1",te+3*K/8),Z.setAttribute("x2",q-1),Z.setAttribute("y2",te+3*K/8),Q=L.shapeClass,typeof b.shapeClass<"u"&&(Q=b.shapeClass),typeof Q<"u"&&Z.setAttribute("class",Q),Q=L.shapeStyle,typeof b.shapeStyle<"u"&&(Q=b.shapeStyle),typeof Q<"u"&&Z.setAttribute("style",Q),J.appendChild(Z),(Z=U.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",$),Z.setAttribute("y1",G-3*K/8),Z.setAttribute("x2",q-1),Z.setAttribute("y2",G-3*K/8),Q=L.shapeClass,typeof b.shapeClass<"u"&&(Q=b.shapeClass),typeof Q<"u"&&Z.setAttribute("class",Q),Q=L.shapeStyle,typeof b.shapeStyle<"u"&&(Q=b.shapeStyle),typeof Q<"u"&&Z.setAttribute("style",Q),J.appendChild(Z),(Z=U.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",$+3*ie/8),Z.setAttribute("y1",te),Z.setAttribute("x2",$+3*ie/8),Z.setAttribute("y2",te+3*K/8),Q=L.shapeClass,typeof b.shapeClass<"u"&&(Q=b.shapeClass),typeof Q<"u"&&Z.setAttribute("class",Q),Q=L.shapeStyle,typeof b.shapeStyle<"u"&&(Q=b.shapeStyle),typeof Q<"u"&&Z.setAttribute("style",Q),J.appendChild(Z),(Z=U.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",q-3*ie/8),Z.setAttribute("y1",te),Z.setAttribute("x2",q-3*ie/8),Z.setAttribute("y2",te+3*K/8),Q=L.shapeClass,typeof b.shapeClass<"u"&&(Q=b.shapeClass),typeof Q<"u"&&Z.setAttribute("class",Q),Q=L.shapeStyle,typeof b.shapeStyle<"u"&&(Q=b.shapeStyle),typeof Q<"u"&&Z.setAttribute("style",Q),J.appendChild(Z),(Z=U.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",$+3*ie/8),Z.setAttribute("y1",G),Z.setAttribute("x2",$+3*ie/8),Z.setAttribute("y2",G-3*K/8),Q=L.shapeClass,typeof b.shapeClass<"u"&&(Q=b.shapeClass),typeof Q<"u"&&Z.setAttribute("class",Q),Q=L.shapeStyle,typeof b.shapeStyle<"u"&&(Q=b.shapeStyle),typeof Q<"u"&&Z.setAttribute("style",Q),J.appendChild(Z),(Z=U.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",q-3*ie/8),Z.setAttribute("y1",G),Z.setAttribute("x2",q-3*ie/8),Z.setAttribute("y2",G-3*K/8),Q=L.shapeClass,typeof b.shapeClass<"u"&&(Q=b.shapeClass),typeof Q<"u"&&Z.setAttribute("class",Q),Q=L.shapeStyle,typeof b.shapeStyle<"u"&&(Q=b.shapeStyle),typeof Q<"u"&&Z.setAttribute("style",Q),J.appendChild(Z),(Q=U.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",($+q)/2),Q.setAttribute("y",G-3*K/8-6),Q.setAttribute("style","font-weight: bold; text-anchor: middle"),typeof(Z=b.displayedText)>"u"&&(Z=""),Q.appendChild(U.createTextNode(Z)),J.appendChild(Q);var Q=(Z=function(Ze){var Ye;return(Ye=(Ze=L.dateTimeFormatter(new Date(Ze.valueOf()+6e4*(new Date).getTimezoneOffset()))).indexOf(" "))>=0?(value1=Ze.substr(0,Ye),value2=Ze.substr(Ye+1)):(value1=Ze,value2=""),[value1,value2]})(b.earlyStart),we=U.createElementNS("http://www.w3.org/2000/svg","text");return we.setAttribute("x",$+3*ie/8/2),we.setAttribute("y",G-5*K/8-20),we.setAttribute("style","text-anchor: middle"),we.appendChild(U.createTextNode(Q[0])),J.appendChild(we),(we=U.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",$+3*ie/8/2),we.setAttribute("y",G-5*K/8-4),we.setAttribute("style","text-anchor: middle"),we.appendChild(U.createTextNode(Q[1])),J.appendChild(we),Q=L.timeSpanFormatter(b.effort),(we=U.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",($+q)/2),we.setAttribute("y",G-5*K/8-12),we.setAttribute("style","text-anchor: middle"),we.appendChild(U.createTextNode(Q)),J.appendChild(we),Q=Z(b.earlyFinish),(we=U.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",q-3*ie/8/2),we.setAttribute("y",G-5*K/8-20),we.setAttribute("style","text-anchor: middle"),we.appendChild(U.createTextNode(Q[0])),J.appendChild(we),(we=U.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",q-3*ie/8/2),we.setAttribute("y",G-5*K/8-4),we.setAttribute("style","text-anchor: middle"),we.appendChild(U.createTextNode(Q[1])),J.appendChild(we),Q=Z(b.lateStart),(K=U.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",$+3*ie/8/2),K.setAttribute("y",G-20),K.setAttribute("style","text-anchor: middle"),K.appendChild(U.createTextNode(Q[0])),J.appendChild(K),(K=U.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",$+3*ie/8/2),K.setAttribute("y",G-4),K.setAttribute("style","text-anchor: middle"),K.appendChild(U.createTextNode(Q[1])),J.appendChild(K),Q=L.timeSpanFormatter(b.slack),(K=U.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",($+q)/2),K.setAttribute("y",G-12),K.setAttribute("style","text-anchor: middle"),K.appendChild(U.createTextNode(Q)),J.appendChild(K),Q=Z(b.lateFinish),(K=U.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",q-3*ie/8/2),K.setAttribute("y",G-20),K.setAttribute("style","text-anchor: middle"),K.appendChild(U.createTextNode(Q[0])),J.appendChild(K),(K=U.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",q-3*ie/8/2),K.setAttribute("y",G-4),K.setAttribute("style","text-anchor: middle"),K.appendChild(U.createTextNode(Q[1])),J.appendChild(K),L.canUserRearrangeItems&&((U=U.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",$),U.setAttribute("y",te),U.setAttribute("width",Math.max(0,q-$-1)),U.setAttribute("height",Math.max(0,G-te-1)),U.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),J.appendChild(U),pe(U,b,M,k(b,L),h(b,L),S,L)),J}},Ae=function(c,w){return function(C,b){var S=C.networkDiagramView,L=typeof w<"u"?w:S.settings,J=typeof c<"u"?c:S.items,M=S.ownerDocument,U=M.createElementNS("http://www.w3.org/2000/svg","g"),$=(J=be(C,b,J,L),M.createElementNS("http://www.w3.org/2000/svg","path"));$.setAttribute("d",J),typeof L.dependencyLineZoneClass<"u"&&$.setAttribute("class",L.dependencyLineZoneClass),typeof L.dependencyLineZoneStyle<"u"&&$.setAttribute("style",L.dependencyLineZoneStyle),U.appendChild($);var q=M.createElementNS("http://www.w3.org/2000/svg","path");return q.setAttribute("d",J),M=L.dependencyLineClass,typeof b.dependencyLineClass<"u"&&(M=b.dependencyLineClass),typeof M<"u"&&q.setAttribute("class",M),M=L.dependencyLineStyle,typeof b.dependencyLineStyle<"u"&&(M=b.dependencyLineStyle),typeof M<"u"&&q.setAttribute("style",M),U.appendChild(q),L.isDependencyToolTipVisible&&L.useInlineToolTips&&L.useInlineToolTipsForDependencies&&(U.addEventListener("mouseover",t(S,U,"mouseover",function(te){var G=DlhSoft.Controls.ToolTip.get(q);G||(G=DlhSoft.Controls.ToolTip.initialize(void 0,q,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+L.border+"; background-color: White; color: Black; font-family: "+(L.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),G.setContent(L.predecessorItemTemplate(C,b).innerHTML.replaceAll("\n","<br/>")),G.show();var K=U.getBoundingClientRect();G.setHorizontalPosition(G.x+te.clientX-K.left),G.setVerticalPosition(G.y+te.clientY-K.bottom+10),S.toolTip=G})),U.addEventListener("mouseout",t(S,U,"mouseout",function(){var te=S.toolTip;te.disable(),te.hide()}))),U}},Ie=function(){return function(c,w){var C=c.networkDiagramView.ownerDocument,b=C.createElementNS("http://www.w3.org/2000/svg","title");return b.appendChild(he(C,w.item.displayedText+" - "+c.displayedText)),b}},be=function(q,J,S,ie){S="M ";var L=k(q,ie)-2,M=h(q,ie)-2,U=k(J.item,ie),$=(J=h(J.item,ie),k(q,ie)),te=(q=h(q,ie),Math.abs($-U)),G=Math.abs(q-J),K=ie.shapeWidth+2,ge=K/2,Z=(ie=ie.shapeHeight+2)/2,Q=Math.max(K,ie);return te<Q?S=J<=q?S+(U+ge-L+",")+(J+ie-M)+" L "+($+ge-L)+","+(q-M):S+(U+ge-L+",")+(J-M)+" L "+($+ge-L)+","+(q+ie-M):(S=U<=$?S+(U+K-L+",")+(J+Z-M):S+(U-L+",")+(J+Z-M),S=G<4*Q?U<=$?S+" L "+($-L)+","+(q+Z-M):S+" L "+($+K-L)+","+(q+Z-M):J<=q?S+" L "+($+ge-L)+","+(q-M):S+" L "+($+ge-L)+","+(q+ie-M)),S},Le=function(c,w,C,b){typeof c.networkDiagramView<"u"&&c.networkDiagramView.settings.itemPropertyChangeHandler(c,w,C,b)},pe=function(c,w,C,b,S,L,M){function U(G){L.draggingItem=w,L.dragType="Position",L.style.cursor=c.style.cursor,L.draggingInitialX=G.clientX,L.draggingInitialY=G.clientY,L.draggingInitialThumbXPosition=b,L.draggingInitialThumbYPosition=S}c.addEventListener("mousedown",t(L,c,"mousedown",function(G){0==G.button&&(U(G),G.preventDefault())},!0),!0),c.addEventListener("touchstart",t(L,c,"touchstart",function(G){U(G.touches[0]),G.preventDefault()},!0),!0),typeof L.draggableItems>"u"&&(L.draggableItems=[]);for(var J=!1,$=0;$<L.draggableItems.length;$++)if(L.draggableItems[$]==w){J=!0;break}if(!J){var q=function(G){if(!(typeof L.draggingItem>"u"||L.draggingItem!=w||"Position"!=L.dragType)){var K=G.clientX-L.draggingInitialX,ie=G.clientY-L.draggingInitialY,ge=G.clientX,Z=L;if(typeof Z.draggingItem<"u"){var Q=new Date;if(!Z.lastXDraggingTime||!(Q>Z.lastXDraggingTime&&Q-Z.lastXDraggingTime<200)){Z.lastXDraggingTime=Q;var we=0;if((Q=Z).offsetParent)do{we+=Q.offsetLeft,Q=Q.offsetParent}while(Q);(ge-=we)<24?(ge=Z.chartContentContainer.scrollLeft,Z.chartContentContainer.scrollLeft=Z.chartContentContainer.scrollLeft-48,ge-=Z.chartContentContainer.scrollLeft,typeof Z.draggingInitialThumbXPosition<"u"&&(Z.draggingInitialThumbXPosition=Z.draggingInitialThumbXPosition-ge)):ge>=Z.chartContentContainer.clientWidth-24&&(ge=Z.chartContentContainer.scrollLeft,Z.chartContentContainer.scrollLeft=Z.chartContentContainer.scrollLeft+48,ge=Z.chartContentContainer.scrollLeft-ge,typeof Z.draggingInitialThumbXPosition<"u"&&(Z.draggingInitialThumbXPosition=Z.draggingInitialThumbXPosition+ge))}}if(Z=G.clientY,typeof(G=L).draggingItem<"u"&&(ge=new Date,!G.lastYDraggingTime||!(ge>G.lastYDraggingTime&&ge-G.lastYDraggingTime<200))){if(G.lastYDraggingTime=ge,Q=0,(ge=G).offsetParent)do{Q+=ge.offsetTop,ge=ge.offsetParent}while(ge);(Z-=Q)<24?(Z=G.chartContentContainer.scrollTop,G.chartContentContainer.scrollTop=G.chartContentContainer.scrollTop-48,Z-=G.chartContentContainer.scrollTop,typeof G.draggingInitialThumbYPosition<"u"&&(G.draggingInitialThumbYPosition=G.draggingInitialThumbYPosition-Z)):Z>=G.chartContentContainer.clientHeight-24&&(Z=G.chartContentContainer.scrollTop,G.chartContentContainer.scrollTop=G.chartContentContainer.scrollTop+48,Z=G.chartContentContainer.scrollTop-Z,typeof G.draggingInitialThumbYPosition<"u"&&(G.draggingInitialThumbYPosition=G.draggingInitialThumbYPosition+Z))}delete L.draggingItem,L.draggingInitialThumbXPosition+K<0&&(K=-L.draggingInitialThumbXPosition),L.draggingInitialThumbYPosition+ie<0&&(ie=-L.draggingInitialThumbYPosition),G=w,ie=(L.draggingInitialThumbYPosition+ie-M.diagramMargin)/(M.itemHeight+M.minDependencyLineLength/M.aspectRatio),M.snapRearrangedItemsToGuidelines&&(ie=Math.round(ie)),G.actualRowIndex=ie,ie=w,K=(L.draggingInitialThumbXPosition+K-M.diagramMargin)/(M.itemWidth+M.minDependencyLineLength),M.snapRearrangedItemsToGuidelines&&(K=Math.round(K)),ie.actualColumnIndex=K,Le(w,"actualRowIndex",!0,!1),Le(w,"actualColumnIndex",!0,!1),typeof w.displayedColumnIndex<"u"&&delete w.displayedColumnIndex,typeof w.displayedRowIndex<"u"&&delete w.displayedRowIndex,me(w,C,L.chartContent,M,!1),L.draggingItem=w,L.draggingPerformed=!0}};L.addEventListener("mousemove",t(L,L,"mousemove",function(G){q(G)},!0),!0),L.addEventListener("touchmove",t(L,L,"touchmove",function(G){q(G.touches[0])},!0),!0);var te=function(){if(!(typeof L.draggingItem>"u"||L.draggingItem!=w||"Position"!=L.dragType)){me(w,C,L.chartContent,M,!0);var G=L.draggingItem;delete L.draggingItem,L.style.cursor="default",L.draggingPerformed&&(Le(G,"actualColumnIndex",!0,!0),Le(G,"actualRowIndex",!0,!0),delete L.draggingPerformed)}};document.addEventListener("mouseup",t(L,document,"mouseup",function(G){0==G.button&&te()},!0),!0),document.addEventListener("touchend",t(L,document,"touchend",function(){te()},!0),!0),L.draggableItems.push(w)}},me=function(c,w,C,b,S){var L=c.networkDiagramView.ownerDocument;if(S)typeof C.temporaryRectangle<"u"&&((S=C.chartArea).removeChild(C.temporaryRectangle),delete C.temporaryRectangle),setTimeout(function(){F(c.chartItem,c,b),M=k(c,b),U=h(c,b),c.chartItem.setAttribute("transform","translate("+M+", "+U+")"),T(w),setTimeout(function(){Pe(C,w,b,!0)},0)});else{typeof C.temporaryRectangle<"u"?L=C.temporaryRectangle:((L=L.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",0),L.setAttribute("y",0),L.setAttribute("width",b.shapeWidth),L.setAttribute("height",b.shapeHeight),typeof b.temporaryThumbClass<"u"&&L.setAttribute("class",b.temporaryThumbClass),L.setAttribute("style",b.temporaryThumbStyle),C.temporaryRectangle=L,(S=C.chartArea).appendChild(L));var M=k(c,b)+(b.itemWidth-b.shapeWidth)/2,U=h(c,b)+(b.itemHeight-b.shapeHeight)/2;L.setAttribute("transform","translate("+M+", "+U+")"),setTimeout(function(){Pe(C,w,b,!1)},0)}},Pe=function(c,L,C,b){var S=H(L,C);L=a(L,C),(b||S>c.clientWidth)&&(c.style.width=S+"px"),(b||L>c.clientHeight)&&(c.style.height=L+"px"),(c=c.chartArea).setAttribute("style",b?"width: "+S+"px; height: "+L+"px":"width: "+Math.max(c.clientWidth,S)+"px; height: "+Math.max(c.clientHeight,L)+"px")},Fe=function(c,w){for(var C=c.childNodes.length;C-- >0;)c.removeChild(c.childNodes[C]);c.appendChild(w)},rt=function(c,w){for(var C in w)0!=C.indexOf("custom")&&0!=C.indexOf("description")||typeof c[C]>"u"&&(c[C]=w[C])},Me=function(c,w,$,b,S,L,M,U,G){G=H(U,$={isExport:!0,canUserRearrangeItems:!1,isTaskToolTipVisible:!1,isDependencyToolTipVisible:!1,containerClass:G.containerClass,containerStyle:G.containerStyle,border:G.border,theme:G.theme,itemWidth:G.itemWidth,itemHeight:G.itemHeight,aspectRatio:G.aspectRatio,shapeWidth:G.shapeWidth,shapeHeight:G.shapeHeight,shapeClass:G.shapeClass,milestoneClass:G.milestoneClass,shapeStyle:G.shapeStyle,milestoneStyle:G.milestoneStyle,dependencyLineClass:G.dependencyLineClass,dependencyLineStyle:G.dependencyLineStyle,minDependencyLineLength:G.minDependencyLineLength,diagramMargin:0,target:G.target,dateTimeFormatter:G.dateTimeFormatter,timeSpanFormatter:G.timeSpanFormatter,isRelativeToTimezone:G.isRelativeToTimezone,arrowSize:G.arrowSize,arrowFill:G.arrowFill,taskTemplate:G.taskTemplate,dependencyLineTemplate:G.dependencyLineTemplate,classic:G.classic});var q=a(U,$);$.chartWidth=G+"px",$.chartHeight=q+"px";var K,ie,te=G+2,ge=(G=q+2,!1);if(null!=b&&typeof b.createElement<"u")K=b;else{null!=b&&typeof b.focus<"u"?ie=b:(ie=window.open("",b??"_blank",typeof S<"u"&&S&&(typeof M>"u"||M)?"width=800,height=480,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),ge=!0),K=ie.document;try{var Z=document.head.getElementsByTagName("link");for(b=0;b<Z.length;b++){var Q=Z[b],we=K.adoptNode(Q.cloneNode(!0));we.href=Q.href,K.head.appendChild(we)}}catch{}}for(K.title=typeof c<"u"?c:"Exported diagram"+(typeof S<"u"&&S?" (printable)":""),c=[],b=0;b<U.length;b++)rt(Q={content:(Z=U[b]).content,earlyStart:Z.earlyStart,earlyFinish:Z.earlyFinish,lateStart:Z.lateStart,lateFinish:Z.lateFinish,isMilestone:Z.isMilestone,effort:Z.effort,slack:Z.slack,isShapeVisible:Z.isShapeVisible,isRelativeToTimezone:Z.isRelativeToTimezone,shapeClass:Z.shapeClass,milestoneClass:Z.milestoneClass,shapeStyle:Z.shapeStyle,milestoneStyle:Z.milestoneStyle,displayedRowIndex:Z.actualRowIndex,displayedColumnIndex:Z.actualColumnIndex,isExported:!0},Z),c.push(Q),Z.exportItem=Q;for(b=0;b<U.length;b++)if(Q=(Z=U[b]).exportItem,typeof Z.predecessors<"u")for(Q.predecessors=[],we=0;we<Z.predecessors.length;we++)Q.predecessors.push({item:(q=Z.predecessors[we]).item.exportItem,dependencyLineClass:q.dependencyLineClass,dependencyLineStyle:q.dependencyLineStyle});var Xe=K.createElement("p");Xe.innerHTML=typeof w<"u"?w:"",K.body.appendChild(Xe);var Ze=K.createElement("div");Ze.setAttribute("style","width: "+te+"px; height: "+G+"px");try{DlhSoft.Controls.Pert.NetworkDiagramView.initialize(Ze,c,$,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch{}setTimeout(function(){ge&&K.body.setAttribute("style","margin: 0px");var Ye=K.createElement("div");Ye.appendChild(Ze),K.body.replaceChild(Ye,Xe),L&&(Ye.setAttribute("style","width: "+Ze.offsetHeight+"px; height: "+te+"px; overflow: hidden"),Ye=Math.round((Ze.offsetWidth-Ze.offsetHeight)/2),Ze.setAttribute("style","width: "+te+"px; transform: rotate(90deg) translateX("+Ye+"px) translateY("+Ye+"px); -webkit-transform: rotate(90deg) translateX("+Ye+"px) translateY("+Ye+"px)")),K.close(),void 0!==typeof ie&&(ie.focus(),typeof S<"u"&&S&&(ie.print(),(typeof M>"u"||M)&&setTimeout(function(){ie.close()})))},0)},Qe=function(c,w){for(var C=0;C<w.length;C++){var b=w[C];delete b.successorInfo,delete b.effortInfo}e:{for(var S=0;S<w.length;S++)if(typeof(C=w[S]).predecessors>"u"||0==C.predecessors.length)break e;C=null}if(null==C)return[];e:{for(S=w.length;S-- >0;)if(0==je(b=w[S]).length)break e;b=null}if(null==b)return[];for(S=[C],C=qe(C,b),b=0;b<C.length;b++)S.push(C[b]);for(C=0;C<w.length;C++)delete(b=w[C]).successorInfo,delete b.effortInfo;return S},Be=function(c,w){for(var C=Qe(0,w),b=[],S=0;S<C.length;S++){var L=C[S];if(typeof L.predecessors<"u")for(var M=0;M<L.predecessors.length;M++){var U=L.predecessors[M];typeof U.item<"u"&&C.indexOf(U.item)>=0&&b.push(U)}}return b},qe=function(c,w){if(null==c||null==w||c==w||typeof w.predecessors>"u")return[];var S,C=[],b=[],L=null;for(S=0;S<w.predecessors.length;S++)if(predecessorItem=w.predecessors[S],typeof predecessorItem.item<"u"){var M=ft(c,predecessorItem.item);null!=M&&(predecessorItem.item.effort>0&&(M+=predecessorItem.item.effort),(null==L||M>=L)&&((null==L||M>L)&&(L=M,b=[]),b.push(predecessorItem)))}for(S=0;S<b.length;S++){for(nextPredecessorItem=b[S],L=qe(c,nextPredecessorItem.item),M=0;M<L.length;M++)C.push(L[M]);C.push(w)}return C},ft=function(c,w){if(null==c||null==w)return null;if(c==w)return 0;c.effortInfo||(c.effortInfo={});var C=w.index.toString();if(typeof c.effortInfo[C]<"u")return c.effortInfo[C];for(var b=null,S=je(c),L=0;L<S.length;L++){var M=S[L],U=ft(M.dependentItem,w);null!=U&&((U+=typeof M.predecessorItem.item<"u"&&M.predecessorItem.item.effort>0?M.predecessorItem.item.effort:0)<0&&(U=0),(null==b||U>b)&&(b=U))}return c.effortInfo[C]=b},je=function(c){if(c.successorInfo)return c.successorInfo;for(var w=[],C=c.networkDiagramView.items,b=0;b<C.length;b++){var S=C[b];if(typeof S.predecessors<"u")for(var L=0;L<S.predecessors.length;L++){var M=S.predecessors[L];typeof M.item<"u"&&M.item==c&&w.push({dependentItem:S,predecessorItem:M})}}return c.successorInfo=w},at=function(c){for(var w=null,C=0;C<c.length;C++)(null==w||c[C]>w)&&(w=c[C]);return w},E=function(c){return typeof c<"u"?new Date(c.valueOf()+6e4*c.getTimezoneOffset()):c},B=function(c){return typeof c<"u"?new Date(c.valueOf()-6e4*c.getTimezoneOffset()):c},O=function(c,w,C){for(var b=0;b<w.length;b++)w[b].networkDiagramView=c,w[b].index=b;c.items=w,c.settings=C,c.refresh=function(){Ee(c)},c.refreshItems=function(){for(var S=0;S<w.length;S++){var L=w[S];x(L),P(L)}},c.refreshChartItems=function(){for(var S=0;S<w.length;S++)x(w[S])},c.refreshItem=N,c.refreshChartItem=x,c.refreshPredecessorItems=P,c.refreshItemGraph=X,c.scrollToItem=function(S){var L=k(S,C),M=L-S.networkDiagramView.chartContentContainer.scrollLeft;M<0?S.networkDiagramView.chartContentContainer.scrollLeft=L:M>S.networkDiagramView.chartContentContainer.clientWidth-S.networkDiagramView.settings.itemWidth&&(S.networkDiagramView.chartContentContainer.scrollLeft=L-(S.networkDiagramView.chartContentContainer.clientWidth-S.networkDiagramView.settings.itemWidth)),(M=(L=h(S,C))-S.networkDiagramView.chartContentContainer.scrollTop)<0?S.networkDiagramView.chartContentContainer.scrollTop=L:M>S.networkDiagramView.chartContentContainer.clientHeight-S.networkDiagramView.settings.itemHeight&&(S.networkDiagramView.chartContentContainer.scrollTop=L-(S.networkDiagramView.chartContentContainer.clientHeight-S.networkDiagramView.settings.itemHeight))},c.scrollToLeft=function(){c.chartContentContainer.scrollLeft=0},c.scrollToRight=function(){c.chartContentContainer.scrollLeft=c.chartContent.clientWidth},c.scrollToTop=function(){c.chartContentContainer.scrollTop=0},c.scrollToBottom=function(){c.chartContentContainer.scrollTop=c.chartContent.clientHeight},c.getChartWidth=function(){return H(w,C)},c.getChartHeight=function(){return a(w,C)},c.getItemTop=function(S){return h(S,C)},c.getItemLeft=function(S){return k(S,C)},c.onItemPropertyChanged=Le,c.initializeTaskDraggingThumbs=function(S,L,M,U){pe(S,L,c.items,M,U,c,c.settings)},c.exportContent=function(S,L){typeof S>"u"&&(S={}),Me(S.title,S.preparingMessage,S.isRelativeToTimezone,L,!1,S.rotate,!1,w,C)},c.print=function(S){typeof S>"u"&&(S={}),Me(S.title,S.preparingMessage,S.isRelativeToTimezone,null,!0,S.rotate,S.autoClose,w,C)},c.isItemCritical=function(S,L){return Qe(0,w).indexOf(S)>=0},c.isDependencyCritical=function(S,L){return Be(0,w).indexOf(S)>=0},c.getCriticalItems=function(S){return Qe(0,w)},c.getCriticalDependencies=function(S){return Be(0,w)},c.repositionEnds=function(){if(0!=w.length){for(var S=!1,L=0;L<w.length;L++){for(var M=w[L],U=0,J=0;J<w.length;J++){var $=w[J];if(typeof $.predecessors<"u"){for(var q=0;q<$.predecessors.length&&!(typeof $.predecessors[q].item<"u"&&$.predecessors[q].item==M&&(U++,U>1));q++);if(U>1)break}}U>1&&(S=!0)}(L=w[0]).displayedRowIndex=S?.5:0,(M=w[w.length-1]).displayedRowIndex=S?.5:0,X(L),X(M)}},c.getOutputDate=E,c.getInputDate=B};return{initialize:fe,initializeItems:Je,refresh:Ee,getDefaultStyleDefinitionTemplate:ee,getDefaultTaskTemplate:He,getDefaultItemTemplate:oe,getDefaultDependencyLineTemplate:Ae,getDefaultPredecessorItemTemplate:Ie,initializeTaskDraggingThumbs:function(c,w,C,b){w.networkDiagramView.initializeTaskDraggingThumbs(c,w,C,b)},defaultDateTimeFormatter:function(c){return Ce(new Date(c.valueOf()+6e4*(new Date).getTimezoneOffset()))},defaultTimeSpanFormatter:ae,getOutputDate:E,getInputDate:B}}()),typeof DlhSoft>"u"&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)}),DlhSoft.assemblies.push({assembly:"DlhSoft.Data.HTML.Controls",company:"DlhSoft",product:"Data Modern Library",version:"5.2.3.1",copyright:"Copyright \ufffd 2014-2021 DlhSoft",title:"Data HTML Controls",description:"Data related HTML client components"}),DlhSoft.buildReleaseDate=function(t,fe,Ee){return(t=new Date(t,4,8))>DlhSoft.buildReleaseDate?t:DlhSoft.buildReleaseDate}(2015),_0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{"),null==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var t=_0x5c25[1],fe=_0x5c25[2],Ee=[],We=[],Ge=_0x5c25[3];return{setLicense:function(De,ye){Ee[_0x5c25[7]]({type:De,content:ye})},validate:function(De,ye,ke,xe,he,Ce,ae){ye=ye+_0x5c25[4]+ke;for(var ue=0;ue<We[_0x5c25[5]];ue++)if(We[ue]==ye)return;e:if(typeof Ce!==fe&&typeof ae!==t&&(ae[_0x5c25[6]]!==t&&(Ce=ae[_0x5c25[6]]),typeof ae===fe&&(Ce=ae)),typeof Ce!==fe)for(ae=0;ae<Ee[_0x5c25[5]];ae++)if((ue=Ee[ae])[_0x5c25[8]]==ye&&typeof ue[_0x5c25[9]]===fe){Ce=ue[_0x5c25[9]];break e}!function(De,ye){if(typeof De!==fe||typeof ye!==fe)return!1;if(ye==Ge)return!0;var ke=ye[_0x5c25[11]](_0x5c25[10]);if(0<=ke){var he,xe=ye[_0x5c25[12]](0,ke),Ce=xe[_0x5c25[11]](_0x5c25[10]);if(0<=Ce)try{he=new Date(parseInt(xe[_0x5c25[12]](Ce+1)))}catch{}if(typeof he===t&&(he=new Date(2013,11,31)),DlhSoft[_0x5c25[13]]>he)return!1;for(xe=xe+_0x5c25[10]+De,i=he=0;i<xe[_0x5c25[5]];i++)he=(he<<5)-he+(Ce=xe[_0x5c25[14]](i)),he&=he;if(0>he&&(he=Math[_0x5c25[15]](2,32)-he),(xe=he.toString(16)[_0x5c25[16]]())==(ke=ye[_0x5c25[12]](ke+1)))return!0}return!1}(ye,Ce)?function(De,ye,ke,xe,he){var Ce=_0x5c25[17],ue=typeof ComponentSource!==t&&ComponentSource?_0x5c25[21]:_0x5c25[18]+_0x5c25[19]+xe+_0x5c25[20]+he,H=xe+_0x5c25[22]+he+_0x5c25[23],a=_0x5c25[24],D=_0x5c25[25],k=_0x5c25[26];setTimeout(function(){var h=De[_0x5c25[27]],T=h[_0x5c25[29]](_0x5c25[28]);T[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var y=h[_0x5c25[29]](_0x5c25[28]);y[_0x5c25[32]](_0x5c25[30],_0x5c25[33]);var F=h[_0x5c25[29]](_0x5c25[28]);F[_0x5c25[32]](_0x5c25[30],_0x5c25[34]),y[_0x5c25[35]](F),F[_0x5c25[35]](h[_0x5c25[36]](Ce)),y[_0x5c25[35]](h[_0x5c25[36]](a+_0x5c25[10])),(F=h[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),F[_0x5c25[35]](h[_0x5c25[36]](ye)),y[_0x5c25[35]](F),y[_0x5c25[35]](h[_0x5c25[36]](D+_0x5c25[10])),(F=h[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),F[_0x5c25[35]](h[_0x5c25[36]](H)),y[_0x5c25[35]](F),y[_0x5c25[35]](h[_0x5c25[36]](k+_0x5c25[10])),(F=h[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var x=h[_0x5c25[29]](_0x5c25[39]);x[_0x5c25[32]](_0x5c25[30],_0x5c25[40]),x[_0x5c25[32]](_0x5c25[41],ue),x[_0x5c25[32]](_0x5c25[42],_0x5c25[43]),x[_0x5c25[35]](h[_0x5c25[36]](_0x5c25[44])),F[_0x5c25[35]](x),(x=h[_0x5c25[29]](_0x5c25[39]))[_0x5c25[32]](_0x5c25[30],_0x5c25[45]),x[_0x5c25[32]](_0x5c25[41],_0x5c25[46]),x[_0x5c25[35]](h[_0x5c25[36]](_0x5c25[47])),x[_0x5c25[50]](_0x5c25[48],function(){De[_0x5c25[49]](T),We[_0x5c25[7]](ke)},!1),F[_0x5c25[35]](x),y[_0x5c25[35]](F),T[_0x5c25[35]](y),De[_0x5c25[35]](T)},0),setTimeout(function(){alert(Ce+_0x5c25[51]+a+_0x5c25[52]+ye+_0x5c25[51]+D+_0x5c25[53]+H+_0x5c25[51]+k+_0x5c25[4])},6e5)}(De,ke,ye,xe,he):De[_0x5c25[6]]=Ce}}}());var DlhSoft,__extends=this&&this.__extends||function(t,fe){function Ee(){this.constructor=t}for(var We in fe)fe.hasOwnProperty(We)&&(t[We]=fe[We]);t.prototype=null===fe?Object.create(fe):(Ee.prototype=fe.prototype,new Ee)};function initializeGanttChartTheme(t,fe){if("Default"!=fe){if("Aero"==fe)return void(t.theme="Aero");switch(typeof t.headerHeight>"u"&&(t.headerHeight=62),typeof t.itemHeight>"u"&&(t.itemHeight=28),typeof t.barMargin>"u"&&(t.barMargin=4),typeof t.completedBarMargin>"u"&&(t.completedBarMargin=1),typeof t.barCornerRadius>"u"&&(t.barCornerRadius=1),typeof t.completedBarCornerRadius>"u"&&(t.completedBarCornerRadius=1),typeof t.arrowSize>"u"&&(t.arrowSize=2),typeof t.hourWidth>"u"&&(t.hourWidth=5),fe){case"Generic-bright":typeof t.headerBackground>"u"&&(t.headerBackground="white"),typeof t.mainStroke>"u"&&(t.mainStroke="#005c9e"),typeof t.mainFill>"u"&&(t.mainFill="white"),typeof t.accentFill>"u"&&(t.accentFill="#005c9e"),typeof t.diamondFill>"u"&&(t.diamondFill="#e31d3b"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#005c9e"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#daae66"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Generic-blue":typeof t.headerBackground>"u"&&(t.headerBackground="white");break;case"Royal-blue":typeof t.border>"u"&&(t.border="#ccc"),typeof t.headerBackground>"u"&&(t.headerBackground="#aaa"),typeof t.headerForeground>"u"&&(t.headerForeground="white"),typeof t.toggleFill>"u"&&(t.toggleFill="#ccc"),typeof t.selectedGridForeground>"u"&&(t.selectedGridForeground="#4b5d6b"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#ddd"),typeof t.nonworkingBackground>"u"&&(t.nonworkingBackground="#f8f8f8"),typeof t.mainStroke>"u"&&(t.mainStroke="#407cee"),typeof t.mainFill>"u"&&(t.mainFill="#407cee"),typeof t.accentFill>"u"&&(t.accentFill="#6aa84f"),typeof t.diamondFill>"u"&&(t.diamondFill="#fdbb86"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#222222"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Purple-green":typeof t.headerBackground>"u"&&(t.headerBackground="#dddfd4"),typeof t.mainStroke>"u"&&(t.mainStroke="#005173"),typeof t.mainFill>"u"&&(t.mainFill="#a0729d"),typeof t.accentFill>"u"&&(t.accentFill="#91bc0e"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#fff;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#fff;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Blue-navy":typeof t.headerBackground>"u"&&(t.headerBackground="#eeeeee"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#e8e8e8"),typeof t.mainStroke>"u"&&(t.mainStroke="#6534ff"),typeof t.mainFill>"u"&&(t.mainFill="#369bf9"),typeof t.accentFill>"u"&&(t.accentFill="#227fd5"),typeof t.alternativeGridBackground>"u"&&(t.alternativeGridBackground="#f9f9f9"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Orange-brown":typeof t.headerBackground>"u"&&(t.headerBackground="#eeeeee"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#e8e8e8"),typeof t.mainStroke>"u"&&(t.mainStroke="#cc9d38"),typeof t.mainFill>"u"&&(t.mainFill="#ffcf6b"),typeof t.accentFill>"u"&&(t.accentFill="#d5a05a"),typeof t.diamondFill>"u"&&(t.diamondFill="#00c389"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#222222"),typeof t.alternativeBackground>"u"&&(t.alternativeBackground="#f9f9f9"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#fff;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#fff;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#6a66b3;");break;case"Teal-green":typeof t.headerBackground>"u"&&(t.headerBackground="#eeeeee"),typeof t.mainStroke>"u"&&(t.mainStroke="#3294a1"),typeof t.mainFill>"u"&&(t.mainFill="#5ebccc"),typeof t.accentFill>"u"&&(t.accentFill="#3294a1"),typeof t.diamondFill>"u"&&(t.diamondFill="#faffb3"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#3294a1"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Steel-blue":typeof t.border>"u"&&(t.border="#aaaaaa"),typeof t.headerBackground>"u"&&(t.headerBackground="#6b7d8b"),typeof t.headerForeground>"u"&&(t.headerForeground="white"),typeof t.headerBorder>"u"&&(t.headerBorder="#aaaaaa"),typeof t.containerBackground>"u"&&(t.containerBackground="#d5e5f2"),typeof t.chartBackground>"u"&&(t.chartBackground="#bfcfda"),typeof t.gridForeground>"u"&&(t.gridForeground="gray"),typeof t.toggleFill>"u"&&(t.toggleFill="gray"),typeof t.selectedGridForeground>"u"&&(t.selectedGridForeground="#4b5d6b"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#95a5b2"),typeof t.nonworkingBackground>"u"&&(t.nonworkingBackground="#95a5b2"),typeof t.mainStroke>"u"&&(t.mainStroke="#4477aa"),typeof t.mainFill>"u"&&(t.mainFill="#6699cc"),typeof t.accentFill>"u"&&(t.accentFill="#4c7f3d"),typeof t.diamondFill>"u"&&(t.diamondFill="#999"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#222222"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Cyan-green":typeof t.headerBackground>"u"&&(t.headerBackground="#dddddd"),typeof t.mainStroke>"u"&&(t.mainStroke="#7fc6ce"),typeof t.mainFill>"u"&&(t.mainFill="#1fb5ce"),typeof t.accentFill>"u"&&(t.accentFill="#1fce43"),typeof t.diamondFill>"u"&&(t.diamondFill="#d6485b"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#222222"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Purple-beige":typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#d0d5e5"),typeof t.mainStroke>"u"&&(t.mainStroke="#bfb8a4"),typeof t.mainFill>"u"&&(t.mainFill="#d0d5f5"),typeof t.accentFill>"u"&&(t.accentFill="#bfb8a4"),typeof t.diamondFill>"u"&&(t.diamondFill="#bfb8a4"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#005c9e"),typeof t.alternativeGridBackground>"u"&&(t.alternativeGridBackground="#f0eeeb"),typeof t.alternativeChartBackground>"u"&&(t.alternativeChartBackground="#f9f9f9"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#555;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#fff;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Dark-black":typeof t.containerClass>"u"&&(t.containerClass="dark"),typeof t.border>"u"&&(t.border="#222222"),typeof t.headerBackground>"u"&&(t.headerBackground="#111111"),typeof t.headerForeground>"u"&&(t.headerForeground="#eeeeee"),typeof t.headerBorder>"u"&&(t.headerBorder="#222222"),typeof t.containerBackground>"u"&&(t.containerBackground="#222222"),typeof t.gridForeground>"u"&&(t.gridForeground="#dddddd"),typeof t.chartForeground>"u"&&(t.chartForeground="#dddddd"),typeof t.scaleSeparatorBorder>"u"&&(t.scaleSeparatorBorder="#505050"),typeof t.toggleFill>"u"&&(t.toggleFill="#808080"),typeof t.toggleHoveringFill>"u"&&(t.toggleHoveringFill="white"),typeof t.selectedGridForeground>"u"&&(t.selectedGridForeground="white"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#404040"),typeof t.nonworkingBackground>"u"&&(t.nonworkingBackground="#333333"),typeof t.mainStroke>"u"&&(t.mainStroke="gray"),typeof t.accentFill>"u"&&(t.accentFill="#ffbb00"),typeof t.summaryFill>"u"&&(t.summaryFill="#505050"),typeof t.diamondFill>"u"&&(t.diamondFill="#ffbb00"),typeof t.currentTimeStroke>"u"&&(t.currentTimeStroke="#289451"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Gray-blue":typeof t.headerBackground>"u"&&(t.headerBackground="white"),typeof t.containerBackground>"u"&&(t.containerBackground="#fafafa"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#def8ff"),typeof t.mainStroke>"u"&&(t.mainStroke="#005c9e"),typeof t.mainFill>"u"&&(t.mainFill="white"),typeof t.accentFill>"u"&&(t.accentFill="#007acc"),typeof t.diamondFill>"u"&&(t.diamondFill="#abe2ff"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#007acc");break;case"DlhSoft-gray":typeof t.border>"u"&&(t.border="#aaaaaa"),typeof t.headerBackground>"u"&&(t.headerBackground="#CDDFFC"),typeof t.headerForeground>"u"&&(t.headerForeground="#333"),typeof t.headerBorder>"u"&&(t.headerBorder="transparent"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#e8e8e8"),typeof t.mainStroke>"u"&&(t.mainStroke="#777"),typeof t.mainFill>"u"&&(t.mainFill="#f9f9f9"),typeof t.accentFill>"u"&&(t.accentFill="#decfb9"),typeof t.summaryFill>"u"&&(t.summaryFill="#777"),typeof t.diamondFill>"u"&&(t.diamondFill="#99c9ce"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#777"),typeof t.alternativeGridBackground>"u"&&(t.alternativeGridBackground="#f8f8f8"),typeof t.currentTimeStroke>"u"&&(t.currentTimeStroke="#82a0b3")}typeof t.containerStyle>"u"&&t.containerBackground&&(t.containerStyle="background-color: "+t.containerBackground),typeof t.columnHeaderStyle>"u"&&t.headerForeground&&(t.columnHeaderStyle="color: "+t.headerForeground),t.gridForeground?(typeof t.itemStyle>"u"&&(t.itemStyle="color: "+t.gridForeground+(t.gridBackground?"; background-color: "+t.gridBackground:"")),typeof t.selectedItemStyle>"u"&&t.selectedGridForeground&&(t.selectedItemStyle="color: "+t.selectedGridForeground+"; background-color: "+(t.selectedGridBackground?t.selectedGridBackground:t.gridForeground))):typeof t.selectedItemStyle>"u"&&(t.selectedGridForeground||t.selectedGridBackground)&&(t.selectedItemStyle="color: "+(t.selectedGridForeground?t.selectedGridForeground:"black")+"; background-color: "+(t.selectedGridBackground?t.selectedGridBackground:"#f0f0f0")),typeof t.toggleButtonStyle>"u"&&t.toggleFill&&(t.toggleButtonStyle="fill: "+t.toggleFill),typeof t.toggleButtonHoveringStyle>"u"&&t.toggleHoveringFill&&(t.toggleButtonHoveringStyle="fill: "+t.toggleHoveringFill),typeof t.scales>"u"&&(t.scales=[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: "+(t.nonworkingBackground?t.nonworkingBackground:"#f8f8f8")+"; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 7px 5px; border-right: 1px solid "+(t.headerBorder?t.headerBorder:"#e8e8e8")+"; border-bottom: 1px solid "+(t.headerBorder?t.headerBorder:"#e8e8e8")+(t.headerForeground?"; color: "+t.headerForeground:""),isSeparatorVisible:!0,separatorStyle:"stroke: "+(t.scaleSeparatorBorder?t.scaleSeparatorBorder:"#c8bfe7")+"; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 7px 5px; border-right: 1px solid "+(t.headerBorder?t.headerBorder:"#e8e8e8")+(t.headerForeground?"; color: "+t.headerForeground:"")},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: "+(t.currentTimeStroke?t.currentTimeStroke:"#e31d3b")+"; stroke-width: 0.5px"}]),t.chartBackground&&t.scales.splice(0,0,{scaleType:"Custom",isHeaderVisible:!1,intervals:[{start:new Date(1,0,1),finish:new Date(1e4,11,31,23,59,59,999)}],isHighlightingVisible:!0,highlightingStyle:"fill: "+t.chartBackground}),t.mainFill&&(typeof t.standardBarStyle>"u"&&(t.standardBarStyle="stroke: "+(t.mainStroke?t.mainStroke:t.mainFill)+"; fill: "+t.mainFill),typeof t.collapsedSummaryLineStyle>"u"&&(t.collapsedSummaryLineStyle="stroke: "+(t.mainStroke?t.mainStroke:t.mainFill)+"; stroke-width: 0.65px; stroke-dasharray: 2 2")),typeof t.standardCompletedBarStyle>"u"&&t.accentFill&&(t.standardCompletedBarStyle="stroke: "+t.accentFill+"; fill: "+t.accentFill),typeof t.summaryBarStyle>"u"&&t.summaryFill&&(t.summaryBarStyle="stroke: "+(t.summaryStroke?t.summaryStroke:t.summaryFill)+"; fill: "+t.summaryFill),typeof t.milestoneBarStyle>"u"&&t.diamondFill&&(t.milestoneBarStyle="stroke: "+(t.diamondStroke?t.diamondStroke:t.diamondFill)+"; fill: "+t.diamondFill),t.mainStroke&&(typeof t.arrowFill>"u"&&(t.baselineBarStyle="fill: none; stroke: "+t.mainStroke+"; stroke-width: 0.65px; stroke-dasharray: 2, 2"),t.arrowFill||(t.arrowFill=t.mainStroke),typeof t.dependencyLineStyle>"u"&&(t.dependencyLineStyle="stroke: "+t.arrowFill+"; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)")),typeof t.assignmentsStyle>"u"&&t.chartForeground&&(t.assignmentsStyle="font-size: x-small; fill: "+t.chartForeground),t.alternativeBackground&&(typeof t.alternativeGridBackground>"u"&&(t.alternativeGridBackground=t.alternativeBackground),typeof t.alternativeChartBackground>"u"&&(t.alternativeChartBackground=t.alternativeBackground)),typeof t.alternativeItemStyle>"u"&&t.alternativeGridBackground&&(t.alternativeItemStyle="background-color: "+t.alternativeGridBackground),typeof t.alternativeChartItemStyle>"u"&&t.alternativeChartBackground&&(t.alternativeChartItemStyle="fill: "+t.alternativeChartBackground)}}function initializeLoadChartTheme(t,fe){initializeGanttChartTheme(t,fe),"Default"!=fe&&(typeof t.barHeight>"u"&&(t.barHeight=20),typeof t.allocationFill>"u"&&(t.allocationFill=t.mainFill?"white"!=t.mainFill?t.mainFill:t.mainStroke:"#8abbed"),typeof t.normalAllocationBarStyle>"u"&&(t.normalAllocationBarStyle=t.underAllocationBarStyle="stroke: "+t.allocationFill+"; fill: "+t.allocationFill),typeof t.overAllocationBarStyle>"u"&&(t.overAllocationBarStyle="stroke: #e31d3b; fill: #e31d3b"))}function initializePertChartTheme(t,fe){if("Default"!=fe){typeof t.shapeStyle>"u"&&(t.shapeStyle="fill: White; stroke: #606060; stroke-width: 1px"),typeof t.milestoneStyle>"u"&&(t.milestoneStyle="fill: White; stroke: #606060; stroke-width: 1px"),typeof t.dependencyLineStyle>"u"&&(t.dependencyLineStyle="stroke: #8abbed; stroke-width: 0.65px; fill: none; marker-end: url(#PertArrowMarker)"),typeof t.arrowFill>"u"&&(t.arrowFill="#8abbed"),typeof t.virtualEffortDependencyLineStyle>"u"&&(t.virtualEffortDependencyLineStyle="stroke: #8abbed; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#PertArrowMarker)");var Ee="http://www.w3.org/2000/svg";typeof t.styleDefinitionTemplate>"u"&&(t.styleDefinitionTemplate=function(){var We=document.createElementNS(Ee,"defs"),Ge=document.createElementNS(Ee,"marker");Ge.setAttribute("id","PertArrowMarker"),Ge.setAttribute("viewBox","0 0 10 10"),Ge.setAttribute("refX","0"),Ge.setAttribute("refY","5"),Ge.setAttribute("markerUnits","strokeWidth"),Ge.setAttribute("markerWidth","5"),Ge.setAttribute("markerHeight","4"),Ge.setAttribute("orient","auto");var Je=document.createElementNS(Ee,"path");return Je.setAttribute("fill",t.arrowFill?t.arrowFill:"#3b87d9"),Je.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),Ge.appendChild(Je),We.appendChild(Ge),We})}}!function(t){var fe,Ee,We,Ge,Je,se,De,ye,ae,ue,ke,xe,he,Ce;fe=t.Controls||(t.Controls={}),function(ae){ae.initialize=function(H,a,D){return new ue(H,a,D)},ae.get=function(H){return H.component};var ue=function(){function H(a,D,k){this.host=a,this.settings=D,this.isInitialized=!1;var h="DlhSoft.Controls ContentControl DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[h[5]][h[4]](a,h[0],h[1],h[2],h[3],k,D),this.host.component=this,typeof D>"u"&&(D={}),this.settings=D,H.initializeSettings(this.settings),(typeof(D=this.settings.content)>"u"||null==D)&&(D=H.getContent(a)),this.content=D,this.settings.content=D,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.containerStyle>"u"&&(a.containerStyle="font-family: Arial; font-size: "+("Modern"==a.theme?"12px":"small")),typeof a.contentTemplate>"u"&&(a.contentTemplate=function(D,k){if((typeof k>"u"||null==k)&&(k=""),k instanceof HTMLElement)return k;var h=D.createElement("span");return h.innerHTML=k.toString(),h})},H.getContent=function(a){var h,D=a.ownerDocument.createElement("span"),k=[];for(h=0;h<a.childNodes.length;h++)k.push(a.childNodes[h]);for(h=a.childNodes.length;0<h--;)a.removeChild(a.childNodes[h]);for(h=0;h<k.length;h++)D.appendChild(k[h]);return D},H.prototype.refresh=function(){for(var a=this.host.ownerDocument,D=this.host.childNodes.length;0<D--;)this.host.removeChild(this.host.childNodes[D]);this.contentContainer=this.settings.contentTemplate(a,this.content),null!=this.settings.containerStyle&&this.contentContainer.setAttribute("style",this.settings.containerStyle),typeof this.settings.containerClass<"u"&&this.contentContainer.setAttribute("class",this.settings.containerClass),this.host.appendChild(this.contentContainer)},H.prototype.setContent=function(a){this.content=a,this.settings.content=a,this.refresh()},H}();ae.Element=ue}(Ee=fe.ContentControl||(fe.ContentControl={})),function(ae){ae.initialize=function(H,a,D,k){return new ue(H,a,D,k)},ae.get=function(H){return H.component};var ue=function(){function H(a,D,k,h){this.host=a,this.settings=k,this.isInitialized=!1;var T="DlhSoft.Controls ItemsControl DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[T[5]][T[4]](a,T[0],T[1],T[2],T[3],h,k),this.host.component=this,typeof k>"u"&&(k={}),this.settings=k,H.initializeSettings(this.settings),(typeof D>"u"||null==D)&&(D=this.settings.items),(typeof D>"u"||null==D)&&(D=H.getItems(a)),this.items=D,this.settings.items=D,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.itemContainerStyle>"u"&&(a.itemContainerStyle="font-family: Arial; font-size: "+("Modern"==a.theme?"12px":"small")),typeof a.itemTemplate>"u"&&(a.itemTemplate=function(D,k){if((typeof k>"u"||null==k)&&(k=""),k instanceof HTMLElement)return k;var h=D.createElement("span");return h.innerHTML=k.toString(),h})},H.getItems=function(a){var k,D=[];for(k=0;k<a.childNodes.length;k++)a.childNodes[k]instanceof HTMLElement&&D.push(a.childNodes[k]);for(k=a.childNodes.length;0<k--;)a.removeChild(a.childNodes[k]);return D},H.prototype.refresh=function(){for(var a=this.host.ownerDocument,D=this.host.childNodes.length;0<D--;)this.host.removeChild(this.host.childNodes[D]);for(this.itemContainers=[],D=0;D<this.items.length;D++){var k=this.settings.itemTemplate(a,this.items[D]);null!=this.settings.itemContainerStyle&&k.setAttribute("style",this.settings.itemContainerStyle),typeof this.settings.itemContainerClass<"u"&&k.setAttribute("class",this.settings.itemContainerClass),this.host.appendChild(k)}},H.prototype.setItems=function(a){this.items=a,this.settings.items=a,this.refresh()},H}();ae.Element=ue}(fe.ItemsControl||(fe.ItemsControl={})),function(ae){ae.initialize=function(H,a,D,k){return new ue(H,a,D,k)},ae.get=function(H){return H.component};var ue=function(){function H(a,D,k,h){this.host=a,this.clickHandler=D,this.settings=k,this.isInitialized=!1,D="DlhSoft.Controls Button DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" "),t[D[5]][D[4]](a,D[0],D[1],D[2],D[3],h,k),this.host.component=this,typeof k>"u"&&(k={}),this.settings=k,H.initializeSettings(this.settings);var T=this.host.ownerDocument;(this.inputHost=a instanceof HTMLInputElement?a:null)&&(T=T.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(T,this.inputHost),this.host=T,t[D[5]][D[4]](T,D[0],D[1],D[2],D[3],h,k),this.host.component=this),(k=this.host.getAttribute("style"))&&(this.settings.containerStyle=k+";"+this.settings.containerStyle,this.host.setAttribute("style","")),(k=this.host.getAttribute("class"))&&!this.settings.containerClass&&(this.settings.containerClass=k,this.host.setAttribute("class","")),(typeof(k=this.settings.content)>"u"||null==k)&&(k=Ee.Element.getContent(a)),this.content=k,this.settings.content=k,this.isEnabled=this.settings.isEnabled,this.isInitialRefresh=!0,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){Ee.Element.initializeSettings(a),a.containerStyle+=("Modern"==a.theme?"; color: #505050":"")+"; display: inline-block; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; background-color: #f0f0f0; border: 1px solid #e0e0e0; "+("Modern"==a.theme?"":"; border-radius: 3px"),typeof a.inputType>"u"&&(a.inputType="button"),typeof a.isEnabled>"u"&&(a.isEnabled=!0),typeof a.disabledStyle>"u"&&(a.disabledStyle="opacity: 0.5"),typeof a.hoveringStyle>"u"&&(a.hoveringStyle="background-color: "+("Modern"==a.theme?"#e8e8ff":"#e8e8e8")),typeof a.pressedStyle>"u"&&(a.pressedStyle="background-color: "+("Modern"==a.theme?"#d0d0ff":"#e8e8e8")),typeof a.contentStyle>"u"&&(a.contentStyle="padding: 4px 8px 4px 8px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default")},H.prototype.refresh=function(){var a=this;if(!(this.isInitialRefresh&&(delete this.isInitialRefresh,this instanceof Ge.Element))){for(var D=this.host.ownerDocument,k=this.host.childNodes.length;0<k--;)this.host.removeChild(this.host.childNodes[k]);this.inputHost?(this.inputElement=this.inputHost,this.inputElement.value&&(this.content=this.inputElement.value)):this.inputElement=D.createElement("input"),this.settings.inputName&&this.inputElement.setAttribute("name",this.settings.inputName),this.inputElement.value||(this.inputElement.value=this.inputElement.name),this.inputElement.setAttribute("type","toggleButton"!=this.settings.inputType?this.settings.inputType:"checkbox"),this.inputElement.style.display="none",this.host.appendChild(this.inputElement),this.contentControlHost=D.createElement("div"),this.contentControlHost.setAttribute("style",this.settings.containerStyle),typeof this.settings.containerClass<"u"&&this.contentControlHost.setAttribute("class",this.settings.containerClass),this.host.appendChild(this.contentControlHost),this.contentControl=new Ee.Element(this.contentControlHost,{theme:this.settings.theme,containerStyle:null,content:this.content,contentTemplate:function(h,T){(typeof T>"u"||null==T)&&(T="");var y=h.createElement("div");a.contentContainer=y,y.setAttribute("style",a.settings.contentStyle),typeof a.settings.contentClass<"u"&&y.setAttribute("class",a.settings.contentClass),y.appendChild(a.settings.contentTemplate(h,T));var F=h.createElement("div");a.hoverableContainer=F,a.isEnabled||(a.hoverableContainer.setAttribute("style",a.settings.disabledStyle),typeof a.settings.disabledClass<"u"&&a.hoverableContainer.setAttribute("class",a.settings.disabledClass));var x=h.createElement("div");return a.pressableContainer=x,x.appendChild(y),F.appendChild(x),F.onmouseenter=function(){a.isEnabled&&a.hoverableContainer==F&&(F.setAttribute("style",a.settings.hoveringStyle),typeof a.settings.hoveringClass<"u"&&F.setAttribute("class",a.settings.hoveringClass),"toggleButton"!=a.settings.inputType&&a.isPressed&&(x.setAttribute("style",a.settings.pressedStyle),typeof a.settings.pressedClass<"u"&&x.setAttribute("class",a.settings.pressedClass)),a.isHovering=!0,a.settings.hoveringHandler&&a.settings.hoveringHandler(a))},F.onmouseleave=function(){a.isEnabled&&a.hoverableContainer==F&&(a.isHovering=!1,F.setAttribute("style",""),F.setAttribute("class",""),"toggleButton"!=a.settings.inputType&&(x.setAttribute("style",""),x.setAttribute("class","")),a.settings.unhoveringHandler&&a.settings.unhoveringHandler(a))},"toggleButton"!=a.settings.inputType?(x.onmousedown=function(){a.isEnabled&&a.pressableContainer==x&&(x.setAttribute("style",a.settings.pressedStyle),typeof a.settings.pressedClass<"u"&&x.setAttribute("class",a.settings.pressedClass),a.isPressed=!0,a.settings.pressedHandler&&a.settings.pressedHandler(a))},h.addEventListener("mouseup",function(){a.isEnabled&&a.pressableContainer==x&&(a.isPressed=!1,x.setAttribute("style",""),x.setAttribute("class",""),a.settings.unpressedHandler&&a.settings.unpressedHandler(a))},!1),x.onmouseup=function(){if(a.isEnabled&&a.pressableContainer==x){a.clickHandler&&a.clickHandler();try{var N=a.inputElement.ownerDocument.createEvent("HTMLEvents");N.initEvent("click",!0,!0),a.inputElement.dispatchEvent(N)}catch{}}}):x.onmousedown=function(){if(a.isEnabled&&a.pressableContainer==x)if(a.isPressed){a.isPressed=!1,x.setAttribute("style",""),x.setAttribute("class",""),a.settings.unpressedHandler&&a.settings.unpressedHandler(a),a.clickHandler&&a.clickHandler();try{(N=a.inputElement.ownerDocument.createEvent("HTMLEvents")).initEvent("click",!0,!0),a.inputElement.dispatchEvent(N),(P=a.inputElement.ownerDocument.createEvent("HTMLEvents")).initEvent("change",!0,!0),a.inputElement.dispatchEvent(P)}catch{}}else{x.setAttribute("style",a.settings.pressedStyle),typeof a.settings.pressedClass<"u"&&x.setAttribute("class",a.settings.pressedClass),a.isPressed=!0,a.settings.pressedHandler&&a.settings.pressedHandler(a),a.clickHandler&&a.clickHandler();try{var N=a.inputElement.ownerDocument.createEvent("HTMLEvents");N.initEvent("click",!0,!0),a.inputElement.dispatchEvent(N);var P=a.inputElement.ownerDocument.createEvent("HTMLEvents");P.initEvent("change",!0,!0),a.inputElement.dispatchEvent(P)}catch{}}},F}},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}},H.prototype.setContent=function(a){this.content=a,this.settings.content=a,this.refresh()},H.prototype.enable=function(){this.isEnabled=!0,this.settings.isEnabled=!0,this.refresh()},H.prototype.disable=function(){this.isEnabled=!1,this.settings.isEnabled=!1,this.refresh()},H}();ae.Element=ue}(We=fe.Button||(fe.Button={})),function(ae){ae.initialize=function(H,a,D,k){return new ue(H,a,D,k)},ae.get=function(H){return H.component};var ue=function(H){function a(D,k,h,T){var y=this;H.call(this,D,void 0,h,T),this.toggleHandler=k,this.isInitialized=!1,this.settings.inputType="toggleButton",this.clickHandler=function(){y.toggleHandler&&y.toggleHandler(y.isPressed)},this.refresh(),this.isInitialized=!0}return __extends(a,H),a}(We.Element);ae.Element=ue}(Ge=fe.ToggleButton||(fe.ToggleButton={})),function(ae){ae.initialize=function(H,a,D){return new ue(H,a,D)},ae.get=function(H){return H.component};var ue=function(){function H(a,D,k){this.host=a,this.settings=D,this.isInitialized=!1;var h="DlhSoft.Controls TextBox DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[h[5]][h[4]](a,h[0],h[1],h[2],h[3],k,D),this.host.component=this,typeof D>"u"&&(D={}),this.settings=D,H.initializeSettings(this.settings);var T=this.host.ownerDocument;(this.inputHost=a instanceof HTMLInputElement?a:null)&&(a=T.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(a,this.inputHost),this.host=a,t[h[5]][h[4]](a,h[0],h[1],h[2],h[3],k,D),this.host.component=this),(typeof(D=D.value)>"u"||null==D)&&(D=this.inputHost?this.inputHost.value:this.host.innerText?this.host.innerText:this.host.innerHTML),this.value=D,this.settings.value=D,this.isEnabled=this.settings.isEnabled,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isEnabled>"u"&&(a.isEnabled=!0),typeof a.isReadOnly>"u"&&(a.isReadOnly=!1),typeof a.inputStyle>"u"&&"Modern"==a.theme&&(a.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,k=this.host.childNodes.length;0<k--;)this.host.removeChild(this.host.childNodes[k]);this.inputElement=this.inputHost?this.inputHost:D.createElement("input"),this.settings.inputName&&this.inputElement.setAttribute("name",this.settings.inputName),this.inputElement.setAttribute("type","text"),typeof this.settings.inputStyle<"u"&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass),this.inputElement.value=this.value,this.settings.isReadOnly?this.inputElement.setAttribute("readonly","readonly"):this.inputElement.removeAttribute("readonly"),this.settings.isEnabled?this.inputElement.removeAttribute("disabled"):this.inputElement.setAttribute("disabled","disabled"),this.host.appendChild(this.inputElement),this.inputElement.onchange=function(){a.isEnabled&&(a.value=a.inputElement.value,a.settings.changeHandler&&a.settings.changeHandler(a.value))},this.inputElement.onclick=function(){a.settings.clickHandler&&a.settings.clickHandler()}},H.prototype.getValue=function(){return this.value},H.prototype.setValue=function(a){this.value=a,this.settings.value=a,this.refresh()},H.prototype.enable=function(){this.isEnabled=!0,this.settings.isEnabled=!0,this.refresh()},H.prototype.disable=function(){this.isEnabled=!1,this.settings.isEnabled=!1,this.refresh()},H}();ae.Element=ue}(fe.TextBox||(fe.TextBox={})),function(ae){ae.initialize=function(H,a,D,k){return new ue(H,a,D,k)},ae.get=function(H){return H.component};var ue=function(){function H(a,D,k,h){this.host=a,this.selectedTime=D,this.settings=k,this.isInitialized=!1;var T="DlhSoft.Controls CalendarSelector DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[T[5]][T[4]](a,T[0],T[1],T[2],T[3],h,k),this.host.component=this,typeof k>"u"&&(k={}),this.settings=k,H.initializeSettings(this.settings),typeof D>"u"&&(D=k.minValue),D<k.minValue&&(D=k.minValue),this.selectedTime=D,null==this.settings.displayedTime&&(a=this.settings.rows*this.settings.columns,this.settings.displayedTime=Math.floor(this.selectedTime/a)*a),this.settings.displayedTime<k.minValue&&(this.settings.displayedTime=k.minValue),this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.rows>"u"?a.rows=4:0>=a.rows&&(a.rows=1),typeof a.columns>"u"?a.columns=3:0>=a.columns&&(a.columns=1),typeof a.headerProvider>"u"&&(a.headerProvider=function(D,k){return D.createTextNode(null!=k?k.toString()+" - "+(k+a.rows*a.columns-1).toString():"?")}),typeof a.headerStyle>"u"&&(a.headerStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; background-color: #f0f0f0; padding: 8px; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.timeStyle>"u"&&(a.timeStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; min-width: "+Math.max(128/a.columns,64)+"px; height: "+Math.max(80/a.rows,20)+"px; padding: 2px; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; font-size: "+("Modern"==a.theme?"12px":"small")),typeof a.selectedTimeStyle>"u"&&(a.selectedTimeStyle="background-color: #3399ff; color: White; padding: 2px"),typeof a.timeFormatter>"u"&&(a.timeFormatter=function(D){return D.toString()}),typeof a.invertMatrix>"u"&&(a.invertMatrix=!1),typeof a.minValue>"u"&&(a.minValue=0),typeof a.scrollingHeight>"u"&&(a.scrollingHeight="auto")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,k=this.host.childNodes.length;0<k--;)this.host.removeChild(this.host.childNodes[k]);(k=D.createElement("table")).cellSpacing="0",k.cellPadding="0",k.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&k.setAttribute("class",this.settings.containerClass);var h=null!=this.settings.displayedTime?this.settings.displayedTime:0,T=D.createElement("tr");T.setAttribute("style",this.settings.headerStyle),T.setAttribute("class",this.settings.headerClass),(y=D.createElement("td")).setAttribute("style","text-align: left; padding-left: 4px"),(F=D.createElement("a")).setAttribute("href","javascript://"),F.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),F.appendChild(D.createTextNode("\u25c4")),F.onclick=function(Ie){a.setDisplayedValue(h-a.settings.rows*a.settings.columns),Ie.stopPropagation()},y.appendChild(F),T.appendChild(y),(y=D.createElement("td")).setAttribute("style",this.settings.headerStyle),y.setAttribute("class",this.settings.headerClass),(F=D.createElement("span")).appendChild(this.settings.headerProvider(D,this.settings.displayedTime)),y.appendChild(F),T.appendChild(y),(y=D.createElement("td")).setAttribute("style","text-align: right; padding-right: 4px"),(F=D.createElement("a")).setAttribute("href","javascript://"),F.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),F.appendChild(D.createTextNode("\u25ba")),F.onclick=function(Ie){a.setDisplayedValue(h+a.settings.rows*a.settings.columns),Ie.stopPropagation()},y.appendChild(F),T.appendChild(y),k.appendChild(T),y=D.createElement("tr"),k.appendChild(y),(T=D.createElement("td")).colSpan=3,y.appendChild(T),(y=D.createElement("div")).setAttribute("style","padding: 2px; max-height: "+this.settings.scrollingHeight+"; overflow-y: auto"),T.appendChild(y),(T=D.createElement("table")).cellSpacing="0",T.cellPadding="0",y.appendChild(T);for(var y=null!=this.settings.displayedTime?this.settings.displayedTime:0,F=null!=this.selectedTime?this.selectedTime:0,x=this.settings.rows,N=this.settings.columns,P=0;P<x;P++){for(var X=D.createElement("tr"),ee=0;ee<N;ee++){this.settings.invertMatrix&&(y=h+ee*x+P);var ve,oe=D.createElement("td");oe.setAttribute("style",this.settings.timeStyle),oe.setAttribute("class",this.settings.timeClass);try{ve=this.settings.timeFormatter(y)}catch{ve=y.toString()}var He=D.createElement("div");oe.appendChild(He);var Ae=D.createElement("a");Ae.setAttribute("href","javascript://"),Ae.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),Ae.appendChild(D.createTextNode(ve)),He.appendChild(Ae),null!=F&&y==F&&(He.setAttribute("style",this.settings.selectedTimeStyle),He.setAttribute("class",this.settings.selectedTimeClass),this.selectedElement=He),Ae.value=y,Ae.onclick=function(Le){a.setValue(Le.currentTarget.value),Le.stopPropagation()},X.appendChild(oe),y++}T.appendChild(X)}this.host.appendChild(k)},H.prototype.getValue=function(){return this.selectedTime},H.prototype.setValue=function(a){(!a||a<this.settings.minValue)&&(a=this.settings.minValue),this.selectedTime=a,this.refresh(),this.settings.selectedTimeChangeHandler&&this.settings.selectedTimeChangeHandler(a)},H.prototype.setDisplayedValue=function(a){(!a||a<this.settings.minValue)&&(a=this.settings.minValue),(null==this.settings.displayedTime||a!=this.settings.displayedTime)&&(this.settings.displayedTime=a,this.refresh(),this.settings.displayedTimeChangeHandler&&this.settings.displayedTimeChangeHandler(a))},H}();ae.Element=ue}(Je=fe.CalendarSelector||(fe.CalendarSelector={})),function(ae){ae.initialize=function(H,a,D,k){return new ue(H,a,D,k)},ae.get=function(H){return H.component};var ue=function(){function H(a,D,k,h){this.host=a,this.selectedDate=D,this.settings=k,this.isInitialized=!1;var T="DlhSoft.Controls Calendar DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[T[5]][T[4]](a,T[0],T[1],T[2],T[3],h,k),this.host.component=this,typeof k>"u"&&(k={}),this.settings=k,H.initializeSettings(this.settings),typeof D>"u"&&(D=new Date),D<this.settings.minValue&&(D=this.settings.minValue),this.selectedDates=(this.selectedDate=D)?[this.selectedDate]:[],this.selectedDateRanges=(this.selectedDateRange=this.selectedDate?{start:this.selectedDate,finish:this.selectedDate}:null)?[this.selectedDateRange]:null,null==this.settings.displayedDate&&(this.settings.displayedDate=this.selectedDate),this.settings.displayedDate<this.settings.minValue&&(this.settings.displayedDate=this.settings.minValue),this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isReadOnly>"u"&&(a.isReadOnly=!1),typeof a.isTodayLinkVisible>"u"&&(a.isTodayLinkVisible=!1),typeof a.defaultTimeOfDay>"u"&&(a.defaultTimeOfDay=0),typeof a.allowMultipleSelection>"u"&&(a.allowMultipleSelection=!1),typeof a.allowRangeSelection>"u"&&(a.allowRangeSelection=!1),typeof a.monthYearHeaderStyle>"u"&&(a.monthYearHeaderStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; background-color: #f0f0f0; padding: 8px; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.dayOfWeekHeaderStyle>"u"&&(a.dayOfWeekHeaderStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; padding: 3px; padding-top: 4px; padding-bottom: 2px; border-bottom: 1px solid "+("Modern"==a.theme?"#e0e0e0":"Silver")+"; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.dayStyle>"u"&&(a.dayStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; min-width: 24px; padding: 2px; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; font-size: "+("Modern"==a.theme?"12px":"small")+(a.allowMultipleSelection||a.allowRangeSelection?"; height: "+("Modern"==a.theme?"18px":"20px"):"")),typeof a.otherMonthDayStyle>"u"&&(a.otherMonthDayStyle="color: "+("Modern"==a.theme?"#c0c0c0":"Silver")),typeof a.selectedDayStyle>"u"&&(a.selectedDayStyle="background-color: #3399ff; color: White; padding: 2px"),typeof a.disabledDayStyle>"u"&&(a.disabledDayStyle="color: "+("Modern"==a.theme?"#c0c0c0":"Silver")),typeof a.todayLinkStyle>"u"&&(a.todayLinkStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; padding: 4px; border-top: 1px solid "+("Modern"==a.theme?"#e0e0e0":"Silver")+"; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.todayString>"u"&&(a.todayString="Today"),typeof a.months>"u"&&(a.months="January February March April May June July August September October November December".split(" ")),typeof a.daysOfWeek>"u"&&(a.daysOfWeek="Su Mo Tu We Th Fr Sa".split(" ")),typeof a.monthRows>"u"&&(a.monthRows=1),1>a.monthRows&&(a.monthRows=1),typeof a.monthColumns>"u"&&(a.monthColumns=1),1>a.monthColumns&&(a.monthColumns=1),typeof a.monthCellSpacing>"u"&&(a.monthCellSpacing="0"),typeof a.applyMonthStyleForSingleCell>"u"&&(a.applyMonthStyleForSingleCell=!1),typeof a.applyNextMonthButtonToLastColumn>"u"&&(a.applyNextMonthButtonToLastColumn=!0),typeof a.applyNextMonthButtonToLastRow>"u"&&(a.applyNextMonthButtonToLastRow=!1),typeof a.containerStyle>"u"&&(a.containerStyle=("Modern"==a.theme?"":"border: 1px solid #707070; ")+"font-family: Arial"+(typeof a.monthCellStyle>"u"&&(1<a.monthRows||1<a.monthColumns||a.applyMonthStyleForSingleCell)?"Modern"==a.theme?"; margin: -2px":"; padding: 2px":"Modern"==a.theme?"; border: 1px solid #e0e0e0":"")),typeof a.monthCellStyle>"u"&&(a.monthCellStyle="margin: 2px; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"Silver")),typeof a.calendarSelectorLevels>"u"&&(a.calendarSelectorLevels=0),typeof a.calendarSelectorPopupStyle>"u"&&(a.calendarSelectorPopupStyle="background-color: White; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"#707070")+"; font-family: Arial"),typeof a.minValue>"u"&&(a.minValue=new Date(101,0,1)),typeof a.weekStart>"u"&&(a.weekStart=0)},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,k=this.host.childNodes.length;0<k--;)this.host.removeChild(this.host.childNodes[k]);var h,T;(k=D.createElement("table")).cellSpacing=this.settings.monthCellSpacing,k.cellPadding="0",k.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&k.setAttribute("class",this.settings.containerClass);var y=H.getDate(null!=this.settings.displayedDate?this.settings.displayedDate:null!=this.selectedDate?this.selectedDate:new Date);this.settings.defaultTimeOfDay>=H.dayDuration&&(y=H.subtractDay(y)),h=y;for(var F=0;F<this.settings.monthRows;F++){var x=D.createElement("tr");k.appendChild(x);for(var N=0;N<this.settings.monthColumns;N++){var P=D.createElement("td");x.appendChild(P);var X=D.createElement("table");X.cellSpacing="0",X.cellPadding="0",(1<this.settings.monthRows||1<this.settings.monthColumns||this.settings.applyMonthStyleForSingleCell)&&(X.setAttribute("style",this.settings.monthCellStyle),X.setAttribute("class",this.settings.monthCellClass)),P.appendChild(X),(P=D.createElement("tr")).setAttribute("style",this.settings.monthYearHeaderStyle),P.setAttribute("class",this.settings.monthYearHeaderClass),(Ie=D.createElement("td")).setAttribute("style","text-align: left; padding-left: 4px"),0==F&&0==N&&((ee=D.createElement("a")).setAttribute("href","javascript://"),ee.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),ee.appendChild(D.createTextNode("\u25c4")),ee.onclick=function(Be){for(var qe=y;qe.getMonth()==y.getMonth();)qe=H.subtractDay(qe);a.setDisplayedValue(qe),Be.stopPropagation()},Ie.appendChild(ee)),P.appendChild(Ie),(Ie=D.createElement("td")).setAttribute("style",this.settings.monthYearHeaderStyle),Ie.setAttribute("class",this.settings.monthYearHeaderClass),Ie.colSpan=5;var ee=D.createElement("span"),Ae=D.createTextNode(this.settings.months[h.getMonth()]+" "+h.getFullYear());if(1>this.settings.calendarSelectorLevels||0<F||0<N)ee.appendChild(Ae);else{var oe=D.createElement("a");oe.setAttribute("href","javascript://"),oe.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),oe.appendChild(Ae),ee.appendChild(oe);var ve=D.createElement("div");ve.setAttribute("style","display: none; position: absolute; margin-left: -40px"),oe.appendChild(ve);var He=D.createElement("div");He.setAttribute("style",this.settings.calendarSelectorPopupStyle),this.settings.calendarSelectorPopupClass&&He.setAttribute("class",this.settings.calendarSelectorPopupClass),ve.appendChild(He),oe.onclick=function(Qe){if((Qe.target||Qe.srcElement)==oe){if("none"!=ve.style.display)ve.style.display="none";else{var Be=12*y.getFullYear()+y.getMonth(),qe={theme:a.settings.theme,headerProvider:function(je,at){var E=je.createTextNode(Math.floor(at/12).toString());if(2>a.settings.calendarSelectorLevels)return E;var B=je.createElement("a");B.setAttribute("href","javascript://"),B.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),B.appendChild(E);var O=je.createElement("div");O.setAttribute("style","display: none; position: absolute; margin-left: -10px"),B.appendChild(O);var c=je.createElement("div");return c.setAttribute("style",a.settings.calendarSelectorPopupStyle),a.settings.calendarSelectorPopupClass&&c.setAttribute("class",a.settings.calendarSelectorPopupClass),O.appendChild(c),B.onclick=function(w){if((w.target||w.srcElement)==B){if("none"!=O.style.display)O.style.display="none";else{var C=Math.floor(at/12)-1;O.style.display="block";var b=Je.initialize(c,C,{rows:5,columns:2,invertMatrix:!0,headerProvider:function(S,L){var M=S.createTextNode((L+1).toString()+" - "+(L+10).toString());if(3>a.settings.calendarSelectorLevels)return M;var U=S.createElement("a");U.setAttribute("href","javascript://"),U.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),U.appendChild(M);var J=S.createElement("div");J.setAttribute("style","display: none; position: absolute; margin-left: -10px"),U.appendChild(J);var $=S.createElement("div");return $.setAttribute("style",a.settings.calendarSelectorPopupStyle),a.settings.calendarSelectorPopupClass&&$.setAttribute("class",a.settings.calendarSelectorPopupClass),J.appendChild($),U.onclick=function(q){if((q.target||q.srcElement)==U){if("none"!=J.style.display)J.style.display="none";else{var te=Math.floor(L/10);J.style.display="block",Je.initialize($,te,{rows:5,columns:2,invertMatrix:!0,headerProvider:function(G,K){return G.createTextNode((10*K+1).toString()+" - "+(10*(K+10)).toString())},timeFormatter:function(G){return(10*G+1).toString()+"-"+(10*G+10).toString().substr((10*G+10).toString().length-2)},minValue:10},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.").settings.selectedTimeChangeHandler=function(G){b.setDisplayedValue(10*G)}}q.stopPropagation()}},U},timeFormatter:function(S){return(S+1).toString()},minValue:100},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");b.settings.selectedTimeChangeHandler=function(S){ft.setDisplayedValue(12*(S+1))}}w.stopPropagation()}},B},timeFormatter:function(je){return a.settings.months[je-12*Math.floor(je/12)]},minValue:1212};ve.style.display="block";var ft=Je.initialize(He,Be,qe,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");ft.settings.selectedTimeChangeHandler=function(je){a.setDisplayedValue(new Date(Math.floor(je/12),je-12*Math.floor(je/12),1))}}Qe.stopPropagation()}}}for(Ie.appendChild(ee),P.appendChild(Ie),(Ie=D.createElement("td")).setAttribute("style","text-align: right; padding-right: 4px"),(this.settings.applyNextMonthButtonToLastRow?F==this.settings.monthRows-1:0==F)&&(this.settings.applyNextMonthButtonToLastColumn?N==this.settings.monthColumns-1:0==N)&&((ee=D.createElement("a")).setAttribute("href","javascript://"),ee.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),ee.appendChild(D.createTextNode("\u25ba")),ee.onclick=function(Qe){for(var Be=y;Be.getMonth()==y.getMonth();)Be=H.addDay(Be);a.setDisplayedValue(Be),Qe.stopPropagation()},Ie.appendChild(ee)),P.appendChild(Ie),X.appendChild(P),ee=D.createElement("tr"),Ie=P=this.settings.weekStart;Ie<P+7;Ie++)T=Ie%7,(Ae=D.createElement("td")).setAttribute("style",this.settings.dayOfWeekHeaderStyle),Ae.setAttribute("class",this.settings.dayOfWeekHeaderClass),Ae.appendChild(D.createTextNode(this.settings.daysOfWeek[T%7])),ee.appendChild(Ae);X.appendChild(ee),null!=(ee=null!=this.selectedDate?H.getDate(this.selectedDate):null)&&this.settings.defaultTimeOfDay>=H.dayDuration&&(ee=H.subtractDay(ee)),Ae=h.getMonth();var Ie=H.getFirstDayOfMonth(h),be=H.getPreviousWeekStart(Ie,P);for(h=0;6>h;h++){var Le=D.createElement("tr");for(Ie=P;Ie<P+7;Ie++){T=Ie%7,(T=D.createElement("td")).setAttribute("style",this.settings.dayStyle),T.setAttribute("class",this.settings.dayClass);var pe=be.getDate().toString(),me=D.createElement("span");T.appendChild(me);var Pe=D.createElement("span");me.appendChild(Pe);var Fe=typeof this.settings.disabledDateSelector<"u"&&this.settings.disabledDateSelector(be),rt=be.getMonth()==Ae,Me=D.createElement("a");Me.setAttribute("href","javascript://"),Me.setAttribute("style","text-decoration: none; display: inline-block; cursor: "+(this.settings.isReadOnly||Fe||!rt&&(this.settings.allowRangeSelection||this.settings.allowMultipleSelection)?"default":"pointer")+"; color: inherit; width: 20px"),Me.appendChild(D.createTextNode(pe)),Pe.appendChild(Me),Fe?(me.setAttribute("style",this.settings.disabledDayStyle),me.setAttribute("class",this.settings.disabledDayClass)):rt?((pe=ee&&Math.abs(be.valueOf()-ee.valueOf())<=H.hourDuration||this.isValueSelected(be))&&(me.setAttribute("style",this.settings.selectedDayStyle),me.setAttribute("class",this.settings.selectedDayClass)),this.settings.highlightingStyleSelector&&(me=this.settings.highlightingStyleSelector(be,pe))&&Pe.setAttribute("style",me),this.settings.highlightingClassSelector&&(me=this.settings.highlightingClassSelector(be,pe))&&Pe.setAttribute("class",me)):(Pe.setAttribute("style",this.settings.otherMonthDayStyle),Pe.setAttribute("class",this.settings.otherMonthDayClass)),!this.settings.isReadOnly&&!Fe&&(Me.value=H.addTimeOfDay(be,this.settings.defaultTimeOfDay),this.settings.allowMultipleSelection||this.settings.allowRangeSelection?this.settings.allowRangeSelection?rt&&(Me.onmousedown=function(Be){var qe=Be.currentTarget.value;a.draggingFromDate=qe,a.setValue(qe),Be.preventDefault()},Me.onmouseover=function(Be){a.draggingFromDate&&(Be=Be.currentTarget.value,!a.draggingToDate||Be.valueOf()!=a.draggingToDate.valueOf())&&(a.draggingToDate=Be,a.setValueRange({start:a.draggingFromDate,finish:a.draggingToDate}))}):rt&&(Me.onclick=function(Be){a.invertValueSelection(Be.currentTarget.value),Be.stopPropagation()}):Me.onclick=function(Be){var qe=Be.currentTarget.value;a.setDisplayedValue(qe),a.setValue(qe),Be.stopPropagation()}),Le.appendChild(T),be=H.addDay(be)}X.appendChild(Le)}h=be}}!this.settings.isReadOnly&&this.settings.isTodayLinkVisible&&(F=D.createElement("tr"),(x=D.createElement("td")).colSpan=7,x.setAttribute("style",this.settings.todayLinkStyle),x.setAttribute("class",this.settings.todayLinkClass),(N=D.createElement("a")).setAttribute("href","javascript://"),N.setAttribute("style","text-decoration: none; color: inherit; cursor: pointer"),N.appendChild(D.createTextNode(this.settings.todayString)),x.appendChild(N),N.value=H.addTimeOfDay(H.getDate(new Date),this.settings.defaultTimeOfDay),N.onclick=function(Qe){var Be=Qe.currentTarget.value;a.setDisplayedValue(Be),a.setValue(Be),Qe.stopPropagation()},F.appendChild(x),k.appendChild(F)),this.host.appendChild(k),this.isInitialized||D.addEventListener("mouseup",function(){a.draggingToDate&&delete a.draggingToDate,a.draggingFromDate&&delete a.draggingFromDate},!0)},H.prototype.getValue=function(){return this.selectedDate},H.prototype.setValue=function(a){null!=a&&a<this.settings.minValue&&(a=this.settings.minValue),(null==this.selectedDate&&null!=a||null!=this.selectedDate&&null==a||null!=this.selectedDate&&null!=a&&a.valueOf()!=this.selectedDate.valueOf()||this.settings.forceSetOnClick)&&(this.isDuringInternalSetValue=!0,this.selectedDate=a,this.setValues(null!=a?[a]:[]),delete this.isDuringInternalSetValue,null==this.settings.displayedDate&&null!=a?(this.settings.displayedDate=a,this.refresh(),this.settings.displayedDateChangeHandler&&this.settings.displayedDateChangeHandler(a)):this.refresh(),this.settings.selectedDateChangeHandler&&this.settings.selectedDateChangeHandler(a))},H.prototype.setDisplayedValue=function(a){null!=a&&a<this.settings.minValue&&(a=this.settings.minValue),(null==this.settings.displayedDate||a.valueOf()!=this.settings.displayedDate.valueOf())&&(this.settings.displayedDate=a,this.refresh(),this.settings.displayedDateChangeHandler&&this.settings.displayedDateChangeHandler(a))},H.prototype.getValues=function(){return this.selectedDates},H.prototype.setValues=function(a){this.selectedDates=a,0<a.length&&(this.isDuringInternalSetValues=!0,this.selectedDate=a[0],this.setValueRanges([{start:this.selectedDate,finish:this.selectedDate}]),delete this.isDuringInternalSetValues)},H.prototype.getValueRange=function(){return this.selectedDateRange},H.prototype.setValueRange=function(a){if(a.finish||(a.finish=a.start),a.finish<a.start){var D=a.finish;a.finish=a.start,a.start=D}this.setValueRanges([a])},H.prototype.getValueRanges=function(){return this.selectedDateRanges},H.prototype.setValueRanges=function(a){if(this.selectedDateRanges=a,0<a.length&&(this.selectedDateRange=a[0],!this.isDuringInternalSetValues)){this.selectedDates=[];for(var D=0;D<a.length;D++){var k=a[D];if(k.finish||(k.finish=k.start),k.finish<k.start){var h=k.finish;k.finish=k.start,k.start=h}for(h=k.start;h<=k.finish;h=H.addDay(h))this.selectedDates.push(h)}this.selectedDate=this.selectedDateRange.start}this.isDuringInternalSetValue||(this.refresh(),this.settings.selectedDateChangeHandler&&this.settings.selectedDateChangeHandler(this.selectedDate)),this.settings.selectionChangedHandler&&this.settings.selectionChangedHandler()},H.prototype.isValueSelected=function(a){a=a.valueOf();for(var D=0;D<this.selectedDates.length;D++)if(this.selectedDates[D].valueOf()==a)return!0;return!1},H.prototype.invertValueSelection=function(a){for(var D=a.valueOf(),k=0;k<this.selectedDates.length;k++)if(this.selectedDates[k].valueOf()==D)return void(1<this.selectedDates.length&&(this.selectedDates.splice(k,1),this.setValues(this.selectedDates)));this.selectedDates.push(a),this.setValues(this.selectedDates)},H.getDate=function(a){var D=a.getTimezoneOffset()*H.minuteDuration;return new Date(Math.floor((a.valueOf()-D)/H.dayDuration)*H.dayDuration+D)},H.getPreviousWeekStart=function(a,D){for(var k=H.getDate(a),h=k;k.getDay()!=D;)k=H.subtractDay(k);if(h.valueOf()-k.valueOf()>6.5*H.dayDuration)for(h=0;7>h;h++)k=H.addDay(k);return k},H.addDay=function(D){var k=D.getTimezoneOffset()*H.minuteDuration;return k=(D=new Date(D.valueOf()-k+H.dayDuration)).getTimezoneOffset()*H.minuteDuration,new Date(D.valueOf()+k)},H.subtractDay=function(a){return H.getDate(new Date(a.valueOf()-H.dayDuration))},H.addTimeOfDay=function(k,D){var h=k.getTimezoneOffset()*H.minuteDuration;return h=(k=new Date(k.valueOf()-h+D)).getTimezoneOffset()*H.minuteDuration,new Date(k.valueOf()+h)},H.getFirstDayOfMonth=function(a){for(a=H.getDate(a);1<a.getDate();)a=H.subtractDay(a);return a},H.weekDuration=7*(H.dayDuration=24*(H.hourDuration=60*(H.minuteDuration=60*(H.secondDuration=1e3)))),H.initialSundayDateTimeValue=3*H.dayDuration,H}();ae.Element=ue}(se=fe.Calendar||(fe.Calendar={})),function(ae){ae.initialize=function(H,a,D,k){return new ue(H,a,D,k)},ae.get=function(H){return H.component};var ue=function(){function H(a,D,k,h){this.host=a,this.value=D,this.settings=k,this.isInitialized=!1,this.dropDownButtonElement=null;var T="DlhSoft.Controls DatePicker DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[T[5]][T[4]](a,T[0],T[1],T[2],T[3],h,k),this.host.component=this,typeof k>"u"&&(k={}),this.settings=k,H.initializeSettings(this.settings);var y=this.host.ownerDocument;if(this.inputHost=a instanceof HTMLInputElement?a:null){if(null==D)try{D=this.settings.dateTimeParser(this.inputHost.value)}catch{}a=y.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(a,this.inputHost),this.host=a,t[T[5]][T[4]](a,T[0],T[1],T[2],T[3],h,k),this.host.component=this}typeof D>"u"&&(D=k.isNullValueAccepted?null:new Date),this.value=D,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.isTodayLinkVisible>"u"&&(a.isTodayLinkVisible=!0),typeof a.calendarSelectorLevels>"u"&&(a.calendarSelectorLevels=1/0),typeof a.popupStyle>"u"&&(a.popupStyle="background-color: White; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"#707070")+"; font-family: Arial"),typeof a.calendarSelectorPopupStyle>"u"&&(a.calendarSelectorPopupStyle=a.popupStyle),typeof a.calendarSelectorPopupClass>"u"&&(a.calendarSelectorPopupClass=a.popupClass),se.Element.initializeSettings(a),typeof a.openDropDownOnInputClick>"u"&&(a.openDropDownOnInputClick=!0),typeof a.dateTimeFormatter>"u"&&(a.dateTimeFormatter=function(x){if(null==x&&a.isNullValueAccepted)return"";var k=function(N,P){void 0===P&&(P=2);for(var X=N.toString();X.length<P;)X="0"+X;return X},h=x.getFullYear(),T=x.getMonth()+1,y=x.getDate(),F=x.getHours();return x=x.getMinutes(),k(T)+"/"+k(y)+"/"+k(h,4)+" "+k(F)+":"+k(x)}),typeof a.dateTimeParser>"u"&&(a.dateTimeParser=function(D){return typeof D>"u"||null==D||0==D.length?a.isNullValueAccepted?null:new Date:(D=new Date(D),isNaN(D.valueOf())||D.getFullYear()<=0?new Date:D)}),typeof a.isNullValueAccepted>"u"&&(a.isNullValueAccepted=!0),typeof a.isDropDownButtonVisible>"u"&&(a.isDropDownButtonVisible=!1),typeof a.dropDownButtonDefinition>"u"&&(a.dropDownButtonDefinition="<svg style='display: inline-block; margin-left: 4px; cursor: pointer; vertical-align: middle' width='12' height='12'><rect x='0' y='0' width='12' height='3' style='fill: #707070; stroke: #707070; stroke-width: 0.65'/><rect x='0' y='3' width='12' height='9' style='fill: none; stroke: #707070; stroke-width: 0.65'/><line x1='3' y1='3' x2='3' y2='12' style='stroke: #707070; stroke-width: 0.65'/><line x1='6' y1='3' x2='6' y2='12' style='stroke: #707070; stroke-width: 0.65'/><line x1='9' y1='3' x2='9' y2='12' style='stroke: #707070; stroke-width: 0.65'/><line x1='0' y1='6' x2='12' y2='6' style='stroke: #707070; stroke-width: 0.65'/><line x1='0' y1='9' x2='12' y2='9' style='stroke: #707070; stroke-width: 0.65'/></svg>"),typeof a.inputStyle>"u"&&"Modern"==a.theme&&(a.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,k=this.host.childNodes.length;0<k--;)this.host.removeChild(this.host.childNodes[k]);if((k=D.createElement("div")).setAttribute("style","margin-top: -1px"),this.inputHost)(h=D.createElement("span")).setAttribute("style","display: inline-block"),h.appendChild(k),this.host.appendChild(h),this.popupElement=(k=this.host.firstChild).firstChild,this.inputHost.parentElement&&this.inputHost.parentElement.removeChild(this.inputHost),this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.inputHost,this.popupElement),this.inputElement=this.inputHost;else{var h=D.createElement("span");h.setAttribute("style","display: inline-block");var T=D.createElement("input");h.appendChild(T),h.appendChild(k),this.host.appendChild(h),this.inputElement=(k=this.host.firstChild).firstChild,this.popupElement=k.childNodes[1]}this.popupElement&&((k=D.createElement("div")).setAttribute("style",this.settings.popupStyle),this.settings.popupClass&&k.setAttribute("class",this.settings.popupClass),this.popupElement.appendChild(k)),this.inputElement&&(typeof this.settings.inputStyle<"u"&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass)),this.settings.isDropDownButtonVisible&&(this.dropDownButtonElement=D.createElement("span"),this.dropDownButtonElement.setAttribute("style","display: inline-block"),this.dropDownButtonElement.innerHTML=this.settings.dropDownButtonDefinition,this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.dropDownButtonElement,this.popupElement)),this.inputElement&&(this.inputElement.DatePicker=this,this.setValue(this.value),this.settings.isReadOnly&&this.inputElement.setAttribute("readonly","readonly")),this.popupElement&&(k=this.popupElement.firstChild,this.calendarHost=D.createElement("div"),k.appendChild(this.calendarHost)),this.calendarHost&&(this.calendar=new se.Element(this.calendarHost,this.value,{theme:this.settings.theme,isReadOnly:this.settings.isReadOnly,displayedDate:this.settings.displayedDate,defaultTimeOfDay:this.settings.defaultTimeOfDay,weekStart:this.settings.weekStart,isTodayLinkVisible:this.settings.isTodayLinkVisible,containerStyle:null,monthYearHeaderStyle:this.settings.monthYearHeaderStyle,monthYearHeaderClass:this.settings.monthYearHeaderClass,dayOfWeekHeaderStyle:this.settings.dayOfWeekHeaderStyle,dayOfWeekHeaderClass:this.settings.dayOfWeekHeaderClass,dayStyle:this.settings.dayStyle,dayClass:this.settings.dayClass,otherMonthDayStyle:this.settings.otherMonthDayStyle,otherMonthDayClass:this.settings.otherMonthDayClass,selectedDayStyle:this.settings.selectedDayStyle,selectedDayClass:this.settings.selectedDayClass,disabledDayStyle:this.settings.disabledDayStyle,disabledDayClass:this.settings.disabledDayClass,todayLinkStyle:this.settings.todayLinkStyle,todayLinkClass:this.settings.todayLinkClass,monthRows:this.settings.monthRows,monthColumns:this.settings.monthColumns,monthCellSpacing:this.settings.monthCellSpacing,monthCellStyle:this.settings.monthCellStyle,monthCellClass:this.settings.monthCellClass,highlightingStyleSelector:this.settings.highlightingStyleSelector,highlightingClassSelector:this.settings.highlightingClassSelector,disabledDateSelector:this.settings.disabledDateSelector,applyMonthStyleForSingleCell:this.settings.applyMonthStyleForSingleCell,applyNextMonthButtonToLastColumn:!0,applyNextMonthButtonToLastRow:!1,allowMultipleSelection:!1,allowRangeSelection:!1,calendarSelectorLevels:this.settings.calendarSelectorLevels,calendarSelectorPopupStyle:this.settings.calendarSelectorPopupStyle,calendarSelectorPopupClass:this.settings.calendarSelectorPopupClass,minValue:this.settings.minValue,months:this.settings.months,daysOfWeek:this.settings.daysOfWeek,todayString:this.settings.todayString,forceSetOnClick:!0,selectedDateChangeHandler:function(y){a.setValue(y),a.settings.selectedDateChangeHandler&&a.settings.selectedDateChangeHandler(y)}},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),this.inputElement&&(this.inputElement.addEventListener("change",function(){a.refreshValue()},!0),this.dropDownButtonElement&&(this.dropDownButtonElement.onmousedown=function(){a.recordClick(),a.refreshValue(),setTimeout(function(){a.toggleDropDown()},0)}),this.popupElement)&&(this.popupElement.style.position="absolute",this.popupElement.style.display="none",this.inputElement.addEventListener("focus",function(){a.settings.openDropDownOnInputClick&&(a.openDropDown(),a.focusValue=a.inputElement.value)},!0),this.inputElement.addEventListener("blur",function(){a.settings.openDropDownOnInputClick&&typeof a.focusValue<"u"&&delete a.focusValue},!0),this.inputElement.addEventListener("keydown",function(y){13==y.keyCode?a.settings.openDropDownOnInputClick&&a.refreshValue():a.closeDropDown()},!0),this.inputElement.addEventListener("mousedown",function(){setTimeout(function(){a.settings.openDropDownOnInputClick&&!(typeof a.focusValue<"u"&&a.inputElement.value!=a.focusValue)&&(a.refreshValue(),a.openDropDown())},0),a.recordClick()},!0),this.inputElement.addEventListener("input",function(){a.closeDropDown()},!0),this.popupElement.onmousedown=function(){a.recordClick()},D.addEventListener("mousedown",function(){setTimeout(function(){a.isDuringRecordedClick()||a.closeDropDown()},0)},!0),D.addEventListener("mousewheel",function(){a.closeDropDown()},!0),D.addEventListener("DOMMouseScroll",function(){a.closeDropDown()},!0))},H.prototype.recordClick=function(){var a=this;this.isDuringClick||(this.isDuringClick=!0,setTimeout(function(){delete a.isDuringClick},0))},H.prototype.isDuringRecordedClick=function(){return typeof this.isDuringClick<"u"},H.prototype.getValue=function(){return this.value},H.prototype.setValue=function(a){this.resetValue(a)},H.prototype.setDisplayedValue=function(a){this.calendar&&this.calendar.setDisplayedValue(a)},H.prototype.refreshValue=function(){this.resetValue()},H.prototype.resetValue=function(a){if(!this.isDuringInternalSetValue){this.isDuringInternalSetValue=!0,this.closeDropDown();var k,D=this.value;try{this.value=a??this.settings.dateTimeParser(this.inputElement.value)}catch{}null!=this.value&&this.value<this.settings.minValue&&(this.value=this.settings.isNullValueAccepted?null:this.settings.minValue),this.settings.disabledDateSelector&&null!=this.value&&this.settings.disabledDateSelector(this.value)&&(this.value=this.settings.isNullValueAccepted?null:new Date);try{k=this.settings.dateTimeFormatter(this.value)}catch{k=""}if(k!=this.inputElement.value&&(this.inputElement.value=k,this.isInitialized))try{var h=this.inputElement.ownerDocument.createEvent("HTMLEvents");h.initEvent("change",!0,!0),this.inputElement.dispatchEvent(h)}catch{}(this.value&&!D||!this.value&&D||this.value&&D&&this.value.valueOf()!=D.valueOf())&&(this.calendar&&(this.calendar.selectedDate=this.value,this.calendar.refresh()),this.settings.valueChangeHandler&&this.settings.valueChangeHandler(this.value)),delete this.isDuringInternalSetValue}},H.prototype.openDropDown=function(){this.isOpen||this.toggleDropDown()},H.prototype.closeDropDown=function(){this.isOpen&&this.toggleDropDown()},H.prototype.toggleDropDown=function(){var a=this;(this.isOpen=!this.isOpen)&&this.value&&this.setDisplayedValue(this.value);var D=function(){var y=a.inputElement.getBoundingClientRect();a.popupElement.style.position="fixed",a.popupElement.style.zIndex="1",a.popupElement.style.left=y.left+"px",a.popupElement.style.top=y.top+y.height+"px",a.popupElement.style.display=a.isOpen?"block":"none";var F=a.popupElement.getBoundingClientRect();F.bottom>a.popupElement.ownerDocument.documentElement.clientHeight&&y.top>=F.height&&(a.popupElement.style.top=y.top-F.height+2+"px"),F.right>a.popupElement.ownerDocument.documentElement.clientWidth&&a.popupElement.ownerDocument.documentElement.clientWidth>=F.width&&(a.popupElement.style.left=a.popupElement.ownerDocument.documentElement.clientWidth-F.width+"px")};if(D(),this.isOpen&&this.settings.dropDownOpenedHandler?this.settings.dropDownOpenedHandler():!this.isOpen&&this.settings.dropDownClosedHandler&&this.settings.dropDownClosedHandler(),this.isOpen){var k=this.host.ownerDocument.documentElement.clientWidth,h=this.host.ownerDocument.documentElement.clientHeight,T=this.host.getBoundingClientRect();this.positionChangeHandlerTimer=setInterval(function(){var y=a.host.ownerDocument.documentElement.clientWidth,F=a.host.ownerDocument.documentElement.clientHeight,x=a.host.getBoundingClientRect();y!=k||F!=h?a.closeDropDown():(x.left!=T.left||x.top!=T.top||x.width!=T.width||x.height!=T.height)&&D(),k=y,h=F,T=x},100)}else this.positionChangeHandlerTimer&&(clearInterval(this.positionChangeHandlerTimer),delete this.positionChangeHandlerTimer)},H}();ae.Element=ue}(De=fe.DatePicker||(fe.DatePicker={})),ae=ye=fe.CalendarDay||(fe.CalendarDay={}),ue=function(){function H(a,D,k,h,T){this.host=a,this.selectedTime=D,this.header=k,this.settings=h,this.isInitialized=!1;var y="DlhSoft.Controls CalendarDay DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[y[5]][y[4]](a,y[0],y[1],y[2],y[3],T,h),this.host.component=this,typeof h>"u"&&(h={}),typeof k<"u"&&typeof h.header>"u"&&(h.header=k),this.settings=h,H.initializeSettings(this.settings),typeof D>"u"&&(a=new Date,D=new Date(a.valueOf()-a.getTimezoneOffset()*H.minuteDuration).getTime(),D-=Math.floor(D/H.dayDuration)*H.dayDuration),this.selectedTime=D,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isReadOnly>"u"&&(a.isReadOnly=!1),typeof a.isNowLinkVisible>"u"&&(a.isNowLinkVisible=!1),typeof a.header>"u"&&(a.header="Time of day"),typeof a.isHeaderVisible>"u"&&(a.isHeaderVisible=!0),typeof a.headerStyle>"u"&&(a.headerStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; background-color: #f0f0f0; padding: 8px; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.timeStyle>"u"&&(a.timeStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; min-width: 24px; padding: 2px; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; font-size: "+("Modern"==a.theme?"12px":"small")),typeof a.selectedTimeStyle>"u"&&(a.selectedTimeStyle="background-color: #3399ff; color: White; padding: 2px"),typeof a.disabledTimeStyle>"u"&&(a.disabledTimeStyle="color: "+("Modern"==a.theme?"#c0c0c0":"Silver")),typeof a.nowLinkStyle>"u"&&(a.nowLinkStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; padding: 4px; border-top: 1px solid "+("Modern"==a.theme?"#e0e0e0":"Silver")+"; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.nowString>"u"&&(a.nowString="Now"),typeof a.hourDivisions>"u"?a.hourDivisions=2:0>=a.hourDivisions&&(a.hourDivisions=1),typeof a.timeFormatter>"u"&&(a.timeFormatter=function(h){var k=Math.floor(h/H.hourDuration),T=(h=Math.floor((h-k*H.hourDuration)/H.minuteDuration),function(y,F){void 0===F&&(F=2);for(var x=y.toString();x.length<F;)x="0"+x;return x});return T(k)+":"+T(h)}),typeof a.hourColumns>"u"?a.hourColumns=4:0>=a.hourColumns&&(a.hourColumns=1),typeof a.scrollingHeight>"u"&&(a.scrollingHeight="auto")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,k=this.host.childNodes.length;0<k--;)this.host.removeChild(this.host.childNodes[k]);if((k=D.createElement("table")).cellSpacing="0",k.cellPadding="0",k.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&k.setAttribute("class",this.settings.containerClass),this.settings.isHeaderVisible){var h=D.createElement("tr");h.setAttribute("style",this.settings.headerStyle),h.setAttribute("class",this.settings.headerClass),(T=D.createElement("td")).setAttribute("style",this.settings.headerStyle),T.setAttribute("class",this.settings.headerClass),(y=D.createElement("span")).appendChild(D.createTextNode(this.settings.header)),T.appendChild(y),h.appendChild(T),k.appendChild(h)}T=D.createElement("tr"),k.appendChild(T),h=D.createElement("td"),T.appendChild(h),(T=D.createElement("div")).setAttribute("style","max-height: "+this.settings.scrollingHeight+"; overflow-y: auto"),h.appendChild(T),(h=D.createElement("table")).cellSpacing="0",h.cellPadding="0",T.appendChild(h);for(var T=null!=this.selectedTime?H.getTime(this.selectedTime,this.settings.hourDivisions):null,y=this.settings.hourDivisions,F=this.settings.hourColumns,x=24/F,N=0;N<x*y;N++){for(var P=D.createElement("tr"),X=0;X<F;X++){var ve,ee=(X*x+N/y)*H.hourDuration,oe=D.createElement("td");oe.setAttribute("style",this.settings.timeStyle),oe.setAttribute("class",this.settings.timeClass);try{ve=this.settings.timeFormatter(ee)}catch{ve=(ee/H.hourDuration).toString()}var He=D.createElement("span");oe.appendChild(He);var Ae=D.createElement("span");He.appendChild(Ae);var Ie=typeof this.settings.disabledTimeSelector<"u"&&this.settings.disabledTimeSelector(ee),be=D.createElement("a");if(be.setAttribute("href","javascript://"),be.setAttribute("style","text-decoration: none; display: inline-block; cursor: "+(this.settings.isReadOnly||Ie?"default":"pointer")+"; color: inherit; width: 40px"),be.appendChild(D.createTextNode(ve)),Ae.appendChild(be),Ie)He.setAttribute("style",this.settings.disabledTimeStyle),He.setAttribute("class",this.settings.disabledTimeClass);else{var Le=null!=T&&ee==T;Le&&(He.setAttribute("style",this.settings.selectedTimeStyle),He.setAttribute("class",this.settings.selectedTimeClass),this.selectedElement=He),this.settings.highlightingStyleSelector&&(He=this.settings.highlightingStyleSelector(ee,Le))&&Ae.setAttribute("style",He),this.settings.highlightingClassSelector&&(Le=this.settings.highlightingClassSelector(ee,Le))&&Ae.setAttribute("class",Le)}!this.settings.isReadOnly&&!Ie&&(be.value=ee,be.onclick=function(Pe){a.setValue(Pe.currentTarget.value),Pe.stopPropagation()}),P.appendChild(oe)}h.appendChild(P)}!this.settings.isReadOnly&&this.settings.isNowLinkVisible&&(ve=D.createElement("tr"),(h=D.createElement("td")).setAttribute("style",this.settings.nowLinkStyle),h.setAttribute("class",this.settings.nowLinkClass),(T=D.createElement("a")).setAttribute("href","javascript://"),T.setAttribute("style","text-decoration: none; color: inherit; cursor: pointer"),T.appendChild(D.createTextNode(this.settings.nowString)),h.appendChild(T),T.value=-1,T.onclick=function(pe){var me=pe.currentTarget.value;0>me&&(me=new Date,me=new Date(me.valueOf()-me.getTimezoneOffset()*H.minuteDuration).getTime(),me-=Math.floor(me/H.dayDuration)*H.dayDuration),a.setValue(me),pe.stopPropagation()},ve.appendChild(h),k.appendChild(ve)),this.host.appendChild(k)},H.prototype.getValue=function(){return this.selectedTime},H.prototype.setValue=function(a){null!=a&&0>a&&(a=0),(a!=this.selectedTime||this.settings.forceSetOnClick)&&(this.selectedTime=a,this.refresh(),this.settings.selectedTimeChangeHandler&&this.settings.selectedTimeChangeHandler(a))},H.getTime=function(a,D){var k=H.hourDuration/D;return Math.floor(a/k)*k},H.dayDuration=24*(H.hourDuration=60*(H.minuteDuration=60*(H.secondDuration=1e3))),H}(),ae.Element=ue,function(ae){ae.initialize=function(H,a,D,k,h){return new ue(H,a,D,k,h)},ae.get=function(H){return H.component};var ue=function(){function H(a,D,k,h,T){this.host=a,this.value=D,this.header=k,this.settings=h,this.isInitialized=!1,this.dropDownButtonElement=null;var y="DlhSoft.Controls TimePicker DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");if(t[y[5]][y[4]](a,y[0],y[1],y[2],y[3],T,h),this.host.component=this,typeof h>"u"&&(h={}),typeof k<"u"&&typeof h.header>"u"&&(h.header=k),this.settings=h,H.initializeSettings(this.settings),k=this.host.ownerDocument,this.inputHost=a instanceof HTMLInputElement?a:null){if(null==D)try{D=this.settings.timeParser(this.inputHost.value)}catch{}a=k.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(a,this.inputHost),this.host=a,t[y[5]][y[4]](a,y[0],y[1],y[2],y[3],T,h),this.host.component=this}typeof D>"u"&&(h.isNullValueAccepted?D=null:(D=new Date,D=new Date(D.valueOf()-D.getTimezoneOffset()*H.minuteDuration).getTime(),D-=Math.floor(D/H.dayDuration)*H.dayDuration)),this.value=D,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.isNowLinkVisible>"u"&&(a.isNowLinkVisible=!0),typeof a.timeFormatter>"u"&&(a.timeFormatter=function(h){if(null==h&&a.isNullValueAccepted)return"";var k=Math.floor(h/H.hourDuration),T=(h=Math.floor((h-k*H.hourDuration)/H.minuteDuration),function(y,F){void 0===F&&(F=2);for(var x=y.toString();x.length<F;)x="0"+x;return x});return T(k)+":"+T(h)}),ye.Element.initializeSettings(a),typeof a.openDropDownOnInputClick>"u"&&(a.openDropDownOnInputClick=!0),typeof a.timeParser>"u"&&(a.timeParser=function(D){if(typeof D>"u"||null==D||0==D.length)return a.isNullValueAccepted?null:0;var k=D.lastIndexOf(" ");return k>=0&&(D=D.substr(k+1)),D=new Date("01/01/1970 "+D),isNaN(D.valueOf())||D.getFullYear()<=0||1970!=D.getFullYear()||0!=D.getMonth()||1!=D.getDate()?(D=new Date,D=new Date(D.valueOf()-D.getTimezoneOffset()*H.minuteDuration).getTime(),D-=Math.floor(D/H.dayDuration)*H.dayDuration):D.getTime()-D.getTimezoneOffset()*H.minuteDuration}),typeof a.isNullValueAccepted>"u"&&(a.isNullValueAccepted=!0),typeof a.isDropDownButtonVisible>"u"&&(a.isDropDownButtonVisible=!1),typeof a.dropDownButtonDefinition>"u"&&(a.dropDownButtonDefinition="<svg style='display: inline-block; margin-left: 4px; cursor: pointer; vertical-align: middle' width='12' height='12'><circle cx='6' cy='6' r='6' style='fill: none; stroke: #707070; stroke-width: 0.65'/><line x1='6' y1='2' x2='6' y2='6' style='stroke: #707070; stroke-width: 0.65'/><line x1='6' y1='6' x2='10' y2='6' style='stroke: #707070; stroke-width: 0.65'/></svg>"),typeof a.popupStyle>"u"&&(a.popupStyle="background-color: White; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"#707070")+"; font-family: Arial"),typeof a.inputStyle>"u"&&"Modern"==a.theme&&(a.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px"),typeof a.defaultPrefix>"u"&&(a.defaultPrefix="")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,k=this.host.childNodes.length;0<k--;)this.host.removeChild(this.host.childNodes[k]);if((k=D.createElement("div")).setAttribute("style","margin-top: -1px"),this.inputHost)(h=D.createElement("span")).setAttribute("style","display: inline-block"),h.appendChild(k),this.host.appendChild(h),this.popupElement=(k=this.host.firstChild).firstChild,this.inputHost.parentElement&&this.inputHost.parentElement.removeChild(this.inputHost),this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.inputHost,this.popupElement),this.inputElement=this.inputHost;else{var h=D.createElement("span");h.setAttribute("style","display: inline-block");var T=D.createElement("input");h.appendChild(T),h.appendChild(k),this.host.appendChild(h),this.inputElement=(k=this.host.firstChild).firstChild,this.popupElement=k.childNodes[1]}this.popupElement&&((k=D.createElement("div")).setAttribute("style",this.settings.popupStyle),this.settings.popupClass&&k.setAttribute("class",this.settings.popupClass),this.popupElement.appendChild(k)),this.inputElement&&(typeof this.settings.inputStyle<"u"&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass)),this.settings.isDropDownButtonVisible&&(this.dropDownButtonElement=D.createElement("span"),this.dropDownButtonElement.setAttribute("style","display: inline-block"),this.dropDownButtonElement.innerHTML=this.settings.dropDownButtonDefinition,this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.dropDownButtonElement,this.popupElement)),this.inputElement&&(this.inputElement.TimePicker=this,this.setValue(this.value),this.settings.isReadOnly&&this.inputElement.setAttribute("readonly","readonly")),this.popupElement&&(k=this.popupElement.firstChild,this.calendarDayHost=D.createElement("div"),k.appendChild(this.calendarDayHost)),this.calendarDayHost&&(this.calendarDay=new ye.Element(this.calendarDayHost,this.value,void 0,{theme:this.settings.theme,isReadOnly:this.settings.isReadOnly,header:this.settings.header,isHeaderVisible:this.settings.isHeaderVisible,isNowLinkVisible:this.settings.isNowLinkVisible,containerStyle:null,headerStyle:this.settings.headerStyle,headerClass:this.settings.headerClass,timeStyle:this.settings.timeStyle,timeClass:this.settings.timeClass,selectedTimeStyle:this.settings.selectedTimeStyle,selectedTimeClass:this.settings.selectedTimeClass,disabledTimeStyle:this.settings.disabledTimeStyle,disabledTimeClass:this.settings.disabledTimeClass,nowLinkStyle:this.settings.nowLinkStyle,nowLinkClass:this.settings.nowLinkClass,highlightingStyleSelector:this.settings.highlightingStyleSelector,highlightingClassSelector:this.settings.highlightingClassSelector,disabledTimeSelector:this.settings.disabledTimeSelector,nowString:this.settings.nowString,hourDivisions:this.settings.hourDivisions,timeFormatter:this.settings.timeFormatter,hourColumns:this.settings.hourColumns,scrollingHeight:this.settings.scrollingHeight,forceSetOnClick:!0,selectedTimeChangeHandler:function(y){a.setValue(y),a.settings.selectedTimeChangeHandler&&a.settings.selectedTimeChangeHandler(y)}},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),this.inputElement&&(this.inputElement.addEventListener("change",function(){a.refreshValue()},!0),this.dropDownButtonElement&&(this.dropDownButtonElement.onmousedown=function(){a.recordClick(),a.refreshValue(),setTimeout(function(){a.toggleDropDown()},0)}),this.popupElement)&&(this.popupElement.style.position="absolute",this.popupElement.style.display="none",this.inputElement.addEventListener("focus",function(){a.settings.openDropDownOnInputClick&&(a.openDropDown(),a.focusValue=a.inputElement.value)},!0),this.inputElement.addEventListener("blur",function(){a.settings.openDropDownOnInputClick&&typeof a.focusValue<"u"&&delete a.focusValue},!0),this.inputElement.addEventListener("keydown",function(y){13==y.keyCode?a.settings.openDropDownOnInputClick&&a.refreshValue():a.closeDropDown()},!0),this.inputElement.addEventListener("mousedown",function(){setTimeout(function(){a.settings.openDropDownOnInputClick&&!(typeof a.focusValue<"u"&&a.inputElement.value!=a.focusValue)&&(a.refreshValue(),a.openDropDown())},0),a.recordClick()},!0),this.inputElement.addEventListener("input",function(){a.closeDropDown()},!0),this.popupElement.onmousedown=function(){a.recordClick()},D.addEventListener("mousedown",function(){setTimeout(function(){a.isDuringRecordedClick()||a.closeDropDown()},0)},!0),D.addEventListener("mousewheel",function(y){a.isMouseWheelScrollingPopup(y)||a.closeDropDown()},!0),D.addEventListener("DOMMouseScroll",function(y){a.isMouseWheelScrollingPopup(y)||a.closeDropDown()},!0))},H.prototype.recordClick=function(){var a=this;this.isDuringClick||(this.isDuringClick=!0,setTimeout(function(){delete a.isDuringClick},0))},H.prototype.isDuringRecordedClick=function(){return typeof this.isDuringClick<"u"},H.prototype.isMouseWheelScrollingPopup=function(a){for(var D=typeof a.wheelDelta<"u"?a.wheelDelta/120:typeof a.detail<"u"?-a.detail/3:0,k=(a=a.target,!1);null!=a;){if(0<a.offsetHeight&&a.offsetHeight<a.scrollHeight&&!(1>=a.scrollTop&&0<D||a.scrollTop>=a.scrollHeight-a.clientHeight-1&&0>D)&&(k=!0),a==this.popupElement)return k;a=a.parentElement}return!1},H.prototype.getValue=function(){return this.value},H.prototype.setValue=function(a){this.resetValue(a)},H.prototype.refreshValue=function(){this.resetValue()},H.prototype.resetValue=function(a){if(!this.isDuringInternalSetValue){this.isDuringInternalSetValue=!0,this.closeDropDown();var k,D=this.value;try{this.value=a??this.settings.timeParser(this.inputElement.value)}catch{}this.settings.disabledTimeSelector&&null!=this.value&&this.settings.disabledTimeSelector(this.value)&&(this.settings.isNullValueAccepted?this.value=null:(a=new Date,this.value=new Date(a.valueOf()-a.getTimezoneOffset()*H.minuteDuration).getTime(),this.value-=Math.floor(this.value/H.dayDuration)*H.dayDuration)),0<(a=0<=(a=this.inputElement.value?this.inputElement.value.lastIndexOf(" "):-1)?this.inputElement.value.substr(0,a):this.settings.defaultPrefix).length&&(a+=" ");try{k=a+this.settings.timeFormatter(this.value)}catch{}if(k!=this.inputElement.value&&(this.inputElement.value=k,this.isInitialized))try{var h=this.inputElement.ownerDocument.createEvent("HTMLEvents");h.initEvent("change",!0,!0),this.inputElement.dispatchEvent(h)}catch{}(this.value&&!D||!this.value&&D||this.value&&D&&this.value!=D)&&(this.calendarDay&&(this.calendarDay.selectedTime=this.value,this.calendarDay.refresh()),this.settings.valueChangeHandler&&this.settings.valueChangeHandler(this.value)),delete this.isDuringInternalSetValue}},H.prototype.openDropDown=function(){this.isOpen||this.toggleDropDown()},H.prototype.closeDropDown=function(){this.isOpen&&this.toggleDropDown()},H.prototype.toggleDropDown=function(){var a=this;this.isOpen=!this.isOpen;var D=function(){var y=a.inputElement.getBoundingClientRect();a.popupElement.style.position="fixed",a.popupElement.style.zIndex="1",a.popupElement.style.left=y.left+"px",a.popupElement.style.top=y.top+y.height+"px",a.popupElement.style.display=a.isOpen?"block":"none";var F=a.popupElement.getBoundingClientRect();F.bottom>a.popupElement.ownerDocument.documentElement.clientHeight&&y.top>=F.height&&(a.popupElement.style.top=y.top-F.height+2+"px"),F.right>a.popupElement.ownerDocument.documentElement.clientWidth&&a.popupElement.ownerDocument.documentElement.clientWidth>=F.width&&(a.popupElement.style.left=a.popupElement.ownerDocument.documentElement.clientWidth-F.width+"px")};if(D(),this.isOpen&&this.settings.dropDownOpenedHandler?this.settings.dropDownOpenedHandler():!this.isOpen&&this.settings.dropDownClosedHandler&&this.settings.dropDownClosedHandler(),this.isOpen){this.calendarDay.selectedElement&&this.calendarDay.selectedElement.scrollIntoView();var k=this.host.ownerDocument.documentElement.clientWidth,h=this.host.ownerDocument.documentElement.clientHeight,T=this.host.getBoundingClientRect();this.positionChangeHandlerTimer=setInterval(function(){var y=a.host.ownerDocument.documentElement.clientWidth,F=a.host.ownerDocument.documentElement.clientHeight,x=a.host.getBoundingClientRect();y!=k||F!=h?a.closeDropDown():(x.left!=T.left||x.top!=T.top||x.width!=T.width||x.height!=T.height)&&D(),k=y,h=F,T=x},100)}else this.positionChangeHandlerTimer&&(clearInterval(this.positionChangeHandlerTimer),delete this.positionChangeHandlerTimer)},H.dayDuration=24*(H.hourDuration=60*(H.minuteDuration=60*(H.secondDuration=1e3))),H}();ae.Element=ue}(ke=fe.TimePicker||(fe.TimePicker={})),function(ae){ae.initialize=function(H,a,D,k){return new ue(H,a,D,k)},ae.get=function(H){return H["DateTimePicker.component"]};var ue=function(){function H(a,D,k,h){var y,T=this;this.host=a,this.value=D,this.settings=k,this.isInitialized=!1,this.host["DateTimePicker.component"]=this,typeof k>"u"&&(k={}),typeof k.license<"u"&&typeof k.datePickerSettings<"u"&&(k.datePickerSettings.license=k.license),this.settings=k,H.initializeSettings(this.settings),typeof D>"u"&&(D=k.datePickerSettings.isNullValueAccepted?null:new Date),this.value=D,this.timePicker=ke.initialize(a,void 0,void 0,this.settings.timePickerSettings,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),this.inputElement=this.timePicker.inputElement,this.inputElement["DateTimePicker.component"]=this,this.datePicker=De.initialize(this.inputElement,this.value,this.settings.datePickerSettings,h),this.value=this.datePicker.value;try{y=D?this.datePicker.settings.dateTimeFormatter(D):""}catch{y=""}0<=(a=y.lastIndexOf(" "))&&(y=y.substr(0,a)),this.timePicker.settings.defaultPrefix=y;var F=this.datePicker.settings.dropDownOpenedHandler;this.datePicker.settings.dropDownOpenedHandler=function(){T.datePicker.isOpen&&T.timePicker.isOpen&&T.timePicker.closeDropDown(),T.isOpen=T.datePicker.isOpen,F&&F()};var x=this.datePicker.settings.dropDownClosedHandler;this.datePicker.settings.dropDownClosedHandler=function(){T.isOpen=T.datePicker.isOpen,x&&x()};var N=this.timePicker.settings.dropDownOpenedHandler;this.timePicker.settings.dropDownOpenedHandler=function(){T.timePicker.isOpen&&!T.value?T.timePicker.closeDropDown():(T.timePicker.isOpen&&T.datePicker.isOpen&&T.datePicker.closeDropDown(),T.isTimeOpen=T.timePicker.isOpen,N&&N())};var P=this.timePicker.settings.dropDownClosedHandler;this.timePicker.settings.dropDownClosedHandler=function(){T.isTimeOpen=T.timePicker.isOpen,P&&P()};var X=this.datePicker.settings.valueChangeHandler;this.datePicker.settings.valueChangeHandler=function(ee){T.value=ee,X&&X(ee)},this.inputElement&&(this.inputElement.addEventListener("focus",function(){T.settings.openDropDownOnInputClick&&("Time"===T.getCurrentValuePart()?(T.timePicker.refreshValue(),T.openTimeDropDown()):T.openDropDown(),T.focusValue=T.inputElement.value)},!0),this.inputElement.addEventListener("blur",function(){T.settings.openDropDownOnInputClick&&typeof T.focusValue<"u"&&delete T.focusValue},!0),this.inputElement.addEventListener("keydown",function(ee){13==ee.keyCode?T.settings.openDropDownOnInputClick&&T.refreshValue():T.closeDropDown()},!0),this.inputElement.addEventListener("mousedown",function(){setTimeout(function(){!T.settings.openDropDownOnInputClick||typeof T.focusValue<"u"&&T.inputElement.value!=T.focusValue||("Time"===T.getCurrentValuePart()?(T.timePicker.refreshValue(),T.openTimeDropDown()):(T.datePicker.refreshValue(),T.openDropDown()))},0)},!0)),this.isInitialized=!0}return H.initializeSettings=function(a){if(typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isReadOnly>"u"&&(a.isReadOnly=!1),typeof a.isNullValueAccepted>"u"&&(a.isNullValueAccepted=!0),typeof a.openDropDownOnInputClick>"u"&&(a.openDropDownOnInputClick=!0),typeof a.datePickerSettings>"u"&&(a.datePickerSettings={}),a.datePickerSettings.isReadOnly=a.isReadOnly,a.datePickerSettings.theme=a.theme,typeof a.datePickerSettings.isTodayLinkVisible>"u"&&(a.datePickerSettings.isTodayLinkVisible=a.areCurrentLinksVisible),typeof a.datePickerSettings.defaultTimeOfDay>"u"&&(a.datePickerSettings.defaultTimeOfDay=a.defaultTimeOfDay),a.datePickerSettings.openDropDownOnInputClick=!1,typeof a.datePickerSettings.isDropDownButtonVisible>"u"&&(a.datePickerSettings.isDropDownButtonVisible=a.areDropDownButtonsVisible),a.datePickerSettings.allowMultipleSelection=!1,a.datePickerSettings.allowRangeSelection=!1,typeof a.datePickerSettings.dateTimeFormatter>"u"&&(a.datePickerSettings.dateTimeFormatter=a.dateTimeFormatter),typeof a.datePickerSettings.dateTimeParser>"u"&&(a.datePickerSettings.dateTimeParser=a.dateTimeParser),a.datePickerSettings.isNullValueAccepted=a.isNullValueAccepted,typeof a.datePickerSettings.valueChangeHandler>"u"&&(a.datePickerSettings.valueChangeHandler=a.valueChangeHandler),typeof a.datePickerSettings.popupClass>"u"&&(a.datePickerSettings.popupClass=a.popupClass),typeof a.datePickerSettings.popupStyle>"u"&&(a.datePickerSettings.popupStyle=a.popupStyle),typeof a.datePickerSettings.inputClass>"u"&&(a.datePickerSettings.inputClass=a.inputClass),typeof a.datePickerSettings.inputStyle>"u"&&(a.datePickerSettings.inputStyle=a.inputStyle),typeof a.datePickerSettings.disabledDateSelector>"u"&&(a.datePickerSettings.disabledDateSelector=a.disabledDateSelector),typeof a.datePickerSettings.calendarSelectorLevels>"u"&&(a.datePickerSettings.calendarSelectorLevels=a.calendarSelectorLevels),typeof a.datePickerSettings.months>"u"&&(a.datePickerSettings.months=a.months),typeof a.datePickerSettings.daysOfWeek>"u"&&(a.datePickerSettings.daysOfWeek=a.daysOfWeek),typeof a.timePickerSettings>"u"&&(a.timePickerSettings={}),a.timePickerSettings.theme=a.theme,a.timePickerSettings.isReadOnly=a.isReadOnly,typeof a.timePickerSettings.isNowLinkVisible>"u"&&(a.timePickerSettings.isNowLinkVisible=a.areCurrentLinksVisible),typeof a.timePickerSettings.nowString>"u"&&(a.timePickerSettings.nowString="Current"),a.timePickerSettings.openDropDownOnInputClick=!1,typeof a.timePickerSettings.isDropDownButtonVisible>"u"&&(a.timePickerSettings.isDropDownButtonVisible=a.areDropDownButtonsVisible),typeof a.timePickerSettings.timeFormatter>"u"&&typeof a.datePickerSettings.dateTimeFormatter<"u"&&(a.timePickerSettings.timeFormatter=function(h){var T=new Date(1970,0,1);return h=null!=h?a.datePickerSettings.dateTimeFormatter(new Date(T.valueOf()+h)):"",(T=h.lastIndexOf(" "))<0?"":h.substr(T+1)}),typeof a.timePickerSettings.timeParser>"u"&&typeof a.datePickerSettings.dateTimeParser<"u"&&typeof a.datePickerSettings.dateTimeFormatter<"u"&&(a.timePickerSettings.timeParser=function(h){if((y=h.lastIndexOf(" "))<0)return a.isNullValueAccepted?null:(h=new Date,(h=new Date(h.valueOf()-h.getTimezoneOffset()*H.minuteDuration).getTime())-Math.floor(h/H.dayDuration)*H.dayDuration);h=h.substr(y+1);var y,T=a.datePickerSettings.dateTimeFormatter(new Date(1970,0,1));return(y=T.indexOf(" "))>=0&&(T=T.substr(0,y+1)),h=a.datePickerSettings.dateTimeParser(T+h),isNaN(h.valueOf())||h.getFullYear()<=0||1970!=h.getFullYear()||0!=h.getMonth()||1!=h.getDate()?(h=new Date,h=new Date(h.valueOf()-h.getTimezoneOffset()*H.minuteDuration).getTime(),h-=Math.floor(h/H.dayDuration)*H.dayDuration):h.getTime()-h.getTimezoneOffset()*H.minuteDuration}),a.timePickerSettings.isNullValueAccepted=a.isNullValueAccepted,typeof a.timePickerSettings.disabledTimeSelector<"u"){var D=a.datePickerSettings.disabledDateSelector;a.datePickerSettings.disabledDateSelector=function(k){var h=!1;return D&&(h=D(k)),!!h||(k=new Date(k.valueOf()-k.getTimezoneOffset()*H.minuteDuration).getTime(),k-=Math.floor(k/H.dayDuration)*H.dayDuration,a.timePickerSettings.disabledTimeSelector(k))}}typeof a.timePickerSettings.popupClass>"u"&&(a.timePickerSettings.popupClass=a.popupClass),typeof a.timePickerSettings.popupStyle>"u"&&(a.timePickerSettings.popupStyle=a.popupStyle),a.timePickerSettings.inputClass=void 0,a.timePickerSettings.inputStyle=null,typeof a.timePickerSettings.disabledTimeSelector>"u"&&(a.timePickerSettings.disabledTimeSelector=a.disabledTimeSelector)},H.prototype.refreshValue=function(){this.datePicker.refreshValue(),this.timePicker.refreshValue()},H.prototype.getValue=function(){return this.datePicker.getValue()},H.prototype.setValue=function(a){this.datePicker.setValue(a)},H.prototype.getTimeValue=function(){return this.timePicker.getValue()},H.prototype.setTimeValue=function(a){this.timePicker.setValue(a)},H.prototype.openDropDown=function(){this.datePicker.openDropDown()},H.prototype.closeDropDown=function(){this.datePicker.closeDropDown()},H.prototype.openTimeDropDown=function(){this.timePicker.openDropDown()},H.prototype.closeTimeDropDown=function(){this.timePicker.closeDropDown()},H.prototype.getCurrentValuePart=function(){if(!this.inputElement||!this.inputElement.value)return null;var a=this.inputElement.value.lastIndexOf(" ");return 0>a?"Date":this.inputElement.selectionStart>a?"Time":"Date"},H.dayDuration=24*(H.hourDuration=60*(H.minuteDuration=60*(H.secondDuration=1e3))),H}();ae.Element=ue}(fe.DateTimePicker||(fe.DateTimePicker={})),function(ae){ae.initialize=function(H,a,D,k,h){return new ue(H,a,D,k,h)},ae.get=function(H){return H.component};var ue=function(){function H(a,D,k,h,T){this.host=a,this.availableChoices=D,this.value=k,this.settings=h,this.isInitialized=!1,this.dropDownButtonElement=null;var y="DlhSoft.Controls MultiSelectorComboBox DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[y[5]][y[4]](a,y[0],y[1],y[2],y[3],T,h),this.host.component=this,typeof h>"u"&&(h={}),this.settings=h,H.initializeSettings(this.settings),typeof this.settings.choiceStyle>"u"&&!(this instanceof he.Element)&&(this.settings.choiceStyle="cursor: pointer");var F=this.host.ownerDocument;(this.inputHost=a instanceof HTMLInputElement?a:null)&&(null==k&&(k=this.inputHost.value),a=F.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(a,this.inputHost),this.host=a,t[y[5]][y[4]](a,y[0],y[1],y[2],y[3],T,h),this.host.component=this),(typeof D>"u"||null==D)&&(D=[]),this.availableChoices=D,(typeof k>"u"||null==k)&&(k=""),this.value=k,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isReadOnly>"u"&&(a.isReadOnly=!1),typeof a.autoAppendAvailableChoices>"u"&&(a.autoAppendAvailableChoices=!1),typeof a.openDropDownOnInputClick>"u"&&(a.openDropDownOnInputClick=!0),typeof a.isDropDownButtonVisible>"u"&&(a.isDropDownButtonVisible=!1),typeof a.dropDownButtonDefinition>"u"&&(a.dropDownButtonDefinition="<span style='display: inline-block; margin-left: 1px; color: "+("Modern"==a.theme?"#909090":"#707070")+"; font-size: "+("Modern"==a.theme?"10px":"x-small")+"; "+(a.isReadOnly?"opacity: 0.25":"cursor: pointer")+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none'>\u25bc</span>"),typeof a.separator>"u"&&(a.separator=","),typeof a.isSpaceSeparated>"u"&&(a.isSpaceSeparated=!0),typeof a.delimiters>"u"&&(a.delimiters=["["]),typeof a.areCheckBoxesVisible>"u"&&(a.areCheckBoxesVisible=!0),typeof a.popupStyle>"u"&&(a.popupStyle="background-color: White; color: "+("Modern"==a.theme?"#505050":"Black")+"; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"#707070")+"; font-family: Arial; font-size: "+("Modern"==a.theme?"12px":"small")+"; max-height: 188px; overflow-y: auto"),typeof a.inputStyle>"u"&&"Modern"==a.theme&&(a.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,k=this.host.childNodes.length;0<k--;)this.host.removeChild(this.host.childNodes[k]);if((k=D.createElement("div")).setAttribute("style","margin-top: -1px"),this.inputHost)(h=D.createElement("span")).setAttribute("style","display: inline-block"),h.appendChild(k),this.host.appendChild(h),this.popupElement=(k=this.host.firstChild).firstChild,this.inputHost.parentElement&&this.inputHost.parentElement.removeChild(this.inputHost),this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.inputHost,this.popupElement),this.inputElement=this.inputHost;else{var h=D.createElement("span");h.setAttribute("style","display: inline-block");var T=D.createElement("input");h.appendChild(T),h.appendChild(k),this.host.appendChild(h),this.inputElement=(k=this.host.firstChild).firstChild,this.popupElement=k.childNodes[1]}this.popupElement&&((k=D.createElement("div")).setAttribute("style",this.settings.popupStyle),this.settings.popupClass&&k.setAttribute("class",this.settings.popupClass),this.popupElement.appendChild(k)),this.inputElement&&(typeof this.settings.inputStyle<"u"&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass)),this.settings.isDropDownButtonVisible&&(this.dropDownButtonElement=D.createElement("span"),this.dropDownButtonElement.setAttribute("style","display: inline-block"),this.dropDownButtonElement.innerHTML=this.settings.dropDownButtonDefinition,this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.dropDownButtonElement,this.popupElement)),this.inputElement&&(this.inputElement.MultiSelectorComboBox=this,this.setValue(this.value),(this.settings.isReadOnly||this instanceof Ce.Element)&&this.inputElement.setAttribute("readonly","readonly")),this.popupElement&&(k=this.popupElement.firstChild,this.checkBoxListElement=D.createElement("div"),this.checkBoxListElement.setAttribute("style","margin: 2px; margin-left: 0px; padding-right: 2px; padding-bottom: 2px"),k.appendChild(this.checkBoxListElement),this.refreshSelectedChoices()),this.inputElement&&(this.inputElement.addEventListener("change",function(){a.refreshValue(),a.refreshAvailableChoices()},!0),this.dropDownButtonElement&&(this.dropDownButtonElement.onmousedown=function(){a.recordClick(),a.refreshValue(),setTimeout(function(){a.toggleDropDown()},0)}),this.popupElement)&&(this.popupElement.style.position="absolute",this.popupElement.style.display="none",this.inputElement.addEventListener("focus",function(){a.settings.openDropDownOnInputClick&&(a.openDropDown(),a.focusValue=a.inputElement.value)},!0),this.inputElement.addEventListener("blur",function(){a.settings.openDropDownOnInputClick&&typeof a.focusValue<"u"&&delete a.focusValue},!0),this.inputElement.addEventListener("keydown",function(y){13==y.keyCode?a.settings.openDropDownOnInputClick&&a.refreshValue():a.closeDropDown()},!0),this.inputElement.addEventListener("mousedown",function(){setTimeout(function(){a.settings.openDropDownOnInputClick&&!(typeof a.focusValue<"u"&&a.inputElement.value!=a.focusValue)&&(a.refreshValue(),a.openDropDown())},0),a.recordClick()},!0),this.inputElement.addEventListener("input",function(){a.closeDropDown()},!0),this.popupElement.onmousedown=function(){a.recordClick()},D.addEventListener("mousedown",function(){setTimeout(function(){a.isDuringRecordedClick()||a.closeDropDown()},0)},!0),D.addEventListener("mousewheel",function(y){a.isMouseWheelScrollingPopup(y)||a.closeDropDown()},!0),D.addEventListener("DOMMouseScroll",function(y){a.isMouseWheelScrollingPopup(y)||a.closeDropDown()},!0))},H.prototype.recordClick=function(){var a=this;this.isDuringClick||(this.isDuringClick=!0,setTimeout(function(){delete a.isDuringClick},0))},H.prototype.isDuringRecordedClick=function(){return typeof this.isDuringClick<"u"},H.prototype.isMouseWheelScrollingPopup=function(a){for(var D=typeof a.wheelDelta<"u"?a.wheelDelta/120:typeof a.detail<"u"?-a.detail/3:0,k=(a=a.target,!1);null!=a;){if(0<a.offsetHeight&&a.offsetHeight<a.scrollHeight&&!(1>=a.scrollTop&&0<D||a.scrollTop>=a.scrollHeight-a.clientHeight-1&&0>D)&&(k=!0),a==this.popupElement)return k;a=a.parentElement}return!1},H.prototype.getValue=function(){return this.value},H.prototype.setValue=function(a){this.resetValue(a)},H.prototype.refreshValue=function(){this.resetValue()},H.prototype.resetValue=function(a){this.isDuringInternalSetValue||(this.closeDropDown(),this.setValueInternal(a))},H.prototype.setValueInternal=function(a,D){if(!this.isDuringInternalSetValue){this.isDuringInternalSetValue=!0,typeof D>"u"&&(D=!0);var k=this.value,h=this.value=typeof a<"u"&&null!=a?a:this.inputElement.value;if(h!=this.inputElement.value&&(this.inputElement.value=h,this.isInitialized))try{var T=this.inputElement.ownerDocument.createEvent("HTMLEvents");T.initEvent("change",!0,!0),this.inputElement.dispatchEvent(T)}catch{}(this.value&&!k||!this.value&&k||this.value&&k&&this.value.valueOf()!=k.valueOf())&&(D&&this.refreshSelectedChoices(),this.settings.valueChangeHandler&&this.settings.valueChangeHandler(this.value)),delete this.isDuringInternalSetValue}},H.prototype.refreshAvailableChoices=function(){if(this.settings.autoAppendAvailableChoices){for(var a=this.getSelectedChoices(!1),D=0;D<a.length;D++){var k=a[D];0>this.availableChoices.indexOf(k)&&this.availableChoices.push(k)}this.refreshSelectedChoices()}},H.prototype.getSelectedChoice=function(a){return this.getSelectedChoices(a)[0]},H.prototype.getSelectedChoices=function(a){typeof a>"u"&&(a=!0);for(var D=[],k=this.value.trim(),h=k.split(this.settings.separator),T=0;T<h.length;T++)if(0!=(k=h[T].trim()).length){for(var y=0;y<this.settings.delimiters.length;y++){var F=k.indexOf(this.settings.delimiters[y]);0<=F&&(k=k.substr(0,F).trim())}(!a||0<=this.availableChoices.indexOf(k))&&D.push(k)}return D},H.prototype.refreshSelectedChoices=function(){for(var a=this,D=this.checkBoxListElement.childNodes.length;0<D--;)this.checkBoxListElement.removeChild(this.checkBoxListElement.childNodes[D]);if(this.checkBoxElements=[],this.checkBoxListElement){D=this.getSelectedChoices();for(var k=0;k<this.availableChoices.length;k++){var h=document.createElement("div");h.setAttribute("style","padding: 1px; padding-left: 2px; padding-right: 2px");var T=this.availableChoices[k],y=document.createElement("input");y.setAttribute("type","checkbox"),y.setAttribute("value",T);var F=0<=D.indexOf(T);F&&y.setAttribute("checked","checked"),this.settings.areCheckBoxesVisible&&(y.setAttribute("style","margin-bottom: -1px"+("Modern"==this.settings.theme&&null!=this.settings.inputStyle?"; border: 1px solid #e0e0e0":"")),y.onchange=function(ee){var oe=(ee=ee.currentTarget).getAttribute("value");a.setSelectedChoice(oe,ee.checked,!1)},h.appendChild(y)),this.checkBoxElements.push(y);var x=document.createElement(this instanceof he.Element?"div":"span");x.setAttribute("style",this.settings.choiceStyle),x.setAttribute("class",this.settings.choiceClass);var N=document.createElement(this instanceof he.Element?"div":"span");F&&(N.setAttribute("style",this.settings.selectedChoiceStyle),N.setAttribute("class",this.settings.selectedChoiceClass)),(F=document.createElement("span")).innerHTML=T,N.appendChild(F),x.appendChild(N),x.checkBox=y,x.onclick=function(X){var ee=X.currentTarget.checkBox.getAttribute("value");a.setValue(ee),X.stopPropagation()},h.appendChild(x),this.checkBoxListElement.appendChild(h)}}},H.prototype.selectChoice=function(a){this.setSelectedChoice(a,!0)},H.prototype.unselectChoice=function(a){this.setSelectedChoice(a,!1)},H.prototype.setSelectedChoice=function(a,D,k){typeof k>"u"&&(k=!0),a=a.trim();for(var h=this.value.trim(),T=h.split(this.settings.separator),y="",F=!1,x=0;x<T.length;x++)if(0!=(h=T[x].trim()).length){for(var N=h,P=0;P<this.settings.delimiters.length;P++){var X=h.indexOf(this.settings.delimiters[P]);0<=X&&(h=h.substr(0,X).trim())}(h!=a||D)&&(y+=(0<y.length?this.settings.separator+(this.settings.isSpaceSeparated?" ":""):"")+N,h==a&&(F=!0))}!F&&D&&(y+=(0<y.length?this.settings.separator+(this.settings.isSpaceSeparated?" ":""):"")+a),k?this.setValue(y):this.setValueInternal(y,!1)},H.prototype.openDropDown=function(){this.isOpen||this.toggleDropDown()},H.prototype.closeDropDown=function(){this.isOpen&&this.toggleDropDown()},H.prototype.toggleDropDown=function(){var a=this;if(!this.settings.isReadOnly&&(this.isOpen||!(0>=this.availableChoices.length))){(this.isOpen=!this.isOpen)&&this.refreshAvailableChoices();var D=function(){var y=a.inputElement.getBoundingClientRect();a.popupElement.style.position="fixed",a.popupElement.style.zIndex="1",a.popupElement.style.left=y.left+"px",a.popupElement.style.top=y.top+y.height+"px",a.popupElement.style.minWidth=a.inputElement.offsetWidth+"px",a.popupElement.style.display=a.isOpen?"block":"none";var F=a.popupElement.getBoundingClientRect();F.bottom>a.popupElement.ownerDocument.documentElement.clientHeight&&y.top>=F.height&&(a.popupElement.style.top=y.top-F.height+2+"px"),F.right>a.popupElement.ownerDocument.documentElement.clientWidth&&a.popupElement.ownerDocument.documentElement.clientWidth>=F.width&&(a.popupElement.style.left=a.popupElement.ownerDocument.documentElement.clientWidth-F.width+"px")};if(D(),this.isOpen&&this.settings.dropDownOpenedHandler?this.settings.dropDownOpenedHandler():!this.isOpen&&this.settings.dropDownClosedHandler&&this.settings.dropDownClosedHandler(),this.isOpen){var k=this.host.ownerDocument.documentElement.clientWidth,h=this.host.ownerDocument.documentElement.clientHeight,T=this.host.getBoundingClientRect();this.positionChangeHandlerTimer=setInterval(function(){var y=a.host.ownerDocument.documentElement.clientWidth,F=a.host.ownerDocument.documentElement.clientHeight,x=a.host.getBoundingClientRect();y!=k||F!=h?a.closeDropDown():(x.left!=T.left||x.top!=T.top||x.width!=T.width||x.height!=T.height)&&D(),k=y,h=F,T=x},100)}else this.positionChangeHandlerTimer&&(clearInterval(this.positionChangeHandlerTimer),delete this.positionChangeHandlerTimer)}},H}();ae.Element=ue}(xe=fe.MultiSelectorComboBox||(fe.MultiSelectorComboBox={})),function(ae){ae.initialize=function(H,a,D,k,h){return new ue(H,a,D,k,h)},ae.get=function(H){return H.component};var ue=function(H){function a(D,k,h,T,y){H.call(this,D,k,h,T,y),this.isInitialized=!1,this.settings.areCheckBoxesVisible=!1,typeof T.choiceStyle>"u"&&(T.choiceStyle="padding: 2px; margin-right: -4px; cursor: pointer"),typeof T.selectedChoiceStyle>"u"&&(T.selectedChoiceStyle="background-color: #3399ff; color: White; margin: -3px; padding: 2px"),this.refresh(),this.isInitialized=!0}return __extends(a,H),a}(xe.Element);ae.Element=ue}(he=fe.ComboBox||(fe.ComboBox={})),function(ae){ae.initialize=function(H,a,D,k,h){return new ue(H,a,D,k,h)},ae.get=function(H){return H.component};var ue=function(H){function a(){H.apply(this,arguments)}return __extends(a,H),a}(he.Element);ae.Element=ue}(Ce=fe.DropDownList||(fe.DropDownList={})),function(ae){ae.initialize=function(H,a,D,k){return new ue(H,a,D,k)},ae.get=function(H){return H["ToolTip.component"]};var ue=function(){function H(a,y,k,h){var T=this;this.content=a,this.targetElement=y,this.settings=k,this.isInitialized=!1,this.isEnabled=!0,this.isVisible=!1;var F=(y=y.ownerDocument).createElement("span");y.body.appendChild(F);var x="DlhSoft.Controls ToolTip DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[x[5]][x[4]](F,x[0],x[1],x[2],x[3],h,k),a&&a instanceof HTMLElement?(a.parentNode&&a.parentNode.removeChild(a),h=a):(h=y.createElement("span")).innerHTML=a,F.appendChild(h),this.host=F,this.contentContainer=h,this.host["ToolTip.component"]=this,this.contentContainer["ToolTip.component"]=this,this.targetElement["ToolTip.component"]=this,typeof k>"u"&&(k={}),this.settings=k,H.initializeSettings(this.settings),this.contentContainer.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&this.contentContainer.setAttribute("class",this.settings.containerClass),this.isEnabled=this.settings.isEnabled,(this.isVisible=this.settings.isVisible)?this.show():this.hide(),this.refresh();var N=!1;this.targetElement.addEventListener("mouseenter",function(){T.isEnabled&&(T.show(),N=!0)}),this.targetElement.addEventListener("mouseleave",function(){T.isEnabled&&(N=!1,isNaN(T.settings.duration)||setTimeout(function(){N||T.hide()},T.settings.duration))}),this.contentContainer.addEventListener("mouseenter",function(){T.isEnabled&&(N=!0)}),this.contentContainer.addEventListener("mouseleave",function(){T.isEnabled&&(N=!1,isNaN(T.settings.duration)||setTimeout(function(){N||T.hide()},T.settings.duration))}),this.targetElement.addEventListener("mouseup",function(){T.isEnabled&&T.hide()},!0),y.addEventListener("mousedown",function(){T.isEnabled&&(N||T.hide())},!0),y.addEventListener("mousewheel",function(){T.isEnabled&&T.hide()},!0),y.addEventListener("DOMMouseScroll",function(){T.isEnabled&&T.hide()},!0),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isEnabled>"u"&&(a.isEnabled=!0),typeof a.duration>"u"&&(a.duration=0),typeof a.isVisible>"u"&&(a.isVisible=!1),typeof a.containerStyle>"u"&&(a.containerStyle="cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"#707070")+"; background-color: "+("Modern"==a.theme?"White":"#ffffc0")+"; color: "+("Modern"==a.theme?"#505050":"Black")+"; font-family: Arial; font-size: "+("Modern"==a.theme?"12px":"small")+"; padding: 4px")},H.prototype.refresh=function(){var a=this.targetElement.getBoundingClientRect();this.x=a.left,this.y=a.top+a.height,this.contentContainer.style.position="fixed",this.contentContainer.style.zIndex="1",this.contentContainer.style.left=this.x+"px",this.contentContainer.style.top=this.y+"px",this.contentContainer.style.display=this.settings.isVisible?"inline-block":"none";var D=this.contentContainer.getBoundingClientRect();D.bottom>this.contentContainer.ownerDocument.documentElement.clientHeight&&a.top>=D.height&&(this.contentContainer.style.top=a.top-D.height+2+"px"),D.right>this.contentContainer.ownerDocument.documentElement.clientWidth&&this.contentContainer.ownerDocument.documentElement.clientWidth>=D.width&&(this.contentContainer.style.left=this.contentContainer.ownerDocument.documentElement.clientWidth-D.width+"px")},H.prototype.setPosition=function(a,D){this.setHorizontalPosition(a),this.setVerticalPosition(D)},H.prototype.setHorizontalPosition=function(a){this.x=a,this.contentContainer.style.left=this.x+"px"},H.prototype.setVerticalPosition=function(a){this.y=a,this.contentContainer.style.top=this.y+"px"},H.prototype.enable=function(){this.isEnabled||(this.settings.isEnabled=this.isEnabled=!0)},H.prototype.disable=function(){this.isEnabled&&(this.settings.isEnabled=this.isEnabled=!1)},H.prototype.show=function(){H.previouslyShown&&H.previouslyShown.hide(),H.previouslyShown=this,this.isVisible||(this.settings.isVisible=this.isVisible=!0,this.refresh(),this.settings.shownHandler&&this.settings.shownHandler())},H.prototype.hide=function(){this.isVisible&&(this.settings.isVisible=this.isVisible=!1,this.refresh(),this.settings.hiddenHandler&&this.settings.hiddenHandler())},H.prototype.setContent=function(a){a&&a instanceof HTMLElement?(a.parentNode&&a.parentNode.removeChild(a),this.host.replaceChild(a,this.contentContainer),this.contentContainer=a):this.contentContainer.innerHTML=a},H}();ae.Element=ue}(fe.ToolTip||(fe.ToolTip={})),function(ae){function ue(H,a){for(var D=fe.TreeGrid.getDefaultColumns(H,a),k=0;k<D.length;k++)delete D[k].isTreeView;return D}ae.initialize=function(H,a,D,k){if(a)for(var h=0;h<a.length;h++)delete a[h].indentation,delete a[h].isExpanded;return D||(D={}),D.columns||(D.columns=ue(a,D)),fe.TreeGrid.initialize(H,a,D,k)},ae.getDefaultColumns=ue}(fe.Grid||(fe.Grid={}))}(DlhSoft||(DlhSoft={}));