typeof DlhSoft>"u"&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)}),DlhSoft.assemblies.push({assembly:"DlhSoft.ProjectData.GanttChart.HTML.Controls",company:"DlhSoft",product:"Project Data Modern Library",version:"5.3.20.10",copyright:"Copyright \xa9 2012-2023 DlhSoft",title:"Project Data Gantt Chart HTML Controls",description:"Project Data Gantt Chart related HTML client components"}),DlhSoft.buildReleaseDate=function(t,pe,Ee){return(t=new Date(t,10,25))>DlhSoft.buildReleaseDate?t:DlhSoft.buildReleaseDate}(2023);var _0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{");null==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var t=_0x5c25[1],pe=_0x5c25[2],Ee=[],Be=[],We=_0x5c25[3];return{setLicense:function(we,me){Ee[_0x5c25[7]]({type:we,content:me})},validate:function(we,me,xe,Se,he,ge,ae){me=me+_0x5c25[4]+xe;for(var fe=0;fe<Be[_0x5c25[5]];fe++)if(Be[fe]==me)return;e:if(typeof ge!==pe&&typeof ae!==t&&(ae[_0x5c25[6]]!==t&&(ge=ae[_0x5c25[6]]),typeof ae===pe&&(ge=ae)),typeof ge!==pe)for(ae=0;ae<Ee[_0x5c25[5]];ae++)if((fe=Ee[ae])[_0x5c25[8]]==me&&typeof fe[_0x5c25[9]]===pe){ge=fe[_0x5c25[9]];break e}!function(we,me){if(typeof we!==pe||typeof me!==pe)return!1;if(me==We)return!0;var xe=me[_0x5c25[11]](_0x5c25[10]);if(0<=xe){var he,Se=me[_0x5c25[12]](0,xe),ge=Se[_0x5c25[11]](_0x5c25[10]);if(0<=ge)try{he=new Date(parseInt(Se[_0x5c25[12]](ge+1)))}catch{}if(typeof he===t&&(he=new Date(2013,11,31)),DlhSoft[_0x5c25[13]]>he)return!1;for(Se=Se+_0x5c25[10]+we,i=he=0;i<Se[_0x5c25[5]];i++)he=(he<<5)-he+(ge=Se[_0x5c25[14]](i)),he&=he;if(0>he&&(he=Math[_0x5c25[15]](2,32)-he),(Se=he.toString(16)[_0x5c25[16]]())==(xe=me[_0x5c25[12]](xe+1)))return!0}return!1}(me,ge)?function(we,me,xe,Se,he){var ge=_0x5c25[17],fe=typeof ComponentSource!==t&&ComponentSource?_0x5c25[21]:_0x5c25[18]+_0x5c25[19]+Se+_0x5c25[20]+he,H=Se+_0x5c25[22]+he+_0x5c25[23],a=_0x5c25[24],D=_0x5c25[25],m=_0x5c25[26];setTimeout(function(){var c=we[_0x5c25[27]],g=c[_0x5c25[29]](_0x5c25[28]);g[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var S=c[_0x5c25[29]](_0x5c25[28]);S[_0x5c25[32]](_0x5c25[30],_0x5c25[33]);var A=c[_0x5c25[29]](_0x5c25[28]);A[_0x5c25[32]](_0x5c25[30],_0x5c25[34]),S[_0x5c25[35]](A),A[_0x5c25[35]](c[_0x5c25[36]](ge)),S[_0x5c25[35]](c[_0x5c25[36]](a+_0x5c25[10])),(A=c[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),A[_0x5c25[35]](c[_0x5c25[36]](me)),S[_0x5c25[35]](A),S[_0x5c25[35]](c[_0x5c25[36]](D+_0x5c25[10])),(A=c[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),A[_0x5c25[35]](c[_0x5c25[36]](H)),S[_0x5c25[35]](A),S[_0x5c25[35]](c[_0x5c25[36]](m+_0x5c25[10])),(A=c[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var F=c[_0x5c25[29]](_0x5c25[39]);F[_0x5c25[32]](_0x5c25[30],_0x5c25[40]),F[_0x5c25[32]](_0x5c25[41],fe),F[_0x5c25[32]](_0x5c25[42],_0x5c25[43]),F[_0x5c25[35]](c[_0x5c25[36]](_0x5c25[44])),A[_0x5c25[35]](F),(F=c[_0x5c25[29]](_0x5c25[39]))[_0x5c25[32]](_0x5c25[30],_0x5c25[45]),F[_0x5c25[32]](_0x5c25[41],_0x5c25[46]),F[_0x5c25[35]](c[_0x5c25[36]](_0x5c25[47])),F[_0x5c25[50]](_0x5c25[48],function(){we[_0x5c25[49]](g),Be[_0x5c25[7]](xe)},!1),A[_0x5c25[35]](F),S[_0x5c25[35]](A),g[_0x5c25[35]](S),we[_0x5c25[35]](g)},0),setTimeout(function(){alert(ge+_0x5c25[51]+a+_0x5c25[52]+me+_0x5c25[51]+D+_0x5c25[53]+H+_0x5c25[51]+m+_0x5c25[4])},6e5)}(we,xe,me,Se,he):we[_0x5c25[6]]=ge}}}()),null==DlhSoft.Controls&&(DlhSoft.Controls={}),null==DlhSoft.Controls.GanttChartView&&(DlhSoft.Controls.GanttChartView=function(){var t="undefined",pe=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ee=["January","February","March","April","May","June","July","August","September","October","November","December"],Be=[31,28,31,30,31,30,31,31,30,31,30,31],We=new Date(2592e5),Ke=new Date(3155762592e5),oe=function(e,n,s,r,o){return e.internalEventListeners&&e.internalEventListeners.push({object:n,event:s,handler:r,useCapture:o}),r},we=function(e,n){var s=document.createEvent("MouseEvents");s.initMouseEvent(n,!0,!0,document.defaultView,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(s)},me=function(e,n,s,r){function o(se){if(typeof V.x!==t&&!(e.offsetWidth<=0)){var Ve=e.offsetWidth-(se=V.gridWidth+(se.clientX-V.x))-3,Xe=Math.max(1,s.minGridWidth),$e=Math.max(1,s.minChartWidth);se<Xe?(Ve-=Xe-se,se=Xe):Ve<$e&&(se-=$e-Ve,Ve=$e),se<1&&(se=1),Ve<1&&(Ve=1),typeof C.percent!==t&&delete C.percent,se=Math.ceil(1e6*se/e.offsetWidth)/1e4,C.style.width=se+"%",k.style.width=100-se+"%",s.gridWidth=C.offsetWidth+"px",s.chartWidth=k.offsetWidth+"px",Rt(V,C,s),typeof s.splitterPositionChangeHandler!==t&&setTimeout(function(){s.splitterPositionChangeHandler(C.offsetWidth,k.offsetWidth)},0)}}if(typeof e.ownerDocument.createElementNS!==t&&typeof e.ownerDocument.addEventListener!==t){var l=["DlhSoft.Controls","GanttChartView","DlhSoft.ProjectData.GanttChart.HTML.Controls","5","validate","Licensing"];if(DlhSoft[l[5]][l[4]](e,l[0],l[1],l[2],l[3],r,s),e.isInitializing=!0,typeof e.initializedItems!==t&&(e.initializedItems.forEach(function(se){se.gridItemContainer&&se.gridItemContainer.parentNode&&se.gridItemContainer.parentNode.removeChild(se.gridItemContainer),se.chartItemArea&&se.chartItemArea.parentNode&&se.chartItemArea.parentNode.removeChild(se.chartItemArea),delete se.ganttChartView,delete se.chartItem,delete se.chartItemArea,delete se.gridItem,delete se.gridItemContent,delete se.gridItemSelectionContainer,delete se.gridItemContainer,delete se.alternativeContentContainer,delete se.toggleButton,delete se.parent,delete se.children,delete se.selectionInput,delete se.contentInput,delete se.startInput,delete se.finishInput,delete se.milestoneInput,delete se.assignmentsContentInput,delete se.completedInput,delete se.dependsOf,delete se.touchMoveHandler,delete se.touchEndHandler}),typeof e.draggableItems!==t&&delete e.draggableItems,typeof e.draggableDependencyItems!==t&&delete e.draggableDependencyItems,typeof e.draggableOrderingItems!==t&&delete e.draggableOrderingItems),e.initializedItems=n.slice(),e.internalEventListeners&&e.internalEventListeners.forEach(function(se){se.object.removeEventListener(se.event,se.handler,se.useCapture)}),e.internalEventListeners=[],typeof e.settings!==t&&typeof e.settings.toggleButtonAreaWidth!==t&&delete e.settings.toggleButtonAreaWidth,typeof e.items!==t)for(r=0;r<e.items.length;r++)delete e.items[r].successors;if("object"!=typeof s&&(s={}),ge(n,s),he(s,n,e),On(e,n,s),l=s.scales,Qe(r=s.columns,e,s),W(n,e),O(n,s,e),typeof s.visibilityFilter!==t){xn(n,s.visibilityFilter);for(var T=0,y=0;y<n.length;y++){var d=n[y];if(typeof d.ganttChartItems!==t){d.isHidden||(d.scheduleChartVisibilityIndex=T++);for(var u=0;u<d.ganttChartItems.length;u++){var p=d.ganttChartItems[u];d.isHidden&&(p.isHidden=!0),p.displayRowIndex=d.scheduleChartVisibilityIndex}}}}var B=ae(e,n,s),f=e.ownerDocument;(T=f.createElement("div")).setAttribute("style","font-family: "+(s.classic?"Arial":"system-ui, Arial")+"; font-size: "+(s.classic?"small":"12px")+"; overflow: auto"),y=f.createElement("div"),typeof s.containerClass!==t&&y.setAttribute("class",s.containerClass),typeof s.containerStyle!==t&&y.setAttribute("style",s.containerStyle),T.appendChild(y),(d=f.createElement("div")).setAttribute("style","border: solid 1px "+s.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto"),y.appendChild(d);var C=f.createElement("div");C.setAttribute("style","overflow: auto; float: left; border-right: solid 1px "+s.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+s.gridWidth),s.isGridVisible&&d.appendChild(C);var k=f.createElement("div");k.setAttribute("style","overflow: auto; float: right; width: "+s.chartWidth),d.appendChild(k);var V=f.createElement("div");V.setAttribute("style","position: relative; opacity: 0; left: 0px; width: "+2*s.splitterWidth+"px; height: 0px; border-left: solid "+s.splitterWidth+"px "+s.splitterBackground+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: ew-resize; -ms-touch-action: pinch-zoom; touch-action: auto"),V.addEventListener("mouseover",oe(e,V,"mouseover",function(){V.style.opacity=1,V.isWaiting!==t&&delete V.isWaiting},!0),!0),V.addEventListener("mouseout",oe(e,V,"mouseout",function(){typeof V.isWaiting===t&&(V.isWaiting=!0,setTimeout(function(){typeof V.isWaiting!==t&&(delete V.isWaiting,typeof V.x===t&&(V.style.opacity=0))},250))},!0),!0),V.addEventListener("mousedown",oe(e,V,"mousedown",function(se){0==se.button&&(V.style.opacity=1,V.x=se.clientX,V.gridWidth=C.offsetWidth)},!0),!0),V.addEventListener("touchstart",oe(e,V,"touchstart",function(se){se=se.touches[0],V.style.opacity=1,V.x=se.clientX,V.gridWidth=C.offsetWidth},!0),!0),f.addEventListener("mousemove",oe(e,f,"mousemove",function(se){o(se)},!0),!0),f.addEventListener("touchmove",oe(e,f,"touchmove",function(se){o(se.touches[0])},!0),!0),f.addEventListener("mouseup",oe(e,f,"mouseup",function(){typeof V.x!==t&&(delete V.x,V.style.opacity=0),DlhSoft.Controls.ToolTip&&(s.useUpdatingToolTips||s.useInlineToolTips)&&((toolTip=e.toolTip)&&(toolTip.disable(),toolTip.hide()),(toolTip=e.resourceRoolTip)&&(toolTip.disable(),toolTip.hide()))},!0),!0),f.addEventListener("touchend",oe(e,f,"touchend",function(){typeof V.x!==t&&(delete V.x,V.style.opacity=0)},!0),!0),s.isGridVisible&&s.isSplitterEnabled&&d.appendChild(V),(y=f.createElement("div")).setAttribute("style","float: right; background: "+s.headerBackground+"; width: 0px; height: "+s.headerHeight+"px"),C.appendChild(y),(d=f.createElement("div")).setAttribute("style","overflow: hidden; background: "+s.headerBackground+"; border-bottom: solid 1px "+s.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: "+s.headerHeight+"px"),C.appendChild(d),(u=f.createElement("div")).setAttribute("style","float: right; background: "+s.headerBackground+"; width: 0px; height: "+s.headerHeight+"px"),k.appendChild(u),(p=f.createElement("div")).setAttribute("style","overflow: hidden; background: "+s.headerBackground+"; border-bottom: solid 1px "+s.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: "+s.headerHeight+"px"),k.appendChild(p);var E=f.createElement("div");E.setAttribute("style","overflow-x: "+(typeof s.isExport!==t&&s.isExport?"hidden":"scroll")+"; overflow-y: "+(typeof s.isExport!==t&&s.isExport?"hidden":"auto")+"; height: "+B),C.appendChild(E);var R=f.createElement("div");R.setAttribute("style","overflow-x: "+(typeof s.isExport!==t&&s.isExport?"hidden":"scroll")+"; overflow-y: "+(typeof s.isExport!==t&&s.isExport?"hidden":"auto")+"; height: "+B),k.appendChild(R),B=ft(r);var ee=f.createElement("div");ee.setAttribute("style","background: "+s.headerBackground+"; border-bottom: solid 1px "+s.border+"; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+B+"px; overflow: hidden; height: "+s.headerHeight+"px"),d.appendChild(ee);var N=f.createElement("div");if(N.setAttribute("style","float: left; width: "+B+"px; overflow: auto"+(s.horizontalGridLines?"; border-bottom: 1px solid "+s.horizontalGridLines+"; margin-bottom: -1px; ; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box":"")),E.appendChild(N),typeof s.extraSpaceHeight!==t){var X=f.createElement("div");X.setAttribute("style","overflow: hidden; width: "+B+"px; height: "+s.extraSpaceHeight+"px"),E.appendChild(X)}var _=q(s.timelineFinish,s),re=f.createElement("div");re.setAttribute("style","background: "+s.headerBackground+"; border-bottom: solid 1px "+s.border+"; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+_+"px; height: "+s.headerHeight+"px"),p.appendChild(re);var ne=f.createElement("div");ne.setAttribute("style","float: left; overflow: hidden; width: "+_+"px; height: 0px"),R.appendChild(ne);var Pe,at,qe,Ae,ve=f.createElementNS("http://www.w3.org/2000/svg","svg");ve.setAttribute("style","width: "+_+"px; height: 0px"),B=s.styleDefinitionTemplate(e),ve.appendChild(B),ve.chartAreaDefinitions=B,B=f.createElementNS("http://www.w3.org/2000/svg","g"),ve.appendChild(B),ne.chartAreaAlternativeRows=B,ve.addEventListener("mousedown",oe(e,ve,"mousedown",B=function(){setTimeout(function(){try{var se=ne.chartArea,Ve=se.chartAreaDefinitions;se.removeChild(Ve),se.childNodes.length>0?se.insertBefore(Ve,se.childNodes[0]):se.appendChild(Ve)}catch{}},0)},!0),!0),f.addEventListener("mouseup",oe(e,f,"mouseup",B,!0),!0),e.resetChartAreaDefinitions=B,ne.appendChild(ve),ne.chartArea=ve,typeof s.extraSpaceHeight!==t&&((B=f.createElement("div")).setAttribute("style","overflow: hidden; width: "+_+"px; height: "+s.extraSpaceHeight+"px"),R.appendChild(B),R.chartExtraSpace=B),setTimeout(function(){at=screen.deviceXDPI,Pe=e.isInitialized?-1:e.offsetWidth,qe=e.isInitialized?-1:e.offsetHeight,Ae=k.offsetHeight},0),typeof e.splitterUpdateTimer!==t&&clearInterval(e.splitterUpdateTimer),e.splitterUpdateTimer=setInterval(function(){try{if(typeof V.x===t&&!(e.offsetWidth<=0)){var se=e.offsetWidth,Ve=k.offsetHeight,Xe=screen.deviceXDPI;if(se!=Pe||Xe!=at){var $e=typeof C.percent!==t?C.percent*se:C.offsetWidth,rt=k.offsetWidth,Re=Math.max(1,s.minGridWidth),dt=Math.max(1,s.minChartWidth);$e<Re?(rt-=Re-$e,$e=Re):rt<dt&&($e-=dt-rt,rt=dt),$e<1&&($e=1),rt<1&&(rt=1);var Je=Math.ceil(100*$e/se);if(C.percent=Je/100,C.style.width=Je+"%",k.style.width=100-Je+"%",s.gridWidth=C.offsetWidth+"px",s.chartWidth=k.offsetWidth+"px",Rt(V,C,s),typeof s.splitterPositionChangeHandler!==t){var je=C.offsetWidth,ht=k.offsetWidth;je>0&&ht>0&&setTimeout(function(){s.splitterPositionChangeHandler(je,ht)},0)}Pe=se,qe=Ve,at=Xe}else Ve!=Ae&&(Rt(V,C,s),Ae=Ve)}}catch{try{clearInterval(e.splitterUpdateTimer)}catch{}}},100),typeof e.heightUpdateTimer!==t&&clearInterval(e.heightUpdateTimer),e.heightUpdateTimer=setInterval(function(){try{if(!(e.clientHeight<=0)){var se=e.clientHeight;if(se!=qe){var Ve=ae(e,n,s);E.style.height=Ve,R.style.height=Ve,Rt(V,C,s),"auto"!=R.style.height&&(ne.availableHeight=R.clientHeight),Lt(ne,kt(n,s)),Ot(n,R,s),qe=se=e.clientHeight}}}catch{try{clearInterval(e.heightUpdateTimer)}catch{}}},100),typeof e.scaleUpdateTimer!==t&&clearInterval(e.scaleUpdateTimer),e.chartScale=1,e.scaleUpdateTimer=setInterval(function(){try{var se=e.getItemsHeight(),Ve=e.gridContent.clientHeight/se;e.chartScale=Ve,e.chartContent.style.transform="scaleY("+Ve+") translateY(-"+(se-e.gridContent.clientHeight)/2+"px)"}catch{}},1e3);var nt=function(se,Ve,Xe,$e,rt,Re){var dt;if(s.mouseHandler||s.mouseMoveHandler&&"mousemove"==Re||s.mouseDownHandler&&"mousedown"==Re||(s.clickHandler||s.itemClickHandler||s.chartClickHandler||s.chartItemClickHandler)&&"click"==Re||(s.doubleClickHandler||s.itemDoubleClickHandler||s.chartDoubleClickHandler||s.chartItemDoubleClickHandler)&&"dblclick"==Re){var Je=se.which;!Je&&se.button&&(1&se.button?Je=1:4&se.button?Je=2:2&se.button&&(Je=3)),dt=rt.getBoundingClientRect();var je=f.body,ht=f.documentElement;rt=dt.left+(window.pageXOffset||ht.scrollLeft||je.scrollLeft)-(ht.clientLeft||je.clientLeft||0),dt=Math.round(dt.top+(window.pageYOffset||ht.scrollTop||je.scrollTop)-(ht.clientTop||je.clientTop||0)),rt=Math.round(rt),rt=se.pageX-rt,ht=(se.pageY-dt)/e.chartScale;var ut,ct,pt=dt=0;if(Xe){for(je=0;je<n.length;je++)if((pt=n[je]).isVisible&&(typeof pt.isHidden===t||!pt.isHidden)&&ht<=(pt=pt.itemTop+s.itemHeight)){ut=n[je];break}}else if(Ve){var Tt,ai=s.scales,zt=0;for(je=0;je<ai.length;je++)(typeof(Tt=ai[je]).isHeaderVisible===t||Tt.isHeaderVisible)&&zt++;var gn=s.headerHeight;for(zt>0&&(gn=s.headerHeight/zt),je=0;je<ai.length;je++)if((typeof(Tt=ai[je]).isHeaderVisible===t||Tt.isHeaderVisible)&&(zt=gn,typeof Tt.headerHeight!==t&&(zt=Tt.headerHeight),ht<=(pt+=zt))){ut=Tt;break}}if(Ve)ct=te(rt,s);else for(ht=s.columns,je=0;je<ht.length;je++)if(rt<=(dt+=(pt=ht[je]).width?pt.width:0)){ct=pt;break}s.mouseHandler&&s.mouseHandler(Re,Xe,Ve,ut,ct,Je,$e,se),s.mouseMoveHandler&&"mousemove"==Re&&s.mouseMoveHandler(Xe,Ve,ut,ct),s.mouseDownHandler&&"mousedown"==Re&&s.mouseDownHandler(Xe,Ve,ut,ct,Je),s.clickHandler&&"click"==Re&&s.clickHandler(Xe,Ve,ut,ct),s.doubleClickHandler&&"dblclick"==Re&&s.doubleClickHandler(Xe,Ve,ut,ct),s.itemClickHandler&&"click"==Re&&Xe&&ut&&s.itemClickHandler(Ve,ut,ct),s.itemDoubleClickHandler&&"dblclick"==Re&&Xe&&ut&&s.itemDoubleClickHandler(Ve,ut,ct),s.chartClickHandler&&"click"==Re&&Ve&&s.chartClickHandler(Xe,ut,ct),s.chartDoubleClickHandler&&"dblclick"==Re&&Ve&&s.chartDoubleClickHandler(Xe,ut,ct),s.chartItemClickHandler&&"click"==Re&&Xe&&Ve&&s.chartItemClickHandler(ut,ct),s.chartItemDoubleClickHandler&&"dblclick"==Re&&Xe&&Ve&&s.chartItemDoubleClickHandler(ut,ct)}};ee.addEventListener("mousemove",oe(e,ee,"mousemove",function(se){nt(se,!1,!1,0,ee,"mousemove")})),ee.addEventListener("mousedown",oe(e,ee,"mousedown",function(se){nt(se,!1,!1,1,ee,"mousedown")})),ee.addEventListener("click",oe(e,ee,"click",function(se){nt(se,!1,!1,1,ee,"click")})),ee.addEventListener("dblclick",oe(e,ee,"dblclick",function(se){nt(se,!1,!1,2,ee,"dblclick")})),N.addEventListener("mousemove",oe(e,N,"mousemove",function(se){nt(se,!1,!0,0,N,"mousemove")})),N.addEventListener("mousedown",oe(e,N,"mousedown",function(se){nt(se,!1,!0,1,N,"mousedown")})),N.addEventListener("click",oe(e,N,"click",function(se){nt(se,!1,!0,1,N,"click")})),N.addEventListener("dblclick",oe(e,N,"dblclick",function(se){nt(se,!1,!0,2,N,"dblclick")})),re.addEventListener("mousemove",oe(e,re,"mousemove",function(se){nt(se,!0,!1,0,re,"mousemove")})),re.addEventListener("mousedown",oe(e,re,"mousedown",function(se){nt(se,!0,!1,1,re,"mousedown")})),re.addEventListener("click",oe(e,re,"click",function(se){nt(se,!0,!1,1,re,"click")})),re.addEventListener("dblclick",oe(e,re,"dblclick",function(se){nt(se,!0,!1,2,re,"dblclick")})),ne.addEventListener("mousemove",oe(e,ne,"mousemove",function(se){nt(se,!0,!0,0,ne,"mousemove")})),ne.addEventListener("mousedown",oe(e,ne,"mousedown",function(se){nt(se,!0,!0,1,ne,"mousedown")})),ne.addEventListener("click",oe(e,ne,"click",function(se){nt(se,!0,!0,1,ne,"click")})),ne.addEventListener("dblclick",oe(e,ne,"dblclick",function(se){nt(se,!0,!0,2,ne,"dblclick")})),ne.addEventListener("touchmove",oe(e,ne,"touchmove",function(se){e.draggingItem&&se.preventDefault()},!0),!0),N.container=E,ne.container=R,ee.container=d,re.container=p,e.gridContainer=C,e.chartContainer=k,e.gridContent=N,e.chartContent=ne,e.gridContentContainer=E,e.chartContentContainer=R,e.gridHeader=ee,e.chartHeader=re,e.gridHeaderContainer=d,e.chartHeaderContainer=p,e.splitter=V,R.isInitializing=!0,B=fe(n,s),Vn(e,T),"auto"!=R.style.height&&(ne.availableHeight=R.clientHeight),st(ee,r,s,e),ie(re,ve,l,s),vn(ve,n,s),wn(N,ne,ve,n,r,B,s,e),Rt(V,C,s),R.isInitializing=!1,Ot(n,R,s),R.scrollLeft=q(s.displayedTime,s),p.scrollLeft!=R.scrollLeft&&(p.scrollLeft=R.scrollLeft),En(e,E,C,d,y,N,R,p,k,u,ne,V,n,s);var ki=!1,yn=function(se,Ve){if(typeof Ve===t&&(Ve=0),s.hourWidth!=se){ki=!0;var Re,Xe=R.scrollLeft,$e=Ve,rt=s.hourWidth;for(s.hourWidth=se,typeof s.hourWidthChangeHandler!==t&&setTimeout(function(){s.hourWidthChangeHandler(s.hourWidth)},0),_=q(s.timelineFinish,s),re.style.width=_+"px",ne.style.width=_+"px",ve.style.width=_+"px",typeof R.chartExtraSpace!==t&&(R.chartExtraSpace.style.width=_+"px"),Re=re.childNodes.length;Re-- >0;)re.removeChild(re.childNodes[Re]);var dt=[];for(Re=ve.childNodes.length;Re-- >1;){var Je=ve.childNodes[Re];Je!=ne.chartAreaAlternativeRows&&("Scale-Highlighting"!=Je.tag&&"Scale-Highlighting-CurrentTime"!=Je.tag&&"Scale-Separator"!=Je.tag&&"Scale-Separator-CurrentTime"!=Je.tag&&dt.push(Je),ve.removeChild(Je))}for(ie(re,ve,s.scales,s),Re=0;Re<n.length;Re++)Je=n[Re],(!s.isVirtualizing||typeof Je.isVirtuallyVisible!==t&&Je.isVirtuallyVisible)&&(mt(Je.chartPredecessorItems,Je,s),yt(Je.chartItem,Je,s));for(Re=dt.length;Re-- >0;)ve.appendChild(dt[Re]);Lt(ne,kt(n,s)),R.scrollLeft=$e*(se/rt)-($e-Xe),setTimeout(function(){ki=!1},200)}};return e.setHourWidth=yn,(s.classic&&typeof s.isMouseWheelZoomEnabled===t||s.isMouseWheelZoomEnabled)&&(ve.addEventListener("mousewheel",oe(e,ve,"mousewheel",r=function(se){if(se.preventDefault(),se.stopPropagation(),!ki){var Ve=typeof se.wheelDelta!==t?se.wheelDelta>=0?1:-1:typeof se.detail!==t?-se.detail>=0?1:-1:0,Xe=e.settings,$e=Xe.hourWidth,rt=typeof Xe.isMouseWheelZoomEnabledMinHourWidth!==t?Xe.isMouseWheelZoomEnabledMinHourWidth:1;Ve<0?$e/=1.2*-Ve:Ve>0&&($e=1.2*$e*Ve)>(Ve=typeof Xe.isMouseWheelZoomEnabledMaxHourWidth!==t?Xe.isMouseWheelZoomEnabledMaxHourWidth:20)&&($e=Ve),$e<rt&&($e=rt),yn($e,se.offsetX)}})),ve.addEventListener("DOMMouseScroll",oe(e,ve,"DOMMouseScroll",r))),e.isInitializing=!1,e.isInitialized=!0,e}alert("The required HTML5 features are not supported by the application host. Some features will be unavailable. Consider upgrading.")},xe=function(e){me(e,e.items,e.settings,e.license)},Se=function(e){typeof e.dateTimePickerType===t&&(e.dateTimePickerType="text"),typeof e.useDatePicker===t&&(e.useDatePicker=!0),typeof e.useTimePicker===t&&(e.useTimePicker=!0),typeof e.useResourceSelector===t&&(e.useResourceSelector=!0),typeof e.useInlineToolTips===t&&(e.useInlineToolTips=!0),typeof e.useInlineToolTipsForDependencies===t&&(e.useInlineToolTipsForDependencies=!0),typeof e.useUpdatingToolTips===t&&(e.useUpdatingToolTips=!0),typeof e.dateFormatter===t&&(e.dateFormatter=D),typeof e.dateTimeFormatter===t&&(e.dateTimeFormatter=m),typeof e.dateTimeParser===t&&(e.dateTimeParser=g),typeof e.itemPropertyChangeHandler===t&&(e.itemPropertyChangeHandler=function(){}),typeof e.target===t&&(e.target="Standard"),typeof e.theme===t&&(e.theme="Modern"),typeof e.isGridVisible===t&&(e.isGridVisible="Phone"!==e.target),typeof e.interaction===t&&(e.interaction="Phone"!=e.target?"Standard":"TouchEnabled"),typeof e.isSplitterEnabled===t&&(e.isSplitterEnabled=!0),typeof e.isReadOnly===t&&(e.isReadOnly=!1),typeof e.isGridReadOnly===t&&(e.isGridReadOnly=!1),typeof e.isChartReadOnly===t&&(e.isChartReadOnly=!1),typeof e.isContentReadOnly===t&&(e.isContentReadOnly=!1),typeof e.isAssignmentsContentReadOnly===t&&(e.isAssignmentsContentReadOnly=!1),typeof e.isIndividualItemNonworkingTimeHighlighted===t&&(e.isIndividualItemNonworkingTimeHighlighted=!1),typeof e.areTaskInterruptionsHighlighted===t&&(e.areTaskInterruptionsHighlighted=!1),typeof e.areTaskDependencyConstraintsEnabled===t&&(e.areTaskDependencyConstraintsEnabled=!1),typeof e.alwaysHandleInvalidDependencies===t&&(e.alwaysHandleInvalidDependencies=!1),typeof e.selectionMode===t&&(e.selectionMode="Focus"),typeof e.isVirtualizing===t&&(e.isVirtualizing=!0)},he=function(e,n,s){if(Se(e),typeof e.gridWidth===t&&(e.gridWidth="35%"),typeof e.chartWidth===t&&(e.chartWidth=e.isGridVisible?"65%":"100%"),typeof e.minGridWidth===t&&(e.minGridWidth=32),typeof e.minColumnWidth===t&&(e.minColumnWidth=32),typeof e.minChartWidth===t&&(e.minChartWidth=36),typeof e.border===t)switch(e.theme){default:e.border="#e0e0e0";break;case"ModernBordered":case"Aero":e.border="#9a9a9a"}if(typeof e.splitterWidth===t&&(e.splitterWidth=4),typeof e.splitterBackground===t&&(e.splitterBackground=e.border),typeof e.indentationLevelWidth===t&&(e.indentationLevelWidth=16),typeof e.itemHeight===t&&(e.itemHeight=e.classic?21:28),typeof e.headerBackground===t&&(e.headerBackground=e.classic?"#f4f4f4":"white"),typeof e.headerHeight===t&&(e.headerHeight=2*(e.classic?21:31)),typeof e.columns===t&&(e.columns=F(n,e)),typeof e.toggleButtonStyle===t&&null==e.toggleButtonClass&&(e.toggleButtonStyle="fill: Gray"),typeof e.toggleButtonHoveringStyle===t&&null==e.toggleButtonHoveringClass&&(e.toggleButtonHoveringStyle="fill: Black"),typeof e.collapsedToggleButtonTemplate===t&&(e.collapsedToggleButtonTemplate=Li(s,e)),typeof e.expandedToggleButtonTemplate===t&&(e.expandedToggleButtonTemplate=Hi(s,e)),typeof e.gridLines!==t&&(typeof e.horizontalGridLines===t&&(e.horizontalGridLines=e.gridLines),typeof e.verticalGridLines===t&&(e.verticalGridLines=e.gridLines),typeof e.horizontalChartLines===t&&(e.horizontalChartLines=e.gridLines)),!e.classic&&typeof e.verticalGridHeaderLines===t&&(e.verticalGridHeaderLines=e.verticalGridLines?e.verticalGridLines:"#e0e0e0"),typeof e.itemStyle===t&&typeof e.horizontalGridLines!==t&&(e.itemStyle="border-top: solid 1px "+e.horizontalGridLines+"; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box",typeof e.cellStyle===t&&(e.cellStyle=typeof e.verticalGridLines!==t?"border-right: solid 1px "+e.verticalGridLines+"; height: "+e.itemHeight+"px; padding-top: 2px; padding-left: 2px":"height: "+e.itemHeight+"px; padding-top: 2px")),typeof e.cellStyle===t&&typeof e.verticalGridLines!==t&&(e.cellStyle="border-right: solid 1px "+e.verticalGridLines+"; height: "+e.itemHeight+"px; padding-top: 3px; padding-left: 2px"),!e.classic&&typeof e.cellStyle===t&&(e.cellStyle="padding-left: 2px;",typeof e.columnHeaderStyle===t&&(e.columnHeaderStyle="padding-left: 2px")),!e.classic&&e.cellStyle&&(e.cellStyle=e.cellStyle+"; padding-top: 5px;"),typeof e.selectedItemStyle===t&&null==e.selectedItemClass&&(e.selectedItemStyle=e.classic?"Aero"===e.theme?typeof e.horizontalGridLines!==t||typeof e.verticalGridLines===t?"background-color: LightBlue; border-top: solid 1px "+(typeof e.horizontalGridLines!==t?e.horizontalGridLines:"White")+"; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box":"background-color: LightBlue":typeof e.horizontalGridLines!==t||typeof e.verticalGridLines===t?"background-color: #f4f4f4; border-top: solid 1px "+(typeof e.horizontalGridLines!==t?e.horizontalGridLines:"White")+"; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box":"background-color: #f4f4f4":"background-color: #8dd2ff60;"),typeof e.summaryItemStyle===t&&null==e.summaryItemClass&&(e.summaryItemStyle="font-weight: bold"),typeof e.daysOfWeek===t&&(e.daysOfWeek=pe),typeof e.months===t&&(e.months=Ee),typeof e.weekStartDay===t&&(e.weekStartDay=0),typeof e.currentTime===t)e.currentTime=new Date;else if("string"==typeof e.currentTime)try{e.currentTime=new Date(e.currentTime)}catch{e.currentTime=new Date(parseInt(e.currentTime))}if("string"==typeof e.displayedTime)try{e.displayedTime=new Date(e.displayedTime)}catch{e.displayedTime=new Date(parseInt(e.displayedTime))}if("string"==typeof e.timelineStart)try{e.timelineStart=new Date(e.timelineStart)}catch{e.timelineStart=new Date(parseInt(e.timelineStart))}if("string"==typeof e.timelineFinish)try{e.timelineFinish=new Date(e.timelineFinish)}catch{e.timelineFinish=new Date(parseInt(e.timelineFinish))}if(!e.classic&&typeof e.scales===t&&(e.scales=[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: "+(e.nonworkingBackground?e.nonworkingBackground:"#f8f8f8")+"; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 7px 5px; border-right: 1px solid "+(e.headerBorder?e.headerBorder:"#e8e8e8")+"; border-bottom: 1px solid "+(e.headerBorder?e.headerBorder:"#e8e8e8")+(e.headerForeground?"; color: "+e.headerForeground:""),isSeparatorVisible:!0,separatorStyle:"stroke: "+(e.scaleSeparatorBorder?e.scaleSeparatorBorder:"#c8bfe7")+"; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 7px 5px; border-right: 1px solid "+(e.headerBorder?e.headerBorder:"#e8e8e8")+(e.headerForeground?"; color: "+e.headerForeground:"")},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: "+(e.currentTimeStroke?e.currentTimeStroke:"#e31d3b")+"; stroke-width: 0.5px"}]),e.classic||(typeof e.alternativeItemStyle===t&&(e.alternativeItemStyle="background-color: #8080800c;"),typeof e.alternativeChartItemStyle===t&&(e.alternativeChartItemStyle="fill: #8080800c;")),!e.classic&&typeof e.arrowSize===t&&(e.arrowSize=1.5),typeof e.isRelativeToTimezone===t||e.isRelativeToTimezone){if(e.currentTime=new Date(e.currentTime.valueOf()-6e4*e.currentTime.getTimezoneOffset()),typeof e.displayedTime!==t&&(e.displayedTime=new Date(e.displayedTime.valueOf()-6e4*e.displayedTime.getTimezoneOffset())),typeof e.timelineStart!==t&&(e.timelineStart=new Date(e.timelineStart.valueOf()-6e4*e.timelineStart.getTimezoneOffset())),typeof e.timelineFinish!==t&&(e.timelineFinish=new Date(e.timelineFinish.valueOf()-6e4*e.timelineFinish.getTimezoneOffset())),typeof e.scales!==t)for(n=0;n<e.scales.length;n++){var r=e.scales[n];if(typeof r.intervals!==t)for(var o=0;o<r.intervals.length;o++){var l=r.intervals[o];typeof l.start!==t&&(l.start=new Date(l.start.valueOf()-6e4*l.start.getTimezoneOffset())),typeof l.finish!==t&&(l.finish=new Date(l.finish.valueOf()-6e4*l.finish.getTimezoneOffset()))}}e.isRelativeToTimezone=!1}if(typeof e.schedule!==t&&null!=e.schedule&&((e.schedule!=e.previousSchedule||e.schedule.workingWeekStart!=e.previousSchedule.workingWeekStart)&&(e.workingWeekStart=e.schedule.workingWeekStart),(e.schedule!=e.previousSchedule||e.schedule.workingWeekFinish!=e.previousSchedule.workingWeekFinish)&&(e.workingWeekFinish=e.schedule.workingWeekFinish),(e.schedule!=e.previousSchedule||e.schedule.workingDayStart!=e.previousSchedule.workingDayStart)&&(e.visibleDayStart=e.schedule.workingDayStart),(e.schedule!=e.previousSchedule||e.schedule.workingDayFinish!=e.previousSchedule.workingDayFinish)&&(e.visibleDayFinish=e.schedule.workingDayFinish),(e.schedule!=e.previousSchedule||e.schedule.specialNonworkingDays!=e.previousSchedule.specialNonworkingDays)&&(e.specialNonworkingDays=e.schedule.specialNonworkingDays)),e.timelineStart=typeof e.timelineStart===t?new Date(Y(e.currentTime,e.weekStartDay).valueOf()-6048e5):Y(e.timelineStart,e.weekStartDay),e.timelineFinish=typeof e.timelineFinish===t?new Date(Y(e.currentTime,e.weekStartDay).valueOf()+320544e5):J(e.timelineFinish,e.weekStartDay),!e.isExport&&typeof e.specialNonworkingDays!==t&&"function"!=typeof e.specialNonworkingDays)for(n=0;n<e.specialNonworkingDays.length;n++)e.specialNonworkingDays[n]=b(new Date(e.specialNonworkingDays[n].valueOf()-6e4*(e.specialNonworkingDays[n].getTimezoneOffset()<0?e.specialNonworkingDays[n].getTimezoneOffset():0)));if(!e.isExport&&typeof e.resourceSchedules!==t)for(r=0;r<e.resourceSchedules.length;r++)if(typeof(o=e.resourceSchedules[r].value).specialNonworkingDays!==t)for(n=0;n<o.specialNonworkingDays.length;n++)o.specialNonworkingDays[n]=b(new Date(o.specialNonworkingDays[n].valueOf()-6e4*(o.specialNonworkingDays[n].getTimezoneOffset()<0?o.specialNonworkingDays[n].getTimezoneOffset():0)));if(typeof e.scales===t&&(e.scales=G(e)),typeof e.updateScale===t&&(e.updateScale=9e5),typeof e.hourWidth===t&&(e.hourWidth=e.classic?2.5:5),typeof e.displayedTime===t&&(e.displayedTime=e.currentTime,setTimeout(function(){var f=s.chartContentContainer.scrollLeft-12*e.hourWidth;s.chartContentContainer.scrollLeft-f<s.chartContentContainer.clientWidth/3&&(s.chartContentContainer.scrollLeft=Math.max(0,f))},0)),e.previousSchedule=e.schedule,typeof e.visibleDayStart===t&&(e.visibleDayStart=288e5),typeof e.visibleDayFinish===t&&(e.visibleDayFinish=576e5),e.visibleDayStart>=e.visibleDayFinish&&(e.visibleWeekStart=0,e.visibleWeekFinish=864e5),typeof e.visibleWeekStart===t&&(e.visibleWeekStart=0),typeof e.visibleWeekFinish===t&&(e.visibleWeekFinish=6),e.visibleWeekStart>e.visibleWeekFinish&&(e.visibleWeekStart==e.visibleWeekFinish+1?(e.visibleWeekStart=0,e.visibleWeekFinish=6):e.visibleWeekFinish=e.visibleWeekStart),typeof e.workingWeekStart===t&&(e.workingWeekStart=1),typeof e.workingWeekFinish===t&&(e.workingWeekFinish=5),e.workingWeekStart>e.workingWeekFinish&&(e.workingWeekStart==e.workingWeekFinish+1?(e.workingWeekStart=0,e.workingWeekFinish=6):e.workingWeekFinish=e.workingWeekStart),e.workingDayStart=e.visibleDayStart,e.workingDayFinish=e.visibleDayFinish,!e.classic&&typeof e.barMargin===t&&(e.barMargin=4),typeof e.barHeight===t&&(e.barHeight=typeof e.barMargin===t?e.itemHeight/2:e.itemHeight-2*e.barMargin),typeof e.barMargin===t&&(e.barMargin=(e.itemHeight-e.barHeight)/2),typeof e.barCornerRadius===t&&(e.barCornerRadius=e.classic?"Aero"===e.theme?3:0:2),!e.classic&&typeof e.completedBarMargin===t&&(e.completedBarMargin=1),typeof e.completedBarMargin===t&&(e.completedBarMargin=e.barHeight/2.5),typeof e.completedBarHeight===t&&(e.completedBarHeight=e.barHeight-2*e.completedBarMargin),typeof e.completedBarCornerRadius===t&&(e.completedBarCornerRadius=0),e.completedBarCornerRadius=Math.min(e.completedBarCornerRadius,Math.max(0,e.barCornerRadius-1)),typeof e.styleDefinitionTemplate===t&&(e.styleDefinitionTemplate=Ri(s,e)),typeof e.standardBarStyle===t&&null==e.standardBarClass)if(e.classic)switch(e.theme){default:e.standardBarStyle="fill: #8abbed; fill-opacity: 0.8; stroke: #8abbed; stroke-width: 0.65px";break;case"ModernBordered":e.standardBarStyle="fill: #8abbed; fill-opacity: 0.8; stroke: Blue; stroke-width: 0.65px";break;case"Aero":e.standardBarStyle="fill: url(#BlueGradient); fill-opacity: 0.8; stroke: Blue"}else e.standardBarStyle="fill: #8dd2ff; fill-opacity: 0.8; stroke: #3b87d9; stroke-width: 0.65px;";if(typeof e.standardCompletedBarStyle===t&&null==e.standardCompletedBarClass&&(e.standardCompletedBarStyle=e.classic?"Aero"===e.theme?"fill: #808080; stroke: #202020; stroke-width: 0.65px":"fill: #3b87d9; stroke: #3b87d9; stroke-width: 0.65px":"fill: #1ca3ec; stroke: #1ca3ec; stroke-width: 0.5px;"),typeof e.summaryBarStyle===t&&null==e.summaryBarClass)switch(e.theme){default:e.summaryBarStyle="fill: #607080; stroke: #607080; stroke-width: 0.65px";break;case"ModernBordered":e.summaryBarStyle="fill: #607080; stroke: #202020; stroke-width: 0.65px";break;case"Aero":e.summaryBarStyle="fill: url(#BlackGradient); stroke: Black"}if(typeof e.summaryCompletedBarStyle===t&&null==e.summaryCompletedBarClass&&(e.summaryCompletedBarStyle="Aero"===e.theme?"fill: #a0a0a0; stroke: #303030; stroke-width: 0.65px":"fill: #404040; stroke: #404040; stroke-width: 0.65px"),typeof e.collapsedSummaryLineStyle===t&&null==e.collapsedSummaryLineClass&&(e.collapsedSummaryLineStyle="stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2 2"),typeof e.milestoneBarStyle===t&&null==e.milestoneBarClass)if(e.classic)switch(e.theme){default:e.milestoneBarStyle="fill: #607080; stroke: #607080; stroke-width: 0.65px";break;case"ModernBordered":e.milestoneBarStyle="fill: #607080; stroke: #202020; stroke-width: 0.65px";break;case"Aero":e.milestoneBarStyle="fill: url(#BlackGradient); stroke: Black"}else e.milestoneBarStyle="fill: #f8c758; stroke: #3b87d9; stroke-width: 0.65px;";if(typeof e.completedBarThumbStyle===t&&null==e.completedBarThumbClass&&(e.completedBarThumbStyle="fill: White; stroke: #a0a0a0; stroke-width: 1px; transform: translateY(3px);"),typeof e.baselineBarStyle===t&&null==e.baselineBarClass&&(e.baselineBarStyle="Aero"===e.theme?"fill: none; stroke: Blue; stroke-dasharray: 2, 2":"fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2"),typeof e.dependencyPointerStyle===t&&null==e.dependencyPointerClass&&(e.dependencyPointerStyle=e.classic?"Aero"===e.theme?"fill: Blue; stroke: Blue":"fill: #3b87d9; stroke: #3b87d9; stroke-width: 0.65px":"fill: White; stroke: #a0a0a0; stroke-width: 1px;"),typeof e.dependencyLineStyle===t&&null==e.dependencyLineClass&&(e.dependencyLineStyle=e.classic?"Aero"===e.theme?"stroke: Blue; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)":"stroke: #3b87d9; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)":"stroke: #3b87d9; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker);"),typeof e.dependencyLineZoneStyle===t&&null==e.dependencyLineZoneClass&&(e.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none"),typeof e.temporaryDependencyLineStyle===t&&null==e.temporaryDependencyLineClass&&(e.temporaryDependencyLineStyle="Aero"===e.theme?"stroke: Blue; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)":"stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)"),typeof e.assignmentsStyle===t&&null==e.assignmentsClass&&(e.assignmentsStyle="stroke-width: 0.25px; font-size: "+(e.classic?"x-small":"12px")),e.classic||(e.assignmentsStyle=e.assignmentsStyle+"; transform: translateX(10px) translateY(-1px);"),typeof e.standardTaskTemplate===t&&(e.standardTaskTemplate=zi()),typeof e.summaryTaskTemplate===t&&(e.summaryTaskTemplate=Gi()),typeof e.milestoneTaskTemplate===t&&(e.milestoneTaskTemplate=Xi()),typeof e.horizontalChartLines!==t){var y=e.internalPreTaskTemplate;e.internalPreTaskTemplate=function(f){if(typeof f.scheduleChartItem!==t)return typeof y!==t?y(f):null;var T=f.ganttChartView.ownerDocument,C=T.createElementNS("http://www.w3.org/2000/svg","g");typeof y!==t&&C.appendChild(y(f));var k=T.createElementNS("http://www.w3.org/2000/svg","line");return k.setAttribute("x1",0),k.setAttribute("y1",-.5),k.setAttribute("x2",q(e.timelineFinish,e)),k.setAttribute("y2",-.5),k.setAttribute("style","stroke: "+e.horizontalChartLines+"; stroke-width: 0.5px"),C.appendChild(k),f.index==f.ganttChartView.items.length-1&&((k=T.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",0),k.setAttribute("y1",e.itemHeight),k.setAttribute("x2",q(e.timelineFinish,e)),k.setAttribute("y2",e.itemHeight),k.setAttribute("style","stroke: "+e.horizontalChartLines+"; stroke-width: 0.5px"),C.appendChild(k)),C}}typeof e.isTaskToolTipVisible===t&&(e.isTaskToolTipVisible="Phone"!==e.target),typeof e.itemTemplate===t&&(e.itemTemplate=Wi(e)),typeof e.areTaskAssignmentsVisible===t&&(e.areTaskAssignmentsVisible=!0),typeof e.assignmentsTemplate===t&&(e.assignmentsTemplate=Ni()),typeof e.isTaskCompletedEffortVisible===t&&(e.isTaskCompletedEffortVisible=!0),typeof e.areTaskDependenciesVisible===t&&(e.areTaskDependenciesVisible=!0),typeof e.dependencyLineTemplate===t&&(e.dependencyLineTemplate=Yi()),typeof e.isDependencyToolTipVisible===t&&(e.isDependencyToolTipVisible=e.isTaskToolTipVisible),typeof e.predecessorItemTemplate===t&&(e.predecessorItemTemplate=Ui(e)),typeof e.isDraggingTaskStartEndsEnabled===t&&(e.isDraggingTaskStartEndsEnabled=!0),typeof e.areTaskDependencyConstraintsEnabledWhileDragging===t&&(e.areTaskDependencyConstraintsEnabledWhileDragging=!1),typeof e.isTaskStartReadOnly===t&&(e.isTaskStartReadOnly=!1),typeof e.isTaskEffortReadOnly===t&&(e.isTaskEffortReadOnly=!1),typeof e.isTaskCompletionReadOnly===t&&(e.isTaskCompletionReadOnly=!1),typeof e.areTaskPredecessorsReadOnly===t&&(e.areTaskPredecessorsReadOnly=!1),typeof e.isBaselineVisible===t&&(e.isBaselineVisible=!0),void 0===typeof e.areStandardTaskLabelsVisible&&(e.areStandardTaskLabelsVisible=!1),void 0===typeof e.areSummaryTaskLabelsVisible&&(e.areSummaryTaskLabelsVisible=!1),void 0===typeof e.areMilestoneTaskLabelsVisible&&(e.areMilestoneTaskLabelsVisible=!1),typeof e.isSummaryTaskCompletedEffortVisible===t&&(e.isSummaryTaskCompletedEffortVisible=!1);var d=null;if(e.isIndividualItemNonworkingTimeHighlighted||e.areTaskInterruptionsHighlighted)for(n=0;n<e.scales.length;n++)if("NonworkingTime"==e.scales[n].scaleType){d=e.scales[n];break}if(null!=d&&e.isIndividualItemNonworkingTimeHighlighted){var u=e.internalPreTaskTemplate;e.internalPreTaskTemplate=function(f){if(typeof f.scheduleChartItem!==t)return typeof u!==t?u(f):null;var T;if(typeof(T=ce(f))===t)T=null;else{var k,V,C=[];for(k=wt(e.timelineStart,typeof T.workingWeekFinish!==t?T.workingWeekFinish:e.workingWeekFinish),V=di(k,typeof T.workingWeekStart!==t?T.workingWeekStart:e.workingWeekStart);k<e.timelineFinish;k=Ne(k),V=Ne(V))C.push({start:k,finish:V});if(typeof T.specialNonworkingDays!==t)if("function"==typeof T.specialNonworkingDays)for(k=wt(e.timelineStart,e.workingWeekFinish),V=j(k);k<e.timelineFinish;k=j(k),V=j(V))T.specialNonworkingDays(k)&&C.push({start:k,finish:V});else for(var E=0;E<T.specialNonworkingDays.length;E++)V=j(k=T.specialNonworkingDays[E]),C.push({start:k,finish:V});T=C}if(null==T||0==T.length)return typeof u!==t?u(f):null;for(k=(C=f.ganttChartView.ownerDocument).createElementNS("http://www.w3.org/2000/svg","g"),V=0;V<T.length;V++){var R=(E=T[V]).finish;if(E=q(E.start,e),!((R=q(R,e)-E)<=0)){var B=C.createElementNS("http://www.w3.org/2000/svg","rect");B.setAttribute("x",E-1),B.setAttribute("y",0),B.setAttribute("width",R),B.setAttribute("height",e.itemHeight),B.setAttribute("class",d.highlightingClass),B.setAttribute("style",d.highlightingStyle),k.appendChild(B)}}return typeof u!==t&&k.appendChild(u(f)),k}}if(null!=d&&e.areTaskInterruptionsHighlighted){var p=e.internalExtraTaskTemplate;e.internalExtraTaskTemplate=function(f){if(typeof f.scheduleChartItem!==t)return typeof p!==t?p(f):null;var T;if(f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)||f.isMilestone)T=null;else{var k,V,C=ce(f);for(T=[],k=wt(b(f.start),typeof C!==t&&typeof C.workingWeekFinish!==t?C.workingWeekFinish:e.workingWeekFinish),V=di(k,typeof C!==t&&typeof C.workingWeekStart!==t?C.workingWeekStart:e.workingWeekStart);k<f.finish;k=Ne(k),V=Ne(V))T.push({start:k>=f.start?k:f.start,finish:V<=f.finish?V:f.finish});var E=typeof C!==t&&typeof C.specialNonworkingDays!==t?C.specialNonworkingDays:e.specialNonworkingDays;if(typeof E!==t)if("function"==typeof E)for(k=wt(b(f.start),typeof C!==t&&typeof C.workingWeekFinish!==t?C.workingWeekFinish:e.workingWeekFinish),V=j(k);k<b(f.finish);k=j(k),V=j(V))C.specialNonworkingDays(k)&&T.push({start:k,finish:V});else for(C=0;C<E.length;C++)V=j(k=E[C]),k>=f.start&&V<=f.finish&&T.push({start:k,finish:V})}if(null==T||0==T.length)return typeof p!==t?p(f):null;for(V=(k=f.ganttChartView.ownerDocument).createElementNS("http://www.w3.org/2000/svg","g"),E=0;E<T.length;E++){var R=(C=T[E]).finish;if(C=q(C.start,e),!((R=q(R,e)-C)<=0)){var B=k.createElementNS("http://www.w3.org/2000/svg","rect");B.setAttribute("x",C-1),B.setAttribute("y",e.barMargin),B.setAttribute("width",R),B.setAttribute("height",e.barHeight),B.setAttribute("class",d.highlightingClass),B.setAttribute("style",d.highlightingStyle),V.appendChild(B)}}return typeof p!==t&&V.appendChild(p(f)),V}}},ge=function(e,n){for(var s=0;s<e.length;s++){var r=e[s];if("string"==typeof r&&(e[s]=r={content:r}),"string"==typeof r.indentation&&(r.indentation=parseInt(r.indentation)),"string"==typeof r.isExpanded&&(r.isExpanded="true"==r.isExpanded.toLowerCase()),"string"==typeof r.start){try{r.start=new Date(r.start)}catch{r.start=new Date(parseInt(r.start))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.start=new Date(r.start.valueOf()+6e4*r.start.getTimezoneOffset())),r.preferredStart=r.start}if("string"==typeof r.finish){try{r.finish=new Date(r.finish)}catch{r.finish=new Date(parseInt(r.finish))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.finish=new Date(r.finish.valueOf()+6e4*r.finish.getTimezoneOffset()))}if("string"==typeof r.completedFinish){try{r.completedFinish=new Date(r.completedFinish)}catch{r.completedFinish=new Date(parseInt(r.completedFinish))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.completedFinish=new Date(r.completedFinish.valueOf()+6e4*r.completedFinish.getTimezoneOffset()))}if("string"==typeof r.isMilestone&&(r.isMilestone="true"==r.isMilestone.toLowerCase()),"string"==typeof r.baselineStart){try{r.baselineStart=new Date(r.baselineStart)}catch{r.baselineStart=new Date(parseInt(r.baselineStart))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.baselineStart=new Date(r.baselineStart.valueOf()+6e4*r.baselineStart.getTimezoneOffset()))}if("string"==typeof r.baselineFinish){try{r.baselineFinish=new Date(r.baselineFinish)}catch{r.baselineFinish=new Date(parseInt(r.baselineFinish))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.baselineFinish=new Date(r.baselineFinish.valueOf()+6e4*r.baselineFinish.getTimezoneOffset()))}if("string"==typeof r.minStart){try{r.minStart=new Date(r.minStart)}catch{r.minStart=new Date(parseInt(r.minStart))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.minStart=new Date(r.minStart.valueOf()+6e4*r.minStart.getTimezoneOffset()))}if("string"==typeof r.maxStart){try{r.maxStart=new Date(r.maxStart)}catch{r.maxStart=new Date(parseInt(r.maxStart))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.maxStart=new Date(r.maxStart.valueOf()+6e4*r.maxStart.getTimezoneOffset()))}if("string"==typeof r.minFinish){try{r.minFinish=new Date(r.minFinish)}catch{r.minFinish=new Date(parseInt(r.minFinish))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.minFinish=new Date(r.minFinish.valueOf()+6e4*r.minFinish.getTimezoneOffset()))}if("string"==typeof r.maxFinish){try{r.maxFinish=new Date(r.maxFinish)}catch{r.maxFinish=new Date(parseInt(r.maxFinish))}(typeof n.isRelativeToTimezone===t||n.isRelativeToTimezone)&&(r.maxFinish=new Date(r.maxFinish.valueOf()+6e4*r.maxFinish.getTimezoneOffset()))}if(typeof r.predecessors!==t){"string"==typeof r.predecessors&&(r.predecessors=r.predecessors.split(","));for(var o=0;o<r.predecessors.length;o++){var l=r.predecessors[o];if("string"==typeof l&&(r.predecessors[o]=l={item:l}),"string"==typeof l.item){var y=parseInt(l.item)-1;l.item=y>=0&&y<e.length?e[y]:null}"string"==typeof l.lag&&(l.lag=parseFloat(l.lag))}}if(typeof r.schedule!==t&&typeof r.schedule.specialNonworkingDays!==t&&"function"!=typeof n.specialNonworkingDays)for(o=0;o<r.schedule.specialNonworkingDays.length;o++)r.schedule.specialNonworkingDays[o]=b(new Date(r.schedule.specialNonworkingDays[o].valueOf()-6e4*r.schedule.specialNonworkingDays[o].getTimezoneOffset()));typeof r.wasGridItemContentLoaded!==t&&delete r.wasGridItemContentLoaded}},ae=function(e,n,s){var r;if(e.isContentHeightInitialized&&e.isContentHeightAuto)r=n.length>0?"auto":s.itemHeight+"px";else{var o=e.clientHeight-s.headerHeight-2;o<0&&(o=0),r=o+"px",o<s.itemHeight&&(e.isContentHeightInitialized||(e.isContentHeightAuto=!0),r=n.length>0?"auto":s.itemHeight+"px"),e.isContentHeightInitialized=!0}return r},fe=function(e,n){if(typeof n.toggleButtonAreaWidth!==t)return n.toggleButtonAreaWidth;var s=0;if(n.isGridVisible)for(var r=0;r<e.length;r++)if((typeof e[r].scheduleChartItem===t||e[r].scheduleChartItem==e[r])&&e[r].indentation>0){s=16;break}return n.toggleButtonAreaWidth=s},H=function(e,n){var s=e.createElement("span");return s.innerHTML=n,s},a=function(e,n){return e.createTextNode(1==n?"\u2713":"")},D=function(e){var n=e.getFullYear(),s=e.getMonth()+1;return s<10&&(s="0"+s),(e=e.getDate())<10&&(e="0"+e),s+"/"+e+"/"+n},m=function(e){var n=D(e),s=e.getHours();return s<10&&(s="0"+s.toString()),(e=e.getMinutes())<10&&(e="0"+e.toString()),n+" "+s+":"+e},c=function(e){return new Date(e.valueOf()+6e4*e.getTimezoneOffset())},g=function(e){var s,r,o,l,y,n=new Date;if(null==e||""==e)return n;if((o=e.indexOf(" "))>=0?(s=e.substr(0,o),l=e.substr(o+1)):(s=e,l="0"),(o=s.indexOf("/"))>=0){for(e=s.substr(0,o);e.length>0&&"0"==e.substr(0,1);)e=e.substr(1);if(e=parseInt(e)-1,(o=(s=s.substr(o+1)).indexOf("/"))>=0){for(r=s.substr(0,o),o=s.substr(o+1);o.length>0&&"0"==o.substr(0,1);)o=o.substr(1);s=parseInt(o)}else r=s,s=n.getFullYear();for(;r.length>0&&"0"==r.substr(0,1);)r=r.substr(1);r=parseInt(r)}else{for(;s.length>0&&"0"==s.substr(0,1);)s=s.substr(1);r=parseInt(s),e=n.getMonth(),s=n.getFullYear()}for((o=l.indexOf(":"))>=0?(y=l.substr(0,o),l=l.substr(o+1)):(y=l,l="0");y.length>1&&"0"==y.substr(0,1);)y=y.substr(1);for(o=parseInt(y);l.length>1&&"0"==l.substr(0,1);)l=l.substr(1);return l=parseInt(l),isNaN(s)||isNaN(e)||isNaN(r)||s<=0||e<0||e>=12||r<1||r>Be[e]+(1!=e||s%400!=0&&(s%100==0||s%4!=0)?0:1)?isNaN(o)||isNaN(l)||o<0||o>=24||l<0||l>=60?n:new Date(n.getFullYear(),n.getMonth(),n.getDate(),o,l,0,0):isNaN(o)||isNaN(l)||o<0||o>=24||l<0||l>=60?new Date(s,e,r,0,0,0,0):new Date(s,e,r,o,l,0,0)},S=function(e){return new Date(e.valueOf()-6e4*e.getTimezoneOffset())},A=function(e,n){var s=e.ownerDocument,r=s.createElementNS("http://www.w3.org/2000/svg","svg");return r.setAttribute("style","width: 12px; height: 12px; vertical-align: initial"),r.setAttribute("focusable","false"),(s=s.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("id","PART_Border"),s.setAttribute("width","12"),s.setAttribute("height","12"),s.setAttribute("style","fill: White; fill-opacity: 0"),r.appendChild(s),e.setAttribute("id","PART_Button"),typeof n.toggleButtonClass!==t&&e.setAttribute("class",n.toggleButtonClass),typeof n.toggleButtonStyle!==t&&e.setAttribute("style",n.toggleButtonStyle),r.appendChild(e),r},F=function(e,n){"object"!=typeof n&&(n={}),Se(n);var s=[{header:"",width:32,isSelection:!0},{header:"Task",width:140,isTreeView:!0},{header:"Start",width:140},{header:"Finish",width:140},{header:"Milestone",width:80},{header:"Completed",width:80},{header:"Assignments",width:200}];return s[0].cellTemplate=z(n,s[0],e),s[1].cellTemplate=de(n,s[1],e),s[1].exportCellTemplate=de(n,s[1],e,!1),s[2].cellTemplate=Fe(n,s[2]),s[2].exportCellTemplate=Fe(n,s[2],!1),s[3].cellTemplate=Ie(n,s[3]),s[3].exportCellTemplate=Ie(n,s[3],!1),s[4].cellTemplate=tt(n,s[4]),s[4].exportCellTemplate=tt(n,s[4],!1),s[5].cellTemplate=Le(n,s[5]),s[5].exportCellTemplate=Le(n,s[5],!1),s[6].cellTemplate=Oe(n,s[6]),s[6].exportCellTemplate=Oe(n,s[6],!1),"Single"!=n.selectionMode&&"Extended"!=n.selectionMode&&"ExtendedFocus"!=n.selectionMode&&s.splice(0,1),s},z=function(e,n,s){return function(r){return n.isReadOnly?a(r.ganttChartView.ownerDocument,r.isSelected):P(r,e,s)}},P=function(e,n){var r,s=e.ganttChartView.ownerDocument;typeof e.selectionInput===t?(r=s.createElement("input"),e.selectionInput=r,r.type="checkbox",r.setAttribute("style","margin: 0px")):r=e.selectionInput,e.isSelected?(r.setAttribute("checked","checked"),r.checked||(r.checked=!0)):r.checked&&(r.checked=!1);var o=function(){U(e,!!r.checked,n.selectionMode)};return typeof r.changeEventListener!==t&&r.removeEventListener("change",r.changeEventListener,!0),r.addEventListener("change",o,!0),r.changeEventListener=o,s=function(l){13==l.keyCode&&(l.preventDefault(),l.stopPropagation(),o())},typeof r.keyPressEventListener!==t&&r.removeEventListener("keypress",r.keyPressEventListener,!0),r.addEventListener("keypress",s,!0),r.keyPressEventListener=s,r},U=function(e,n,s){var r;if(e.isSelected=n,le(e,"isSelected",!0,!0),Vi(e),typeof e.ganttChartView!==t&&(e.ganttChartView.selectedItem=e,"Extended"!=s&&"ExtendedFocus"!=s&&(e.ganttChartView.selectedItems=[e]),"Extended"!=s&&"ExtendedFocus"!=s))for(r=0;r<e.ganttChartView.items.length;r++)(n=e.ganttChartView.items[r])!=e&&n.isSelected&&(n.isSelected=!1,le(n,"isSelected",!1,!0),Vi(n));if(typeof e.ganttChartView!==t&&("Extended"==s||"ExtendedFocus"==s)){for(s=[],r=0;r<e.ganttChartView.items.length;r++)(n=e.ganttChartView.items[r]).isSelected&&s.push(n);e.ganttChartView.selectedItems=s}},$=function(e,n){typeof e.ganttChartView!==t&&(e.ganttChartView.currentItem=e),("Focus"==n.selectionMode||"ExtendedFocus"==n.selectionMode)&&(typeof e.scheduleChartItem!==t&&(e=e.scheduleChartItem),e.isSelected||U(e,!0,n.selectionMode))},de=function(e,n,s,r){var o=function(l){return H(l.ganttChartView.ownerDocument,l.content)};return typeof r!==t&&!r||e.isReadOnly||e.isGridReadOnly||e.isContentReadOnly?o:function(l){return n.isReadOnly||typeof l.isReadOnly!==t&&l.isReadOnly?o(l):Me(l,Math.max(0,n.width-l.indentation*l.ganttChartView.settings.indentationLevelWidth-l.ganttChartView.settings.toggleButtonAreaWidth-16),e)}},Me=function(e,n,s){var o,r=e.ganttChartView.ownerDocument;if(typeof e.contentInput===t){o=r.createElement("input"),e.contentInput=o,o.type="text",o.addEventListener("focus",function(){$(e,s)},!1);var l=function(){e.content=o.value,le(e,"content",!0,!0),Dt(e)};typeof o.changeEventListener!==t&&o.removeEventListener("change",o.changeEventListener,!0),o.addEventListener("change",l,!0),o.changeEventListener=l,r=function(y){13==y.keyCode&&(y.preventDefault(),y.stopPropagation(),l())},typeof o.keyPressEventListener!==t&&o.removeEventListener("keypress",o.keyPressEventListener,!0),o.addEventListener("keypress",r,!0),o.keyPressEventListener=r,o.addEventListener("focus",function(){o.style.backgroundColor="White"},!1),o.addEventListener("blur",function(){o.style.backgroundColor="Transparent"},!1)}else o=e.contentInput;return o.value=e.content,r="",e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&(r="; font-weight: bold"),o.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+r+(s.classic?"":"; font-size: 12px; padding: 1px;")),o},Fe=function(e,n,s){var r=function(o){return o.ganttChartView.ownerDocument.createTextNode(typeof o.start===t||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?"":e.dateTimeFormatter(c(o.start)))};return typeof s!==t&&!s||e.isReadOnly||e.isGridReadOnly?r:function(o){return n.isReadOnly||typeof o.isReadOnly!==t&&o.isReadOnly||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?r(o):He(o,Math.max(0,n.width-16),e)}},He=function(e,n,s){var r=e.ganttChartView.ownerDocument,o=r.createElement("input");e.startInput=o;try{o.type=s.dateTimePickerType}catch{o.type="text"}o.addEventListener("focus",function(){$(e,s)},!1),o.addEventListener("focus",function(){o.style.backgroundColor="White"},!1),o.addEventListener("blur",function(){o.style.backgroundColor="Transparent"},!1),typeof e.start!==t&&(o.value=s.dateTimeFormatter(c(e.start))),DlhSoft.Controls.DatePicker&&"text"==s.dateTimePickerType&&s.useDatePicker&&o.addEventListener("focus",function(){if(!e.isWaitingToRefreshGridItem){var d=(s.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).get(o);if(!d||!d.isOpen){var u=0,p=0;try{u=o.selectionStart,p=o.selectionEnd}catch{}(d=(s.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).initialize(o,void 0,{inputStyle:null,isDropDownButtonVisible:!1,defaultTimeOfDay:s.workingDayStart,dateTimeFormatter:s.dateTimeFormatter,dateTimeParser:s.dateTimeParser,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid "+s.border,disabledDateSelector:ue(s),disabledTimeSelector:ke(s),calendarSelectorLevels:s.calendarSelectorLevels,months:s.months,daysOfWeek:Te(s.daysOfWeek),weekStart:s.weekStartDay},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{o.selectionStart=u,o.selectionEnd=p}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{o.focus()}catch{}},100):r.createEvent&&setTimeout(function(){var f=r.createEvent("MouseEvents");f.initEvent("blur",!0,!1),o.dispatchEvent(f)})}}},!0);var l="";e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&(l="; font-weight: bold"),o.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+l+(s.classic?"":"; font-size: 12px; padding: 1px;")),e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)?o.setAttribute("disabled","true"):o.removeAttribute("disabled");var y=function(){if(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled){var u,p,d=e.completedFinish>e.start;s.isTaskEffortPreservedWhenStartChangesInGrid&&(u=gt(e,s),p=Pt(e,s));var f=e.start.valueOf(),T=e.finish.valueOf(),C=e.completedFinish.valueOf(),k=s.dateTimeParser(o.value);(null==k||isNaN(k))&&(k=new Date),k=Ze(S(k),s,!0,e.isMilestone,ce(e)),(!s.validateStartFinish||k<=e.finish||e.isMilestone)&&(e.start=k,e.preferredStart=e.start,e.isMilestone&&(e.finish=e.start),e.start.valueOf()!=f&&le(e,"start",!0,!0),e.finish<e.start&&(e.finish=e.start,e.finish.valueOf()!=T&&le(e,"finish",!1,!0)),e.completedFinish<e.start||!d?(e.completedFinish=e.start,e.completedFinish.valueOf()!=C&&le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,e.completedFinish.valueOf()!=C&&le(e,"completedFinish",!1,!0)),typeof e.completedInput!==t&&(typeof(d=e.completedInput).changeEventListener!==t&&d.removeEventListener("change",d.changeEventListener,!0),delete e.completedInput),s.isTaskEffortPreservedWhenStartChangesInGrid&&(oi(e,u,s),li(e,p,s)))}ot(e)};return typeof o.changeEventListener!==t&&o.removeEventListener("change",o.changeEventListener,!0),o.addEventListener("change",y,!0),o.changeEventListener=y,n=function(d){13==d.keyCode&&(d.preventDefault(),d.stopPropagation(),y())},typeof o.keyPressEventListener!==t&&o.removeEventListener("keypress",o.keyPressEventListener,!0),o.addEventListener("keypress",n,!0),o.keyPressEventListener=n,o},Ie=function(e,n,s){var r=function(o){return typeof o.finish===t||typeof o.isMilestone!==t&&1==o.isMilestone&&typeof o.start!==t&&o.finish.valueOf()==o.start.valueOf()||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?o.ganttChartView.ownerDocument.createTextNode(""):o.ganttChartView.ownerDocument.createTextNode(e.dateTimeFormatter(c(o.finish)))};return typeof s!==t&&!s||e.isReadOnly||e.isGridReadOnly?r:function(o){return n.isReadOnly||typeof o.isReadOnly!==t&&o.isReadOnly||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?r(o):be(o,Math.max(0,n.width-16),e)}},be=function(e,n,s){var r=e.ganttChartView.ownerDocument,o=r.createElement("input");e.finishInput=o;try{o.type=s.dateTimePickerType}catch{o.type="text"}o.addEventListener("focus",function(){$(e,s)},!1),o.addEventListener("focus",function(){o.style.backgroundColor="White"},!1),o.addEventListener("blur",function(){o.style.backgroundColor="Transparent"},!1),typeof e.finish!==t&&(o.value=s.dateTimeFormatter(c(e.finish))),DlhSoft.Controls.DatePicker&&"text"==s.dateTimePickerType&&s.useDatePicker&&o.addEventListener("focus",function(){if(!e.isWaitingToRefreshGridItem){var u=(s.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).get(o);if(!u||!u.isOpen){var p=0,f=0;try{p=o.selectionStart,f=o.selectionEnd}catch{}(u=(s.useTimePicker&&DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).initialize(o,void 0,{inputStyle:null,isDropDownButtonVisible:!1,defaultTimeOfDay:s.workingDayFinish,dateTimeFormatter:s.dateTimeFormatter,dateTimeParser:s.dateTimeParser,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid "+s.border,disabledDateSelector:ue(s),disabledTimeSelector:De(s,e),calendarSelectorLevels:s.calendarSelectorLevels,months:s.months,daysOfWeek:Te(s.daysOfWeek),weekStart:s.weekStartDay},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{o.selectionStart=p,o.selectionEnd=f}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{o.focus()}catch{}},100):r.createEvent&&setTimeout(function(){var T=r.createEvent("MouseEvents");T.initEvent("blur",!0,!1),o.dispatchEvent(T)})}}},!0);var l="";typeof e.isMilestone!==t&&1==e.isMilestone&&(l="; visibility: hidden");var y="";e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&(y="; font-weight: bold"),o.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+l+y+(s.classic?"":"; font-size: 12px; padding: 1px;")),e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)?o.setAttribute("disabled","true"):o.removeAttribute("disabled");var d=function(){if(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled){var u=e.finish.valueOf(),p=e.completedFinish.valueOf(),f=s.dateTimeParser(o.value);(null==f||isNaN(f))&&(f=new Date),f=S(f),o.value.length>0&&o.value.indexOf(" ")<0&&0==L(f)&&(f=j(f)),f=Ze(f,s,e.isMilestone,!0,ce(e)),(!s.validateStartFinish||f>=e.start)&&(e.finish=f,e.finish<e.start&&(e.finish=e.start),e.finish.valueOf()!=u&&le(e,"finish",!0,!0),e.completedFinish<e.start?(e.completedFinish=e.start,e.completedFinish.valueOf()!=p&&le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,e.completedFinish.valueOf()!=p&&le(e,"completedFinish",!1,!0)),typeof e.completedInput!==t&&(typeof(u=e.completedInput).changeEventListener!==t&&u.removeEventListener("change",u.changeEventListener,!0),delete e.completedInput))}ot(e)};return typeof o.changeEventListener!==t&&o.removeEventListener("change",o.changeEventListener,!0),o.addEventListener("change",d,!0),o.changeEventListener=d,n=function(u){13==u.keyCode&&(u.preventDefault(),u.stopPropagation(),d())},typeof o.keyPressEventListener!==t&&o.removeEventListener("keypress",o.keyPressEventListener,!0),o.addEventListener("keypress",n,!0),o.keyPressEventListener=n,o},ue=function(e){return function(n){if(n.getDay()<e.workingWeekStart||n.getDay()>e.workingWeekFinish)return!0;if(e.specialNonworkingDays){if("function"==typeof e.specialNonworkingDays)return e.specialNonworkingDays(S(n));n=S(n).valueOf();for(var s=0;s<e.specialNonworkingDays.length;s++)if(n==e.specialNonworkingDays[s].valueOf())return!0}return!1}},ke=function(e){return function(n){return n<e.visibleDayStart||n>=e.visibleDayFinish}},De=function(e,n){return function(s){return(b(n.start)<b(n.finish)?s<=e.visibleDayStart:s<e.visibleDayStart)||s>e.visibleDayFinish}},Te=function(e){if(e){for(var n=[],s=0;s<e.length;s++){var r=(r=e[s]).length>0?r[0].toUpperCase()+(r.length>1?r[1]:""):"";n.push(r)}return n}},tt=function(e,n,s){var r=function(o){return typeof o.isMilestone===t||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?o.ganttChartView.ownerDocument.createTextNode(""):a(o.ganttChartView.ownerDocument,o.isMilestone)};return typeof s!==t&&!s||e.isReadOnly||e.isGridReadOnly?r:function(o){return n.isReadOnly||typeof o.isReadOnly!==t&&o.isReadOnly||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?r(o):Ye(o,e)}},Ye=function(e,n){var r,s=e.ganttChartView.ownerDocument;if(typeof e.milestoneInput===t?(r=s.createElement("input"),e.milestoneInput=r,r.type="checkbox",r.setAttribute("style","margin: 0px; margin-left: 2px; margin-right: 2px"),r.addEventListener("focus",function(){$(e,n)},!1)):r=e.milestoneInput,e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)||typeof e.isMilestone===t||!e.isMilestone?r.removeAttribute("checked"):r.setAttribute("checked","checked"),!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled){var o=function(){r.checked?(e.isMilestone=!0,le(e,"isMilestone",!0,!0),e.finish>e.start&&(e.finish=e.start,le(e,"finish",!1,!0)),e.completedFinish>e.start&&(e.completedFinish=e.start,le(e,"completedFinish",!1,!0))):(e.isMilestone=!1,le(e,"isMilestone",!0,!0)),ot(e)};typeof r.changeEventListener!==t&&r.removeEventListener("change",r.changeEventListener,!0),r.addEventListener("change",o,!0),r.changeEventListener=o,s=function(l){13==l.keyCode&&(l.preventDefault(),l.stopPropagation(),o())},typeof r.keyPressEventListener!==t&&r.removeEventListener("keypress",r.keyPressEventListener,!0),r.addEventListener("keypress",s,!0),r.keyPressEventListener=s}else r.setAttribute("style","visibility: hidden");return r},Oe=function(e,n,s){var r=function(o){return typeof o.assignmentsContent===t||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?o.ganttChartView.ownerDocument.createTextNode(""):H(o.ganttChartView.ownerDocument,o.assignmentsContent)};return typeof s!==t&&!s||e.isReadOnly||e.isGridReadOnly||e.isAssignmentsContentReadOnly?r:function(o){return n.isReadOnly||typeof o.isReadOnly!==t&&o.isReadOnly||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?r(o):it(o,Math.max(0,n.width-16),e)}},it=function(e,n,s){var l,r=e.ganttChartView,o=r.ownerDocument;if(typeof e.assignmentsContentInput===t){l=o.createElement("input"),e.assignmentsContentInput=l,l.type="text",l.addEventListener("focus",function(){$(e,s)},!1);var y=function(){e.assignmentsContent=l.value,le(e,"assignmentsContent",!0,!0),!e.hasChildren&&e.hasFixedEffort&&(e.fixedEffort=gt(e,s),e.fixedEffortAssignments=Ct(e)),bt(e);var u=null;if(DlhSoft.Controls.MultiSelectorComboBox&&(u=DlhSoft.Controls.MultiSelectorComboBox.get(l)),null!=u&&u.availableChoices.length>0)var p=setInterval(function(){!u.isOpen&&o.activeElement!=e.assignmentsContentInput&&(clearInterval(p),ot(e))},100);else ot(e)};typeof l.changeEventListener!==t&&l.removeEventListener("change",l.changeEventListener,!0),l.addEventListener("change",function(u){l.dontAutoFocus=!0,y()},!0),l.changeEventListener=y;var d=function(u){13==u.keyCode&&(u.preventDefault(),u.stopPropagation(),typeof l.dontAutoFocus!==t&&delete l.dontAutoFocus,y())};typeof l.keyPressEventListener!==t&&l.removeEventListener("keypress",l.keyPressEventListener,!0),l.addEventListener("keypress",d,!0),l.keyPressEventListener=d,l.addEventListener("focus",function(){l.style.backgroundColor="White"},!1),l.addEventListener("blur",function(){l.style.backgroundColor="Transparent"},!1)}else l=e.assignmentsContentInput;return typeof e.assignmentsContent!==t&&(l.value=e.assignmentsContent),DlhSoft.Controls.MultiSelectorComboBox&&s.useResourceSelector&&l.addEventListener("focus",function(){if(!e.isWaitingToRefreshGridItem){var u=DlhSoft.Controls.MultiSelectorComboBox.get(l);if(!u||!u.isOpen&&u.availableChoices.length>0){typeof(u=s.assignableResources)===t&&(u=Qt(r.items),s.assignableResources=u);var p=0,f=0;try{p=l.selectionStart,f=l.selectionEnd}catch{}(u=DlhSoft.Controls.MultiSelectorComboBox.initialize(l,u,void 0,{inputStyle:null,autoAppendAvailableChoices:s.autoAppendAssignableResources,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; color: Black; border: 1px solid "+s.border+"; font-size: small; max-height: 188px; overflow-y: auto"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{l.selectionStart=p,l.selectionEnd=f}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{l.focus()}catch{}},100):o.createEvent&&setTimeout(function(){var T=o.createEvent("MouseEvents");T.initEvent("blur",!0,!1),l.dispatchEvent(T)})}}},!0),d="",e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&(d="; font-weight: bold"),l.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+d+(s.classic?"":"; font-size: 12px; padding: 1px;")),l},Le=function(e,n,s){var r=function(o){return typeof o.start===t||typeof o.finish===t||o.finish.valueOf()==o.start.valueOf()||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?o.ganttChartView.ownerDocument.createTextNode(""):a(o.ganttChartView.ownerDocument,o.ganttChartView.isItemCompleted(o))};return typeof s!==t&&!s||e.isReadOnly||e.isGridReadOnly?r:function(o){return n.isReadOnly||typeof o.isReadOnly!==t&&o.isReadOnly||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled&&typeof o.isBarVisible!==t&&!o.isBarVisible?r(o):et(o,e)}},et=function(e,n){var r,s=e.ganttChartView.ownerDocument;typeof e.completedInput===t?(r=s.createElement("input"),e.completedInput=r,r.type="checkbox",r.setAttribute("style","margin: 0px; margin-left: 2px; margin-right: 2px"),r.addEventListener("focus",function(){$(e,n)},!1)):r=e.completedInput,e.isSetAsCompleted||(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)&&e.completedFinish>=e.finish&&e.finish>e.start&&(typeof e.isMilestone===t||!e.isMilestone)?r.setAttribute("checked","checked"):r.removeAttribute("checked"),e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&r.setAttribute("style","visibility: hidden");var o=function(){r.checked?(e.completedFinish<e.finish&&(e.completedFinish=e.finish,le(e,"completedFinish",!0,!0)),(e.isMilestone||e.finish.valueOf()<=e.start.valueOf())&&(e.isSetAsCompleted=!0,le(e,"isSetAsCompleted",!0,!0))):(e.completedFinish>e.start&&(e.completedFinish=e.start,le(e,"completedFinish",!0,!0)),(e.isMilestone||e.finish.valueOf()<=e.start.valueOf())&&(e.isSetAsCompleted=!1,le(e,"isSetAsCompleted",!0,!0))),ot(e)};return typeof r.changeEventListener!==t&&r.removeEventListener("change",r.changeEventListener,!0),r.addEventListener("change",o,!0),r.changeEventListener=o,s=function(l){13==l.keyCode&&(l.preventDefault(),l.stopPropagation(),o())},typeof r.keyPressEventListener!==t&&r.removeEventListener("keypress",r.keyPressEventListener,!0),r.addEventListener("keypress",s,!0),r.keyPressEventListener=s,r},ft=function(e){for(var n=0,s=0;s<e.length;s++)n+=e[s].width;return n},Qe=function(e,n,s){for(var r=fe(n.items,s),o=0;o<e.length;o++){var l=e[o];l.ganttChartView=n,typeof l.width===t&&(l.width=100),typeof l.minWidth===t&&(l.minWidth=Math.min(l.width,s.minColumnWidth+(l.isTreeView?r:0))),typeof l.maxWidth===t&&(l.maxWidth=s.maxColumnWidth),typeof l.cellTemplate===t&&(l.cellTemplate=function(y){return H(y.ganttChartView.ownerDocument,y.content)}),(s.verticalGridLines||s.verticalGridHeaderLines)&&(l.minWidth<4&&(l.minWidth=4),l.width<l.minWidth&&(l.width=l.minWidth))}},st=function(e,n,s,r){var o=e.ownerDocument,l=o.createElement("div");typeof s.columnHeaderClass!==t&&l.setAttribute("class",s.columnHeaderClass),typeof s.columnHeaderStyle!==t&&l.setAttribute("style",s.columnHeaderStyle);for(var y=0;y<n.length;y++)l.appendChild(x(o,n[y],s,r));e.appendChild(l)},x=function(e,n,s,r){var o=e.createElement("div");o.setAttribute("style","overflow-y: hidden; vertical-align: middle; display: table-cell; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: "+s.headerHeight+"px");var l=e.createElement("div"),y=n.width>=4?2:n.width/2;if(l.setAttribute("style","padding-left: "+y+"px; padding-right: "+y+"px; overflow-x: hidden; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: "+n.width+"px"),y=e.createElement("div"),typeof n.headerClass!==t&&y.setAttribute("class",n.headerClass),typeof n.headerStyle!==t&&y.setAttribute("style",n.headerStyle),y.appendChild(H(e,n.header)),l.appendChild(y),o.appendChild(l),s.verticalGridLines||s.verticalGridHeaderLines||n.width>=1&&(typeof s.allowUserToResizeColumns===t||s.allowUserToResizeColumns)&&(typeof n.allowUserToResize===t||n.allowUserToResize)){o.isGripperVisible=!1,r=n.ganttChartView;var d=function(f){o.isGripperVisible=f,o.style.cursor=f?s.classic?"e-resize":"ew-resize":"default",o.style.borderRight=f?"solid 1px "+s.border:s.verticalGridLines||s.verticalGridHeaderLines?"solid 1px "+(s.verticalGridHeaderLines?s.verticalGridHeaderLines:s.verticalGridLines):"",l.style.width=n.width-(o.style.borderRight?1:0)+"px"};if((s.verticalGridLines||s.verticalGridHeaderLines)&&d(),n.width>=1&&(typeof s.allowUserToResizeColumns===t||s.allowUserToResizeColumns)&&(typeof n.allowUserToResize===t||n.allowUserToResize)){var u=s.splitterWidth;o.addEventListener("mouseover",function(f){!DlhSoft.Controls.GanttChartView.isGripperDragging&&!(o.isGripperDragging||typeof f.offsetX===t&&f.currentTarget!=o)&&d((typeof f.offsetX!==t?f.offsetX:f.layerX-f.currentTarget.offsetLeft)>=n.width-u)},!0),o.addEventListener("mousemove",function(f){!DlhSoft.Controls.GanttChartView.isGripperDragging&&!(o.isGripperDragging||typeof f.offsetX===t&&f.currentTarget!=o)&&d((typeof f.offsetX!==t?f.offsetX:f.layerX-f.currentTarget.offsetLeft)>=n.width-u)},!0),l.addEventListener("mouseover",function(f){!DlhSoft.Controls.GanttChartView.isGripperDragging&&!o.isGripperDragging&&typeof f.offsetX===t&&f.currentTarget==l&&d(f.layerX-f.currentTarget.offsetLeft>=n.width-u)},!1),l.addEventListener("mousemove",oe(r,l,"mousemove",function(f){!DlhSoft.Controls.GanttChartView.isGripperDragging&&!o.isGripperDragging&&typeof f.offsetX===t&&f.currentTarget==l&&d(f.layerX-f.currentTarget.offsetLeft>=n.width-u)})),o.addEventListener("mousedown",oe(r,o,"mousedown",function(f){0!=f.button||!o.isGripperVisible||DlhSoft.Controls.GanttChartView.isGripperDragging||(DlhSoft.Controls.GanttChartView.isGripperDragging=!0,o.isGripperDragging=!0,o.initialGripperDraggingX=f.clientX,o.initialColumnWidth=n.width)},!0),!0),e.addEventListener("mousemove",oe(r,e,"mousemove",function(f){o.isGripperDragging&&(n.width=Math.max(n.minWidth,o.initialColumnWidth+(f.clientX-o.initialGripperDraggingX)),typeof n.maxWidth!==t&&n.width>n.maxWidth&&(n.width=n.maxWidth),l.style.width=n.width-1+"px",typeof s.columnWidthChangeHandler!==t&&setTimeout(function(){s.columnWidthChangeHandler(n,n.width)},0),r.isWaitingToRefreshColumns||(r.isWaitingToRefreshColumns=!0,setTimeout(function(){var T=ft(s.columns);r.gridHeader.style.width=T+"px",r.gridContent.style.width=T+"px",delete r.isWaitingToRefreshColumns,r.refreshGridItems()},0)))},!0),!0),e.addEventListener("mouseup",oe(r,e,"mouseup",function(){o.isGripperDragging&&(delete o.isGripperDragging,delete o.initialGripperDraggingX,delete o.initialColumnWidth,d(!1),delete DlhSoft.Controls.GanttChartView.isGripperDragging)},!0),!0),o.addEventListener("mouseout",oe(r,o,"mouseout",function(){o.isGripperDragging||d(!1)}))}}return o},W=function(e,n){for(var s=-1,r=null,o=null,l=[],y=0;y<e.length;y++){var d=e[y];if(typeof d.scheduleChartItem===t&&(typeof d.isSelected===t&&(d.isSelected=!1),d.isSelected&&(null==o&&(o=d),l.push(d)),typeof d.indentation===t&&(d.indentation=0),0==y&&0!=d.indentation&&(d.indentation=0,le(d,"indentation",!1,!0)),typeof d.isExpanded===t&&(d.isExpanded=!0),null!=r)){var u=r.indentation+1;d.indentation>u&&(d.indentation=u,le(d,"indentation",!1,!0)),r.hasChildren=d.indentation>r.indentation,r.hasChildren&&typeof r.isMilestone!==t&&r.isMilestone&&(r.isMilestone=!1,le(r,"isMilestone",!1,!0))}d.isVisible=s<0||d.indentation<=s,typeof d.scheduleChartItem===t&&(d.isVisible&&!d.isExpanded&&(s=d.indentation),d.isExpanded&&d.indentation==s&&(s=-1),r=d)}null!=r&&(r.hasChildren=!1),n.selectedItem=o,n.selectedItems=l},O=function(e,n,s){s.isTimingInformationInitialized=!1,s.isBasicTimingInformationInitialized=!1;var l,y,d,r=b(n.currentTime),o=[];for(y=0;y<e.length;y++){(l=e[y]).index=y;var u=null;for(o.length>0&&(u=o[o.length-1]);null!=u&&l.indentation<=u.indentation;)o.pop(),u=o[o.length-1];if(l.parent=u,l.children=[],u?.children.push(l),!l.hasChildren||typeof l.isSummaryEnabled!==t&&!l.isSummaryEnabled){d=l.start;var p=l.finish,f=l.completedFinish;typeof l.start===t&&(l.start=r,l.preferredStart=l.start),typeof l.finish===t&&(l.finish=typeof l.isMilestone!==t&&l.isMilestone?l.start:j(r)),typeof l.isSetAsCompleted===t&&(l.isSetAsCompleted=typeof l.completedFinish!==t&&l.completedFinish.valueOf()==l.finish.valueOf()),typeof l.completedFinish===t&&(l.completedFinish=l.start),typeof l.isRelativeToTimezone===t||l.isRelativeToTimezone?(l.start=new Date(l.start.valueOf()-6e4*l.start.getTimezoneOffset()),l.preferredStart=l.start,l.finish=new Date(l.finish.valueOf()-6e4*l.finish.getTimezoneOffset()),l.completedFinish="number"==typeof l.completedFinish?_e(l.start,l.completedFinish*Ge(l.start,l.finish,n,ce(l)),n,ce(l)):new Date(l.completedFinish.valueOf()-6e4*l.completedFinish.getTimezoneOffset()),typeof l.baselineStart!==t&&(l.baselineStart=new Date(l.baselineStart.valueOf()-6e4*l.baselineStart.getTimezoneOffset())),typeof l.baselineFinish!==t&&(l.baselineFinish=new Date(l.baselineFinish.valueOf()-6e4*l.baselineFinish.getTimezoneOffset())),typeof l.minStart!==t&&(l.minStart=new Date(l.minStart.valueOf()-6e4*l.minStart.getTimezoneOffset())),typeof l.maxStart!==t&&(l.maxStart=new Date(l.maxStart.valueOf()-6e4*l.maxStart.getTimezoneOffset())),typeof l.minFinish!==t&&(l.minFinish=new Date(l.minFinish.valueOf()-6e4*l.minFinish.getTimezoneOffset())),typeof l.maxFinish!==t&&(l.maxFinish=new Date(l.maxFinish.valueOf()-6e4*l.maxFinish.getTimezoneOffset())),l.isRelativeToTimezone=!1):"number"==typeof l.completedFinish&&(l.completedFinish=_e(l.start,l.completedFinish*Ge(l.start,l.finish,n,ce(l)),n,ce(l))),typeof l.minStart!==t&&l.start<l.minStart?l.start=l.minStart:typeof l.maxStart!==t&&l.start>l.maxStart&&(l.start=l.maxStart),typeof l.maxFinish!==t&&l.finish>l.maxFinish?l.finish=l.maxFinish:typeof l.minFinish!==t&&l.finish<l.minFinish&&(l.finish=l.minFinish),l.finish<l.start&&(l.finish=l.start),l.completedFinish<l.start?l.completedFinish=l.start:l.completedFinish>l.finish&&(l.completedFinish=l.finish),typeof l.loadChartItem===t&&(l.start=Ze(l.start,n,!0,typeof l.isMilestone!==t&&l.isMilestone,ce(l))),typeof l.dependsOf!==t&&delete l.dependsOf,l.preferredStart=l.start,typeof l.loadChartItem===t&&(l.finish=Ze(l.finish,n,typeof l.isMilestone!==t&&l.isMilestone,!0,ce(l)),l.completedFinish=Ze(l.completedFinish,n,typeof l.isMilestone!==t&&l.isMilestone,!0,ce(l))),l.finish<l.start&&(l.finish=l.start),l.completedFinish<l.start&&(l.completedFinish=l.start),l.completedFinish>l.finish&&(l.completedFinish=l.finish),(typeof d===t||l.start.valueOf()!=d.valueOf())&&le(l,"start",!1,!0),(typeof p===t||l.finish.valueOf()!=p.valueOf())&&le(l,"finish",!1,!0),(typeof f===t||l.completedFinish.valueOf()!=f.valueOf())&&le(l,"completedFinish",!1,!0)}for(d=0;d<o.length;d++)(typeof(p=o[d]).isSummaryEnabled===t||p.isSummaryEnabled)&&((typeof p.start===t||p.start>l.start)&&(p.start=l.start,le(p,"start",!1,!0)),(typeof p.finish===t||p.finish<l.finish)&&(p.finish=l.finish,le(p,"finish",!1,!0)),(typeof p.completedFinish===t||p.completedFinish.valueOf()!=p.start.valueOf())&&(p.completedFinish=p.start,le(p,"completedFinish",!1,!0)));(null==u||l.indentation>u.indentation)&&o.push(l)}for(s.isBasicTimingInformationInitialized=!0,y=e.length;y-- >0;)(l=e[y]).hasChildren&&(typeof l.isSummaryEnabled===t||l.isSummaryEnabled)&&h(l);if(n.areTaskDependencyConstraintsEnabled)for(y=0;y<e.length;y++)typeof(l=e[y]).predecessors!==t&&null!=l.predecessors&&l.predecessors.length>0&&Ht(l,e,n,s);else if(n.alwaysHandleInvalidDependencies)for(y=0;y<e.length;y++)typeof(l=e[y]).predecessors!==t&&null!=l.predecessors&&l.predecessors.length>0&&Ht(l,e,n,s,!0);for(y=0;y<e.length;y++)!(l=e[y]).hasChildren&&l.hasFixedEffort&&(l.fixedEffort=gt(l,n),l.fixedEffortAssignments=Ct(l));s.isTimingInformationInitialized=!0},h=function(e,n){if(!(e.children.length<=0||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)){typeof n===t&&(n=!0);var s=e.start,r=e.finish,o=e.completedFinish;delete e.start,delete e.finish,delete e.completedFinish;for(var l=0;l<=1;l++){for(var y=0;y<e.children.length;y++){var d=e.children[y];typeof d.isParentSummarizationEnabled!==t&&!d.isParentSummarizationEnabled&&l<1||((typeof e.start===t||e.start>d.start)&&(e.start=d.start),(typeof e.finish===t||e.finish<d.finish)&&(e.finish=d.finish))}if(typeof e.start!==t&&typeof e.finish!==t)break}e.completedFinish=e.start,(typeof s===t||e.start.valueOf()!=s.valueOf())&&le(e,"start",!1,n),(typeof r===t||e.finish.valueOf()!=r.valueOf())&&le(e,"finish",!1,n),(typeof o===t||e.completedFinish.valueOf()!=o.valueOf())&&le(e,"completedFinish",!1,n)}},w=function(e,n){return e==n||v(e,n)||v(n,e)},v=function(e,n){var s=e.parent;return null!=s&&(!(typeof s.isSummaryEnabled!==t&&!s.isSummaryEnabled||s!=n)||v(s,n))},I=function(e,n){if(typeof e.predecessors===t)return!1;for(var s=0;s<e.predecessors.length;s++)if(e.predecessors[s].item==n)return!0;return!1},b=function(e){return new Date(864e5*Math.floor(e.valueOf()/864e5))},L=function(e){return e.valueOf()-b(e).valueOf()},M=function(e){return(e=Math.floor((e.valueOf()-2592e5)/864e5)%7)<0&&(e+=7),e},Y=function(e,n){return b(e),new Date(6048e5*Math.floor((e.valueOf()-2592e5)/6048e5)+2592e5+864e5*n)},J=function(e,n){var s=Y(e,n);return Math.abs(s.valueOf()-e.valueOf())<=36e5?s:new Date(s.valueOf()+6048e5)},K=function(e){return e.hourWidth*(e.visibleDayFinish-e.visibleDayStart)/36e5},q=function(e,n){var o=K(n),s=K(n)*(n.visibleWeekFinish-n.visibleWeekStart+1),r=Y(e,n.weekStartDay);return r=Math.floor((r-n.timelineStart)/6048e5)*s-Math.max(0,n.weekStartDay-n.visibleWeekStart)*o,r=(s=M(e))<=n.visibleWeekStart?r+0:s>n.visibleWeekFinish?r+(n.visibleWeekFinish-n.visibleWeekStart+1)*o:r+(s-n.visibleWeekStart)*o,o=L(e),s>=n.visibleWeekStart&&s<=n.visibleWeekFinish&&(r=o<=n.visibleDayStart?r+0:o>=n.visibleDayFinish?r+(n.visibleDayFinish-n.visibleDayStart)/36e5*n.hourWidth:r+(o-n.visibleDayStart)/36e5*n.hourWidth),r},te=function(e,n){for(var s=n.timelineStart.valueOf(),r=K(n),o=K(n)*(n.visibleWeekFinish-n.visibleWeekStart+1);e>o;)s+=6048e5,e-=o;for(s+=864e5*Math.max(0,n.visibleWeekStart-n.weekStartDay);e>r;)s+=864e5,e-=r;return s+=n.visibleDayStart,s+=e/n.hourWidth*36e5,new Date(s)},G=function(e){switch(e.theme){default:return[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 2.25px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 2.25px"},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: #8bbf8a; stroke-width: 0.5px"}];case"ModernBordered":return[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 2.25px; border-right: solid 1px White; border-bottom: solid 1px White",isSeparatorVisible:!0,separatorStyle:"stroke: #c8bfe7; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 2.25px; border-right: solid 1px White"},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: #8bbf8a; stroke-width: 1px"}];case"Aero":return[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 2.25px; border-right: solid 1px #c8bfe7; border-bottom: solid 1px #c8bfe7",isSeparatorVisible:!0,separatorStyle:"stroke: #c8bfe7; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 2.25px; border-right: solid 1px #c8bfe7"},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: Black; stroke-width: 1px"}]}},Q=function(e,n){return new Date(Math.floor((e-2592e5).valueOf()/n.updateScale)*n.updateScale+2592e5)},ie=function(e,n,s,r,o){typeof o===t&&(o=!1);var d,u,l=e.ownerDocument,y=0;for(d=0;d<s.length;d++)(typeof(u=s[d]).isHeaderVisible===t||u.isHeaderVisible)&&y++;var p=r.headerHeight;for(y>0&&(p=r.headerHeight/y),d=0;d<s.length;d++)if(u=s[d],(!o||"CurrentTime"==u.scaleType||"FutureTime"==u.scaleType)&&typeof(y=ye(u,r))!==t){0==y.length&&y.push({start:r.timelineStart,finish:r.timelineFinish});var f=p;typeof u.headerHeight!==t&&(f=u.headerHeight);for(var T=r.timelineStart,C=0;C<y.length;C++){var k=y[C],V=k.start,E=k.finish;"CurrentTime"!=u.scaleType&&"FutureTime"!=u.scaleType&&"NonworkingTime"!=u.scaleType&&(V>T&&(typeof u.isHeaderVisible===t||u.isHeaderVisible)&&(V=T),V<T&&(V=T),V<r.timelineStart&&(V=r.timelineStart),E>r.timelineFinish&&(E=r.timelineFinish),E<V&&(E=V),C==y.length-1&&E<r.timelineFinish&&(typeof u.isHeaderVisible===t||u.isHeaderVisible)&&(E=r.timelineFinish),T=E);var R=q(V,r),B=q(E,r),ee=B-R;if(!(ee<=0)){if(typeof u.isHeaderVisible===t||u.isHeaderVisible){var N=Cn(u,k,r),X=l.createElement("div");X.setAttribute("style","float: left; overflow: hidden; width: "+ee+"px; height: "+f+"px");var _=l.createElement("div");_.setAttribute("class",u.headerClass),_.setAttribute("style",u.headerStyle),_.appendChild(H(l,N)),X.appendChild(_),e.appendChild(X)}k.start=V,k.finish=E,k=!1,typeof u.isHighlightingVisible!==t&&(k=u.isHighlightingVisible),k&&((k=l.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",R-1),k.setAttribute("y",0),k.setAttribute("width",ee),k.setAttribute("height",0),k.setAttribute("class",u.highlightingClass),k.setAttribute("style",u.highlightingStyle),k.tag="Scale-Highlighting"+("CurrentTime"!=u.scaleType&&"FutureTime"!=u.scaleType?"":"-CurrentTime"),n.appendChild(k)),R=!1,typeof u.isSeparatorVisible!==t&&(R=u.isSeparatorVisible),R&&((R=l.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",B-.75),R.setAttribute("y1",0),R.setAttribute("x2",B-.75),R.setAttribute("y2",0),R.setAttribute("class",u.separatorClass),R.setAttribute("style",u.separatorStyle),R.tag="Scale-Separator"+("CurrentTime"!=u.scaleType&&"FutureTime"!=u.scaleType?"":"-CurrentTime"),n.appendChild(R))}}}},ye=function(e,n){var r,o,s="Custom";switch(typeof e.scaleType!==t&&(s=e.scaleType),s){case"CurrentTime":return[{start:n.timelineStart,finish:n.currentTime}];case"FutureTime":return[{start:n.currentTime,finish:n.timelineFinish}];case"Years":s=[],o=(r=new Date(n.timelineStart.valueOf())).getTimezoneOffset(),r.setMonth(0,1);var l=r.getTimezoneOffset();for(r=new Date(r.valueOf()-6e4*(l-o)-(l>0?864e5:0));o=ze(r),r<n.timelineFinish;r=o)s.push({start:r,finish:o});return s;case"Months":for(s=[],o=(r=new Date(n.timelineStart.valueOf())).getTimezoneOffset(),r.setDate(1),l=r.getTimezoneOffset(),r=new Date(r.valueOf()-6e4*(l-o)-(l>0?864e5:0));o=Ue(r),r<n.timelineFinish;r=o)s.push({start:r,finish:o});return s;case"Weeks":for(s=[],r=n.timelineStart,o=n.weekStartDay,l=n.visibleWeekStart;M(r)!=o;)r=Ce(r);for(;M(r)<l;)r=j(r);for(r=new Date(r.valueOf());o=Ne(r),r<n.timelineFinish;r=o)s.push({start:r,finish:o});return s;case"Days":for(s=[],r=n.timelineStart;o=j(r),r<n.timelineFinish;r=o)s.push({start:r,finish:o});return s;case"Hours":for(s=[],r=new Date(b(n.timelineStart).valueOf()+n.visibleDayStart);o=Z(new Date(r.valueOf()+36e5),n.visibleDayFinish,n.visibleDayStart),r<n.timelineFinish;r=o)s.push({start:r,finish:o});return s;case"NonworkingTime":for(s=[],r=wt(n.timelineStart,n.workingWeekFinish),o=di(r,n.workingWeekStart);r<n.timelineFinish;r=Ne(r),o=Ne(o))s.push({start:r,finish:o});if(typeof n.specialNonworkingDays!==t)if("function"==typeof n.specialNonworkingDays)for(r=wt(n.timelineStart,n.workingWeekFinish),o=j(r);r<n.timelineFinish;r=j(r),o=j(o))n.specialNonworkingDays(r)&&s.push({start:r,finish:o});else for(l=0;l<n.specialNonworkingDays.length;l++)o=j(r=n.specialNonworkingDays[l]),s.push({start:r,finish:o});return s;default:return e.intervals}},Z=function(e,n,s){return L(e)>n?(e=j(e),new Date(b(e).valueOf()+s)):new Date(e.valueOf())},j=function(e){return new Date(e.valueOf()+864e5)},Ce=function(e){return new Date(e.valueOf()-864e5)},Ne=function(e){return new Date(e.valueOf()+6048e5)},Ue=function(s){var n=s.getTimezoneOffset(),r=(s=new Date(s.valueOf()+(n>0?864e5:0))).getMonth()+1;return r>=12&&(r=0,s.setFullYear(s.getFullYear()+1)),s.setMonth(r,1),r=s.getTimezoneOffset(),new Date(s.valueOf()-6e4*(r-n)-(r>0?864e5:0))},ze=function(s){var n=s.getTimezoneOffset();(s=new Date(s.valueOf()+(n>0?864e5:0))).setFullYear(s.getFullYear()+1),s.setMonth(0,1);var r=s.getTimezoneOffset();return new Date(s.valueOf()-6e4*(r-n)-(r>0?864e5:0))},Gt=function(e,n){if(typeof n===t)return!1;if("function"==typeof n)return n(e);for(var s=e.valueOf(),r=0;r<n.length;r++)if(n[r].valueOf()==s)return!0;return!1},wt=function(e,n){for(;M(e)!=n;)e=Ce(e);return j(e)},di=function(e,n){for(;M(e)!=n;)e=j(e);return new Date(e.valueOf())},Cn=function(e,n,s){var r="Date";if(typeof e.headerTextFormat!==t&&(r=e.headerTextFormat),(e=n.start)<s.timelineStart&&(e=s.timelineStart),"function"==typeof r)return r(e);switch(r){case"Localized":return e.toLocaleString();case"DateTime":return s.dateTimeFormatter(c(e));case"Date":return s.dateFormatter(c(e));case"Hour":return((e=new Date(e.valueOf()+6e4*e.getTimezoneOffset())).getHours()<10?"0":"")+e.getHours();case"DayOfWeek":return s.daysOfWeek[M(e)];case"DayOfWeekAbbreviation":return(n=s.daysOfWeek[M(e)]).length>0?n[0].toUpperCase():"";case"Day":return((e=new Date(e.valueOf()+6e4*e.getTimezoneOffset())).getDate()<10?"0":"")+e.getDate();case"Month":return s.months[new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getMonth()];case"MonthAbbreviation":return(n=s.months[new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getMonth()]).length<=0?"":n[0].toUpperCase()+(n.length>1?n.substr(1,Math.min(3,n.length)-1):"");case"Year":return new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getFullYear();case"MonthYear":return s.months[new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getMonth()]+" "+new Date(e.valueOf()+6e4*(e.getTimezoneOffset()+720)).getFullYear();default:return typeof n.headerText!==t?n.headerText:e.toString()}},vn=function(e,n,s){for(var r=0,o=0;o<n.length;o++){var l=n[o],y=r;typeof l.displayRowIndex!==t&&(y=l.displayRowIndex*s.itemHeight),e.appendChild(bn(l,y,s)),l.isVisible&&(typeof l.isHidden===t||!l.isHidden)&&(r=Math.max(r,y+s.itemHeight))}},wn=function(e,n,s,r,o,l,y,d){for(var u=0,p=0;p<r.length;p++){var f=r[p];y.isGridVisible&&typeof f.displayRowIndex===t&&e.appendChild(Ei(f,r,o,n,l,y,d));var T=u;typeof f.displayRowIndex!==t&&(T=f.displayRowIndex*y.itemHeight),s.appendChild(fi(f,T,y)),f.isVisible&&!(typeof f.isHidden!==t&&f.isHidden)&&(u=Math.max(u,T+y.itemHeight)),f.itemTop=T}Lt(n,u),setTimeout(function(){Xt(r,n,y)},0)},kt=function(e,n){for(var s=0,r=0,o=-1,l=0;l<e.length;l++){var y=e[l];(typeof y.scheduleChartItem===t||y.scheduleChartItem==y)&&y.isVisible&&(typeof y.isHidden===t||!y.isHidden)&&(typeof y.displayRowIndex===t&&r>o?(s+=n.itemHeight,o=r++):(s=Math.max(s,y.itemTop+n.itemHeight),o=y.displayRowIndex))}return s},Et=function(e,n,s){if(e.isPart)return Et(e.ganttChartItem,n,s);var r;if(typeof e.displayRowIndex!==t)return e.itemTop=e.displayRowIndex*s.itemHeight;for(var o=r=0;o<n.length;o++){var l=n[o];if(l==e)break;l.isVisible&&(typeof l.isHidden===t||!l.isHidden)&&typeof l.displayRowIndex===t&&(r+=s.itemHeight)}return e.itemTop=r},Xt=function(e,n,s){if(typeof s.alternativeItemClass!==t||typeof s.alternativeItemStyle!==t||typeof s.alternativeChartItemClass!==t||typeof s.alternativeChartItemStyle!==t){for(var r=n.chartAreaAlternativeRows;r.childNodes.length>0;)r.removeChild(r.childNodes[0]);var o,l=0,y=!1;for(r.count=l,o=0;o<e.length;o++){var d=e[o];if(d.isVisible&&typeof d.alternativeContentContainer!==t){var u=d.alternativeContentContainer;l%2==1?(typeof s.alternativeItemClass!==t&&u.setAttribute("class",s.alternativeItemClass),typeof s.alternativeItemStyle!==t&&u.setAttribute("style",s.alternativeItemStyle),(typeof s.alternativeChartItemClass!==t||typeof s.alternativeChartItemStyle!==t)&&(!s.isVirtualizing||d.isVirtuallyVisible||!y)&&(y=!0,(typeof r.count===t||l>r.count)&&((d=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",0),d.setAttribute("y",l*s.itemHeight),d.setAttribute("width",n.clientWidth),d.setAttribute("height",s.itemHeight),typeof s.alternativeChartItemClass!==t&&d.setAttribute("class",s.alternativeChartItemClass),typeof s.alternativeChartItemStyle!==t&&d.setAttribute("style",s.alternativeChartItemStyle),d.index=l,r.appendChild(d))),r.count=l):(u.setAttribute("class",""),u.setAttribute("style","")),l++}}for(o=r.childNodes.length;o-- >0;)(e=r.childNodes[o]).index>r.count&&r.removeChild(e)}},Ei=function(e,n,s,r,o,l,y){var d=e.ganttChartView.ownerDocument,u=d.createElement("div");typeof l.itemClass!==t&&u.setAttribute("class",l.itemClass),typeof l.itemStyle!==t&&u.setAttribute("style",l.itemStyle),u.style.display=e.isVisible?"block":"none";var p=d.createElement("div");e.alternativeContentContainer=p;var f=d.createElement("div");try{f.addEventListener("mousedown",oe(y,f,"mousedown",function(V){V.target!=e.selectionInput&&$(e,l)})),f.addEventListener("mouseup",oe(y,f,"mouseup",function(V){V.target!=e.selectionInput&&$(e,l)}))}catch{}e.isSelected&&(typeof l.selectedItemClass!==t&&f.setAttribute("class",l.selectedItemClass),typeof l.selectedItemStyle!==t&&f.setAttribute("style",l.selectedItemStyle));var T=d.createElement("div");typeof e.class!==t&&T.setAttribute("class",e.class),typeof e.style!==t&&T.setAttribute("style",e.style);var C=d.createElement("div");e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)?(typeof l.summaryItemClass!==t&&C.setAttribute("class",l.summaryItemClass),typeof l.summaryItemStyle!==t&&C.setAttribute("style",l.summaryItemStyle)):e.isMilestone?(typeof l.milestoneItemClass!==t&&C.setAttribute("class",l.milestoneItemClass),typeof l.milestoneItemStyle!==t&&C.setAttribute("style",l.milestoneItemStyle)):(typeof l.standardItemClass!==t&&C.setAttribute("class",l.standardItemClass),typeof l.standardItemStyle!==t&&C.setAttribute("style",l.standardItemStyle)),d=d.createElement("div"),e.gridItem=d,e.gridItemContent=C,e.gridItemSelectionContainer=f;var k=l.itemHeight;return(!e.isVisible||typeof e.isHidden!==t&&e.isHidden)&&(k=0),d.setAttribute("style","overflow: hidden; height: "+k+"px"),Vt(d,e,n,s,r,o,l),C.appendChild(d),T.appendChild(C),f.appendChild(T),p.appendChild(f),u.appendChild(p),e.gridItemContainer=u,(typeof l.isGridRowClickTimeScrollingEnabled===t||l.isGridRowClickTimeScrollingEnabled)&&u.addEventListener("mouseup",oe(y,u,"mouseup",function(){var V;if(typeof e.ganttChartItems===t)V=e.start;else{V=null;for(var E=0;E<e.ganttChartItems.length;E++)(null==V||e.ganttChartItems[E].start<V)&&(V=e.ganttChartItems[E].start);V=V??e.start}(V=q(V,l))-(E=V-8*l.hourWidth)>=r.container.clientWidth/2.5&&(E=V),r.container.scrollLeft=Math.max(0,E)},!0),!0),u},Vt=function(e,n,s,r,o,l,y){var d=n.ganttChartView.ownerDocument;if(!y.isVirtualizing||typeof n.isVirtuallyVisible!==t&&n.isVirtuallyVisible){var u=function(){if(typeof n.gridItemSelectionContainer!==t){var p=n.gridItemSelectionContainer;typeof y.selectedItemClass!==t&&p.setAttribute("class",n.isSelected?y.selectedItemClass:null),typeof y.selectedItemStyle!==t&&p.setAttribute("style",n.isSelected?y.selectedItemStyle:null)}typeof n.gridItemContent!==t&&((p=n.gridItemContent).setAttribute("class",""),p.setAttribute("style",""),n.hasChildren&&(typeof n.isSummaryEnabled===t||n.isSummaryEnabled)?(typeof y.summaryItemClass!==t&&p.setAttribute("class",y.summaryItemClass),typeof y.summaryItemStyle!==t&&p.setAttribute("style",y.summaryItemStyle)):n.isMilestone?(typeof y.milestoneItemClass!==t&&p.setAttribute("class",y.milestoneItemClass),typeof y.milestoneItemStyle!==t&&p.setAttribute("style",y.milestoneItemStyle)):(typeof y.standardItemClass!==t&&p.setAttribute("class",y.standardItemClass),typeof y.standardItemStyle!==t&&p.setAttribute("style",y.standardItemStyle))),p=[];var f=null;try{f=d.activeElement}catch{}for(;null!=f&&f!=n.gridItem;)p.push(f),f=f.parentNode;var T=-1;for(f=e.childNodes.length;f-- >0;)if(p.indexOf(e.childNodes[f])>=0){T=f;break}for(f=e.childNodes.length;f-- >0;)e.removeChild(e.childNodes[f]);for(f=0;f<r.length;f++)e.appendChild(Ai(n,s,r[f],o,l,y));typeof n.ganttChartView.draggingItem===t&&T>=0&&setTimeout(function(){try{for(var C=e.childNodes[T];"input"!=C.nodeName&&"textarea"!=C.nodeName&&"label"!=C.nodeName&&"select"!=C.nodeName&&"button"!=C.nodeName&&C.childNodes.length>0;)C=C.childNodes[0];C&&C.dontAutoFocus?delete C.dontAutoFocus:setTimeout(function(){try{C.focus()}catch{}},0)}catch{}},0)};n.wasGridItemContentLoaded?setTimeout(u,0):(u(),n.wasGridItemContentLoaded=!0)}},Yt=function(e){typeof e.isWaitingToRefreshGridItem===t&&(e.isWaitingToRefreshGridItem=!0,setTimeout(function(){typeof e.gridItem!==t&&Vt(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings),delete e.isWaitingToRefreshGridItem},0))},Vi=function(e){typeof e.gridItem!==t&&function(e,n,s,r,o,l,y){var d=n.ganttChartView.ownerDocument;(!y.isVirtualizing||typeof n.isVirtuallyVisible!==t&&n.isVirtuallyVisible)&&setTimeout(function(){if(typeof n.gridItemSelectionContainer!==t){var u=n.gridItemSelectionContainer;typeof y.selectedItemClass!==t&&u.setAttribute("class",n.isSelected?y.selectedItemClass:null),typeof y.selectedItemStyle!==t&&u.setAttribute("style",n.isSelected?y.selectedItemStyle:null)}u=[];var p=null;try{p=d.activeElement}catch{}for(;null!=p&&p!=n.gridItem;)u.push(p),p=p.parentNode;var f=-1;for(p=e.childNodes.length;p-- >0;)if(e.childNodes[p].isSelection&&u.indexOf(e.childNodes[p])>=0){f=p;break}for(p=e.childNodes.length;p-- >0;)e.childNodes[p].isSelection&&e.removeChild(e.childNodes[p]);for(p=0;p<r.length;p++)r[p].isSelection&&p<e.childNodes.length&&e.insertBefore(Ai(n,s,r[p],o,l,y),e.childNodes[p]);typeof n.ganttChartView.draggingItem===t&&f>=0&&setTimeout(function(){try{for(var T=e.childNodes[f];"input"!=T.nodeName&&"textarea"!=T.nodeName&&"label"!=T.nodeName&&"select"!=T.nodeName&&"button"!=T.nodeName&&T.childNodes.length>0;)T=T.childNodes[0];T&&T.dontAutoFocus?delete T.dontAutoFocus:setTimeout(function(){try{T.focus()}catch{}},0)}catch{}},0)},0)}(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings)},Ai=function(e,n,s,r,o,l){var y=e.ganttChartView.ownerDocument,d=y.createElement("div"),u=0;1==s.isTreeView&&(u=l.indentationLevelWidth*e.indentation),d.setAttribute("style","overflow: hidden; vertical-align: middle; display: table-cell; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 0px; padding: 0px; width: "+s.width+"px; height: "+l.itemHeight+"px; padding-left: "+u+"px");var p=y.createElement("div");typeof s.cellClass!==t?p.setAttribute("class",s.cellClass):typeof l.cellClass!==t&&p.setAttribute("class",l.cellClass),typeof s.cellStyle!==t?p.setAttribute("style",s.cellStyle):typeof l.cellStyle!==t&&p.setAttribute("style",l.cellStyle);var f=y.createElement("div");return f.setAttribute("style","white-space: nowrap; overflow: hidden; margin: 0px; padding: 0px; width: "+(s.width-u-16)+"px"),1==s.isTreeView&&((u=y.createElement("div")).setAttribute("style","display: inline-block; width: "+o+"px"),e.hasChildren&&((o=y.createElement("div")).setAttribute("style","cursor: default; padding-left: 1px; font-size: 12px; display: inline-block"),y=l.collapsedToggleButtonTemplate,e.isExpanded&&(y=l.expandedToggleButtonTemplate),y=y(),o.appendChild(y),Fi(o,e,n,y,r,null,null,l),u.appendChild(o)),f.appendChild(u)),e=s.cellTemplate(e),f.appendChild(e),p.appendChild(f),d.appendChild(p),d.isSelection=s.isSelection,d},Li=function(e,n){return function(){var s=e.ownerDocument.createElementNS("http://www.w3.org/2000/svg","polygon");return s.setAttribute("points","3.5,2.5 3.5,11.5 10.5,6.5"),A(s,n)}},Hi=function(e,n){return function(){var s=e.ownerDocument.createElementNS("http://www.w3.org/2000/svg","polygon");return s.setAttribute("points","2.5,3.5 11.5,3.5 6.5,10.5"),A(s,n)}},Fi=function(e,n,s,r,o,l,y,d){(typeof l===t||null==l)&&(l=r.querySelector("#PART_Button")),null!=l&&Oi(l,l,d,n.ganttChartView),(typeof y===t||null==y)&&(y=r.querySelector("#PART_Border")),null!=y&&Oi(y,l,d,n.ganttChartView),s={toggleButton:e,item:n,items:s,content:r,chartContent:o,settings:d},null!=l&&(l.tag=s,(typeof d.isExport===t||!d.isExport)&&l.addEventListener("mouseup",oe(n.ganttChartView,l,"mouseup",ui,!0),!0)),null!=y&&(y.tag=s,(typeof d.isExport===t||!d.isExport)&&y.addEventListener("mouseup",oe(n.ganttChartView,y,"mouseup",ui,!0),!0)),e.tag=s,null==l&&null==y&&(typeof d.isExport===t||!d.isExport)&&e.addEventListener("mouseup",oe(n.ganttChartView,e,"mouseup",ui,!0),!0),r.addEventListener("keypress",oe(n.ganttChartView,r,"keypress",function(u){32==u.keyCode&&(u.preventDefault(),u.stopPropagation(),vt(n,!n.isExpanded,!0))},!0),!0),n.toggleButton=e},Oi=function(e,n,s,r){typeof s.isExport!==t&&s.isExport||(e.addEventListener("mouseover",oe(r,e,"mouseover",function(){typeof s.toggleButtonHoveringClass!==t&&n.setAttribute("class",s.toggleButtonHoveringClass),typeof s.toggleButtonHoveringStyle!==t&&n.setAttribute("style",s.toggleButtonHoveringStyle)},!0),!0),e.addEventListener("mouseout",oe(r,e,"mouseout",function(){n.setAttribute("class",s.toggleButtonClass),n.setAttribute("style",s.toggleButtonStyle)},!0),!0))},ui=function(e){e.stopPropagation(),vt(e=e.target.tag.item,!e.isExpanded,!0)},vt=function(e,n,s,r){e.isExpanded!=n&&(e.isExpanded=n,(typeof r===t||r)&&le(e,"isExpanded",s,!0),Pi(e))},Pi=function(e,n){if(typeof e.toggleButton===t)(typeof n===t||n)&&setTimeout(function(){Pi(e,!1)},0);else{var s=e.toggleButton,r=(u=s.tag).settings,o=r.expandedToggleButtonTemplate,l=r.collapsedToggleButtonTemplate;e.isExpanded&&(l=o),l=(o=l()).querySelector("#PART_Button");var y=o.querySelector("#PART_Border");s.replaceChild(o,u.content),u.content=o;var u,d=u.items;if(Fi(s,e,d,o,u=u.chartContent,l,y,r),e.isVisible&&!(typeof e.isHidden!==t&&e.isHidden)&&Sn(d,e,u,r),bt(e),Xt(d,u,r),typeof(s=e.scheduleChartView)!==t)for(r=e.scheduleChartIndex;r<s.scheduleChartItems.length;r++)if(typeof(u=s.scheduleChartItems[r]).ganttChartItems!==t)for(o=0;o<u.ganttChartItems.length;o++)(l=u.ganttChartItems[o]).displayRowIndex=u.itemTop/s.settings.itemHeight,s.refreshChartItem(l)}},Sn=function(e,n,s,r){var p,f,T,o=-1,l=!1,y=!1,d=!1,u=0,C=[];for(f=0;f<e.length;f++){(T=e[f])==n?(l=T.isExpanded,o=T.indentation):T.indentation<=o&&(d=!0);var k=T.chartItem,V=T.chartPredecessorItems;if(y&&!d){if(T.scheduleChartItem&&T.scheduleChartItem!=T)p=T.scheduleChartItem.isVisible;else if(l){p=!0;for(var E=T.parent;null!=E;){if(!E.isVisible||!E.isExpanded){p=!1;break}E=E.parent}}else p=!1;T.isVisible!=p&&(T.isVisible=l,le(T,"isVisible",!1,!0),p=r.itemHeight,(!T.isVisible||typeof T.isHidden!==t&&T.isHidden)&&(p=0),typeof T.gridItem!==t&&(T.gridItem.style.height=p+"px"),typeof T.gridItemContainer!==t&&(T.gridItemContainer.style.display=p>0?"block":"none"),p="visible",(!T.isVisible||typeof T.isHidden!==t&&T.isHidden)&&(p="hidden"),k.setAttribute("style","visibility: "+p),V.setAttribute("style","visibility: "+p))}if(typeof T.displayRowIndex===t&&(k.setAttribute("transform","translate(0, "+u+")"),V.setAttribute("transform","translate(0, "+u+")"),At(T,u)),T==n&&(y=!0),p=r.itemHeight,(!T.isVisible||typeof T.isHidden!==t&&T.isHidden)&&(p=0),T.itemTop!=u&&(T.itemTop=u),typeof T.displayRowIndex===t&&(u+=p),T.predecessors&&T.predecessors.length>0&&C.indexOf(T)<0)for(C.push(T),k=0;k<T.predecessors.length;k++)C.indexOf(V=T.predecessors[k].item)<0&&C.push(V)}if(Lt(s,u),St(e,n),r.areTaskDependenciesVisible)for(f=0;f<C.length;f++)St(e,C[f]);Ot(e,s.container,r)},At=function(e,n){typeof e.parts===t||e.parts.length<=0||setTimeout(function(){for(var s=0;s<e.parts.length;s++){var r=e.parts[s];r.itemTop=n,typeof r.chartItem!==t&&(r.chartItem.setAttribute("transform","translate(0, "+n+")"),r.chartPredecessorItems.setAttribute("transform","translate(0, "+n+")"),r.chartItem.style.visibility=e.chartItem.style.visibility,r.chartPredecessorItems.style.visibility=e.chartItem.style.visibility,typeof r.isInternallyHidden!==t&&(delete r.isInternallyHidden,r.chartItem.style.display="inline"))}},0)},Lt=function(e,n){n<e.availableHeight&&(n=e.availableHeight),e.style.height=n+"px";var s=e.chartArea;s.style.height=n+"px";for(var r=0;r<s.childNodes.length;r++){var o=s.childNodes[r];if(typeof o.tag!==t)switch(o.tag){case"Scale-Highlighting":case"Scale-Highlighting-CurrentTime":o.setAttribute("height",n);break;case"Scale-Separator":case"Scale-Separator-CurrentTime":o.setAttribute("y2",n)}}},St=function(e,n){var r,o,l,y,s=[];if(typeof n.successors===t)for(n.successors=[],o=0;o<e.length;o++)if((r=e[o])!=n&&typeof r.predecessors!==t&&0!=r.predecessors.length)for(l=0;l<r.predecessors.length;l++)if(r.predecessors[l].item==n){n.successors.push(r);break}for(o=0;o<n.successors.length;o++){var d=n.successors[o];if(typeof d.predecessors!==t&&d.predecessors.length>0)for(l=0;l<d.predecessors.length;l++){var u=d.predecessors[l].item;if(typeof u!==t){for(r=!0,y=0;y<s;y++)if(u==s[y]){r=!1;break}r&&(mt(u.chartPredecessorItems,u,u.ganttChartView.settings),yt(u.chartItem,u,u.ganttChartView.settings),s.push(u))}}if(typeof d.predecessors!==t&&d.predecessors.length>0){for(r=!0,y=0;y<s;y++)if(typeof d!==t&&d==s[y]){r=!1;break}r&&(mt(d.chartPredecessorItems,d,d.ganttChartView.settings),yt(d.chartItem,d,d.ganttChartView.settings),s.push(d))}}},bn=function(e,n,s){var r=e.ganttChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");e.chartPredecessorItems=r;var o="visible";return(!e.isVisible||typeof e.isHidden!==t&&e.isHidden)&&(o="hidden"),r.setAttribute("style","visibility: "+o+"; -ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),r.setAttribute("transform","translate(0, "+n+")"),typeof e.isInternallyHidden!==t&&e.isInternallyHidden&&(r.style.display="none"),mt(r,e,s),r},fi=function(e,n,s){var r=e.ganttChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");e.chartItem=r;var o="visible";(!e.isVisible||typeof e.isHidden!==t&&e.isHidden)&&(o="hidden"),r.setAttribute("style","visibility: "+o+"; -ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),r.setAttribute("transform","translate(0, "+n+")"),typeof e.isInternallyHidden!==t&&e.isInternallyHidden&&(r.style.display="none"),At(e,n),yt(r,e,s);try{r.addEventListener("mousedown",oe(e.ganttChartView,r,"mousedown",function(){$(e,s)})),r.addEventListener("mouseup",oe(e.ganttChartView,r,"mouseup",function(){$(e,s)})),r.addEventListener("touchstart",oe(e.ganttChartView,r,"touchstart",function(){$(e,s)})),r.addEventListener("touchend",oe(e.ganttChartView,r,"touchend",function(){$(e,s)}))}catch{}return r},mt=function(e,n,s){for(var r=e.childNodes.length;r-- >0;)e.removeChild(e.childNodes[r]);if(n.predecessors)for(r=0;r<n.predecessors.length;r++)Dn(r,e,n,n.predecessors[r],s)},Dn=function(e,n,s,r,o){if((!o.isVirtualizing||typeof s.isVirtuallyVisible!==t&&s.isVirtuallyVisible)&&(typeof s.isBarVisible===t||s.isBarVisible)&&o.areTaskDependenciesVisible&&!((typeof s.ganttChartView===t||s.ganttChartView.items.indexOf(r.item))<0||!r.item.isVisible||typeof r.item.isHidden!==t&&r.item.isHidden||typeof r.item.isBarVisible!==t&&!r.item.isBarVisible)){var l=o.dependencyLineTemplate(s,r);l.predecessorIndex=e,l.addEventListener("click",oe(s.ganttChartView,l,"click",function(y){o.dependencyLineClickHandler&&o.dependencyLineClickHandler(s.predecessors[this.predecessorIndex],s,y)})),l.addEventListener("dblclick",oe(s.ganttChartView,l,"dblclick",function(y){o.dependencyLineDoubleClickHandler&&o.dependencyLineDoubleClickHandler(s.predecessors[this.predecessorIndex],s,y)})),typeof o.predecessorItemContextMenuHandler!==t?l.addEventListener("contextmenu",oe(s.ganttChartView,l,"contextmenu",function(y){o.predecessorItemContextMenuHandler(y,s.predecessors[this.predecessorIndex],s)})):!o.isReadOnly&&!o.isChartReadOnly&&!o.areTaskPredecessorsReadOnly&&(typeof s.isReadOnly===t||!s.isReadOnly)&&l.addEventListener("contextmenu",oe(s.ganttChartView,l,"contextmenu",function(y){if(confirm("Are you sure you want to remove the predecessor?")){for(var d=[],u=0;u<s.predecessors.length;u++)if(u!=this.predecessorIndex){var p=s.predecessors[u];delete p.item.successors,d.push(p)}s.predecessors=d,le(s,"predecessors",!0,!0),mt(s.chartPredecessorItems,s,o),yt(s.chartItem,s,o),St(s.ganttChartView.items,s)}y.preventDefault()})),n.appendChild(l),o.isDependencyToolTipVisible&&(!o.useInlineToolTips||!o.useInlineToolTipsForDependencies)&&(e=o.predecessorItemTemplate,typeof r.template!==t&&(e=r.template),l.appendChild(e(s,r)))}},yt=function(e,n,s){for(var r=e.childNodes.length;r-- >0;)e.removeChild(e.childNodes[r]);if((!s.isVirtualizing||typeof n.isVirtuallyVisible!==t&&n.isVirtuallyVisible)&&(typeof n.isBarVisible===t||n.isBarVisible)){if(r=s.standardTaskTemplate,typeof n.standardTaskTemplate!==t&&(r=n.standardTaskTemplate),n.hasChildren&&(typeof n.isSummaryEnabled===t||n.isSummaryEnabled)?(r=s.summaryTaskTemplate,typeof n.summaryTaskTemplate!==t&&(r=n.summaryTaskTemplate)):n.isMilestone&&(r=s.milestoneTaskTemplate,typeof n.milestoneTaskTemplate!==t&&(r=n.milestoneTaskTemplate)),typeof n.taskTemplate!==t&&(r=n.taskTemplate),typeof s.internalPreTaskTemplate!==t){var o=s.internalPreTaskTemplate(n);null!=o&&e.appendChild(o)}(r=r(n)).addEventListener("contextmenu",oe(n.ganttChartView,r,"contextmenu",function(l){typeof s.itemContextMenuHandler!==t?s.itemContextMenuHandler(l,n):l.preventDefault()})),e.appendChild(r),typeof s.internalExtraTaskTemplate!==t&&null!=(o=s.internalExtraTaskTemplate(n))&&e.appendChild(o),typeof s.extraTaskTemplate!==t&&null!=(o=s.extraTaskTemplate(n))&&e.appendChild(o),s.areTaskAssignmentsVisible&&(e=s.assignmentsTemplate(n),r.appendChild(e)),s.isTaskToolTipVisible&&!s.useInlineToolTips&&(e=s.itemTemplate,typeof n.template!==t&&(e=n.template),r.appendChild(e(n)))}},Ut=function(e){for(var n=0;n<e.length;n++)Bt(e[n])},bt=function(e){(!e.ganttChartView.settings.isVirtualizing||typeof e.isVirtuallyVisible!==t&&e.isVirtuallyVisible)&&typeof e.isWaitingToRefreshChartItem===t&&(e.isWaitingToRefreshChartItem=!0,setTimeout(function(){mt(e.chartPredecessorItems,e,e.ganttChartView.settings),yt(e.chartItem,e,e.ganttChartView.settings);var n=Et(e,e.ganttChartView.items,e.ganttChartView.settings);e.chartItem.setAttribute("transform","translate(0, "+n+")"),e.chartPredecessorItems.setAttribute("transform","translate(0, "+n+")"),At(e,n),delete e.isWaitingToRefreshChartItem},0))},Dt=function(e){(!e.ganttChartView.settings.isVirtualizing||typeof e.isVirtuallyVisible!==t&&e.isVirtuallyVisible)&&(typeof e.isWaitingToRefreshGridItem!==t||typeof e.isWaitingToRefreshChartItem!==t?(typeof e.isWaitingToRefreshGridItem===t&&Yt(e),typeof e.isWaitingToRefreshChartItem===t&&bt(e)):(e.isWaitingToRefreshGridItem=!0,e.isWaitingToRefreshChartItem=!0,setTimeout(function(){typeof e.gridItem!==t&&Vt(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings),mt(e.chartPredecessorItems,e,e.ganttChartView.settings),yt(e.chartItem,e,e.ganttChartView.settings);var n=Et(e,e.ganttChartView.items,e.ganttChartView.settings);e.chartItem.setAttribute("transform","translate(0, "+n+")"),e.chartPredecessorItems.setAttribute("transform","translate(0, "+n+")"),At(e,n),delete e.isWaitingToRefreshGridItem,delete e.isWaitingToRefreshChartItem},0)))},It=function(e){(!e.ganttChartView.settings.isVirtualizing||typeof e.isVirtuallyVisible!==t&&e.isVirtuallyVisible)&&typeof e.isWaitingToRefreshPredecessorItems===t&&(e.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){St(e.ganttChartView.items,e),delete e.isWaitingToRefreshPredecessorItems},0))},Bt=function(e){(!e.ganttChartView.settings.isVirtualizing||typeof e.isVirtuallyVisible!==t&&e.isVirtuallyVisible)&&(typeof e.isWaitingToRefreshGridItem!==t||typeof e.isWaitingToRefreshChartItem!==t||typeof e.isWaitingToRefreshPredecessorItems!==t?(typeof e.isWaitingToRefreshGridItem===t&&Yt(e),typeof e.isWaitingToRefreshChartItem===t&&bt(e),typeof e.isWaitingToRefreshPredecessorItems===t&&It(e)):(e.isWaitingToRefreshGridItem=!0,e.isWaitingToRefreshChartItem=!0,e.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){typeof e.gridItem!==t&&Vt(e.gridItem,e,e.ganttChartView.items,e.ganttChartView.settings.columns,e.ganttChartView.chartContent,e.ganttChartView.settings.toggleButtonAreaWidth,e.ganttChartView.settings),mt(e.chartPredecessorItems,e,e.ganttChartView.settings),yt(e.chartItem,e,e.ganttChartView.settings);var n=Et(e,e.ganttChartView.items,e.ganttChartView.settings);e.chartItem.setAttribute("transform","translate(0, "+n+")"),e.chartPredecessorItems.setAttribute("transform","translate(0, "+n+")"),At(e,n),St(e.ganttChartView.items,e),delete e.isWaitingToRefreshGridItem,delete e.isWaitingToRefreshChartItem,delete e.isWaitingToRefreshPredecessorItems},0)))},ot=function(e){for(Bt(e),e=e.parent;null!=e;)h(e),Bt(e),e=e.parent},Zt=function(e,n,s,r){ge(n,r),W(n,s),O(n,r,s),(s=e.index-1)>=0&&ot(n[s]),ot(e),(s=e.index+1)<n.length&&ot(n[s])},jt=function(e,n){var s=n.toggleButtonAreaWidth;return delete n.toggleButtonAreaWidth,fe(e,n),n.toggleButtonAreaWidth!=s},Mi=function(e,n,s,r,o){for(s.initializedItems.push(n),n.ganttChartView=s,n.isVirtuallyVisible=!0;e>0&&r[e-1].isPart;)e--;for(var l=0;l<r.length;l++)if(r[l].parts&&r[l].parts.indexOf(n)>=0){n.isPart=!0,n.ganttChartItem=r[l];break}var u,y=e<r.length?r[e]:null;if(null==y||y.isPart?n.indentation>(y=null!=(y=e>0?r[e-1]:null)?y.indentation+1:0)&&(n.indentation=y):(typeof n.indentation===t||n.indentation<y.indentation-1||n.indentation>y.indentation)&&(n.indentation=y.indentation),ge([n],o),r.splice(e,0,n),W(r,s),typeof n.parts!==t)for(typeof n.isGroup===t&&(n.isGroup=!0,n.isSummaryEnabled=!1),ge(n.parts,o),(n.isGroup||typeof n.isBarVisible===t)&&(n.isBarVisible=!1),l=0;l<n.parts.length;l++){var d=n.parts[l];d.ganttChartView=n.ganttChartView,d.ganttChartItem=n,d.isPart=!0,d.isVirtuallyVisible=!0,(n.isGroup||typeof d.indentation===t)&&(d.indentation=0),(n.isGroup||typeof d.displayRowIndex===t)&&(d.displayRowIndex=-1),d.isInternallyHidden=!0,r.indexOf(d)>=0||r.splice(r.length,0,d)}O(r,o,s),o.isGridVisible&&!n.isPart&&typeof n.displayRowIndex===t&&(l=null,e<r.length-1&&((y=r[e+1]).isPart||(u=y.itemTop,typeof y.gridItemContainer!==t&&(l=y.gridItemContainer))),s.gridContent.insertBefore(Ei(n,r,o.columns,s.chartContent,o.toggleButtonAreaWidth,o,s),l)),typeof u===t&&(u=kt(r,o)-o.itemHeight),y=u,typeof n.displayRowIndex!==t&&(y=n.displayRowIndex*o.itemHeight);var p=s.chartContent.chartArea;if(p.appendChild(fi(n,y,o)),n.isVisible&&!(typeof n.isHidden!==t&&n.isHidden)&&(u=Math.max(u,y+o.itemHeight)),n.itemTop=y,typeof n.parts!==t)for(l=0;l<n.parts.length;l++)p.appendChild(fi(d=n.parts[l],y,o));if(typeof n.displayRowIndex===t)for(l=e+1;l<r.length;l++)y=u,typeof(d=r[l]).displayRowIndex!==t&&(y=d.displayRowIndex*o.itemHeight),d.isVisible&&!(typeof d.isHidden!==t&&d.isHidden)&&(u=Math.max(u,y+o.itemHeight)),d.itemTop=y,bt(d),St(r,d);for(l=e+1;l<r.length;l++)Yt(r[l]);s.isContentHeightInitialized&&s.isContentHeightAuto&&(e=ae(s,r,o),s.gridContentContainer.style.height=e,s.chartContentContainer.style.height=e),Lt(s.chartContent,kt(r,o)),Xt(r,s.chartContent,o),jt(r,o)&&Ut(r),Zt(n,r,s,o),Ot(r,s.chartContentContainer,o)},Bi=function(e,n,s,r){if(typeof e.parts!==t)for(var o=0;o<e.parts.length;o++)Bi(e.parts[o],n,s,r);var l=null,y=!1;if((o=e.index)>0){for(l=s[o-1];null!=l.parent;)l=l.parent;y=l.isExpanded,e.hasChildren&&vt(l,e.isExpanded,!1,!0),l.indentation>=e.indentation&&(l=null)}else s[0].isExpanded||vt(s[0],!0,!1,!0);var d=o+1<s.length?s[o+1]:null;null!=d&&!d.isExpanded&&d.indentation>e.indentation&&vt(d,!0,!1,!0);var p,f,T,u=null!=d?d.indentation:null;for(f=0;f<n.items.length;f++)if(null!=(p=n.items[f]).predecessors)for(T=p.predecessors.length;T-- >0;)p.predecessors[T].item==e&&(p.predecessors.splice(T,1),le(p,"predecessors",!1,!0),Dt(p),It(p));var C=e.itemTop;if(s.splice(o,1),W(s,n),O(s,r,n),r.isGridVisible&&typeof e.displayRowIndex===t&&typeof e.gridItemContainer!==t&&n.gridContent.removeChild(e.gridItemContainer),f=n.chartContent.chartArea,typeof e.chartItem!==t&&f.removeChild(e.chartItem),null!=(d=o<s.length?s[o]:null)&&d.indentation<u)for(le(d,"indentation",!1,!0),d.predecessors=[],le(d,"predecessors",!1,!0),f=0;f<s.length;f++)if((p=s[f])!=d&&typeof p.predecessors!==t&&0!=p.predecessors.length)for(T=0;T<p.predecessors.length;T++)p.predecessors[T].item==d&&(p.predecessors.splice(T--,1),le(p,"predecessors",!1,!0),Dt(p),It(p));for(null!=l&&vt(l,y,!1,!0),f=o;f<s.length;f++)e=s[f],actualItemTop=C,typeof e.displayRowIndex!==t&&(actualItemTop=e.displayRowIndex*r.itemHeight),e.isVisible&&!(typeof e.isHidden!==t&&e.isHidden)&&(C=Math.max(C,actualItemTop+r.itemHeight)),e.itemTop=actualItemTop,Dt(e);if(Lt(n.chartContent,kt(s,r)),Xt(s,n.chartContent,r),jt(s,r)&&Ut(s),o>=s.length&&(o=s.length-1),o>=0){for(f=0;f<o;f++)bt(s[f]);Zt(s[o],s,n,r)}Ot(s,n.chartContentContainer,r)},Ri=function(e,n){return function(o){typeof o===t&&(o=e);var r=o.ownerDocument,l=(o=r.createElementNS("http://www.w3.org/2000/svg","defs"),r.createElementNS("http://www.w3.org/2000/svg","linearGradient"));l.setAttribute("id","BlueGradient"),l.setAttribute("x1","0%"),l.setAttribute("y1","0%"),l.setAttribute("x2","0%"),l.setAttribute("y2","100%");var y=r.createElementNS("http://www.w3.org/2000/svg","stop");y.setAttribute("offset","0%"),y.setAttribute("style","stop-color: White");var d=r.createElementNS("http://www.w3.org/2000/svg","stop");d.setAttribute("offset","25%"),d.setAttribute("style","stop-color: LightBlue");var u=r.createElementNS("http://www.w3.org/2000/svg","stop");u.setAttribute("offset","100%"),u.setAttribute("style","stop-color: Blue"),l.appendChild(y),l.appendChild(d),l.appendChild(u),o.appendChild(l),(l=r.createElementNS("http://www.w3.org/2000/svg","linearGradient")).setAttribute("id","BlackGradient"),l.setAttribute("x1","0%"),l.setAttribute("y1","0%"),l.setAttribute("x2","0%"),l.setAttribute("y2","100%"),(y=r.createElementNS("http://www.w3.org/2000/svg","stop")).setAttribute("offset","0%"),y.setAttribute("style","stop-color: Black"),(d=r.createElementNS("http://www.w3.org/2000/svg","stop")).setAttribute("offset","10%"),d.setAttribute("style","stop-color: White"),(u=r.createElementNS("http://www.w3.org/2000/svg","stop")).setAttribute("offset","20%"),u.setAttribute("style","stop-color: Gray");var p=r.createElementNS("http://www.w3.org/2000/svg","stop");return"Aero"===(p.setAttribute("offset","60%"),p.setAttribute("style","stop-color: Black"),l.appendChild(y),l.appendChild(d),l.appendChild(u),l.appendChild(p),o.appendChild(l),(l=r.createElementNS("http://www.w3.org/2000/svg","marker")).setAttribute("id","ArrowMarker"),l.setAttribute("viewBox","0 0 10 10"),l.setAttribute("refX","0"),l.setAttribute("refY","5"),l.setAttribute("markerUnits","strokeWidth"),l.setAttribute("markerWidth",(4.5*(n.arrowSize?n.arrowSize:1)).toString()),l.setAttribute("markerHeight",(3.5*(n.arrowSize?n.arrowSize:1)).toString()),l.setAttribute("orient","auto"),r=r.createElementNS("http://www.w3.org/2000/svg","path"),n.theme)?r.setAttribute("fill","Blue"):r.setAttribute("fill","#3b87d9"),r.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),r.setAttribute("fill",n.arrowFill?n.arrowFill:"Aero"==n.theme?"Blue":"#3b87d9"),l.appendChild(r),o.appendChild(l),o}},Wi=function(e){return function(n){var s=n.ganttChartView,r=n.ganttChartView.ownerDocument,o=r.createElementNS("http://www.w3.org/2000/svg","title");if(o.appendChild(H(r,n.content)),typeof e.areToolTipsSimplified===t||!e.areToolTipsSimplified)if(typeof n.loadChartView===t){if(typeof n.scheduleChartView===t&&n.parent&&(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Parent: "+n.parent.content))),typeof n.scheduleChartView!==t&&n.scheduleChartItem&&(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Row: "+n.scheduleChartItem.content))),n.hasChildren&&(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Children: "+n.children.length))),o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode((n.isMilestone?"":"Start: ")+e.dateTimeFormatter(c(n.start)))),n.isMilestone||(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Finish: "+e.dateTimeFormatter(c(n.finish))))),e.areTaskAssignmentsVisible&&n.assignmentsContent&&(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Assignments: "+n.assignmentsContent))),n.isMilestone||(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Effort: "+s.getItemTotalEffort(n)/36e5+"h")),e.isTaskCompletedEffortVisible&&(s=s.getItemCompletion(n),isNaN(s)||(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Completed: "+Math.round(100*s*(e.integralCompletionPercents?1:100))/(e.integralCompletionPercents?1:100)+"%"))))),e.areTaskDependenciesVisible&&n.predecessors&&n.predecessors.length>0){o.appendChild(r.createTextNode("\n")),s="";for(var l=0;l<n.predecessors.length;l++){var y=n.predecessors[l];y.item&&(s.length>0&&(s+=", "),s+=y.item.content,y.dependencyType&&(s=s+" ("+Zi(y.dependencyType)+")"))}o.appendChild(r.createTextNode("Predecessors: "+s))}}else isNaN(n.units)||(o.appendChild(r.createTextNode("\n")),o.appendChild(r.createTextNode("Allocation: "+Math.round(1e4*n.units)/100+"%")));return o}},Ni=function(e){return function(n){var s=n.ganttChartView,r=typeof e!==t?e:s.settings;if(r.areResourceImagesVisibleAsAssignments){var o=s.chartContent.childNodes[0].childNodes[0];if(!s.chartContent.hasClipPathForResourceImagesBeenInitialized){var l=document.createElementNS("http://www.w3.org/2000/svg","clipPath");l.setAttribute("id","resourceImageClipPath"),l.setAttribute("clipPathUnits","objectBoundingBox");var y=document.createElementNS("http://www.w3.org/2000/svg","circle");y.setAttribute("cx",.5),y.setAttribute("cy",.5),y.setAttribute("r",.5),l.appendChild(y),o.appendChild(l),s.chartContent.hasClipPathForResourceImagesBeenInitialized=!0}var d=document.createElementNS("http://www.w3.org/2000/svg","g");d.setAttribute("id","assignmentsGroup");var u=(u=q(n.finish,r))+(r.classic||n.hasChildren||n.isMilestone?0:12-Math.min(12,u-q(n.start,r)));(n.isMilestone||n.hasChildren&&(typeof n.isSummaryEnabled===t||n.isSummaryEnabled))&&(u+=r.barHeight/2),!n.isMilestone&&(!n.hasChildren||!(typeof n.isSummaryEnabled===t||n.isSummaryEnabled))&&(u+=r.itemHeight-10),n.isMilestone&&(u+=3);var p=0;return Ct(n).forEach(function(f){var C,T=f.key;if(typeof r.resourceImageUrls!==t&&(k=lt(r.resourceImageUrls,T))>=0&&(C=r.resourceImageUrls[k].value),C&&r.itemHeight>4){var k=r.itemHeight-4,V=document.createElementNS("http://www.w3.org/2000/svg","image");V.setAttribute("x",u+28*p),V.setAttribute("y",2),V.setAttribute("width",k+"px"),V.setAttribute("height",k+"px"),n.isExported&&0!=C.indexOf("://")&&(k=0!=C.indexOf("/")?window.location.pathname.substr(0,window.location.pathname.lastIndexOf("/")+1):"",C=window.location.protocol+"//"+window.location.host+k+C),V.setAttribute("href",C),V.setAttribute("clip-path","url(#resourceImageClipPath)"),d.appendChild(V);var E=1!=f.value?" "+Math.round(1e4*f.value)/100+"%":"";DlhSoft.Controls.ToolTip&&r.useInlineToolTips?(V.addEventListener("mouseover",oe(s,V,"mouseover",function(B){1!=B.buttons&&((B=s.toolTip)&&(B.disable(),B.hide()),(B=DlhSoft.Controls.ToolTip.get(V))||(B=DlhSoft.Controls.ToolTip.initialize(void 0,V,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+r.border+"; background-color: White; color: Black; font-family: "+(r.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),B.setContent(T+E),B.show(),s.resourceToolTip=B)})),V.addEventListener("mouseout",oe(s,V,"mouseout",function(){var B=s.resourceToolTip;B&&B.hide()}))):((f=document.createElementNS("http://www.w3.org/2000/svg","title")).appendChild(document.createTextNode(T+E)),V.appendChild(f))}p++}),d}return o=document.createElementNS("http://www.w3.org/2000/svg","text"),u=q(n.finish,r),u+=r.classic||n.hasChildren||n.isMilestone?0:12-Math.min(12,u-q(n.start,r)),(n.isMilestone||n.hasChildren&&(typeof n.isSummaryEnabled===t||n.isSummaryEnabled))&&(u+=r.barHeight/2),o.setAttribute("x",u+7),o.setAttribute("y",r.barMargin+r.barHeight/2),o.setAttribute("dominant-baseline","central"),typeof(l="Phone"!=r.target?n.assignmentsContent:n.content)===t&&(l=""),o.appendChild(document.createTextNode(l)),typeof r.assignmentsClass!==t?o.setAttribute("class",r.assignmentsClass):typeof r.assignmentsStyle!==t&&o.setAttribute("style",r.assignmentsStyle),o}},pi=function(e){var n=e.ganttChartView.ownerDocument;for(typeof e.chartItemArea===t&&(e.chartItemArea=n.createElementNS("http://www.w3.org/2000/svg","g")),n=e.chartItemArea.childNodes.length;n-- >0;)e.chartItemArea.removeChild(e.chartItemArea.childNodes[n]);return e.chartItemArea},hi=function(e,n,s,T,o){var l,y=(p=(l=e.ganttChartView).settings).barMargin,d=p.barHeight,u=p.barHeight,p=n.childNodes.length-6,f=null!=T?T-s-4-(e.hasChildren?4:0):200;return(T=(l=l.ownerDocument).createElementNS("http://www.w3.org/2000/svg","foreignObject")).setAttribute("width",f),T.setAttribute("height",u),e.isMilestone?(T.setAttribute("x",s-200-d),T.setAttribute("y",y),T.setAttribute("style","line-height: "+u+"px; text-overflow: ellipsis; white-space: nowrap; text-align: right; font-size: "+(d/2+1)+"px; color: "+o)):e.hasChildren?(T.setAttribute("x",s+4),T.setAttribute("y",y),T.setAttribute("style","line-height: "+2*u/3+"px; text-overflow: ellipsis; white-space: nowrap; font-size: "+d/2+"px; color: "+o)):(T.setAttribute("x",s+2),T.setAttribute("y",y),T.setAttribute("style","line-height: "+u+"px; text-overflow: ellipsis; white-space: nowrap; font-size: "+(d/2+1)+"px; color: "+o)),s=l.createElement("div"),e=l.createTextNode(e.label),s.appendChild(e),T.appendChild(s),n.insertBefore(T,n.childNodes[p]),s},zi=function(e,n,s){return function(r){var o=typeof n!==t?n:r.ganttChartView,l=typeof s!==t?s:o.settings,y=typeof e!==t?e:o.items,d=o.ownerDocument,u=pi(r);if(l.isBaselineVisible&&typeof r.baselineStart!==t&&typeof r.baselineFinish!==t){var f=q(r.baselineStart,l),T=Math.max(q(r.baselineFinish,l),f+(l.classic?4:12));(p=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",f),p.setAttribute("y",l.barMargin/2),p.setAttribute("width",Math.max(0,T-f-1)),p.setAttribute("height",l.barHeight),p.setAttribute("rx",l.barCornerRadius),p.setAttribute("ry",l.barCornerRadius),f=l.baselineBarClass,typeof r.baselineBarClass!==t&&(f=r.baselineBarClass),typeof f!==t?p.setAttribute("class",f):(f=l.baselineBarStyle,typeof r.baselineBarStyle!==t&&(f=r.baselineBarStyle),typeof f!==t&&p.setAttribute("style",f)),u.appendChild(p)}var p=q(r.start,l),C=(f=Math.max(q(r.finish,l),p+(l.classic?4:12)),T=l.percentBasedCompletionBar&&r.finish.valueOf()!=r.start.valueOf()?p+o.getItemCompletion(r)*(f-p):q(r.completedFinish,l),d.createElementNS("http://www.w3.org/2000/svg","rect"));C.setAttribute("x",p),C.setAttribute("y",l.barMargin),C.setAttribute("width",Math.max(0,f-p-1)),C.setAttribute("height",l.barHeight),C.setAttribute("rx",l.barCornerRadius),C.setAttribute("ry",l.barCornerRadius);var k=l.standardBarClass;if(typeof r.standardBarClass!==t&&(k=r.standardBarClass),typeof r.barClass!==t&&(k=r.barClass),typeof k!==t?C.setAttribute("class",k):(k=l.standardBarStyle,typeof r.standardBarStyle!==t&&(k=r.standardBarStyle),typeof r.barStyle!==t&&(k=r.barStyle),typeof k!==t&&C.setAttribute("style",k)),l.isTaskToolTipVisible&&DlhSoft.Controls.ToolTip&&l.useInlineToolTips&&(u.addEventListener("mouseover",oe(o,u,"mouseover",function(_){1!=_.buttons&&((_=o.toolTip)&&(_.disable(),_.hide()),(_=DlhSoft.Controls.ToolTip.get(C))||(_=DlhSoft.Controls.ToolTip.initialize(void 0,C,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: "+(l.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),_.setContent(l.itemTemplate(r).innerHTML.replaceAll("\n","<br/>")),_.show(),o.taskToolTip=_)})),u.addEventListener("mouseout",oe(o,u,"mouseout",function(){var _=o.taskToolTip;_.disable(),_.hide()}))),u.appendChild(C),l.isTaskCompletedEffortVisible){(k=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",p+.65),k.setAttribute("y",l.barMargin+l.completedBarMargin-.65),k.setAttribute("width",Math.max(0,T-p-1-1.3)),k.setAttribute("height",l.completedBarHeight+1.3),k.setAttribute("rx",l.completedBarCornerRadius),k.setAttribute("ry",l.completedBarCornerRadius);var V=l.standardCompletedBarClass;typeof r.standardCompletedBarClass!==t&&(V=r.standardCompletedBarClass),typeof r.completedBarClass!==t&&(V=r.completedBarClass),typeof V!==t?k.setAttribute("class",V):(V=l.standardCompletedBarStyle,typeof r.standardCompletedBarStyle!==t&&(V=r.standardCompletedBarStyle),typeof r.completedBarStyle!==t&&(V=r.completedBarStyle),typeof V!==t&&k.setAttribute("style",V)),u.appendChild(k)}if(l.areStandardTaskLabelsVisible&&r.label&&(k=hi(r,u,p,f,r.labelColor?r.labelColor:l.standardLabelColor?l.standardLabelColor:"black"),V=l.standardLabelClass,typeof r.labelClass!==t&&(V=r.labelClass),typeof V!==t?k.setAttribute("class",V):(V=l.standardLabelStyle,typeof r.labelStyle!==t&&(V=r.labelStyle),typeof V!==t&&k.setAttribute("style",V))),!(l.isReadOnly||l.isChartReadOnly||typeof r.isReadOnly!==t&&r.isReadOnly||typeof r.isBarReadOnly!==t&&r.isBarReadOnly)){var E,R;if((k=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",p),k.setAttribute("y",l.barMargin),k.setAttribute("width",Math.max(0,f-p-1)),k.setAttribute("height",l.barHeight),k.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),l.isTaskStartReadOnly||u.appendChild(k),(V=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",p-4),V.setAttribute("y",l.barMargin),V.setAttribute("width",l.classic?4:8),V.setAttribute("height",l.barHeight),V.setAttribute("style","fill: White; fill-opacity: 0; cursor: "+(l.classic?"w-resize":"ew-resize")),l.isDraggingTaskStartEndsEnabled&&!l.isTaskStartReadOnly&&"TouchEnabled"!=l.interaction&&u.appendChild(V),(E=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",f-4),E.setAttribute("y",l.barMargin),E.setAttribute("width",8),E.setAttribute("height",l.barHeight),E.setAttribute("style","fill: White; fill-opacity: 0; cursor: "+(l.classic?"e-resize":"ew-resize")),!l.isTaskEffortReadOnly&&"TouchEnabled"!=l.interaction&&u.appendChild(E),l.classic)(R=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",T-2),R.setAttribute("y",l.barMargin),R.setAttribute("width",6),R.setAttribute("height",l.barHeight),R.setAttribute("style","fill: White; fill-opacity: 0; cursor: ew-resize");else{R=d.createElementNS("http://www.w3.org/2000/svg","g");var B=d.createElementNS("http://www.w3.org/2000/svg","polygon");R.appendChild(B);var N=Math.max(T-1-10,p),ee=Math.min(T-1+10,f-1);B.setAttribute("points",N+","+(l.itemHeight-l.barMargin)+" "+ee+","+(l.itemHeight-l.barMargin)+" "+(T-1<p+10?p:T-1>f-1-10?f-1:Math.min(Math.max(T-1,p),f-2))+","+(l.itemHeight-l.barMargin-l.barHeight/2)),B.setAttribute("style","fill: White; fill-opacity: 0; cursor: ew-resize"),B=d.createElementNS("http://www.w3.org/2000/svg","rect"),R.appendChild(B),N=Math.max(p,T-10),(ee=Math.min(20,f-T))<20&&(N-=10-ee,ee=20),B.setAttribute("x",N),B.setAttribute("y",l.itemHeight/2),B.setAttribute("width",ee),B.setAttribute("height",l.itemHeight/2),B.setAttribute("style","fill: White; fill-opacity: 0;")}N=typeof l.areToolTipsSimplified!==t&&l.areToolTipsSimplified?NaN:o.getItemCompletion(r);var X=isNaN(N)?"":Math.round(100*N*(l.integralCompletionPercents?1:100))/(l.integralCompletionPercents?1:100)+"%";!l.isTaskCompletionReadOnly&&l.isTaskCompletedEffortVisible&&"TouchEnabled"!=l.interaction&&(u.appendChild(R),X&&DlhSoft.Controls.ToolTip&&l.useInlineToolTips?(R.addEventListener("mouseover",oe(o,R,"mouseover",function(re){1==re.buttons&&"CompletedFinish"!=o.dragType||((re=o.toolTip)&&(re.disable(),re.hide()),(re=DlhSoft.Controls.ToolTip.get(R))||(re=DlhSoft.Controls.ToolTip.initialize(void 0,R,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: "+(l.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),re.setContent(X),re.show(),o.taskCompletionToolTip=re)})),R.addEventListener("mouseout",oe(o,R,"mouseout",function(){var re=o.taskCompletionToolTip;re.disable(),re.hide()}))):((N=d.createElementNS("http://www.w3.org/2000/svg","title")).appendChild(H(d,X)),R.appendChild(N))),vi(k,V,E,R,r,p,f,T,y,o,l),l.areTaskDependenciesVisible&&!l.areTaskPredecessorsReadOnly&&!r.isPart&&(T=null,(typeof l.allowCreatingStartDependencies===t||l.allowCreatingStartDependencies)&&((T=d.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",p-(l.classic?0:8)),T.setAttribute("cy",l.barMargin+l.barHeight/2),T.setAttribute("r",l.barHeight/(l.classic?4:3)),T.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),u.appendChild(T)),(d=d.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",f-2+(l.classic?0:9)),d.setAttribute("cy",l.barMargin+l.barHeight/2),d.setAttribute("r",l.barHeight/(l.classic?4:3)),d.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer;"),u.appendChild(d),ti(d,T,u,r,l.barMargin+l.barHeight/2,f-2,p,y,o,l))}return u}},Gi=function(e,n,s){return function(r){var o=typeof n!==t?n:r.ganttChartView,l=typeof s!==t?s:o.settings,y=typeof e!==t?e:o.items,d=o.ownerDocument,u=pi(r),p=q(r.start,l),f=q(r.finish,l),N=2.15*l.barHeight/3,T=d.createElementNS("http://www.w3.org/2000/svg","rect");T.setAttribute("x",p),T.setAttribute("y",l.barMargin),T.setAttribute("width",Math.max(0,f-p-1)),T.setAttribute("height",N);var C=l.summaryBarClass;if(typeof r.summaryBarClass!==t&&(C=r.summaryBarClass),typeof r.barClass!==t&&(C=r.barClass),typeof C!==t)T.setAttribute("class",C);else{var k=l.summaryBarStyle;typeof r.summaryBarStyle!==t&&(k=r.summaryBarStyle),typeof r.barStyle!==t&&(k=r.barStyle),typeof k!==t&&T.setAttribute("style",k)}if(u.appendChild(T),l.isTaskToolTipVisible&&DlhSoft.Controls.ToolTip&&l.useInlineToolTips&&(u.addEventListener("mouseover",oe(o,u,"mouseover",function(X){1!=X.buttons&&((X=o.toolTip)&&(X.disable(),X.hide()),(X=DlhSoft.Controls.ToolTip.get(T))||(X=DlhSoft.Controls.ToolTip.initialize(void 0,T,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: "+(l.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),X.setContent(l.itemTemplate(r).innerHTML.replaceAll("\n","<br/>")),X.show(),o.taskToolTip=X)})),u.addEventListener("mouseout",oe(o,T,"mouseout",function(){var X=o.taskToolTip;X.disable(),X.hide()}))),l.isTaskCompletedEffortVisible&&l.isSummaryTaskCompletedEffortVisible){(E=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",p),E.setAttribute("y",l.barMargin+2.15*l.completedBarMargin/3),E.setAttribute("width",Math.max(0,f-p-1)*o.getItemCompletion(r)),E.setAttribute("height",2.15*l.completedBarHeight/3),E.setAttribute("rx",l.completedBarCornerRadius),E.setAttribute("ry",l.completedBarCornerRadius);var V=l.summaryCompletedBarClass;typeof r.summaryCompletedBarClass!==t&&(V=r.summaryCompletedBarClass),typeof r.completedBarClass!==t&&(V=r.completedBarClass),typeof V!==t?E.setAttribute("class",V):(V=l.summaryCompletedBarStyle,typeof r.summaryCompletedBarStyle!==t&&(V=r.summaryCompletedBarStyle),typeof r.completedBarStyle!==t&&(V=r.completedBarStyle),typeof V!==t&&E.setAttribute("style",V)),u.appendChild(E)}r.isExpanded||((E=d.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",p),E.setAttribute("y1",l.barMargin+N+2.5),E.setAttribute("x2",f-1),E.setAttribute("y2",l.barMargin+N+2.5),V=l.collapsedSummaryLineClass,typeof r.collapsedSummaryLineClass!==t&&(V=r.collapsedSummaryLineClass),typeof V!==t?E.setAttribute("class",V):(V=l.collapsedSummaryLineStyle,typeof r.collapsedSummaryLineStyle!==t&&(V=r.collapsedSummaryLineStyle),typeof V!==t&&E.setAttribute("style",V)),u.appendChild(E)),V=d.createElementNS("http://www.w3.org/2000/svg","polygon");var E,R=N+1.5,B=3*l.barHeight/4,ee=l.barHeight/4;return V.setAttribute("points",(N=p-1-l.barHeight/3)+","+(E=l.barMargin-.25)+" "+N+","+(E+R)+" "+(N+B/2)+","+(E+R+ee)+" "+(N+B)+","+(E+R)+" "+(N+B)+","+E),typeof C!==t&&V.setAttribute("class",C),typeof k!==t&&V.setAttribute("style",k),u.appendChild(V),(V=d.createElementNS("http://www.w3.org/2000/svg","polygon")).setAttribute("points",(N=f+l.barHeight/3)+","+E+" "+N+","+(E+R)+" "+(N-B/2)+","+(E+R+ee)+" "+(N-B)+","+(E+R)+" "+(N-B)+","+E),typeof C!==t&&V.setAttribute("class",C),typeof k!==t&&V.setAttribute("style",k),u.appendChild(V),l.areSummaryTaskLabelsVisible&&r.label&&(C=hi(r,u,p,f,r.labelColor?r.labelColor:l.summaryLabelColor?l.summaryLabelColor:"white"),k=l.summaryLabelClass,typeof r.labelClass!==t&&(k=r.labelClass),typeof k!==t?C.setAttribute("class",k):(k=l.summaryLabelStyle,typeof r.labelStyle!==t&&(k=r.labelStyle),typeof k!==t&&C.setAttribute("style",k))),!l.isReadOnly&&!l.isChartReadOnly&&(typeof r.isReadOnly===t||!r.isReadOnly)&&(typeof r.isBarReadOnly===t||!r.isBarReadOnly)&&l.areTaskDependenciesVisible&&!l.areTaskPredecessorsReadOnly&&!r.isPart&&(C=null,(typeof l.allowCreatingStartDependencies===t||l.allowCreatingStartDependencies)&&((C=d.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",p-.5),C.setAttribute("cy",l.barMargin+l.barHeight/2),C.setAttribute("r",l.barHeight/(l.classic?4:3)),C.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),u.appendChild(C)),(d=d.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",f-.5),d.setAttribute("cy",l.barMargin+l.barHeight/2),d.setAttribute("r",l.barHeight/(l.classic?4:3)),d.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),u.appendChild(d),ti(d,C,u,r,l.barMargin+l.barHeight/2,f-1.5,p,y,o,l)),u}},Xi=function(e,n,s){return function(r){var o=typeof n!==t?n:r.ganttChartView,l=typeof s!==t?s:o.settings,y=typeof e!==t?e:o.items,d=o.ownerDocument,u=pi(r);if(l.isBaselineVisible&&typeof r.baselineStart!==t){var f=q(r.baselineStart,l),C=d.createElementNS("http://www.w3.org/2000/svg","polygon"),p=l.barHeight+1;if(C.setAttribute("points",f+","+(k=l.barMargin-1)+" "+(f-p/2)+","+(k+p/2)+" "+f+","+(k+p)+" "+(f+p/2)+","+(k+p/2)),f=l.baselineBarClass,typeof r.baselineBarClass!==t&&(f=r.baselineBarClass),typeof f!==t)C.setAttribute("class",f);else{var V=l.baselineBarStyle;typeof r.baselineBarStyle!==t&&(V=r.baselineBarStyle)}C.setAttribute("style",V),u.appendChild(C)}f=q(r.start,l);var k,T=d.createElementNS("http://www.w3.org/2000/svg","polygon");return T.setAttribute("points",(C=f-1)+","+(k=l.barMargin)+" "+(C-(V=l.barHeight+1)/2)+","+(k+V/2)+" "+C+","+(k+V)+" "+(C+V/2)+","+(k+V/2)),k=l.milestoneBarClass,typeof r.milestoneBarClass!==t&&(k=r.milestoneBarClass),typeof r.barClass!==t&&(k=r.barClass),typeof k!==t?T.setAttribute("class",k):(k=l.milestoneBarStyle,typeof r.milestoneBarStyle!==t&&(k=r.milestoneBarStyle),typeof r.barStyle!==t&&(k=r.barStyle),typeof k!==t&&T.setAttribute("style",k)),u.appendChild(T),l.isTaskToolTipVisible&&DlhSoft.Controls.ToolTip&&l.useInlineToolTips&&(u.addEventListener("mouseover",oe(o,u,"mouseover",function(E){1!=E.buttons&&((E=o.toolTip)&&(E.disable(),E.hide()),(E=DlhSoft.Controls.ToolTip.get(T))||(E=DlhSoft.Controls.ToolTip.initialize(void 0,T,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: "+(l.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),E.setContent(l.itemTemplate(r).innerHTML.replaceAll("\n","<br/>")),E.show(),o.taskToolTip=E)})),u.addEventListener("mouseout",oe(o,u,"mouseout",function(){var E=o.taskToolTip;E.disable(),E.hide()}))),l.areMilestoneTaskLabelsVisible&&r.label&&(f=hi(r,u,f,null,r.labelColor?r.labelColor:l.milestoneLabelColor?l.milestoneLabelColor:"black"),k=l.milestoneLabelClass,typeof r.labelClass!==t&&(k=r.labelClass),typeof k!==t?f.setAttribute("class",k):(k=l.milestoneLabelStyle,typeof r.labelStyle!==t&&(k=r.labelStyle),typeof k!==t&&f.setAttribute("style",k))),!l.isReadOnly&&!l.isChartReadOnly&&(typeof r.isReadOnly===t||!r.isReadOnly)&&(typeof r.isBarReadOnly===t||!r.isBarReadOnly)&&((f=d.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",C-V/2),f.setAttribute("y",l.barMargin),f.setAttribute("width",V),f.setAttribute("height",V),f.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),u.appendChild(f),vi(f,null,null,null,r,C,C,C,y,o,l),l.areTaskDependenciesVisible&&!l.areTaskPredecessorsReadOnly&&!r.isPart&&((d=d.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",C),d.setAttribute("cy",l.barMargin+l.barHeight/2+(l.classic?0:.5)),d.setAttribute("r",l.barHeight/(l.classic?4:3)),d.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),u.appendChild(d),ti(d,null,u,r,l.barMargin+l.barHeight/2,C,C,y,o,l))),u}},Yi=function(e,n){return function(s,r){var o=s.ganttChartView,l=typeof n!==t?n:o.settings,u=typeof e!==t?e:o.items,y=o.ownerDocument,d=y.createElementNS("http://www.w3.org/2000/svg","g"),p=(u=In(s,r,u,l),y.createElementNS("http://www.w3.org/2000/svg","path"));p.setAttribute("d",u),typeof l.dependencyLineZoneClass!==t&&p.setAttribute("class",l.dependencyLineZoneClass),typeof l.dependencyLineZoneStyle!==t&&p.setAttribute("style",l.dependencyLineZoneStyle),d.appendChild(p);var f=y.createElementNS("http://www.w3.org/2000/svg","path");return f.setAttribute("d",u),y=l.dependencyLineClass,typeof r.dependencyLineClass!==t&&(y=r.dependencyLineClass),typeof y!==t?f.setAttribute("class",y):(y=l.dependencyLineStyle,typeof r.dependencyLineStyle!==t&&(y=r.dependencyLineStyle),typeof y!==t&&f.setAttribute("style",y)),d.appendChild(f),l.isDependencyToolTipVisible&&DlhSoft.Controls.ToolTip&&l.useInlineToolTips&&l.useInlineToolTipsForDependencies&&(d.addEventListener("mouseover",oe(o,d,"mouseover",function(T){var C=o.dependencyToolTip;C&&(C.disable(),C.hide()),(C=DlhSoft.Controls.ToolTip.get(f))||(C=DlhSoft.Controls.ToolTip.initialize(void 0,f,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+l.border+"; background-color: White; color: Black; font-family: "+(l.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),C.setContent(l.predecessorItemTemplate(s,r).innerHTML.replaceAll("\n","<br/>")),C.show();var k=d.getBoundingClientRect();C.setHorizontalPosition(C.x+T.clientX-k.left),C.setVerticalPosition(C.y+T.clientY-k.bottom+10),o.dependencyToolTip=C})),d.addEventListener("mouseout",oe(o,d,"mouseout",function(){var T=o.dependencyToolTip;T.disable(),T.hide()}))),d}},Ui=function(e){return function(n,s){var r=n.ganttChartView.ownerDocument,o=r.createElementNS("http://www.w3.org/2000/svg","title");return o.appendChild(H(r,s.item.content+" - "+n.content)),(typeof e.areToolTipsSimplified===t||!e.areToolTipsSimplified)&&(s.dependencyType&&(o.appendChild(r.createTextNode("\n")),o.appendChild(H(r,"Type: "+Zi(s.dependencyType)))),s.lag&&(o.appendChild(r.createTextNode("\n")),o.appendChild(H(r,"Lag: "+s.lag/36e5+"h")))),o}},Zi=function(e){switch(e){case"StartStart":case"SS":return"SS";case"FinishFinish":case"FF":return"FF";case"StartFinish":case"SF":return"SF";default:return"FS"}},In=function(e,n,y,r){var d,u,V,o=Et(n.item,y,r),l=Et(e,y,r),p=(y="M ",r.itemHeight),f=p/2,T=p/3.5,C=2,k=!1;return o!=l||typeof n.dependencyType!==t&&"FinishStart"!=n.dependencyType&&"FS"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?(typeof n.dependencyType===t||"StartStart"!=n.dependencyType&&"SS"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?(d=q(n.item.finish,r)-1,n.item.hasChildren&&(typeof n.item.isSummaryEnabled===t||n.item.isSummaryEnabled)?d+=r.barHeight/3+.25:n.item.isMilestone?d+=p/4:d<(V=q(n.item.start,r)+(r.classic?4:12)-1)&&(d=V),u=d+T):(d=q(n.item.start,r),n.item.hasChildren&&(typeof n.item.isSummaryEnabled===t||n.item.isSummaryEnabled)?d-=r.barHeight/3+.25:n.item.isMilestone&&(d-=p/4),u=d-T),y=y+(d+" ")+((o=o-l+.5)+f)+" L "+u+" "+(o+f),typeof n.dependencyType===t||"FinishFinish"!=n.dependencyType&&"FF"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?(d=q(e.start,r),typeof n.dependencyType===t||"StartStart"!=n.dependencyType&&"SS"!=n.dependencyType?e.isMilestone?l=d-1:(l=d+1.5,V=q(e.finish,r),l<u&&V-u>2*T&&e.start>=n.item.finish&&(l=u)):(k=!0,e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)?d-=r.barHeight/3+1:e.isMilestone&&(d-=p/4+1),l=d-T)):(d=q(e.finish,r)-1,typeof n.dependencyType===t||"FinishFinish"!=n.dependencyType&&"FF"!=n.dependencyType?e.isMilestone?l=d:(d<(V=q(e.start,r)+(r.classic?4:12))&&(d=V),l=d-2.5):(k=!0,e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)?d+=r.barHeight/3+1:e.isMilestone?d+=p/4+1:d<(V=q(e.start,r)+(r.classic?4:12)-1)&&(d=V),l=d+T)),typeof n.dependencyType===t||"StartStart"!=n.dependencyType&&"SS"!=n.dependencyType&&"StartFinish"!=n.dependencyType&&"SF"!=n.dependencyType?l<u&&(y=y+" "+u+" "+((o=(o-=T/6)<=0?o+f:o-f)+f)):l>u&&(y=y+" "+u+" "+((o=(o-=T/6)<=0?o+f:o-f)+f)),y=y+" "+l+" "+(o+f),o=k?f+.5:o<=0?r.barMargin-1-C:p-r.barMargin+1+C,k&&(l>d-C&&(C=-C),d-=C),y=y+" "+l+" "+o,k&&(y=y+" "+d+" "+o)):(typeof n.dependencyType===t||"FinishStart"==n.dependencyType||"FS"==n.dependencyType?(d=q(n.item.finish,r),n.item.isMilestone&&(d+=r.barHeight/3+.25),u=q(e.start,r),e.isMilestone&&(u-=r.barHeight/3+.25)):(d=q(n.item.start,r),n.item.isMilestone&&(d-=r.barHeight/3+.25),u=q(e.finish,r),e.isMilestone&&(u+=r.barHeight/3+.25)),y=y+(d+" ")+((o=o-l+.5)+f)+" L "+(u+(u>d?-1:1)*(p/5-1))+" "+(o+f)),y},le=function(e,n,s,r){if(typeof e.ganttChartView!==t){var o=e.ganttChartView,l=o.settings;if("start"==n||"minStart"==n||"maxStart"==n?(typeof e.minStart!==t&&e.start<e.minStart?(e.start=e.minStart,typeof e.loadChartItem===t&&(e.start=Ze(e.start,l,!0,typeof e.isMilestone!==t&&e.isMilestone,ce(e))),s&&(e.preferredStart=e.start)):typeof e.maxStart!==t&&e.start>e.maxStart&&(e.start=e.maxStart,typeof e.loadChartItem===t&&(e.start=Ze(e.start,l,!0,typeof e.isMilestone!==t&&e.isMilestone,ce(e))),s&&(e.preferredStart=e.start)),e.finish<e.start&&(e.finish=e.start,le(e,"finish",!1,!0)),e.completedFinish<e.start?(e.completedFinish=e.start,le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,le(e,"completedFinish",!1,!0))):("finish"==n||"minFinish"==n||"maxFinish"==n)&&(typeof e.maxFinish!==t&&e.finish>e.maxFinish?(e.finish=e.maxFinish,typeof e.loadChartItem===t&&(e.finish=Ze(e.finish,l,typeof e.isMilestone!==t&&e.isMilestone,!0,ce(e)))):typeof e.minFinish!==t&&e.finish<e.minFinish&&(e.finish=e.minFinish,typeof e.loadChartItem===t&&(e.finish=Ze(e.finish,l,typeof e.isMilestone!==t&&e.isMilestone,!0,ce(e)))),e.finish<e.start&&(e.finish=e.start,le(e,"finish",!1,!0)),e.completedFinish<e.start?(e.completedFinish=e.start,le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,le(e,"completedFinish",!1,!0))),o.isTimingInformationInitialized){var d,u,y=o.items;if("indentation"==n||"predecessors"==n)for(d=0;d<y.length;d++)typeof(u=y[d]).dependsOf!==t&&delete u.dependsOf;if("predecessors"==n&&l.alwaysHandleInvalidDependencies)typeof(u=e).predecessors!==t&&u.predecessors.length>0&&Ht(u,y,l,o,!0);else if(("predecessors"==n||"start"==n||"finish"==n)&&typeof e.isDuringPropertyChangeTaskDependencyConstraintsEnsuring===t&&l.areTaskDependencyConstraintsEnabled&&(l.areTaskDependencyConstraintsEnabledWhileDragging||typeof o.isDuringTimeDragOperation===t)){for(e.isDuringPropertyChangeTaskDependencyConstraintsEnsuring=!0,u=e.parent;null!=u;)typeof u.predecessors!==t&&u.predecessors.length>0&&Ht(u,y,l,o),u=u.parent;for(typeof(u=e).predecessors!==t&&u.predecessors.length>0?Ht(u,y,l,o):ci(u,l);null!=u;){if(typeof u.successors===t)for(u.successors=[],d=0;d<y.length;d++){var p=y[d];if(p!=u&&typeof p.predecessors!==t&&0!=p.predecessors.length)for(var f=0;f<p.predecessors.length;f++)if(p.predecessors[f].item==u){u.successors.push(p);break}}for(d=0;d<u.successors.length;d++)Ht(u.successors[d],y,l,o);u=u.parent}delete e.isDuringPropertyChangeTaskDependencyConstraintsEnsuring}e.isPart&&e.ganttChartItem&&le(e.ganttChartItem,"parts",!1,!0)}if("assignmentsContent"==n&&!e.hasChildren&&e.hasFixedEffort&&typeof e.fixedEffortAssignments!==t&&e.fixedEffortUpdatesFinish){for(p=u=0,y=o.getItemAssignments(e),d=0;d<y.length;d++)u+=y[d].value;for(d=0;d<e.fixedEffortAssignments.length;d++)p+=e.fixedEffortAssignments[d].value;u<=0&&(u=1),p<=0&&(p=1),o.setItemEffort(e,o.getItemEffort(e)*p/u)}if(("start"==n||"finish"==n)&&!e.hasChildren&&e.hasFixedEffort&&typeof e.fixedEffort!==t&&!e.fixedEffortUpdatesFinish){for(u=o.getItemEffort(e)/e.fixedEffort,y="",d=0;d<e.fixedEffortAssignments.length;d++)p=e.fixedEffortAssignments[d],y.length>0&&(y+=", "),f=Math.floor(p.value/u*1e6)/1e6,y+=p.key+(1!=f?" ["+100*f+"%]":"");o.setItemAssignmentsContent(e,y)}l.itemPropertyChangeHandler(e,n,s,r),"isExpanded"==n?typeof e.ganttChartView!==t&&typeof e.ganttChartView.settings.itemExpansionChangeHandler!==t&&e.ganttChartView.settings.itemExpansionChangeHandler(e,e.isExpanded):"isSelected"==n&&typeof e.ganttChartView!==t&&typeof e.ganttChartView.settings.itemSelectionChangeHandler!==t&&e.ganttChartView.settings.itemSelectionChangeHandler(e,e.isSelected,s),typeof e.scheduleChartView!==t&&"content"==n&&e.scheduleChartView.refreshScheduleChartItem(e)}},ci=function(e,n){if(typeof e.isAwaitingPreferredStartUpdates===t)if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled))for(var s=0;s<e.children.length;s++)ci(e.children[s],n);else if(typeof e.preferredStart!==t&&e.preferredStart<e.start){e.isAwaitingPreferredStartUpdates=!0;var r=e.start.valueOf(),o=e.finish.valueOf(),l=e.completedFinish.valueOf();effort=Ge(e.start,e.finish,n,ce(e)),completedEffort=Ge(e.start,e.completedFinish,n,ce(e)),e.start=e.preferredStart,e.finish=_e(e.start,effort,n,ce(e)),e.completedFinish=_e(e.start,completedEffort,n,ce(e)),e.start.valueOf()!=r&&le(e,"start",!1,!1),e.finish.valueOf()!=o&&le(e,"finish",!1,!1),e.completedFinish.valueOf()!=l&&le(e,"completedFinish",!1,!1),setTimeout(function(){e.start.valueOf()!=r&&le(e,"start",!1,!0),e.finish.valueOf()!=o&&le(e,"finish",!1,!0),e.completedFinish.valueOf()!=l&&le(e,"completedFinish",!1,!0),(e.start.valueOf()!=r||e.finish.valueOf()!=o||e.completedFinish.valueOf()!=l)&&ot(e),delete e.isAwaitingPreferredStartUpdates},1)}},Ht=function(e,n,s,r,o){if(o){if(r.isBasicTimingInformationInitialized){o=[];var l,y=!1;for(r=0;r<e.predecessors.length;r++)typeof(l=e.predecessors[r]).item===t||n.indexOf(l.item)<0||Ft(l.item,e)?(s.invalidPredecessorDetectionHandler&&s.invalidPredecessorDetectionHandler(l,e,l.item),y=!0):o.push(l);e.predecessors=o,y&&(le(e,"predecessors",!1,!0),typeof e.ganttChartView!==t&&Bt(e))}}else if(r.isBasicTimingInformationInitialized&&(typeof e.areDependencyConstraintsEnabled===t||e.areDependencyConstraintsEnabled)){for(ci(e,s),o=[],y=!1,r=0;r<e.predecessors.length;r++)typeof(l=e.predecessors[r]).item===t||n.indexOf(l.item)<0||Ft(l.item,e)?(s.invalidPredecessorDetectionHandler&&s.invalidPredecessorDetectionHandler(l,e,l.item),y=!0):o.push(l);for(e.predecessors=o,y&&(le(e,"predecessors",!1,!0),typeof e.ganttChartView!==t&&Bt(e)),r=0;r<e.predecessors.length;r++)_i(e,l=e.predecessors[r],n,s)}},_i=function(e,n,s,r){if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled))for(var o=0;o<e.children.length;o++)_i(e.children[o],n,s,r);else if(!(typeof r.areDependencyConstraintsAppliedOnMilestones!==t&&!r.areDependencyConstraintsAppliedOnMilestones&&e.isMilestone||typeof r.areDependencyConstraintsAppliedOnStartedTasks!==t&&!r.areDependencyConstraintsAppliedOnStartedTasks&&Wt(e))){var y,l=n.item;if(s=!1,typeof n.dependencyType===t||""==n.dependencyType||"FinishStart"==n.dependencyType||"FS"==n.dependencyType){if(l=l.finish,typeof n.lag!==t&&0!=n.lag&&(l=_e(l,n.lag,r,ce(e))),e.start<l&&(!e.isMilestone&&(!e.hasChildren||!(typeof e.isSummaryEnabled===t||e.isSummaryEnabled))&&(o=Ge(e.start,e.finish,r,ce(e)),y=Ge(e.start,e.completedFinish,r,ce(e))),!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)){var d=e.start.valueOf(),u=(n=e.finish.valueOf(),e.completedFinish.valueOf());e.start=Ze(Q(l,r),r,!0,e.isMilestone,ce(e)),e.start.valueOf()!=d&&le(e,"start",!1,!0),e.isMilestone?(e.finish=e.start,e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.completedFinish=e.start):(e.finish=_e(e.start,o,r,ce(e)),e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.completedFinish=_e(e.start,y,r,ce(e))),e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0),s=!0}}else"StartStart"==n.dependencyType||"SS"==n.dependencyType?(l=l.start,typeof n.lag!==t&&0!=n.lag&&(l=_e(l,n.lag,r,ce(e))),e.start<l&&(!e.isMilestone&&(!e.hasChildren||!(typeof e.isSummaryEnabled===t||e.isSummaryEnabled))&&(o=Ge(e.start,e.finish,r,ce(e)),y=Ge(e.start,e.completedFinish,r,ce(e))),(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)&&(d=e.start.valueOf(),n=e.finish.valueOf(),u=e.completedFinish.valueOf(),e.start=Ze(Q(l,r),r,!0,e.isMilestone,ce(e)),e.start.valueOf()!=d&&le(e,"start",!1,!0),e.isMilestone?(e.finish=e.start,e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.completedFinish=e.start):(e.finish=_e(e.start,o,r,ce(e)),e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.completedFinish=_e(e.start,y,r,ce(e))),e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0),s=!0))):"FinishFinish"==n.dependencyType||"FF"==n.dependencyType?(l=l.finish,typeof n.lag!==t&&0!=n.lag&&(l=_e(l,n.lag,r,ce(e))),e.finish>l&&(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)&&(n=e.finish.valueOf(),u=e.completedFinish.valueOf(),e.finish=Ze(Q(l,r),r,e.isMilestone,!0,ce(e)),e.finish<e.start&&(e.finish=e.start),e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.isMilestone?e.completedFinish!=e.start&&(e.completedFinish=e.start,e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0)),s=!0)):("StartFinish"==n.dependencyType||"SF"==n.dependencyType)&&(l=l.start,typeof n.lag!==t&&0!=n.lag&&(l=_e(l,n.lag,r,ce(e))),e.finish>l&&(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)&&(n=e.finish.valueOf(),u=e.completedFinish.valueOf(),e.finish=Ze(Q(l,r),r,e.isMilestone,!0,ce(e)),e.finish<e.start&&(e.finish=e.start),e.finish.valueOf()!=n&&le(e,"finish",!1,!0),e.isMilestone?e.completedFinish!=e.start&&(e.completedFinish=e.start,e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0)):e.completedFinish>e.finish&&(e.completedFinish=e.finish,e.completedFinish.valueOf()!=u&&le(e,"completedFinish",!1,!0)),(e.start.valueOf()!=d||e.finish.valueOf()!=n||e.completedFinish.valueOf()!=u)&&(s=!0)));s&&typeof e.ganttChartView!==t&&typeof e.isAwaitingEnsureItemDependencyConstraintsUpdates===t&&(typeof e.ganttChartView===t||e.ganttChartView.isTimingInformationInitialized?(e.isAwaitingEnsureItemDependencyConstraintsUpdates=!0,setTimeout(function(){ot(e),delete e.isAwaitingEnsureItemDependencyConstraintsUpdates},0)):ot(e))}},Ft=function(e,n){if(typeof e.dependsOf!==t&&typeof e.dependsOf[n.index]!==t)return e.dependsOf[n.index];if(typeof e.dependsOf===t&&(e.dependsOf={}),e==n)return!0;var s=$i(e);if(s.indexOf(n)>=0)return e.dependsOf[n.index]=!0;var r=$i(n);if(r.indexOf(e)>=0)return e.dependsOf[n.index]=!0;var l,y,o=mi(e);for(l=0;l<o.length;l++)if((y=o[l])==n||y==e||s.indexOf(y)>=0||r.indexOf(y)>=0||Ft(y,n))return e.dependsOf[n.index]=!0;for(o=0;o<s.length;o++){var d=mi(s[o]);for(l=0;l<d.length;l++)if((y=d[l])==n||y==e||s.indexOf(y)>=0||r.indexOf(y)>=0||Ft(y,n))return e.dependsOf[n.index]=!0}for(s=e.children,l=0;l<s.length;l++)if(typeof(r=s[l]).predecessors!==t&&r.predecessors.length>0&&Ft(r,n))return e.dependsOf[n.index]=!0;return e.dependsOf[n.index]=!1},$i=function(e){for(var n=[];typeof e.parent!==t&&null!=e.parent;)(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)&&n.push(e.parent),e=e.parent;return n},mi=function(e){var n=[];if(typeof e.predecessors!==t&&null!=e.predecessors)for(var s=0;s<e.predecessors.length;s++)typeof e.predecessors[s].item!==t&&n.push(e.predecessors[s].item);return n},xn=function(e,n){for(var s=0;s<e.length;s++){var r=e[s],o=null==n||n(r);if(r.isHidden=!o,o)for(r=r.parent;null!=r;)r.isHidden=!1,r=r.parent}},Ki=function(e,n,s){return Ze(e,n,!0,!0,s)},xt=function(e,n,s){return Ze(e,n,!0,!1,s)},Ze=function(T,p,s,r,f){var l=typeof f!==t&&typeof f.workingDayStart!==t?f.workingDayStart:p.visibleDayStart,y=typeof f!==t&&typeof f.workingDayFinish!==t?f.workingDayFinish:p.visibleDayFinish,d=typeof f!==t&&typeof f.workingWeekStart!==t?f.workingWeekStart:p.workingWeekStart,u=typeof f!==t&&typeof f.workingWeekFinish!==t?f.workingWeekFinish:p.workingWeekFinish;for(p=typeof f!==t&&typeof f.specialNonworkingDays!==t?f.specialNonworkingDays:p.specialNonworkingDays,f=b(T),((T=L(T))<l||!s&&T==l)&&(s?T=l:(f=Ce(f),T=y)),(T>y||!r&&T==y)&&(r?T=y:(f=j(f),T=l)),r=M(f);r<d||r>u||Gt(f,p);){for(s?(r++,f=j(f),T=l):(r--,f=Ce(f),T=y);r<0;)r+=7;for(;r>=7;)r-=7}return new Date(f.valueOf()+T)},Ge=function(T,n,p,u){if(n.valueOf()<T.valueOf())return-Ge(n,T,p,u);if(n.valueOf()==T.valueOf())return 0;var o=typeof u!==t&&typeof u.workingDayStart!==t?u.workingDayStart:p.visibleDayStart,l=typeof u!==t&&typeof u.workingDayFinish!==t?u.workingDayFinish:p.visibleDayFinish,y=typeof u!==t&&typeof u.workingWeekStart!==t?u.workingWeekStart:p.workingWeekStart,d=typeof u!==t&&typeof u.workingWeekFinish!==t?u.workingWeekFinish:p.workingWeekFinish,f=(u=typeof u!==t&&typeof u.specialNonworkingDays!==t?u.specialNonworkingDays:p.specialNonworkingDays,p=0,b(T));(T=L(T))<o?T=o:T>=l&&(f=j(f),T=o);for(var C=b(n);f<C;){var k=M(f);k>=y&&k<=d&&!Gt(f,u)&&(p+=l-T),f=j(f),T=o}return(n=L(n))<o?n=o:n>l&&(n=l),n>T&&(p+=n-T),p},_e=function(e,n,s,r){if(n<0)return _t(-n,e,s,r);if(e=Ze(e,s,!0,!1,r),0==n)return e;var o=typeof r!==t&&typeof r.workingDayStart!==t?r.workingDayStart:s.visibleDayStart,l=typeof r!==t&&typeof r.workingDayFinish!==t?r.workingDayFinish:s.visibleDayFinish,y=L(e);if(y+n<l)return new Date(e.valueOf()+n);for(y=l-y,e=new Date(e.valueOf()+y),n-=y;n>0;){if(e=L(e)>0?Ze(j(b(e)),s,!0,!1,r):Ze(b(e),s,!0,!1,r),o+n<l)return new Date(e.valueOf()+n);y=l-o,e=new Date(e.valueOf()+y),n-=y}return new Date(e.valueOf())},_t=function(e,n,s,r){if(e<0)return _e(n,-e,s,r);if(n=Ze(n,s,!1,!0,r),0==e)return n;var o=typeof r!==t&&typeof r.workingDayStart!==t?r.workingDayStart:s.visibleDayStart,l=typeof r!==t&&typeof r.workingDayFinish!==t?r.workingDayFinish:s.visibleDayFinish,y=L(n);if(y-e>o)return new Date(n.valueOf()-e);for(y-=o,n=new Date(n.valueOf()-y),e-=y;e>0;){if(n=L(n)<864e5?Ze(b(n),s,!1,!0,r):Ze(Ce(b(n)),s,!1,!0,r),l-e>o)return new Date(n.valueOf()-e);y=l-o,n=new Date(n.valueOf()-y),e-=y}return new Date(n.valueOf())},ei=function(e,n,s,r,o){return Ge(e,n,r,o)/Ge(e,s,r,o)},yi=function(e,n,s,r,o){return _e(e,n*Ge(e,s,r,o),r,o)},$t=function(e){for(var n=0,s=(e=Ct(e),0);s<e.length;s++)n+=e[s].value;return 0==n&&(n=1),n},gi=function(e){if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)){for(var n=0,s=(e=e.children,0);s<e.length;s++)n+=gi(e[s]);return n}return e.ganttChartView.getItemEffort(e)*$t(e)},Ci=function(e){if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)){for(var n=0,s=(e=e.children,0);s<e.length;s++)n+=Ci(e[s]);return n}return e.ganttChartView.getItemCompletedEffort(e)*$t(e)},ce=function(e){if(e.schedule)return e.schedule;if(e.scheduleChartItem)return e.scheduleChartItem.schedule;var n=Ct(e);if(n){for(var r,s=-1/0,o=0;o<n.length;o++){var l=n[o];l.value>s&&(r=l.key,s=l.value)}if((e=e.ganttChartView)&&e.settings&&e.settings.resourceSchedules)return(r=lt(e.settings.resourceSchedules,r))<0||!e.settings.resourceSchedules[r]?void 0:e.settings.resourceSchedules[r].value}},vi=function(e,n,s,r,o,l,y,d,u,p,f){function T(X,_){p.isDuringTimeDragOperation=!0,p.draggingItem=o,p.dragType="Start",p.style.cursor=e.style.cursor,p.draggingInitialX=X.clientX,p.draggingInitialStartPosition=l,p.draggingInitialFinishPosition=y,p.draggingInitialCompletedFinishPosition=d,DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((C=DlhSoft.Controls.ToolTip.get(e))||(C=DlhSoft.Controls.ToolTip.initialize(void 0,e,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+f.border+"; background-color: White; color: Black; font-family: "+(f.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),C.setContent(f.dateTimeFormatter(c(o.start))+" \u2013 "+f.dateTimeFormatter(c(o.finish))),C.show(),C.originalX=C.x,p.toolTip=C)}var C;if(e.addEventListener("mousedown",oe(p,e,"mousedown",function(X){0==X.button&&(T(X),X.preventDefault())},!0),!0),e.addEventListener("touchstart",oe(p,e,"touchstart",function(X){T(X.touches[0],!0),X.preventDefault(),X.target.addEventListener("touchmove",oe(p,X.target,"touchmove",o.touchMoveHandler)),X.target.addEventListener("touchend",oe(p,X.target,"touchend",o.touchEndHandler))},!0),!0),e.addEventListener("touchend",oe(p,e,"touchend",function(){we(e,"mouseover"),we(e,"mousedown"),setTimeout(function(){we(e,"mouseout")},2e3)},!0),!0),null!=n){var k=function(X,_){p.isDuringTimeDragOperation=!0,p.draggingItem=o,p.dragType="StartOnly",p.style.cursor=e.style.cursor,p.draggingInitialX=X.clientX,p.draggingInitialStartPosition=l,DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((C=DlhSoft.Controls.ToolTip.get(n))||(C=DlhSoft.Controls.ToolTip.initialize(void 0,n,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+f.border+"; background-color: White; color: Black; font-family: "+(f.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),C.setContent(f.dateTimeFormatter(c(o.start))+" \u2013"),C.show(),C.setHorizontalPosition(C.x+4),C.originalX=C.x,p.toolTip=C)};n.addEventListener("mousedown",oe(p,n,"mousedown",function(X){0==X.button&&(k(X),X.preventDefault())},!0),!0),n.addEventListener("touchstart",oe(p,n,"touchstart",function(X){k(X.touches[0],!0),X.preventDefault(),X.target.addEventListener("touchmove",oe(p,X.target,"touchmove",o.touchMoveHandler)),X.target.addEventListener("touchend",oe(p,X.target,"touchend",o.touchEndHandler))},!0),!0)}if(null!=s){var V=function(X,_){p.isDuringTimeDragOperation=!0,p.draggingItem=o,p.dragType="Finish",p.style.cursor=s.style.cursor,p.draggingInitialX=X.clientX,p.draggingInitialFinishPosition=y,DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((C=DlhSoft.Controls.ToolTip.get(s))||(C=DlhSoft.Controls.ToolTip.initialize(void 0,s,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+f.border+"; background-color: White; color: Black; font-family: "+(f.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),C.setContent("\u2013 "+f.dateTimeFormatter(c(o.finish))),C.show(),C.setHorizontalPosition(C.x-C.contentContainer.clientWidth),C.originalX=C.x,p.toolTip=C)};s.addEventListener("mousedown",oe(p,s,"mousedown",function(X){0==X.button&&(V(X),X.preventDefault())},!0),!0),s.addEventListener("touchstart",oe(p,s,"touchstart",function(X){V(X.touches[0],!0),X.preventDefault(),X.target.addEventListener("touchmove",oe(p,X.target,"touchmove",o.touchMoveHandler)),X.target.addEventListener("touchend",oe(p,X.target,"touchend",o.touchEndHandler))},!0),!0)}if(null!=r){var E=function(X,_){if(p.isDuringTimeDragOperation=!0,p.draggingItem=o,p.dragType="CompletedFinish",p.style.cursor=r.style.cursor,p.draggingInitialX=X.clientX,p.draggingInitialCompletedFinishPosition=d,DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_){(C=DlhSoft.Controls.ToolTip.get(r))||(C=DlhSoft.Controls.ToolTip.initialize(void 0,r,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+f.border+"; background-color: White; color: Black; font-family: "+(f.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."));var re=ei(o.start,o.completedFinish,o.finish,f,ce(o));isNaN(re)||(C.setContent(Math.round(100*re*(f.integralCompletionPercents?1:100))/(f.integralCompletionPercents?1:100)+"%"),C.show(),C.setHorizontalPosition(C.x+2),C.originalX=C.x,p.toolTip=C)}};if(!f.classic){var R=function(){if(typeof p.temporaryHoveringCompletedFinishThumb!==t){var X=p.temporaryHoveringCompletedFinishThumb;if(delete p.temporaryHoveringCompletedFinishThumb,typeof X.childNodes[0].originalClass===t&&typeof X.childNodes[0].originalStyle===t)return;X.childNodes[0].setAttribute("class",X.childNodes[0].originalClass),X.childNodes[0].setAttribute("style",X.childNodes[0].originalStyle),delete X.childNodes[0].originalClass,delete X.childNodes[0].originalStyle}p.draggingItem||o.finish.valueOf()==o.start.valueOf()||(o.temporaryThumb=r,p.temporaryHoveringCompletedFinishThumb=r,r.childNodes[0].originalClass=r.childNodes[0].getAttribute("class"),r.childNodes[0].originalStyle=r.childNodes[0].getAttribute("style"),typeof f.completedBarThumbClass!==t&&r.childNodes[0].setAttribute("class",f.completedBarThumbClass),(typeof f.completedBarThumbClass!==t||typeof f.completedBarThumbStyle!==t)&&r.childNodes[0].setAttribute("style",f.completedBarThumbStyle),r.style.cursor="ew-resize")},B=function(){if(typeof p.temporaryHoveringCompletedFinishThumb!==t){var X=p.temporaryHoveringCompletedFinishThumb;X==o.temporaryThumb&&(delete p.temporaryHoveringCompletedFinishThumb,typeof X.childNodes[0].originalClass===t&&typeof X.childNodes[0].originalStyle===t||(X.childNodes[0].setAttribute("class",X.childNodes[0].originalClass),X.childNodes[0].setAttribute("style",X.childNodes[0].originalStyle),delete X.childNodes[0].originalClass,delete X.childNodes[0].originalStyle))}};e.addEventListener("mouseover",oe(p,e,"mouseover",R,!0),!0),r.addEventListener("mouseover",oe(p,r,"mouseover",R,!0),!0),e.addEventListener("mouseout",oe(p,e,"mouseout",B,!0),!0),r.addEventListener("mouseout",oe(p,r,"mouseout",B,!0),!0)}r.addEventListener("mousedown",oe(p,r,"mousedown",function(X){0==X.button&&(E(X),X.preventDefault())},!0),!0),r.addEventListener("touchstart",oe(p,r,"touchstart",function(X){E(X.touches[0],!0),X.preventDefault(),X.target.addEventListener("touchmove",oe(p,X.target,"touchmove",o.touchMoveHandler)),X.target.addEventListener("touchend",oe(p,X.target,"touchend",o.touchEndHandler))},!0),!0)}for(typeof p.draggableItems===t&&(p.draggableItems=[]),R=!1,B=0;B<p.draggableItems.length;B++)if(p.draggableItems[B]==o){R=!0;break}if(!R){var ee=function(X,_){if(typeof p.draggingItem!==t&&p.draggingItem==o&&("Start"==p.dragType||"StartOnly"==p.dragType||"Finish"==p.dragType||"CompletedFinish"==p.dragType)){var ne,ve,re=X.clientX-p.draggingInitialX;Qi(X.clientX,p),delete p.draggingItem,p.draggingInitialStartPosition+re<0&&(re=-p.draggingInitialStartPosition),"Start"==p.dragType||"StartOnly"==p.dragType?("StartOnly"!=p.dragType&&(ne=Ge(o.start,o.finish,f,ce(o))),ve=Ge(o.start,o.completedFinish,f,ce(o)),re=Ze(Q(te(p.draggingInitialStartPosition+re,f),f),f,!0,o.isMilestone,ce(o)),"StartOnly"==p.dragType&&re>o.finish&&(re=o.finish),o.start=re,o.preferredStart=o.start,le(o,"start",!0,!1),"StartOnly"!=p.dragType?(o.isMilestone?(o.finish=o.start,le(o,"finish",!1,!1),o.completedFinish=o.start):(o.finish=_e(o.start,ne,f,ce(o)),le(o,"finish",!1,!1),o.completedFinish=_e(o.start,ve,f,ce(o))),le(o,"completedFinish",!1,!1),DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((C=p.toolTip).setContent(f.dateTimeFormatter(c(o.start))+" \u2013 "+f.dateTimeFormatter(c(o.finish))),C.setHorizontalPosition(C.originalX+(q(o.start,f)-p.draggingInitialStartPosition)))):(o.finish<o.start&&(o.finish=o.start,le(o,"finish",!1,!1)),(o.completedFinish<o.start||ve<=0)&&(o.completedFinish=o.start,le(o,"completedFinish",!1,!1)),DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((C=p.toolTip).setContent(f.dateTimeFormatter(c(o.start))+" \u2013"),C.setHorizontalPosition(C.originalX+(q(o.start,f)-p.draggingInitialStartPosition)))),Kt(o,u,p.chartContent,f)):"Finish"==p.dragType?((re=Ze(Q(te(p.draggingInitialFinishPosition+re,f),f),f,o.isMilestone,!0,ce(o)))<o.start&&(re=o.start),re.valueOf()!=o.finish.valueOf()&&(o.finish=re,le(o,"finish",!0,!1)),o.completedFinish>re&&(o.completedFinish=re,le(o,"completedFinish",!1,!1)),DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&((C=p.toolTip).setContent("\u2013 "+f.dateTimeFormatter(c(o.finish))),C.setHorizontalPosition(C.originalX+(q(o.finish,f)-p.draggingInitialFinishPosition))),Kt(o,u,p.chartContent,f)):"CompletedFinish"==p.dragType&&(f.percentBasedCompletionBar?o.start.valueOf()!=o.finish.valueOf()&&(ne=q(o.start,f),ve=Math.max(q(o.finish,f),ne+(f.classic?4:12)),re=Math.max(0,Math.min(1,(p.draggingInitialCompletedFinishPosition+re-ne)/(ve-ne))),(re=yi(o.start,re,o.finish,f)).valueOf()!=o.completedFinish.valueOf()&&(o.completedFinish=re,le(o,"completedFinish",!0,!1))):((re=Ze(Q(te(p.draggingInitialCompletedFinishPosition+re,f),f),f,o.isMilestone,!0,ce(o)))<o.start&&(re=o.start),re>o.finish&&(re=o.finish),re.valueOf()!=o.completedFinish.valueOf()&&(o.completedFinish=re,le(o,"completedFinish",!0,!1))),DlhSoft.Controls.ToolTip&&f.useUpdatingToolTips&&!_&&(C=p.toolTip,re=ei(o.start,o.completedFinish,o.finish,f,ce(o)),isNaN(re)||(C.setContent(Math.round(100*re*(f.integralCompletionPercents?1:100))/(f.integralCompletionPercents?1:100)+"%"),C.setHorizontalPosition(C.originalX+(q(o.completedFinish,f)-p.draggingInitialCompletedFinishPosition)))),Kt(o,u,p.chartContent,f)),p.draggingItem=o,p.draggingPerformed=!0}};p.addEventListener("mousemove",oe(p,p,"mousemove",function(X){ee(X)},!0),!0),p.addEventListener("touchmove",oe(p,p,"touchmove",function(X){ee(X.touches[0],!0)},!0),!0),o.touchMoveHandler=function(X){ee(X.touches[0],!0)};var N=function(){if(typeof p.draggingItem!==t&&p.draggingItem==o&&("Start"==p.dragType||"StartOnly"==p.dragType||"Finish"==p.dragType||"CompletedFinish"==p.dragType)){delete p.isDuringTimeDragOperation;var X=p.draggingItem;p.style.cursor="default",p.draggingPerformed&&("Start"==p.dragType||"StartOnly"==p.dragType?(le(X,"start",!0,!0),le(X,"finish",!1,!0),le(X,"completedFinish",!1,!0)):"Finish"==p.dragType?(le(X,"finish",!0,!0),le(X,"completedFinish",!1,!0)):"CompletedFinish"==p.dragType&&le(X,"completedFinish",!0,!0),delete p.draggingPerformed),delete p.draggingItem}};document.addEventListener("mouseup",oe(p,document,"mouseup",function(X){0==X.button&&N()},!0),!0),document.addEventListener("touchend",oe(p,document,"touchend",function(){N()},!0),!0),o.touchEndHandler=function(){N()},p.draggableItems.push(o)}},ti=function(e,n,s,r,o,l,y,d,u,p){function f(B,ee){delete u.cancelDrag,u.draggingItem=r,u.dragType="Dependency",u.dragDependencyType="Finish",u.style.cursor=e.style.cursor,u.draggingInitialX=B.clientX,u.draggingInitialY=B.clientY,u.draggingInitialRightPosition=l,u.draggingInitialTopPosition=o,u.draggingInitialFinishPosition=l,u.draggingInitialThumbPosition=o,DlhSoft.Controls.ToolTip&&p.useUpdatingToolTips&&!ee&&((toolTip=DlhSoft.Controls.ToolTip.get(e))||(toolTip=DlhSoft.Controls.ToolTip.initialize(void 0,e,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+p.border+"; background-color: White; color: Black; font-family: "+(p.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),toolTip.setContent(r.content+" \u2013"),toolTip.show(),toolTip.setPosition(toolTip.x+16,toolTip.y-8),toolTip.originalX=toolTip.x,toolTip.originalY=toolTip.y,u.toolTip=toolTip)}var T=r.ganttChartView.ownerDocument;if(u.temporaryHoveringThumb&&(u.temporaryHoveringThumb.originalClass||u.temporaryHoveringThumb.originalStyle)&&(u.temporaryHoveringThumb.setAttribute("class",u.temporaryHoveringThumb.originalClass),u.temporaryHoveringThumb.setAttribute("style",u.temporaryHoveringThumb.originalStyle),delete u.temporaryHoveringThumb.originalClass,delete u.temporaryHoveringThumb.originalStyle),null!=e&&(e.addEventListener("mousedown",oe(u,e,"mousedown",function(B){0==B.button&&(f(B),B.preventDefault())},!0),!0),e.addEventListener("touchstart",oe(u,e,"touchstart",function(B){f(B.touches[0],!0),B.preventDefault()},!0),!0)),null!=n){var C=function(B,ee){delete u.cancelDrag,u.draggingItem=r,u.dragType="Dependency",u.dragDependencyType="Start",u.style.cursor=e.style.cursor,u.draggingInitialX=B.clientX,u.draggingInitialY=B.clientY,u.draggingInitialRightPosition=y,u.draggingInitialTopPosition=o,u.draggingInitialFinishPosition=y,u.draggingInitialThumbPosition=o,B.preventDefault(),DlhSoft.Controls.ToolTip&&p.useUpdatingToolTips&&!ee&&((toolTip=DlhSoft.Controls.ToolTip.get(n))||(toolTip=DlhSoft.Controls.ToolTip.initialize(void 0,n,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+p.border+"; background-color: White; color: Black; font-family: "+(p.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),toolTip.setContent(r.content+" \u2013"),toolTip.show(),toolTip.setPosition(toolTip.x+16,toolTip.y-8),toolTip.originalX=toolTip.x,toolTip.originalY=toolTip.y,u.toolTip=toolTip)};n.addEventListener("mousedown",oe(u,n,"mousedown",function(B){0==B.button&&(C(B),B.preventDefault())},!0),!0),n.addEventListener("touchstart",oe(u,n,"touchstart",function(B){C(B.touches[0],!0),B.preventDefault()},!0),!0)}e?.addEventListener("mouseover",oe(u,e,"mouseover",function(){if(p.classic&&typeof u.temporaryHoveringThumb!==t){var B=u.temporaryHoveringThumb;if(delete u.temporaryHoveringThumb,typeof B.originalClass===t&&typeof B.originalStyle===t)return;B.setAttribute("class",B.originalClass),B.setAttribute("style",B.originalStyle),delete B.originalClass,delete B.originalStyle}typeof u.temporaryDependencyLine!==t||e.originalStyle||(e.mouseOver=!0,u.temporaryHoveringThumb=e,e.originalClass=e.getAttribute("class"),e.originalStyle=e.getAttribute("style"),typeof p.dependencyPointerClass!==t&&e.setAttribute("class",p.dependencyPointerClass),(typeof p.dependencyPointerClass!==t||typeof p.dependencyPointerStyle!==t)&&e.setAttribute("style",p.dependencyPointerStyle),e.style.cursor="pointer",setTimeout(function(){we(e,"mouseout")},4e3))},!0),!0),n?.addEventListener("mouseover",oe(u,n,"mouseover",function(){if(p.classic&&typeof u.temporaryHoveringThumb!==t){var B=u.temporaryHoveringThumb;if(delete u.temporaryHoveringThumb,typeof B.originalClass===t&&typeof B.originalStyle===t)return;B.setAttribute("class",B.originalClass),B.setAttribute("style",B.originalStyle),delete B.originalClass,delete B.originalStyle}typeof u.temporaryDependencyLine!==t||n.originalStyle||(n.mouseOver=!0,u.temporaryHoveringThumb=n,n.originalClass=n.getAttribute("class"),n.originalStyle=n.getAttribute("style"),typeof p.dependencyPointerClass!==t&&n.setAttribute("class",p.dependencyPointerClass),(typeof p.dependencyPointerClass!==t||typeof p.dependencyPointerStyle!==t)&&n.setAttribute("style",p.dependencyPointerStyle),n.style.cursor="pointer",setTimeout(function(){we(n,"mouseout")},4e3))},!0),!0),e?.addEventListener("mouseout",oe(u,e,"mouseout",function(){delete e.mouseOver,setTimeout(function(){typeof e.originalClass===t&&typeof e.originalStyle===t||e.mouseOver||(e.setAttribute("class",e.originalClass),e.setAttribute("style",e.originalStyle),delete e.originalClass,delete e.originalStyle)},p.classic?250:0)},!0),!0),n?.addEventListener("mouseout",oe(u,n,"mouseout",function(){delete n.mouseOver,setTimeout(function(){typeof n.originalClass===t&&typeof n.originalStyle===t||n.mouseOver||(n.setAttribute("class",n.originalClass),n.setAttribute("style",n.originalStyle),delete n.originalClass,delete n.originalStyle)},p.classic?250:0)},!0),!0),e?.addEventListener("touchend",oe(u,e,"touchend",function(){we(e,"mouseover"),setTimeout(function(){we(e,"mouseout")},2e3)},!0),!0),n?.addEventListener("touchend",oe(u,n,"touchend",function(){we(n,"mouseover"),setTimeout(function(){we(n,"mouseout")},2e3)},!0),!0),typeof u.draggableDependencyItems===t&&(u.draggableDependencyItems=[]);for(var k=!1,V=0;V<u.draggableDependencyItems.length;V++)if(u.draggableDependencyItems[V]==r){k=!0;break}if(!k){var E=function(B,ee){if(typeof u.draggingItem!==t&&u.draggingItem==r&&"Dependency"==u.dragType){var N=B.clientX-u.draggingInitialX,X=B.clientY-u.draggingInitialY;if(Qi(B.clientX,u),Ji(B.clientY,u),delete u.draggingItem,u.draggingInitialFinishPosition+N<0&&(N=-u.draggingInitialFinishPosition),typeof u.temporaryInitDependencyLine!==t){try{s.removeChild(u.temporaryInitDependencyLine)}catch{}delete u.temporaryInitDependencyLine}if(typeof u.temporaryDependencyLine!==t){try{s.removeChild(u.temporaryDependencyLine)}catch{}delete u.temporaryDependencyLine}if(u.cancelDrag)delete u.cancelDrag,delete u.draggingItem,u.style.cursor="default";else if(p.classic||((_=T.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",u.draggingInitialRightPosition+("Start"==u.dragDependencyType?-8:8)*(r.isMilestone||r.hasChildren?2:1)),_.setAttribute("y1",u.draggingInitialTopPosition),_.setAttribute("x2",u.draggingInitialRightPosition),_.setAttribute("y2",u.draggingInitialTopPosition),typeof p.temporaryDependencyLineClass!==t&&_.setAttribute("class",p.temporaryDependencyLineClass),typeof p.temporaryDependencyLineStyle!==t&&_.setAttribute("style",p.temporaryDependencyLineStyle),_.style.markerEnd="none",u.temporaryInitDependencyLine=_,s.appendChild(_)),(_=T.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",u.draggingInitialRightPosition+(p.classic?0:("Start"==u.dragDependencyType?-8:8)*(r.isMilestone||r.hasChildren?2:1))),_.setAttribute("y1",u.draggingInitialTopPosition),_.setAttribute("x2",u.draggingInitialFinishPosition+N),_.setAttribute("y2",u.draggingInitialThumbPosition+X),typeof p.temporaryDependencyLineClass!==t&&_.setAttribute("class",p.temporaryDependencyLineClass),typeof p.temporaryDependencyLineStyle!==t&&_.setAttribute("style",p.temporaryDependencyLineStyle),u.temporaryDependencyLine=_,s.appendChild(_),u.draggingItem=r,DlhSoft.Controls.ToolTip&&p.useUpdatingToolTips&&!ee){toolTip=u.toolTip;for(var re=Math.floor((r.itemTop+u.draggingInitialThumbPosition+X)/p.itemHeight),_=null,ne=0,ve=0;ve<d.length;ve++){var Pe=d[ve];if(Pe.isVisible&&(typeof Pe.isHidden===t||!Pe.isHidden)&&typeof Pe.displayRowIndex===t){if(ne==re){_=Pe;break}ne++}}re="Start",null!=_&&(ne=u.draggingInitialFinishPosition+N,ve=q(_.start,p),Pe=q(_.finish,p),(_.isMilestone||_.hasChildren&&(typeof _.isSummaryEnabled===t||_.isSummaryEnabled))&&(ve-=p.itemHeight/2,Pe+=p.itemHeight/2),Pe<ve+(p.classic?4:12)&&(Pe=ve+(p.classic?4:12)),(ne<ve||ne>Pe||w(_,r)||I(_,r)||I(r,_))&&(_=null),null!=_&&(typeof p.allowCreatingToFinishDependencies===t||p.allowCreatingToFinishDependencies)&&!_.isMilestone&&ne>ve+3*(Pe-ve)/4&&(re="Finish")),null==r.scheduleChartView&&(toolTip.setContent(r.content+" \u2013"+(null!=_?" "+_.content+("Finish"!=re?"":" \u2022"):"")),toolTip.setPosition(toolTip.originalX+N,toolTip.originalY+X))}}};u.addEventListener("mousemove",oe(u,u,"mousemove",function(B){E(B)},!0),!0),u.addEventListener("touchmove",oe(u,u,"touchmove",function(B){E(B.touches[0],!0)},!0),!0);var R=function(B){if(typeof u.draggingItem!==t&&u.draggingItem==r&&"Dependency"==u.dragType){if(typeof u.temporaryInitDependencyLine!==t){try{s.removeChild(u.temporaryInitDependencyLine)}catch{}delete u.temporaryInitDependencyLine}if(typeof u.temporaryDependencyLine!==t){try{s.removeChild(u.temporaryDependencyLine)}catch{}delete u.temporaryDependencyLine}for(var ee=Math.floor((r.itemTop+u.draggingInitialThumbPosition+(B.clientY-u.draggingInitialY))/p.itemHeight),N=null,X=0,_=0;_<d.length;_++){var re=d[_];if(re.isVisible&&(typeof re.isHidden===t||!re.isHidden)&&typeof re.displayRowIndex===t){if(X==ee){N=re;break}X++}}if(null!=N){if(B=u.draggingInitialFinishPosition+(B.clientX-u.draggingInitialX),N.scheduleChartView)for(_=0;_<N.ganttChartItems.length;_++)if(ee=u.getChartPosition((re=N.ganttChartItems[_]).start),X=u.getChartPosition(re.finish),re.isMilestone&&(ee-=p.itemHeight/2,X+=p.itemHeight/2),B>=ee&&B<=X){N=re;break}if(ee=q(N.start,p),X=q(N.finish,p),(N.isMilestone||N.hasChildren&&(typeof N.isSummaryEnabled===t||N.isSummaryEnabled))&&(ee-=p.itemHeight/2,X+=p.itemHeight/2),X<ee+(p.classic?4:12)&&(X=ee+(p.classic?4:12)),B>=ee&&B<=X)if(_=null==N||typeof p.allowCreatingToFinishDependencies!==t&&!p.allowCreatingToFinishDependencies||N.isMilestone||B<=ee+3*(X-ee)/4?"Start":"Finish",w(N,r)||I(N,r)||I(r,N)||p.alwaysHandleInvalidDependencies&&Ft(r,N))p.invalidPredecessorDetectionHandler&&(re={item:r},"Start"!=u.dragDependencyType?"Finish"==_&&(re.dependencyType="FF"):re.dependencyType="Finish"!=_?"SS":"SF",p.invalidPredecessorDetectionHandler(re,N,r));else{var ne,ve;delete r.successors,typeof N.predecessors===t&&(N.predecessors=[]),re={item:r},"Start"!=u.dragDependencyType?"Finish"==_&&(re.dependencyType="FF"):re.dependencyType="Finish"!=_?"SS":"SF",N.predecessors.push(re),le(N,"predecessors",!0,!0),N.start<r.finish&&!p.areTaskDependencyConstraintsEnabled&&!p.areTaskDependencyConstraintsDisabledWhenDropping&&(!N.isMilestone&&(!N.hasChildren||!(typeof N.isSummaryEnabled===t||N.isSummaryEnabled))&&(ne=Ge(N.start,N.finish,p,ce(N)),ve=Ge(N.start,N.completedFinish,p,ce(N))),(!N.hasChildren||typeof N.isSummaryEnabled!==t&&!N.isSummaryEnabled)&&"Start"==_&&(N.start=Ze(Q("Start"!=u.dragDependencyType?r.finish:r.start,p),p,!0,N.isMilestone,ce(r)),le(N,"start",!1,!0),N.isMilestone?(N.finish=N.start,le(N,"finish",!1,!0),N.completedFinish=N.start):(N.finish=_e(N.start,ne,p,ce(N)),le(N,"finish",!1,!0),N.completedFinish=_e(N.start,ve,p,ce(N))),le(N,"completedFinish",!1,!0))),Kt(N,d,u.chartContent,p),Kt(r,d,u.chartContent,p)}}delete u.draggingItem,u.style.cursor="default"}};T.addEventListener("mouseup",oe(u,T,"mouseup",function(B){0==B.button&&R(B)},!0),!0),T.addEventListener("touchend",oe(u,T,"touchend",function(B){R(B.changedTouches[0])},!0),!0),u.draggableDependencyItems.push(r)}},Qi=function(e,n){if(typeof n.draggingItem!==t){var s=new Date;if(!n.lastXDraggingTime||!(s>n.lastXDraggingTime&&s-n.lastXDraggingTime<50)){n.lastXDraggingTime=s;var r=0;if((s=n).offsetParent)do{r+=s.offsetLeft,s=s.offsetParent}while(s);(e-=r)<n.gridContentContainer.offsetWidth+24?(s=n.chartContentContainer.scrollLeft,n.chartContentContainer.scrollLeft=n.chartContentContainer.scrollLeft-20,s-=n.chartContentContainer.scrollLeft,typeof n.draggingInitialStartPosition!==t&&(n.draggingInitialStartPosition=n.draggingInitialStartPosition-s),typeof n.draggingInitialFinishPosition!==t&&(n.draggingInitialFinishPosition=n.draggingInitialFinishPosition-s),typeof n.draggingInitialCompletedFinishPosition!==t&&(n.draggingInitialCompletedFinishPosition=n.draggingInitialCompletedFinishPosition-s)):e>=n.gridContentContainer.offsetWidth+n.chartContentContainer.clientWidth-24&&(s=n.chartContentContainer.scrollLeft,n.chartContentContainer.scrollLeft=n.chartContentContainer.scrollLeft+20,s=n.chartContentContainer.scrollLeft-s,typeof n.draggingInitialStartPosition!==t&&(n.draggingInitialStartPosition=n.draggingInitialStartPosition+s),typeof n.draggingInitialFinishPosition!==t&&(n.draggingInitialFinishPosition=n.draggingInitialFinishPosition+s),typeof n.draggingInitialCompletedFinishPosition!==t&&(n.draggingInitialCompletedFinishPosition=n.draggingInitialCompletedFinishPosition+s))}}},Ji=function(e,n){if(typeof n.draggingItem!==t){var r,s=new Date;if(!n.lastYDraggingTime||!(s>n.lastYDraggingTime&&s-n.lastYDraggingTime<50))n.lastYDraggingTime=s,e-=function(e){var n=0;if(e.offsetParent)do{n+=e.offsetTop,e=e.offsetParent}while(e);return n}(n),e>=n.chartHeaderContainer.clientHeight&&e<n.chartHeaderContainer.clientHeight+24?(r=n.chartContentContainer.scrollTop,n.chartContentContainer.scrollTop=n.chartContentContainer.scrollTop-20,typeof n.isDuringVerticalScrolling===t&&(n.isDuringVerticalScrolling=!0,setTimeout(function(){n.draggingInitialThumbPosition=n.draggingInitialThumbPosition-(r-n.chartContentContainer.scrollTop),delete n.isDuringVerticalScrolling},0))):e>=n.chartHeaderContainer.clientHeight+n.chartContentContainer.clientHeight-24&&(r=n.chartContentContainer.scrollTop,n.chartContentContainer.scrollTop=n.chartContentContainer.scrollTop+20,typeof n.isDuringVerticalScrolling===t&&(n.isDuringVerticalScrolling=!0,setTimeout(function(){n.draggingInitialThumbPosition=n.draggingInitialThumbPosition+(n.chartContentContainer.scrollTop-r),delete n.isDuringVerticalScrolling},0)))}},Kt=function(e,n,s,r){mt(e.chartPredecessorItems,e,r),yt(e.chartItem,e,r),St(n,e),setTimeout(function(){if(typeof e.gridItem!==t){if(typeof e.completedInput!==t){var o=e.completedInput;typeof o.changeEventListener!==t&&o.removeEventListener("change",o.changeEventListener,!0),delete e.completedInput}Vt(e.gridItem,e,n,r.columns,s,r.toggleButtonAreaWidth,r)}for(o=e.parent;null!=o;)h(o,!1),mt((e=o).chartPredecessorItems,e,r),yt(e.chartItem,e,r),St(n,e),typeof e.gridItem!==t&&Vt(e.gridItem,e,n,r.columns,s,r.toggleButtonAreaWidth,r),o=e.parent},0)},qi=function(e){var n=e.itemTop-e.ganttChartView.chartContentContainer.scrollTop;n<0?e.ganttChartView.chartContentContainer.scrollTop=e.itemTop:n>e.ganttChartView.chartContentContainer.clientHeight-e.ganttChartView.settings.itemHeight&&(e.ganttChartView.chartContentContainer.scrollTop=e.itemTop-(e.ganttChartView.chartContentContainer.clientHeight-e.ganttChartView.settings.itemHeight))},En=function(e,n,s,r,o,l,y,d,u,p,f,T,C,k){var V,E;n.addEventListener("scroll",oe(e,n,"scroll",function(){y.scrollTop!=n.scrollTop&&!E&&(V=!0,setTimeout(function(){y.scrollTop=n.scrollTop,setTimeout(function(){V=!1},100)},200)),r.scrollLeft!=n.scrollLeft&&(r.scrollLeft=n.scrollLeft)},!0),!0),ii(n,s,o,k),typeof e.updateGridHeaderTimer!==t&&clearInterval(e.updateGridHeaderTimer),e.updateGridHeaderTimer=setInterval(function(){try{ii(n,s,o,k)}catch{try{clearInterval(e.updateGridHeaderTimer)}catch{}}},100),y.addEventListener("scroll",oe(e,y,"scroll",function(){n.scrollTop!=y.scrollTop&&!V&&(E=!0,setTimeout(function(){n.scrollTop=y.scrollTop,setTimeout(function(){E=!1},100)},200)),d.scrollLeft!=y.scrollLeft&&(d.scrollLeft=y.scrollLeft),Ot(C,y,k),Xt(C,f,k),k.displayedTime=te(y.scrollLeft,k),(typeof e.isDuringScrollToDateTime===t||!e.isDuringScrollToDateTime)&&typeof k.displayedTimeChangeHandler!==t&&setTimeout(function(){k.displayedTimeChangeHandler(k.displayedTime)},0),typeof e.isDuringScrollToDateTime!==t&&delete e.isDuringScrollToDateTime},!0),!0),setTimeout(function(){d.scrollLeft!=y.scrollLeft&&(d.scrollLeft=y.scrollLeft),Ot(C,y,k)},1),ii(y,u,p,k),typeof e.updateChartHeaderTimer!==t&&clearInterval(e.updateChartHeaderTimer),e.updateChartHeaderTimer=setInterval(function(){try{ii(y,u,p,k)}catch{try{clearInterval(e.updateChartHeaderTimer)}catch{}}},100),window.addEventListener("mousewheel",oe(e,window,"mousewheel",function(){try{e.cancelDrag=!0}catch{}},!0),!0)},ii=function(e,n,s,r){setTimeout(function(){try{var o=n.clientWidth-e.clientWidth;o<0&&(o=0);var l=o+"px";s.style.width!=l&&(s.style.width=l,o>0?(s.style.boxSizing="border-box",s.style.MozBoxSizing="border-box",s.style.border="solid 1px "+r.border,s.style.borderTop="none",s.style.borderRight="none"):(s.style.border="",s.style.borderTop="",s.style.borderRight="",s.style.boxSizing="",s.style.MozBoxSizing=""))}catch{}},0)},Rt=function(e,n,s){s.isSplitterEnabled&&(e.style.height=n.clientHeight+"px",e.style.left=Math.max(0,n.offsetWidth-1)+"px")},Ot=function(e,n,s){if((typeof n.isInitializing===t||!n.isInitializing)&&s.isVirtualizing)for(var r=n.scrollTop-s.itemHeight,o=(n=r+n.clientHeight+2*s.itemHeight,0);o<e.length;o++){var l=e[o];l.isPart||(l.scheduleChartItem&&l.scheduleChartItem!=l?(l.itemTop!=l.scheduleChartItem.itemTop||l.isVirtuallyVisible!=l.scheduleChartItem.isVirtuallyVisible)&&(l.itemTop=l.scheduleChartItem.itemTop,l.isVirtuallyVisible=l.scheduleChartItem.isVirtuallyVisible,l.isVirtuallyVisible&&(mt(l.chartPredecessorItems,l,s),yt(l.chartItem,l,s),l.chartItem.setAttribute("transform","translate(0, "+l.itemTop+")"),l.chartPredecessorItems.setAttribute("transform","translate(0, "+l.itemTop+")"),At(l,l.itemTop))):typeof l.isVirtuallyVisible===t&&(typeof l.isVisible===t||l.isVisible)&&(typeof l.isHidden===t||!l.isHidden)&&typeof l.itemTop!==t&&l.itemTop>=r&&l.itemTop<n?(l.isVirtuallyVisible=!0,le(l,"isVirtuallyVisible",!1,!0),typeof l.gridItem!==t&&Vt(l.gridItem,l,e,s.columns,l.ganttChartView.chartContent,s.toggleButtonAreaWidth,s),mt(l.chartPredecessorItems,l,s),yt(l.chartItem,l,s),l.chartItem.setAttribute("transform","translate(0, "+l.itemTop+")"),l.chartPredecessorItems.setAttribute("transform","translate(0, "+l.itemTop+")"),At(l,l.itemTop)):typeof l.isVirtuallyVisible!==t&&(typeof l.isVisible===t||l.isVisible)&&(typeof l.isHidden===t||!l.isHidden)&&typeof l.itemTop!==t&&(l.itemTop<r||l.itemTop>=n)&&delete l.isVirtuallyVisible)}},Vn=function(e,n){for(var s=e.childNodes.length;s-- >0;)e.removeChild(e.childNodes[s]);e.appendChild(n)},wi=function(e,n,s,r){var o=r.indexOf(e);o<0||n<0||n==o||n>=r.length||(r.splice(o,1),r.splice(n,0,e),ji(r),xe(s),typeof s.settings.itemMoveHandler!==t&&s.settings.itemMoveHandler(e,o,n))},ni=function(e,n,s,r,o){if(!(e<0||s<0||s==e||s>o.length-n)){var y,l=[];for(y=e;y<e+n;y++)l.push(o[y]);for(o.splice(e,n),y=0;y<l.length;y++)o.splice(s+y,0,l[y]);if(ji(o),xe(r),typeof r.settings.itemMoveHandler!==t)for(y=0;y<l.length;y++)r.settings.itemMoveHandler(l[y],e+y,s+y)}},ji=function(e){for(var n=0,s=0;s<e.length;s++){var r=e[s];r.indentation>n&&(r.indentation=n,le(r,"indentation",!1,!0)),n=r.indentation+1}},Ln=function(e,n){for(var s in n)0!=s.indexOf("custom")&&0!=s.indexOf("description")||typeof e[s]===t&&(e[s]=n[s])},en=function(e,n,s,r,o,l,y,d,u,p,f,T,C,k,V,E){var R,ee,B=[];if(typeof r!==t)for(R=0;R<r.length;R++)B.push({isTreeView:(ee=E.columns[r[R]]).isTreeView,header:ee.header,width:ee.width,headerClass:ee.headerClass,headerStyle:ee.headerStyle,cellClass:ee.cellClass,cellStyle:ee.cellStyle,cellTemplate:typeof ee.exportCellTemplate!==t?ee.exportCellTemplate:ee.cellTemplate});else for(R=0;R<E.columns.length;R++)(ee=E.columns[R]).isSelection||B.push({isTreeView:ee.isTreeView,header:ee.header,width:ee.width,headerClass:ee.headerClass,headerStyle:ee.headerStyle,cellClass:ee.cellClass,cellStyle:ee.cellStyle,cellTemplate:typeof ee.exportCellTemplate!==t?ee.exportCellTemplate:ee.cellTemplate});typeof s===t&&(s=E.isGridVisible),R=s?ft(B)+1:0,typeof o!==t?(typeof y===t||!y)&&(o=new Date(o.valueOf()-6e4*o.getTimezoneOffset())):o=E.timelineStart,typeof l!==t?(typeof y===t||!y)&&(l=new Date(l.valueOf()-6e4*l.getTimezoneOffset())):l=E.timelineFinish,(o={isExport:!0,isReadOnly:!0,selectionMode:"None",isVirtualizing:!1,isGridVisible:s,isSplitterEnabled:!1,gridWidth:R+"px",columns:B,allowUserToResizeColumns:!1,isGridRowClickTimeScrollingEnabled:!1,isMouseWheelZoomEnabled:!1,timelineStart:o,timelineFinish:l,hourWidth:typeof d!==t?d:E.hourWidth,displayedTime:typeof o!==t?o:E.timelineStart,currentTime:E.currentTime,isTaskToolTipVisible:!1,isDependencyToolTipVisible:!1,containerClass:E.containerClass,containerStyle:E.containerStyle,border:E.border,theme:E.theme,headerBackground:E.headerBackground,headerHeight:E.headerHeight,itemHeight:E.itemHeight,itemClass:E.itemClass,itemStyle:E.itemStyle,standardItemClass:E.standardItemClass,summaryItemClass:E.summaryItemClass,milestoneItemClass:E.milestoneItemClass,standardItemStyle:E.standardItemStyle,summaryItemStyle:E.summaryItemStyle,milestoneItemStyle:E.milestoneItemStyle,indentationLevelWidth:E.indentationLevelWidth,toggleButtonClass:E.toggleButtonClass,toggleButtonStyle:E.toggleButtonStyle,scales:[],visibleWeekStart:E.visibleWeekStart,visibleWeekFinish:E.visibleWeekFinish,workingWeekStart:E.workingWeekStart,workingWeekFinish:E.workingWeekFinish,visibleDayStart:E.visibleDayStart,visibleDayFinish:E.visibleDayFinish,specialNonworkingDays:E.specialNonworkingDays,barMargin:E.barMargin,barHeight:E.barHeight,barCornerRadius:E.barCornerRadius,completedBarMargin:E.completedBarMargin,completedBarHeight:E.completedBarHeight,completedBarCornerRadius:E.completedBarCornerRadius,standardBarClass:E.standardBarClass,summaryBarClass:E.summaryBarClass,milestoneBarClass:E.milestoneBarClass,standardBarStyle:E.standardBarStyle,summaryBarStyle:E.summaryBarStyle,milestoneBarStyle:E.milestoneBarStyle,standardCompletedBarClass:E.standardCompletedBarClass,standardCompletedBarStyle:E.standardCompletedBarStyle,summaryCompletedBarClass:E.summaryCompletedBarClass,summaryCompletedBarStyle:E.summaryCompletedBarStyle,dependencyLineClass:E.dependencyLineClass,dependencyLineStyle:E.dependencyLineStyle,assignmentsClass:E.assignmentsClass,assignmentsStyle:E.assignmentsStyle,areTaskAssignmentsVisible:E.areTaskAssignmentsVisible,isTaskCompletedEffortVisible:E.isTaskCompletedEffortVisible,areTaskDependenciesVisible:E.areTaskDependenciesVisible,areDependencyConstraintsAppliedOnStartedTasks:E.areDependencyConstraintsAppliedOnMilestones,areDependencyConstraintsAppliedOnMilestones:E.areDependencyConstraintsAppliedOnMilestones,isBaselineVisible:E.isBaselineVisible,areStandardTaskLabelsVisible:E.areStandardTaskLabelsVisible,areSummaryTaskLabelsVisible:E.areSummaryTaskLabelsVisible,areMilestoneTaskLabelsVisible:E.areMilestoneTaskLabelsVisible,areResourceImagesVisibleAsAssignments:E.areResourceImagesVisibleAsAssignments,resourceImageUrls:E.resourceImageUrls,standardLabelColor:E.standardLabelColor,summaryLabelColor:E.summaryLabelColor,milestoneLabelColor:E.milestoneLabelColor,standardLabelClass:E.standardLabelClass,standardLabelStyle:E.standardLabelStyle,summaryLabelClass:E.summaryLabelClass,summaryLabelStyle:E.summaryLabelStyle,milestoneLabelClass:E.milestoneLabelClass,milestoneLabelStyle:E.milestoneLabelStyle,arrowSize:E.arrowSize,arrowFill:E.arrowFill,alternativeItemClass:E.alternativeItemClass,alternativeChartItemClass:E.alternativeChartItemClass,alternativeItemStyle:E.alternativeItemStyle,alternativeChartItemStyle:E.alternativeChartItemStyle,gridLines:E.gridLines,horizontalGridLines:E.horizontalGridLines,verticalGridLines:E.verticalGridLines,verticalGridHeaderLines:E.verticalGridHeaderLines,horizontalChartLines:E.horizontalChartLines,isIndividualItemNonworkingTimeHighlighted:E.isIndividualItemNonworkingTimeHighlighted,areTaskInterruptionsHighlighted:E.areTaskInterruptionsHighlighted,isBaselineVisible:E.isBaselineVisible,taskInitiationCost:E.taskInitiationCost,defaultResourceUsageCost:E.defaultResourceUsageCost,specificResourceUsageCosts:E.specificResourceUsageCosts,defaultResourceHourCost:E.defaultResourceHourCost,specificResourceHourCosts:E.specificResourceHourCosts,target:E.target,months:E.months,daysOfWeek:E.daysOfWeek,weekStartDay:E.weekStartDay,dateFormatter:E.dateFormatter,dateTimeFormatter:E.dateTimeFormatter,isRelativeToTimezone:E.isRelativeToTimezone,standardTaskTemplate:E.standardTaskTemplate,summaryTaskTemplate:E.summaryTaskTemplate,milestoneTaskTemplate:E.milestoneTaskTemplate,assignmentsTemplate:E.assignmentsTemplate,dependencyLineTemplate:E.dependencyLineTemplate,styleDefinitionTemplate:E.styleDefinitionTemplate,classic:E.classic}).timelineStart=Y(o.timelineStart,o.weekStartDay),o.timelineFinish=J(o.timelineFinish,o.weekStartDay),l=q(o.timelineFinish,o),o.chartWidth=l+"px";var N=R+l+2+(s?1:0);for(R=0;R<E.scales.length;R++)o.scales.push({scaleType:(s=E.scales[R]).scaleType,isHeaderVisible:s.isHeaderVisible,headerHeight:s.headerHeight,headerTextFormat:s.headerTextFormat,headerClass:s.headerClass,headerStyle:s.headerStyle,isHighlightingVisible:s.isHighlightingVisible,highlightingClass:s.highlightingClass,highlightingStyle:s.highlightingStyle,isSeparatorVisible:s.isSeparatorVisible,separatorClass:s.separatorClass,separatorStyle:s.separatorStyle,intervals:s.intervals});var X,_,re=!1;if(null!=f&&typeof f.createElement!==t)X=f;else{null!=f&&typeof f.focus!==t?_=f:(_=window.open("",f??"_blank",typeof T!==t&&T&&(typeof k===t||k)?"width=800,height=480,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),re=!0),X=_.document;try{var ne=document.head.getElementsByTagName("link");for(R=0;R<ne.length;R++){var ve=ne[R],Pe=X.adoptNode(ve.cloneNode(!0));Pe.href=ve.href,X.head.appendChild(Pe)}}catch{}}for(X.title=typeof e!==t?e:"Exported chart"+(typeof T!==t&&T?" (printable)":""),typeof u===t&&(u=0),typeof p===t&&(p=V.length-1),e=[],R=ne=0;R<V.length;R++)typeof(f=V[R]).displayRowIndex!==t&&(f.displayRowIndex<u||f.displayRowIndex>p)||typeof f.displayRowIndex===t&&(ne++<u||ne>p+1)||(E={content:f.content,label:f.label,indentation:f.indentation,start:f.start,finish:f.finish,completedFinish:f.completedFinish,isMilestone:f.isMilestone,schedule:ce(f),assignmentsContent:f.assignmentsContent,baselineStart:f.baselineStart,baselineFinish:f.baselineFinish,isBarVisible:f.isBarVisible,isRelativeToTimezone:f.isRelativeToTimezone,class:f.class,style:f.style,barClass:f.barClass,standardBarClass:f.standardBarClass,standardCompletedBarClass:f.standardCompletedBarClass,summaryBarClass:f.summaryBarClass,milestoneBarClass:f.milestoneBarClass,baselineBarClass:f.baselineBarClass,barStyle:f.barStyle,standardBarStyle:f.standardBarStyle,standardCompletedBarStyle:f.standardCompletedBarStyle,summaryBarStyle:f.summaryBarStyle,milestoneBarStyle:f.milestoneBarStyle,baselineBarStyle:f.baselineBarStyle,labelColor:f.labelColor,labelClass:f.labelClass,labelStyle:f.labelStyle,isSummaryEnabled:f.isSummaryEnabled,isParentSummarizationEnabled:f.isParentSummarizationEnabled,isHidden:f.isHidden,isExported:!0,tag:f},typeof f.displayRowIndex!==t&&(E.displayRowIndex=f.displayRowIndex-u),Ln(E,f),e.push(E),f.exportItem=E);for(R=0;R<V.length;R++)if((typeof(f=V[R]).displayRowIndex===t||!(f.displayRowIndex<u||f.displayRowIndex>p))&&(E=f.exportItem,typeof f.predecessors!==t))for(E.predecessors=[],ne=0;ne<f.predecessors.length;ne++)typeof(ve=f.predecessors[ne]).item.displayRowIndex!==t&&(ve.item.displayRowIndex<u||ve.item.displayRowIndex>p)||E.predecessors.push({item:ve.item.exportItem,dependencyType:ve.dependencyType,lag:ve.lag,dependencyLineClass:ve.dependencyLineClass,dependencyLineStyle:ve.dependencyLineStyle});var at=X.createElement("p");at.innerHTML=typeof n!==t?n:"",X.body.appendChild(at);var qe=X.createElement("div");qe.setAttribute("style","width: "+N+"px");try{DlhSoft.Controls.GanttChartView.initialize(qe,e,o,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch{}setTimeout(function(){re&&X.body.setAttribute("style","margin: 0px");var Ae=X.createElement("div");Ae.appendChild(qe),X.body.replaceChild(Ae,at),C&&(Ae.setAttribute("style","width: "+qe.offsetHeight+"px; height: "+N+"px; overflow: hidden"),Ae=Math.round((qe.offsetWidth-qe.offsetHeight)/2),qe.setAttribute("style","width: "+N+"px; transform: rotate(90deg) translateX("+Ae+"px) translateY("+Ae+"px); -webkit-transform: rotate(90deg) translateX("+Ae+"px) translateY("+Ae+"px)")),X.close(),void 0!==typeof _&&(_.focus(),typeof T!==t&&T&&setTimeout(function(){_.print(),(typeof k===t||k)&&setTimeout(function(){_.close()})}))},0)},tn=function(e){var n=Ke;if(typeof e===t)return n;for(var s=0;s<e.length;s++){var r=e[s];(!r.hasChildren||typeof r.isSummaryEnabled!==t&&!r.isSummaryEnabled)&&r.start<n&&(n=r.start)}return new Date(n.valueOf())},Ti=function(e){var n=We;if(typeof e===t)return n;for(var s=0;s<e.length;s++){var r=e[s];(!r.hasChildren||typeof r.isSummaryEnabled!==t&&!r.isSummaryEnabled)&&(typeof r.isMilestone!==t&&r.isMilestone?r.start>n&&(n=r.start):r.finish>n&&(n=r.finish))}return new Date(n.valueOf())},nn=function(e,n){for(var s=0,r=0;r<e.length;r++){var o=e[r];null==o.parent&&(s+=gt(o,n))}return s},rn=function(e,n){for(var s=0,r=0;r<e.length;r++){var o=e[r];null==o.parent&&(s+=Pt(o,n))}return s},sn=function(e,n){for(var s=[],r=0;r<n.length;r++){var o=n[r];if(o!=e&&typeof o.predecessors!==t&&0!=o.predecessors.length)for(var l=0;l<o.predecessors.length;l++)if(o.predecessors[l].item==e){s.push(o);break}}return s},ri=function(e,n){for(var s=[],r=sn(e,n),o=0;o<r.length;o++){var l=r[o];if(typeof l.predecessors!==t&&0!=l.predecessors.length)for(var y=0;y<l.predecessors.length;y++)l.predecessors[y].item==e&&s.push({successor:l,predecessor:l.predecessors[y]})}return s},si=function(e,n,s,r,o){if(typeof n===t&&(n=0),o=o||Ti(s),e.finish>=o)return!0;var l;if(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled){var y=e.successorPredecessors?e.successorPredecessors:ri(e,s);for(l=0;l<y.length;l++){var d=y[l].successor;if(!r.areTaskDependencyConstraintsEnabled){for(var u=e,p=!0;u;){if(I(u,d)){p=!1;break}u=u.parent}if(!p)continue}if(((typeof(u=y[l].predecessor).dependencyType===t||""==u.dependencyType||"FinishStart"==u.dependencyType||"FS"==u.dependencyType)&&Ge(e.finish,d.start,r,ce(e))<=(u.lag?u.lag:0)+n||("StartStart"==u.dependencyType||"SS"==u.dependencyType)&&Ge(e.start,d.start,r,ce(e))<=(u.lag?u.lag:0)+n)&&si(d,n,s,r,o))return!0}}else for(e=e.children,l=0;l<e.length;l++)if(si(e[l],n,s,r,o))return!0;return!1},Si=function(e,n,s){for(var r=0;r<e.length;r++){var o=e[r];(!o.hasChildren||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled)&&typeof o.predecessors!==t&&null!=o.predecessors&&o.predecessors.length>0&&Ht(o,e,n,s)}},on=function(e,o,l,r){o=new Date(o.valueOf()-6e4*o.getTimezoneOffset()),o=xt(o,r,ce(e)),l=gt(e,r);var y=Pt(e,r);Ii(e,o),oi(e,l,r),li(e,y,r),ot(e)},ln=function(e,n){for(var s=0,r=Ct(e),o=0;o<r.length;o++){var d,l=r[o],y=l.key;if(typeof n.specificResourceUsageCosts!==t&&(d=lt(n.specificResourceUsageCosts,y))>=0?s+=n.specificResourceUsageCosts[d].value*l.value:typeof n.defaultResourceUsageCost!==t&&(s+=n.defaultResourceUsageCost*l.value),!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled){var u=gt(e,n)/36e5;typeof n.specificResourceHourCosts!==t&&(d=lt(n.specificResourceHourCosts,y))>=0?s+=n.specificResourceHourCosts[d].value*u*l.value:typeof n.defaultResourceHourCost!==t&&(s+=n.defaultResourceHourCost*u*l.value)}}return s},bi=function(e,n){var s=(s=typeof n.taskInitiationCost!==t?n.taskInitiationCost:0)+ln(e,n);if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled))for(var r=0;r<e.children.length;r++)s+=Di(e.children[r],n);return s},Di=function(e,n){return(typeof e.executionCost!==t?e.executionCost:0)+bi(e,n)},an=function(e,n,s,r,o,l,y){if(typeof s!==t){typeof e===t&&(e=!1),typeof n===t&&(n=new Date),typeof l===t&&(l=!1),typeof y===t&&(y=!1),Si(s,r,o),o=[];var u,p,f,d=[],T=[];for(p=0;p<s.length;p++)if(!(u=s[p]).hasChildren||typeof u.isSummaryEnabled!==t&&!u.isSummaryEnabled){if(y){f=!1;for(var C=u;null!=C;){if(typeof C.predecessors!==t&&C.predecessors.length>0){f=!0;break}C=C.parent}if(!f)continue}o.push({key:u,value:Fn(u)}),C=l?[]:Ct(u);var k=[];for(f=0;f<C.length;f++){var V=C[f];V.value>0&&k.push(V)}d.push({key:u,value:k}),T.push(u)}for(s=[],l=o.length;l>0;){for(y=[],p=0;p<o.length;p++){for(u=o[p].key,f=!0,C=o[p].value,k=0;k<C.length;k++)if(lt(o,V=C[k])>=0&&y.indexOf(V)<0){f=!1;break}if(f){if(f=n,C=r,typeof(k=u).minStart!==t&&f<k.minStart&&(f=k.minStart),e||!Wt(k))for(;null!=k;){if(typeof k.predecessors!==t)for(V=0;V<k.predecessors.length;V++){var E=k.predecessors[V];if(typeof E!==t)switch(typeof(R=E.dependencyType)===t&&(R="FinishStart"),R){case"":case"FinishStart":case"FS":(E=_e(E.item.finish,typeof E.lag===t?0:E.lag,C,ce(E.item)))>f&&(f=E);break;case"StartStart":case"SS":(E=_e(E.item.start,typeof E.lag===t?0:E.lag,C,ce(E.item)))>f&&(f=E)}}for(k=k.parent;null!=k&&typeof k.isSummaryEnabled!==t&&!k.isSummaryEnabled;)k=k.parent}var B;for(C=f,k=d[f=lt(d,u)].value,f=0;f<k.length;f++)if(V=k[f].value,(R=lt(s,B=k[f].key))>=0){if(E=1,typeof r.resourceQuantities!==t){var ee=lt(r.resourceQuantities,B);ee>=0&&(E=r.resourceQuantities[ee].value)}for(previousAllocations=s[R].value,R=0;R<previousAllocations.length;R++)(B=previousAllocations[R].key)+V<=E||(ee=previousAllocations[R].value)>C&&(C=ee)}for((e||!Wt(u))&&(C=xt(C,r,ce(u)))!=u.start&&(f=gt(u,r),V=Pt(u,r),Ii(u,C),oi(u,f,r),li(u,V,r)),E=u.finish,f=0;f<k.length;f++){V=k[f].value,(R=lt(s,B=k[f].key))<0?s.push({key:B,value:ee=[]}):ee=s[R].value;for(var X,_,re,N=[{key:V,value:E}],R=0;R<ee.length;R++){B=ee[R].key;var ne=ee[R].value;ne>C&&(re=ne<E?ne:E,(X=lt(N,_=B+V))<0?N.push({key:_,value:re}):re>N[_]&&(N[X].value=re),N.push(ne<E?{key:B+V,value:ne}:{key:B+V,value:E}))}for(V=0;V<N.length;V++)re=N[V].value,(X=lt(ee,_=N[V].key))<0?ee.push({key:_,value:re}):re>ee[X].value&&(ee[X].value=re)}y.push(u)}}for(p=0;p<y.length;p++)o.splice(lt(o,y[p]),1);if(o.length==l)break;l=o.length}for(p=0;p<T.length;p++)le(u=T[p],"start",!0,!0),le(u,"finish",!0,!0),le(u,"completedFinish",!0,!0),ot(u)}},Fn=function(e){for(var n=[],s=(e=mi(e),0);s<e.length;s++)dn(e[s],n);return n},dn=function(e,n){if(!e.hasChildren||typeof e.isSummaryEnabled!==t&&!e.isSummaryEnabled)n.indexOf(e)<0&&n.push(e);else for(var s=0;s<e.children.length;s++)dn(e.children[s],n)},Wt=function(e){return!e.isMilestone&&e.completedFinish>e.start},gt=function(e,n){if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)){for(var s=0,r=e.children,o=0;o<r.length;o++)s+=gt(r[o],n);return s}return Ge(e.start,e.finish,n,ce(e))},Pt=function(e,n){if(e.hasChildren&&(typeof e.isSummaryEnabled===t||e.isSummaryEnabled)){for(var s=0,r=e.children,o=0;o<r.length;o++)s+=Pt(r[o],n);return s}return Ge(e.start,e.completedFinish,n,ce(e))},oi=function(e,n,s){n=_e(e.start,n,s,ce(e)),e.finish=n,le(e,"finish",!1,!1),un(e,!1)},li=function(e,n,s){e.completedFinish=_e(e.start,n,s,ce(e)),le(e,"completedFinish",!1,!1)},Ii=function(e,n){e.start=n,e.preferredStart=n,le(e,"start",!1,!1),un(e,!1)},un=function(e,n){for(var s=e.parent;null!=s;)h(s,n),s=(e=s).parent},fn=function(e,n,s){typeof s===t&&(s=!1);var r=e.parent,o=e.index;if(null==r){for(r=0;o-- >0;)0==(e=n[o]).indentation&&r++;return r+(s?0:1)}return fn(r,n)+"."+(r.children.indexOf(e)+(s?0:1))},Ct=function(e){var n;if(typeof(e=e.assignmentsContent)===t)n=[];else{e=e.split(",");for(var s=[],r=0;r<e.length;r++){var o=qt(e[r]),l=1,y=o.indexOf("["),d=o.lastIndexOf("]");if(y>=0&&d>=0){d=qt(o.substr(y+1,d-y-1)),o=qt(o.substr(0,y)),(y=d.indexOf("%"))>=0&&(d=qt(d.substr(0,y)));try{l=(n=parseFloat(d))/100}catch{l=1}}o.length<=0||((y=lt(s,o))<0?s.push({key:o,value:l}):s[y].value=s[y].value+l)}n=s}return n},pn=function(e){for(var n=[],s=(e=Ct(e),0);s<e.length;s++)n.push(e[s].key);return n},Nt=function(e,n){if(typeof n===t)return[];for(var s=[],r=0;r<n.length;r++){var o=n[r];if(!o.hasChildren||typeof o.isSummaryEnabled!==t&&!o.isSummaryEnabled)for(var l=Ct(o),y=0;y<l.length;y++){var d=l[y];if(d.key==e){s.push({key:o,value:d.value});break}}}return s},Qt=function(e){if(typeof e===t)return[];for(var n=[],s=0;s<e.length;s++)if(!(r=e[s]).hasChildren||typeof r.isSummaryEnabled!==t&&!r.isSummaryEnabled)for(var r=pn(r),o=0;o<r.length;o++){var l=r[o];n.indexOf(l)<0&&n.push(l)}return n},hn=function(e,n){for(var s=[],r=Nt(e,n),o=0;o<r.length;o++){var l=r[o],y=l.key;if(!y.hasChildren||typeof y.isSummaryEnabled!==t&&!y.isSummaryEnabled)for(y=[{start:y.start,finish:y.finish}];y.length>0;){var d;if(d=y[0],y.splice(0,1),!(d.finish<=d.start))if(0==s.length)s.push({key:d,value:l.value});else{tn(n);for(var u=!1,p=0;p<s.length;p++){var f=s[p].key,T=s[p].value;if(!(d.start>=f.finish)){if(d.finish<=f.start){for(u=0;u<=p;u++)if(s[u].key.start>=d.start){s.splice(u,0,{key:d,value:l.value});break}u=!0;break}if(d.start<=f.start&&d.finish>=f.finish){s[p].value=T+l.value,d.start<f.start&&y.push({start:d.start,finish:f.start}),d.finish>f.finish&&y.push({start:f.finish,finish:d.finish}),u=!0;break}if(d.start>=f.start&&d.finish<=f.finish){s.splice(p,1),d.start>f.start&&s.splice(p++,0,{key:{start:f.start,finish:d.start},value:T}),s.splice(p++,0,{key:d,value:T+l.value}),d.finish<f.finish&&s.splice(p++,0,{key:{start:d.finish,finish:f.finish},value:T}),u=!0;break}if(d.start>=f.start&&d.finish>=f.finish){s.splice(p,1),d.start>f.start&&s.splice(p++,0,{key:{start:f.start,finish:d.start},value:T}),s.splice(p++,0,{key:{start:d.start,finish:f.finish},value:T+l.value}),d.finish>f.finish&&y.push({start:f.finish,finish:d.finish}),u=!0;break}if(d.start<=f.start&&d.finish<=f.finish){s.splice(p,1),d.start<f.start&&y.push({start:d.start,finish:f.start}),s.splice(p++,0,{key:{start:f.start,finish:d.finish},value:T+l.value}),d.finish<f.finish&&s.splice(p++,0,{key:{start:d.finish,finish:f.finish},value:T}),u=!0;break}}}u||s.push({key:d,value:l.value})}}}return s},xi=function(e,n,s){for(var r=0;r<e.length;r++){var o=e[r];if(o.key==n){if((n=o.value).indexOf(s)>=0)return!0;for(r=0;r<n.length;r++)if(xi(e,n[r],s))return!0;break}}return!1},Mt=function(e){var n=e.content;return null==e.parent?n:n+" ("+Mt(e.parent)+")"},Jt=function(e,n){return e==n||null!=e.parent&&Jt(e.parent,n)},qt=function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},lt=function(e,n){for(var s=0;s<e.length;s++)if(e[s].key==n)return s;return-1},cn=function(e){return typeof e!==t?new Date(e.valueOf()+6e4*e.getTimezoneOffset()):e},mn=function(e){return typeof e!==t?new Date(e.valueOf()-6e4*e.getTimezoneOffset()):e},On=function(e,n,s){var r;for(r=0;r<n.length;r++)n[r].ganttChartView=e;for(r=0;r<n.length;r++){var o=n[r];if(typeof o.parts!==t){typeof o.isGroup===t&&(o.isGroup=!0,o.isSummaryEnabled=!1),ge(o.parts,s),(o.isGroup||typeof o.isBarVisible===t)&&(o.isBarVisible=!1);for(var l=0;l<o.parts.length;l++){var y=o.parts[l];y.ganttChartView=o.ganttChartView,y.ganttChartItem=o,y.isPart=!0,y.isVirtuallyVisible=!0,(o.isGroup||typeof y.indentation===t)&&(y.indentation=0),(o.isGroup||typeof y.displayRowIndex===t)&&(y.displayRowIndex=-1),y.isInternallyHidden=!0,n.indexOf(y)>=0||n.splice(n.length,0,y)}}}e.items=n,e.settings=s,e.refresh=function(){xe(e)},e.refreshItems=function(){Ut(n)},e.refreshGridItems=function(){for(var d=0;d<n.length;d++)Yt(n[d])},e.refreshChartItems=function(){for(var d=0;d<n.length;d++)bt(n[d])},e.refreshGridItem=Yt,e.refreshChartItem=bt,e.refreshItem=Dt,e.refreshPredecessorItems=It,e.refreshItemGraph=Bt,e.refreshItemPath=ot,e.refreshItemNeighbourhood=function(d){Zt(d,n,e,s)},e.refreshCurrentTimeLine=function(){var f,d=e.chartHeader,u=e.chartContent,p=u.chartArea,T=[];for(f=p.childNodes.length;f-- >1;){var C=p.childNodes[f];"Scale-Highlighting-CurrentTime"!=C.tag&&"Scale-Separator-CurrentTime"!=C.tag&&T.push(C),p.removeChild(C)}for(ie(d,p,s.scales,s,!0),f=T.length;f-- >0;)p.appendChild(T[f]);Lt(u,kt(n,s))},e.setCurrentTime=function(d){s.currentTime=d,e.refreshCurrentTimeLine()},e.updateCurrentTime=function(){var d=new Date;d=new Date(d.valueOf()-6e4*d.getTimezoneOffset()),e.setCurrentTime(d)},e.getCurrentItem=function(){return e.currentItem},e.getSelectedItem=function(){return e.selectedItem},e.getSelectedItems=function(){return e.selectedItems},e.selectItem=function(d){U(d,!0,s.selectionMode)},e.unselectItem=function(d){U(d,!1,s.selectionMode)},e.expandItem=function(d){vt(d,!0,!0)},e.collapseItem=function(d){vt(d,!1,!0)},e.scrollToItem=qi,e.scrollToBottom=function(){e.chartContentContainer.scrollTop=e.chartContent.clientHeight},e.scrollToDateTime=function(d){e.isDuringScrollToDateTime=!0,e.chartContentContainer.scrollLeft=q(d,e.settings)},e.increaseTimelinePage=function(d){s.timelineStart=new Date(s.timelineStart.valueOf()+d),s.timelineFinish=new Date(s.timelineFinish.valueOf()+d),xe(e)},e.decreaseTimelinePage=function(d){s.timelineStart=new Date(s.timelineStart.valueOf()-d),s.timelineFinish=new Date(s.timelineFinish.valueOf()-d),xe(e)},e.setSplitterPosition=function(T){var u=e.gridContainer,p=e.chartContainer,f=e.splitter;T=Math.ceil(1e6*T/e.offsetWidth)/1e4,typeof u.percent!==t&&delete u.percent,u.style.width=T+"%",p.style.width=100-T+"%",Rt(f,u,s)},e.getChartPosition=function(d){return q(d,s)},e.getChartWidth=function(){return q(s.timelineFinish,s)},e.getDateTime=function(d){return te(d,s)},e.getWorkingTime=function(d){return Ki(d,s)},e.getStartWorkingTime=function(d){return xt(d,s)},e.getFinishWorkingTime=function(d){return Ze(d,s,!1,!0,void 0)},e.getEffort=function(d,u){return Ge(d,u,s)},e.getFinish=function(d,u){return _e(d,u,s)},e.getStart=function(d,u){return _t(d,u,s)},e.getCompletion=function(d,u,p){return ei(d,u,p,s)},e.getCompletedFinish=function(d,u,p){return yi(d,u,p,s)},e.getItemsHeight=function(){return kt(n,s)},e.getItemTop=function(d){return Et(d,n,s)},e.onItemPropertyChanged=le,e.initializeTaskDraggingThumbs=function(d,u,p,f,T,C,k,V){vi(d,u,p,f,T,C,k,V,e.items,e,e.settings)},e.initializeDependencyDraggingThumbs=function(d,u,p,f,T,C,k){ti(d,u,p,f,T,C,k,e.items,e,e.settings)},e.insertItem=function(d,u){Mi(d,u,e,n,s)},e.addItem=function(d){e.insertItem(n.length,d)},e.insertItems=function(d,u){for(var p=0;p<u.length;p++)e.insertItem(d++,u[p])},e.addItems=function(d){for(var u=0;u<d.length;u++)e.addItem(d[u])},e.removeItem=function(d){Bi(d,e,n,s)},e.removeItems=function(d){for(var u=0;u<d.length;u++)e.removeItem(d[u])},e.increaseItemIndentation=function(d){var u=d.index>0?e.items[d.index-1]:null;if(!(null==u||d.indentation>u.indentation)){if(vt(d,!0,!1,!0),d.indentation++,le(d,"indentation",!0,!0),d.predecessors&&d.predecessors.length>0){for(var p=!1,f=0;f<d.predecessors.length;f++)d.predecessors[f].item==u&&d.indentation>u.indentation&&(d.predecessors.splice(f--,1),p=!0);p&&le(d,"predecessors",!1,!0)}for(p=0;p<n.length;p++)if((f=n[p])==u&&typeof f.predecessors!==t&&0!=f.predecessors.length)for(var T=0;T<f.predecessors.length;T++)f.predecessors[T].item==d&&u.indentation>f.predecessors[T].item.indentation&&(f.predecessors.splice(T--,1),le(f,"predecessors",!1,!0),Dt(f),It(f));for(jt(n,s)&&Ut(n),Zt(d,n,e,s);null!=d;)d.isExpanded||vt(d,!0,!1),d=d.parent}},e.decreaseItemIndentation=function(d){var u=d.index<e.items.length-1?e.items[d.index+1]:null;if(!(d.indentation<=0||null!=u&&d.indentation<u.indentation)){if(d.indentation--,le(d,"indentation",!0,!0),u&&d.predecessors&&d.predecessors.length>0){for(var p=!1,f=0;f<d.predecessors.length;f++)d.predecessors[f].item==u&&d.indentation<u.indentation&&(d.predecessors.splice(f--,1),p=!0);p&&le(d,"predecessors",!1,!0)}for(p=0;p<n.length;p++)if((f=n[p])==u&&typeof f.predecessors!==t&&0!=f.predecessors.length)for(var T=0;T<f.predecessors.length;T++)f.predecessors[T].item==d&&u.indentation<f.predecessors[T].item.indentation&&(f.predecessors.splice(T--,1),le(f,"predecessors",!1,!0),Dt(f),It(f));for(jt(n,s)&&Ut(n),Zt(d,n,e,s);null!=d;)d.isExpanded||vt(d,!0,!1),d=d.parent}},e.setItemContent=function(d,u){d.content=u,le(d,"content",!0,!0)},e.setItemStart=function(d,u){d.start=xt(u,s,ce(d)),d.preferredStart=d.start,le(d,"start",!0,!0),d.completedFinish<d.start&&(d.completedFinish=d.start,le(d,"completedFinish",!1,!0))},e.setItemFinish=function(d,u){var p;p=ce(d),p=Ze(u,s,!1,!0,p),d.finish=p,le(d,"finish",!0,!0),d.completedFinish>d.finish&&(d.completedFinish=d.finish,le(d,"completedFinish",!1,!0))},e.setItemIsMilestone=function(d,u){d.isMilestone=u,le(d,"isMilestone",!0,!0)},e.getItemEffort=function(d){return gt(d,s)},e.setItemEffort=function(d,u){d.finish=_e(d.start,u,s,ce(d)),le(d,"finish",!0,!0),d.completedFinish>d.finish&&(d.completedFinish=d.finish,le(d,"completedFinish",!1,!0))},e.getItemTotalEffort=function(d){return gi(d)},e.setItemTotalEffort=function(d,u){d.ganttChartView.setItemEffort(d,u/$t(d))},e.setItemHasFixedEffort=function(d,u){d.hasFixedEffort=u,!d.hasChildren&&d.hasFixedEffort&&(d.fixedEffort=gt(d,s),d.fixedEffortAssignments=Ct(d))},e.getItemDuration=function(d){return Ge(d.start,d.finish,s,ce(d))},e.setItemDuration=e.setItemEffort,e.getItemCompletedEffort=function(d){return Pt(d,s)},e.setItemCompletedEffort=function(d,u){d.completedFinish=_e(d.start,u,s,ce(d)),d.completedFinish>d.finish&&(d.completedFinish=d.finish),le(d,"completedFinish",!0,!0)},e.getItemTotalCompletedEffort=function(d){return Ci(d)},e.setItemTotalCompletedEffort=function(d,u){d.ganttChartView.setItemCompletedEffort(d,u/$t(d))},e.getItemCompletion=function(d){return e.getItemCompletedEffort(d)/e.getItemEffort(d)},e.setItemCompletion=function(d,u){e.setItemCompletedEffort(d,u*e.getItemEffort(d))},e.isItemCompleted=function(d){return e.getItemCompletion(d)>=1||(d.isMilestone||d.finish.valueOf()<=d.start.valueOf())&&typeof d.isSetAsCompleted!==t&&d.isSetAsCompleted},e.setItemAsCompleted=function(d){(d.isMilestone||d.finish.valueOf()<=d.start.valueOf())&&(d.isSetAsCompleted=!0),e.setItemCompletion(d,1)},e.hasItemStarted=function(d){return Wt(d)},e.setItemAsNotStarted=function(d){(d.isMilestone||d.finish.valueOf()<=d.start.valueOf())&&(d.isSetAsCompleted=!1),e.setItemCompletion(d,0)},e.isItemOnSchedule=function(d){var u=new Date;return u=new Date(u.valueOf()-6e4*u.getTimezoneOffset()),d.completedFinish>=u},e.setItemAssignmentsContent=function(d,u){d.assignmentsContent=u,le(d,"assignmentsContent",!0,!0)},e.getItemPredecessorsString=function(d,u){var p=u;typeof p===t&&(p=!1);var f="";if(typeof d.predecessors!==t&&0!=d.predecessors.length)for(var T=0;T<d.predecessors.length;T++){var C=d.predecessors[T],k=n.indexOf(C.item);k<0||(f.length>0&&(f+=", "),f+=k+(p?0:1),typeof C.dependencyType!==t&&""!=C.dependencyType&&"FinishStart"!=C.dependencyType&&"FS"!=C.dependencyType&&("StartStart"==C.dependencyType||"SS"==C.dependencyType?f+="SS":"FinishFinish"==C.dependencyType||"FF"==C.dependencyType?f+="FF":("StartFinish"==C.dependencyType||"SF"==C.dependencyType)&&(f+="SF")),typeof C.lag!==t&&0!=C.lag&&(C.lag>0&&(f+="+"),f+=C.lag/36e5))}return f},e.setItemPredecessorsString=function(d,u,p){typeof p===t&&(p=!1);var f=[];d.predecessors=f,u=u.split(",");for(var T=0;T<u.length;T++)if(!((C=qt(u[T])).length<=0)){for(var k=0;k<C.length&&C.charCodeAt(k)>=48&&C.charCodeAt(k)<=57;)k++;var V=C.substr(0,k);if(V=parseInt(V)-(p?0:1),!(isNaN(V)||V<0||V>=n.length||(V=n[V],w(d,V)||I(d,V)||I(V,d)))){k=(C=C.substr(k)).indexOf("+");var C,R=C.indexOf("-"),E=k>=0?k:R>=0?R:-1;if(R=0,E>=0){var B=parseFloat(C.substr(E+1));isNaN(B)||(R=B*(k>=0?1:-1)*36e5)}C=(E<0?C:C.substr(0,E)).toUpperCase(),f.push({item:V,dependencyType:C,lag:R})}}for(p=0;p<n.length;p++)delete n[p].successors;le(d,"predecessors",!0,!0)},e.getItemIndexString=function(d,u){return typeof u===t&&(u=!1),typeof d.index!==t?(d.index+(u?0:1)).toString():""},e.getItemWbsIndexString=function(d,u){return fn(d,n,u).toString()},e.moveRange=function(d,u,p){ni(d,u,p,e,n)},e.moveItem=function(d,u){wi(d,u,e,n)},e.moveItemUp=function(d){var u=n.indexOf(d);u<=0||wi(d,u-1,e,n)},e.moveItemDown=function(d){var u=n.indexOf(d);u<0||u>=n.length-1||wi(d,u+1,e,n)},e.moveItemHierarchy=function(d,u){for(var p=n.indexOf(d),f=p+1;f<n.length&&!(n[f].indentation<=d.indentation);f++);ni(p,f-p,u,e,n)},e.moveItemHierarchyUp=function(d){for(var u=n.indexOf(d),p=u+1;p<n.length&&!(n[p].indentation<=d.indentation);p++);for(var f=u;f-- >0;){if(n[f].indentation<d.indentation)return;if(n[f].indentation==d.indentation)break}ni(u,p-u,f,e,n)},e.moveItemHierarchyDown=function(d){for(var u=n.indexOf(d),p=u+1;p<n.length&&!(n[p].indentation<=d.indentation);p++);for(var f=u+(p-=u);f++<n.length-1&&!(n[f].indentation<=d.indentation););n[f-1].indentation<d.indentation||ni(u,p,f-p,e,n)},e.exportContent=function(d,u){typeof d===t&&(d={}),en(d.title,d.preparingMessage,d.isGridVisible,d.columnIndexes,d.timelineStart,d.timelineFinish,d.isRelativeToTimezone,d.hourWidth,d.startRowIndex,d.endRowIndex,u,!1,d.rotate,!1,n,s)},e.print=function(d){typeof d===t&&(d={}),en(d.title,d.preparingMessage,d.isGridVisible,d.columnIndexes,d.timelineStart,d.timelineFinish,d.isRelativeToTimezone,d.hourWidth,d.startRowIndex,d.endRowIndex,null,!0,d.rotate,d.autoClose,n,s)},e.getRootItems=function(){for(var d=[],u=0;u<n.length;u++){var p=n[u];null==p.parent&&d.push(p)}return d},e.getLeafItems=function(){for(var d=[],u=0;u<n.length;u++){var p=n[u];null!=p.parent&&d.push(p)}return d},e.getSummaryItems=function(){for(var d=[],u=0;u<n.length;u++){var p=n[u];p.hasChildren&&d.push(p)}return d},e.getProjectStart=function(){return tn(n)},e.getProjectFinish=function(){return Ti(n)},e.getProjectEffort=function(){return nn(n,s)},e.getProjectTotalEffort=function(){for(var d=0,u=0;u<n.length;u++){var p=n[u];null==p.parent&&(d+=gi(p))}return d},e.getProjectCompletedEffort=function(){return rn(n,s)},e.getProjectTotalCompletedEffort=function(){for(var d=0,u=0;u<n.length;u++){var p=n[u];null==p.parent&&(d+=Ci(p))}return d},e.getProjectCompletion=function(){return rn(n,s)/nn(n,s)},e.isItemCritical=function(d,u){return si(d,u,n,s)},e.getCriticalItems=function(d,u){var p,f=u||n;if(typeof(p=d)===t&&(p=0),typeof f===t)p=void 0;else{for(var T=Ti(f),C=0;C<f.length;C++){var k=f[C];k.successorPredecessors=ri(k,f)}var V=[];for(C=0;C<f.length;C++)(!(k=f[C]).hasChildren||typeof k.isSummaryEnabled!==t&&!k.isSummaryEnabled)&&si(k,p,f,s,T)&&V.push(k);for(C=0;C<f.length;C++)delete(k=f[C]).successorPredecessors;p=V}return p},e.getPertCriticalItems=function(d,u){return function(e,n,s,r){if(typeof n!==t)return n=e.getNetworkDiagramItems(r,void 0,void 0,n),e=e.ownerDocument.createElement("div"),DlhSoft.Controls.Pert.NetworkDiagramView.initialize(e,n,void 0,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),e.getCriticalItems().filter(function(o){return o.tag}).map(function(o){return o.tag})}(e,u||n,0,d)},e.ensureDependencyConstraints=function(){Si(n,s,e)},e.setupBaseline=function(){for(var d=0;d<n.length;d++){var u=n[d];!u.hasChildren||typeof u.isSummaryEnabled!==t&&!u.isSummaryEnabled?(u.baselineStart=u.start,u.isMilestone?delete u.baselineFinish:u.baselineFinish=u.finish):(delete u.baselineFinish,delete u.baselineStart),Dt(u)}},e.rescheduleItemToStart=function(d,u){on(d,u,n,s)},e.rescheduleItemToFinish=function(d,u){var T=u,p=(T=new Date(T.valueOf()-6e4*T.getTimezoneOffset()),gt(d,s)),f=Pt(d,s);T=_t(p,T,s,ce(d)),T=xt(T,s,ce(d)),Ii(d,T),oi(d,p,s),li(d,f,s),ot(d)},e.splitRemainingWork=function(d,u,p){if(typeof n===t||d.hasChildren||d.isMilestone||!Wt(d)||!d.isMilestone&&d.completedFinish>=d.finish)d=null;else{var f=n.indexOf(d);if(f<0)d=null;else{for(u={content:typeof u===t?d.content:d.content+u,indentation:d.indentation,isExpanded:d.isExpanded,start:d.completedFinish,finish:d.finish,assignmentsContent:d.assignmentsContent,isReadOnly:d.isReadOnly,isHidden:d.isHidden,isBarVisible:d.isBarVisible,isBarReadOnly:d.isBarReadOnly,isSummaryEnabled:d.isSummaryEnabled,isParentSummarizationEnabled:d.isParentSummarizationEnabled,displayRowIndex:d.displayRowIndex,class:d.class,style:d.style,barClass:d.barClass,standardBarClass:d.standardBarClass,summaryBarClass:d.summaryBarClass,milestoneBarClass:d.milestoneBarClass,baselineBarClass:d.baselineBarClass,barStyle:d.barStyle,standardBarStyle:d.standardBarStyle,summaryBarStyle:d.summaryBarStyle,milestoneBarStyle:d.milestoneBarStyle,baselineBarStyle:d.baselineBarStyle,taskTemplate:d.taskTemplate,template:d.template,tag:d.tag},typeof p!==t&&(d.content=d.content+p),d.finish=d.completedFinish,Mi(f+1,u,e,n,s),p=ri(d,n),f=0;f<p.length;f++){var T=p[f].predecessor;(typeof T.dependencyType===t||""==T.dependencyType||"FinishStart"==T.dependencyType||"FS"==T.dependencyType||"FinishFinish"==T.dependencyType||"FF"==T.dependencyType)&&(T.item=u)}u.predecessors=[{item:d}],It(d),It(u),d=u}}return d},e.optimizeWork=function(d,u,p,f){var T;if(typeof d===t&&(d=!1),typeof u===t&&(u=!1),typeof p===t&&(p=new Date),f)an(u,p,n,s,e,!0,d);else{for(p=new Date(p.valueOf()+6e4*p.getTimezoneOffset()),T=[],f=0;f<n.length;f++){var C=n[f];if((!C.hasChildren||typeof C.isSummaryEnabled!==t&&!C.isSummaryEnabled)&&!(C.start<=p||!u&&Wt(C))){if(d){for(var k=!1,V=C;null!=V;){if(typeof V.predecessors!==t&&V.predecessors.length>0){k=!0;break}V=V.parent}if(!k)continue}on(C,p,n,s),T.push(C)}}for(Si(n,s,e),f=0;f<T.length;f++)le(d=T[f],"start",!0,!0),le(d,"finish",!0,!0),le(d,"completedFinish",!0,!0),ot(d);T=void 0}return T},e.levelAllocations=function(d){d||(d=e.items),d.length||(d=[d]);for(var u=0;u<d.length;u++){var f,p=d[u],T="",C=Ct(p);if(C&&C.length>0){var k=0;for(f=0;f<C.length;f++)k+=C[f].value;if(k>0){for(f=0;f<C.length;f++)T.length>0&&(T+=", "),T+=C[f].key+(C.length>1?" ["+Math.round(C[f].value/k*1e4)/100+"%]":"");p.assignmentsContent=T,le(p,"assignmentsContent",!1,!0),ot(p)}}}},e.levelResources=function(d,u){return an(d,u,n,s,e)},e.getItemSuccessors=function(d){return sn(d,n)},e.getItemSuccessorPredecessorItems=function(d){return ri(d,n)},e.getItemAllocationUnits=$t,e.getItemAssignments=Ct,e.getItemAssignedResources=pn,e.getResourceAssignments=function(d){return Nt(d,n)},e.getResourceAssignedItems=function(d){for(var u=[],p=(d=Nt(d,n),0);p<d.length;p++)u.push(d[p].key);return u},e.getAssignedResources=function(){return Qt(n)},e.getItemAssignmentsCost=function(d){return ln(d,s)},e.getItemExtraCost=function(d){return bi(d,s)},e.getItemCost=function(d){return Di(d,s)},e.setItemCost=function(d,u){d.executionCost=u-bi(d,s),le(d,"executionCost",!0,!0)},e.getResourceCost=function(d){for(var u=0,p=(d=Nt(d,n),0);p<d.length;p++){var T,f=d[p];typeof s.specificResourceUsageCosts!==t&&(T=lt(s.specificResourceUsageCosts,resource))>=0?u+=s.specificResourceUsageCosts[T].value*f.value:typeof s.defaultResourceUsageCost!==t&&(u+=s.defaultResourceUsageCost*f.value);var C=f.key;(!C.hasChildren||typeof C.isSummaryEnabled!==t&&!C.isSummaryEnabled)&&(C=gt(C,s)/36e5,typeof s.specificResourceHourCosts!==t&&(T=lt(s.specificResourceHourCosts,resource))>=0?u+=s.specificResourceHourCosts[T].value*C*f.value:typeof s.defaultResourceHourCost!==t&&(u+=s.defaultResourceHourCost*C*f.value))}return u},e.getProjectCost=function(){for(var d=0,u=0;u<n.length;u++){var p=n[u];null==p.parent&&(d+=Di(p,s))}return d},e.getScheduleChartItems=function(p){var f,C,u=[],T=(p=typeof p!==t?"array"==typeof p?p:[p]:typeof s.assignableResources!==t?s.assignableResources:[],Qt(n));for(C=0;C<T.length;C++)p.indexOf(f=T[C])<0&&p.push(f);for(C=0;C<p.length;C++){T={tag:f=p[C],content:f,ganttChartItems:[]},f=Nt(f,n);for(var k=0;k<f.length;k++){var V=(E=f[k]).key,E={tag:V,content:V.content,start:V.start,finish:V.finish,completedFinish:V.completedFinish,isMilestone:V.isMilestone,schedule:ce(V),assignmentsContent:1!=E.value?Math.round(1e4*E.value)/100+"%":"",minStart:V.minStart,maxStart:V.maxStart,minFinish:V.minFinish,maxFinish:V.maxFinish,isHidden:V.isHidden,isBarVisible:V.isBarVisible,isBarReadOnly:V.isBarReadOnly,isReadOnly:V.isReadOnly,isRelativeToTimezone:V.isRelativeToTimezone};T.ganttChartItems.push(E)}u.push(T)}return u},e.getAllocations=function(d){return hn(d,n)},e.getLoadChartItems=function(d){var u=[];typeof d===t?d=Qt(n):"array"!=typeof d&&(d=[d]);for(var p=0;p<d.length;p++){for(var f=d[p],T={tag:f,content:f,ganttChartItems:[]},C=hn(f,n),k=0;k<C.length;k++){var V=C[k],E=1;if(typeof s.resourceQuantities!==t){var R=lt(s.resourceQuantities,f);R>=0&&(E=s.resourceQuantities[R].value)}typeof(R=s.maxLoadChartDisplayedResourceQuantity)===t&&(R=100),E>R&&(E=R),T.ganttChartItems.push({start:V.key.start,finish:V.key.finish,units:V.value/E,content:Math.round(1e4*V.value)/100+"%",isRelativeToTimezone:!1})}u.push(T)}return u},e.getFilteredGanttChartItems=function(d){d=[d];for(var u=[],p=0;p<d.length;p++){var f=d[p],T=[];if(typeof d===t)d=Qt(n);else if("array"!=typeof d)var C=Nt(f,n);for(f=0;f<C.length;f++){var k=C[f].key;(!k.hasChildren||typeof k.isSummaryEnabled!==t&&!k.isSummaryEnabled)&&!(u.indexOf(k)>=0)&&(T.push({tag:k,content:k.content,start:k.start,finish:k.finish,completedFinish:k.completedFinish,isMilestone:k.isMilestone,assignmentsContent:d.length>1?k.assignmentsContent:1!=C[f].value?Math.round(1e4*C[f].value)/100+"%":"",minStart:k.minStart,maxStart:k.maxStart,minFinish:k.minFinish,maxFinish:k.maxFinish,isHidden:k.isHidden,isBarVisible:k.isBarVisible,isBarReadOnly:k.isBarReadOnly,isReadOnly:!0,isRelativeToTimezone:k.isRelativeToTimezone}),u.push(k))}}return T},e.copyCommonSettings=function(d){typeof d!==t&&(d.target=s.target,d.theme=s.theme,d.border=s.border,d.containerClass=s.containerClass,d.containerStyle=s.containerStyle,d.isGridVisible=s.isGridVisible,d.gridWidth=s.gridWidth,d.chartWidth=s.chartWidth,d.isSplitterEnabled=s.isSplitterEnabled,d.splitterWidth=s.splitterWidth,d.splitterBackground=s.splitterBackground,d.minGridWidth=s.minGridWidth,d.minChartWidth=s.minChartWidth,d.headerBackground=s.headerBackground,d.headerHeight=s.headerHeight,d.indentationLevelWidth=s.indentationLevelWidth,d.gridLines=s.gridLines,d.horizontalGridLines=s.horizontalGridLines,d.verticalGridLines=s.verticalGridLines,d.verticalGridHeaderLines=s.verticalGridHeaderLines,d.horizontalChartLines=s.horizontalChartLines,d.displayedTime=s.displayedTime,d.currentTime=s.currentTime,d.timelineStart=s.timelineStart,d.timelineFinish=s.timelineFinish,d.scales=s.scales,d.updateScale=s.updateScale,d.hourWidth=s.hourWidth,d.workingWeekStart=s.workingWeekStart,d.workingWeekFinish=s.workingWeekFinish,d.visibleDayStart=s.visibleDayStart,d.visibleDayFinish=s.visibleDayFinish,d.visibleWeekStart=s.visibleWeekStart,d.visibleWeekFinish=s.visibleWeekFinish,d.specialNonworkingDays=s.specialNonworkingDays,d.months=s.months,d.daysOfWeek=s.daysOfWeek,d.weekStartDay=s.weekStartDay,d.dateFormatter=s.dateFormatter,d.dateTimeFormatter=s.dateTimeFormatter,d.dateTimeParser=s.dateTimeParser,d.isRelativeToTimezone=s.isRelativeToTimezone,d.classic=s.classic)},e.getPertChartItems=function(R,u,p,f,ee,C,k){var V=R,E=u,B=(R=p,ee),N=(ee=C,k||n);(typeof V===t||V<0)&&(V=Number.MAX_VALUE),typeof E===t&&(E="Start"),typeof R===t&&(R="Finish"),typeof B===t&&(B=" completed"),typeof ee===t&&(ee=" starting");var _,re,ne,ve,X=new Date(new Date(1e4,0,1).valueOf()-1);for(k=[],C=[],u=0;u<N.length;u++)(p=N[u]).indentation<=V&&(!p.hasChildren||typeof p.isSummaryEnabled!==t&&!p.isSummaryEnabled&&(typeof p.isBarVisible===t||p.isBarVisible)||p.indentation==V)&&C.push({key:p,value:[]});for(u=0;u<C.length;u++){var Pe=[p=C[u].key];if(p.indentation==V&&p.hasChildren&&(typeof p.isSummaryEnabled===t||p.isSummaryEnabled||typeof p.isBarVisible!==t&&!p.isBarVisible))for(_=0;_<N.length;_++)Jt(re=N[_],p)&&Pe.push(re);var at=C[u].value;for(_=0;_<Pe.length;_++)for(var qe=Pe[_];null!=qe;){if(typeof qe.predecessors!==t)for(ne=0;ne<qe.predecessors.length;ne++)if(typeof qe.predecessors[ne].item!==t&&(typeof qe.predecessors[ne].dependencyType===t||""==qe.predecessors[ne].dependencyType||"FinishStart"==qe.predecessors[ne].dependencyType||"FS"==qe.predecessors[ne].dependencyType)){for(var Ae=ve=qe.predecessors[ne].item;null!=Ae&&lt(C,Ae)<0;)Ae=Ae.parent;if(Ae!=p){var nt=[];if(null!=Ae)nt.push(Ae);else for(Ae=0;Ae<C.length;Ae++)Jt(re=C[Ae].key,ve)&&nt.push(re);for(Ae=0;Ae<nt.length;Ae++)at.indexOf(ve=nt[Ae])<0&&(V<Number.MAX_VALUE&&xi(C,ve,p)||at.push(ve))}}qe=qe.parent}}for(Ae=0,ne=_=null,u=0;u<N.length;u++)p=N[u],(null==_||p.start<_)&&(_=p.start),(null==ne||p.finish>ne)&&(ne=p.finish);for(null==_&&(_=X),E={content:E,displayedText:(Ae++).toString(),displayedRowIndex:0,displayedColumnIndex:0},k.push(E),N=[E],V=[],u=0;u<C.length;u++)0==C[u].value.length&&V.push(C[u].key);if(V.length>0){for(N=[],u=0;u<V.length;u++)p=V[u],ne=E,X=(Ae++).toString(),p.start>_&&(ne={content:null!=p.content?p.content.toString()+ee:null,displayedText:X,predecessors:[]},k.push(ne),ne.predecessors.push({item:E,content:f,isEffortVirtual:!0})),N.push(X={content:p.content+B,displayedText:X+(ne!=E?"'":""),predecessors:[],tag:p}),k.push(X),X.predecessors.push({item:ne,content:Mt(p),displayedText:null!=p.content?p.content.toString():null,effort:Ge(p.start,p.finish,s,ce(p)),tag:p});do{for(Pe=[],u=0;u<N.length;u++)Pe.push(N[u]);for(p=!1,u=0;u<N.length;u++){for(X=(V=N[u]).tag,at=[],_=0;_<C.length;_++)C[_].value.indexOf(X)>=0&&at.push(C[_].key);if(at.length>0){for(Pe.splice(Pe.indexOf(V),1),_=0;_<at.length;_++){for(p=at[_],X=null,ne=0;ne<k.length;ne++)if(k[ne].tag==p){X=k[ne];break}null==X&&(X={content:p.content+B,displayedText:(Ae++).toString(),predecessors:[],tag:p},Pe.push(X),k.push(X)),X.predecessors.push({item:V,content:Mt(p),displayedText:null!=p.content?p.content.toString():null,effort:Ge(p.start,p.finish,s,ce(p)),tag:p})}p=!0}}N=Pe}while(p)}for(p={content:R,displayedText:(Ae++).toString(),predecessors:[],displayedRowIndex:0},k.push(p),p=p.predecessors,u=0;u<N.length;u++)p.push({item:N[u]});for(_=0;_<C.length;_++){for(p=C[_].key,V=null,ne=0;ne<k.length;ne++)if(k[ne].tag==p){V=k[ne];break}if(null!=V){if(u=[],typeof V.predecessors!==t)for(ne=0;ne<V.predecessors.length;ne++)V.predecessors[ne].tag==p&&u.push(V.predecessors[ne]);if(u.length>1){for(B={content:null!=p.content?p.content.toString()+ee:null,displayedText:V.displayedText,predecessors:[]},k.splice(k.indexOf(V),0,B),Ae=B.predecessors,ne=0;ne<u.length;ne++)V.predecessors.splice(V.predecessors.indexOf(R=u[ne]),1),Ae.push({item:R.item,content:f,isEffortVirtual:!0});V.predecessors.push({item:B,content:Mt(p),displayedText:null!=p.content?p.content.toString():null,effort:Ge(p.start,p.finish,s,ce(p)),tag:p}),V.displayedText=V.displayedText+"'"}else 1==u.length&&null!=(u=(R=u[0]).item.tag)&&p.start>xt(u.finish,s)&&(ne={content:null!=p.content?p.content.toString()+ee:null,displayedText:V.displayedText,predecessors:[]},k.splice(k.indexOf(V),0,ne),ne.predecessors.push({item:R.item,content:f,isEffortVirtual:!0}),V.predecessors.splice(0,V.predecessors.length),V.predecessors.push({item:ne,content:Mt(p),displayedText:null!=p.content?p.content.toString():null,effort:Ge(p.start,p.finish,s,ce(p)),tag:p}),V.displayedText=V.displayedText+"'")}}for(u=0;u<C.length;u++)if(C[u].key.isMilestone){for(p=C[u].key,V=null,ne=0;ne<k.length;ne++)if(k[ne].tag==p){V=k[ne];break}if(null!=V&&typeof V.predecessors!==t&&1==V.predecessors.length&&(R=V.predecessors[0]).item!=E&&R.tag==p){for(V.predecessors.splice(0,1),X=R.item,ne=0;ne<X.predecessors.length;ne++)R.item.predecessors.splice(R.item.predecessors.indexOf(f=X.predecessors[ne]),1),V.predecessors.push(f);for(ne=0;ne<k.length;ne++)if((f=k[ne]).predecessors)for(Ae=0;Ae<f.predecessors.length;Ae++)(ee=f.predecessors[Ae]).item==X&&(ee.item=V);V.content=null!=p.content?p.content.toString():null,V.displayedText=V.displayedText.replace("'",""),k.splice(k.indexOf(X),1)}}return k},e.getNetworkDiagramItems=function(d,u,p,f){var T=d,C=u,k=p,V=f||n;(typeof T===t||T<0)&&(T=Number.MAX_VALUE),typeof C===t&&(C="Start"),typeof k===t&&(k="Finish"),f=new Date(1900,0,1),p=new Date(new Date(1e4,0,1).valueOf()-1),u=[];var E,R,B,ee,N,X,_=[];for(d=0;d<V.length;d++)(E=V[d]).indentation<=T&&(!E.hasChildren||typeof E.isSummaryEnabled!==t&&!E.isSummaryEnabled&&(typeof E.isBarVisible===t||E.isBarVisible)||E.indentation==T)&&_.push({key:E,value:[]});for(d=0;d<_.length;d++){if(N=[E=_[d].key],E.indentation==T&&E.hasChildren&&(typeof E.isSummaryEnabled===t||E.isSummaryEnabled||typeof E.isBarVisible!==t&&!E.isBarVisible))for(R=0;R<V.length;R++)Jt(B=V[R],E)&&N.push(B);var re=_[d].value;for(R=0;R<N.length;R++)for(var ne=N[R];null!=ne;){if(typeof ne.predecessors!==t)for(ee=0;ee<ne.predecessors.length;ee++)if(typeof ne.predecessors[ee].item!==t&&(typeof ne.predecessors[ee].dependencyType===t||""==ne.predecessors[ee].dependencyType||"FinishStart"==ne.predecessors[ee].dependencyType||"FS"==ne.predecessors[ee].dependencyType)){for(B=X=ne.predecessors[ee].item;null!=B&&lt(_,B)<0;)B=B.parent;if(B!=E){var ve=[];if(null!=B)ve.push(B);else for(var Pe=0;Pe<_.length;Pe++)Jt(B=_[Pe].key,X)&&ve.push(B);for(X=0;X<ve.length;X++)re.indexOf(B=ve[X])<0&&(T<Number.MAX_VALUE&&xi(_,B,E)||re.push(B))}}ne=ne.parent}}for(X=R=null,d=0;d<V.length;d++)E=V[d],(null==R||E.start<R)&&(R=E.start),(null==X||E.finish>X)&&(X=E.finish);for(null==R&&(R=p),null==X&&(X=f),u.push(C={content:C,displayedText:C,earlyStart:R,earlyFinish:R,lateStart:p,lateFinish:p,isMilestone:!0,effort:0,displayedRowIndex:0,displayedColumnIndex:0}),T=[C],R=[],d=0;d<_.length;d++)0==_[d].value.length&&R.push(_[d].key);if(R.length>0){for(T=[],d=0;d<R.length;d++)ee={content:Mt(E=R[d]),displayedText:E.content,earlyStart:f,earlyFinish:f,lateStart:p,lateFinish:p,effort:Ge(E.start,E.finish,s,ce(E)),isMilestone:E.isMilestone,predecessors:[],tag:E},T.push(ee),u.push(ee),ee.earlyStart=xt(C.earlyFinish,s),ee.earlyFinish=_e(ee.earlyStart,ee.effort,s),ee.predecessors.push({item:C,tag:E});do{for(re=[],d=0;d<T.length;d++)re.push(T[d]);for(ee=!1,d=0;d<T.length;d++){for(E=(V=T[d]).tag,ne=[],R=0;R<_.length;R++)_[R].value.indexOf(E)>=0&&ne.push(_[R].key);if(ne.length>0){for(re.splice(re.indexOf(V),1),R=0;R<ne.length;R++){for(E=ne[R],N=null,ee=0;ee<u.length;ee++)if(u[ee].tag==E){N=u[ee];break}null==N&&(N={content:Mt(E),displayedText:E.content,earlyStart:f,earlyFinish:f,lateStart:p,lateFinish:p,effort:Ge(E.start,E.finish,s,ce(E)),isMilestone:E.isMilestone,predecessors:[],tag:E},re.push(N),u.push(N)),(ee=xt(V.earlyFinish,s))>N.earlyStart&&(N.earlyStart=ee,N.earlyFinish=_e(N.earlyStart,N.effort,s)),N.predecessors.push({item:V,tag:E})}ee=!0}}T=re}while(ee)}for(u.push(k={content:k,displayedText:k,earlyStart:f,earlyFinish:f,lateStart:X,lateFinish:X,isMilestone:!0,effort:0,predecessors:[],displayedRowIndex:0}),R=k.predecessors,d=0;d<T.length;d++)(ee=(_=T[d]).earlyFinish)>k.earlyStart&&(k.earlyStart=ee,k.earlyFinish=k.earlyStart),R.push({item:_});for(T=[k];T.length>0;){for(_=[],d=0;d<T.length;d++)if(typeof(V=T[d]).predecessors!==t)for(R=0;R<V.predecessors.length;R++){for(N=(X=V.predecessors[R]).item,E=!1,ee=0;ee<_.length;ee++)if(_[ee]==N){E=!0;break}E||_.push(N),(E=V.lateStart)<N.lateFinish&&(N.lateFinish=N.effort>0?Ze(E,s,!1,!0,void 0):E,N.lateStart=_t(N.effort,N.lateFinish,s))}T=_}if(u.length>2)for(d=0;d<u.length;d++)(E=u[d]).slack=Ge(E.earlyStart,E.lateStart,s);else C.earlyStart=f,C.earlyFinish=f,C.lateStart=f,C.lateFinish=f,k.earlyStart=p,k.earlyFinish=p,k.lateStart=p,k.lateFinish=p;for(d=0;d<u.length;d++)u[d].isRelativeToTimezone=!1;return u},e.getOutputDate=cn,e.getInputDate=mn,e.itemDependsOf=function(d,u){return Ft(d,u)}};return{initialize:me,initializeItems:ge,refresh:xe,getDefaultColumns:F,getDefaultCollapsedToggleButtonTemplate:Li,getDefaultExpandedToggleButtonTemplate:Hi,getDefaultScales:G,getDefaultStyleDefinitionTemplate:Ri,getDefaultStandardTaskTemplate:zi,getDefaultSummaryTaskTemplate:Gi,getDefaultMilestoneTaskTemplate:Xi,getDefaultItemTemplate:Wi,getDefaultAssignmentsTemplate:Ni,getDefaultDependencyLineTemplate:Yi,getDefaultPredecessorItemTemplate:Ui,initializeTaskDraggingThumbs:function(e,n,s,r,o,l,y,d){o.ganttChartView.initializeTaskDraggingThumbs(e,n,s,r,o,l,y,d)},initializeDependencyDraggingThumb:function(e,n,s,r,o){s.ganttChartView.initializeDependencyDraggingThumb(e,n,s,r,o)},getWorkingTime:Ki,getEffort:Ge,getFinish:_e,getStart:_t,getCompletion:ei,getCompletedFinish:yi,getWeekStart:function(e,n){return Y(e,n)},getWeekFinish:J,defaultDateTimeFormatter:function(e){return m(c(e))},defaultDateFormatter:function(e){return D(c(e))},defaultDateTimeParser:function(e){return S(g(e))},textColumnTemplateBase:function(e,n,s){return(typeof(n=n())===t||typeof s!==t&&!s())&&(n=""),e.createTextNode(n)},textInputColumnTemplateBase:function(e,n,s,r,o,l,y,d){var u=e.createElement("input");return u.setAttribute("type","text"),typeof(e=s())===t&&(e=""),u.setAttribute("value",e),e="",typeof l!==t&&!l()&&(e="; display: none"),l="",typeof y!==t&&y()&&(l="; font-weight: bold"),u.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+e+l+(d?"":"; padding: 1px; font-size: inherit;")),typeof o!==t&&!o()&&u.setAttribute("disabled","true"),u.addEventListener("change",function(){r(u.value)},!0),u.addEventListener("keypress",function(p){13==p.keyCode&&(p.preventDefault(),p.stopPropagation(),r(u.value))},!0),u.addEventListener("focus",function(){u.style.backgroundColor="White"},!0),u.addEventListener("blur",function(){u.style.backgroundColor="Transparent"},!0),u},optionSelectColumnTemplateBase:function(e,n,s,T,o,l,y,d,u){var p=e.createElement("select"),f=function(k,V){var E=e.createElement("option");E.appendChild(e.createTextNode(k)),k==V&&E.setAttribute("selected",!0),p.appendChild(E)};typeof(T=T())===t&&(T=""),f("",T),s=s();for(var C=0;C<s.length;C++)f(s[C],T);return f="",typeof y!==t&&!y()&&(f="; display: none"),y="",typeof d!==t&&d()&&(y="; font-weight: bold"),p.setAttribute("style","background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+f+y+(u?"":"; padding: 1px; font-size: inherit;")),typeof l!==t&&!l()&&p.setAttribute("disabled","true"),p.addEventListener("change",function(){o(p.value)},!0),p.addEventListener("keypress",function(k){13==k.keyCode&&(k.preventDefault(),k.stopPropagation(),o(p.value))},!0),p.addEventListener("focus",function(){p.style.backgroundColor="White"},!0),p.addEventListener("blur",function(){p.style.backgroundColor="Transparent"},!0),p},numberInputColumnTemplateBase:function(e,n,s,r,o,l,y,d){return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(e,n,function(){var u=s();return isNaN(u)?"":u},function(u){u=parseFloat(u),isNaN(u)&&(u=0),r(u)},o,l,y,d)},percentInputColumnTemplateBase:function(e,n,s,r,o,l,y,d){return DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(e,n,s,function(u){u<0&&(u=0),u>100&&(u=100),r(u)},o,l,y,d)},timeSpanInputColumnTemplateBase:function(e,n,s,r,o,l,y,d,u){return typeof o===t&&(o=1),DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(e,n,function(){var p=s()/(36e5*o);return Math.round(100*p)/100},function(p){(p=parseFloat(p))<0&&(p=0),r(36e5*p*o)},l,y,d,u)},datePickerInputColumnTemplateBase:function(e,n,s,r,o,l,y,d,u,p,f,T,C,k,V){f||(f=["Su","Mo","Tu","We","Th","Fr","Sa"]);var E=T,R=C;T||(T=DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter),C||(C=DlhSoft.Controls.GanttChartView.defaultDateTimeParser);var B=e.createElement("input");B.setAttribute("type","text"),typeof(s=s())===t?s="":null!=s&&(s=T(s)),B.setAttribute("value",s),DlhSoft.Controls.DatePicker&&B.addEventListener("focus",function(){var N=DlhSoft.Controls.DatePicker.get(B);if(!N||!N.isOpen){var X=0,_=0;try{X=B.selectionStart,_=B.selectionEnd}catch{}(N=DlhSoft.Controls.DatePicker.initialize(B,void 0,{inputStyle:null,defaultTimeOfDay:d,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid #e0e0e0",calendarSelectorLevels:u,months:p,daysOfWeek:Te(f),weekStart:k,dateTimeFormatter:E,dateTimeParser:R},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{B.selectionStart=X,B.selectionEnd=_}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{B.focus()}catch{}},100):e.createEvent&&setTimeout(function(){var re=e.createEvent("MouseEvents");re.initEvent("blur",!0,!1),B.dispatchEvent(re)})}},!0),T="",typeof l!==t&&!l()&&(T="; display: none"),l="",typeof y!==t&&y()&&(l="; font-weight: bold"),B.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+T+l+(V?"":"; padding: 1px; font-size: inherit;")),typeof o!==t&&!o()&&B.setAttribute("disabled","true");var ee=function(){var N=""!=(N=B.value)?C(N):null;r(N)};return B.addEventListener("change",function(){ee()},!0),B.addEventListener("keypress",function(N){13==N.keyCode&&(N.preventDefault(),N.stopPropagation(),ee())},!0),B.addEventListener("focus",function(){B.style.backgroundColor="White"},!0),B.addEventListener("blur",function(){B.style.backgroundColor="Transparent"},!0),B},dateTimePickerInputColumnTemplateBase:function(e,n,s,r,o,l,y,d,u,p,f,T,C,k,V){f||(f=["Su","Mo","Tu","We","Th","Fr","Sa"]);var E=T,R=C;T||(T=DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter),C||(C=DlhSoft.Controls.GanttChartView.defaultDateTimeParser);var B=e.createElement("input");B.setAttribute("type","text"),typeof(s=s())===t?s="":null!=s&&(s=T(s)),B.setAttribute("value",s),(DlhSoft.Controls.DateTimePicker||DlhSoft.Controls.DatePicker)&&B.addEventListener("focus",function(){var N=(DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).get(B);if(!N||!N.isOpen){var X=0,_=0;try{X=B.selectionStart,_=B.selectionEnd}catch{}(N=(DlhSoft.Controls.DateTimePicker?DlhSoft.Controls.DateTimePicker:DlhSoft.Controls.DatePicker).initialize(B,void 0,{inputStyle:null,defaultTimeOfDay:d,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid #e0e0e0",calendarSelectorLevels:u,months:p,daysOfWeek:Te(f),weekStart:k,dateTimeFormatter:E,dateTimeParser:R},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{B.selectionStart=X,B.selectionEnd=_}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{B.focus()}catch{}},100):e.createEvent&&setTimeout(function(){var re=e.createEvent("MouseEvents");re.initEvent("blur",!0,!1),B.dispatchEvent(re)})}},!0),T="",typeof l!==t&&!l()&&(T="; display: none"),l="",typeof y!==t&&y()&&(l="; font-weight: bold"),B.setAttribute("style","outline: none; background-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+T+l+(V?"":"; padding: 1px; font-size: inherit;")),typeof o!==t&&!o()&&B.setAttribute("disabled","true");var ee=function(){var N=""!=(N=B.value)?C(N):null;r(N)};return B.addEventListener("change",function(){ee()},!0),B.addEventListener("keypress",function(N){13==N.keyCode&&(N.preventDefault(),N.stopPropagation(),ee())},!0),B.addEventListener("focus",function(){B.style.backgroundColor="White"},!0),B.addEventListener("blur",function(){B.style.backgroundColor="Transparent"},!0),B},multiSelectorComboBoxInputColumnTemplateBase:function(e,n,s,r,o,l,y,d,u){var p=e.createElement("input");return p.setAttribute("type","text"),typeof(r=r())===t&&(r=""),p.setAttribute("value",r),DlhSoft.Controls.MultiSelectorComboBox&&p.addEventListener("focus",function(){if(!(f=DlhSoft.Controls.MultiSelectorComboBox.get(p))||!f.isOpen&&f.availableChoices.length>0){var f=s(),T=0,C=0;try{T=p.selectionStart,C=p.selectionEnd}catch{}(f=DlhSoft.Controls.MultiSelectorComboBox.initialize(p,f,void 0,{inputStyle:null,autoAppendAvailableChoices:!1,isDropDownButtonVisible:!1,popupStyle:"margin-top: 1px; background-color: White; border: 1px solid #e0e0e0; color: Black; font-size: small; max-height: 188px; overflow-y: auto"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")).openDropDown(),setTimeout(function(){try{p.selectionStart=T,p.selectionEnd=C}catch{}},100),null==navigator.userAgent.match(/(Android)|(IPad)|(IPhone)/i)?setTimeout(function(){try{p.focus()}catch{}},100):e.createEvent&&setTimeout(function(){var V=e.createEvent("MouseEvents");V.initEvent("blur",!0,!1),p.dispatchEvent(V)})}},!0),r="",typeof y!==t&&!y()&&(r="; display: none"),y="",typeof d!==t&&d()&&(y="; font-weight: bold"),p.setAttribute("style","boutline: none; ackground-color: Transparent; width: "+n+"px; border-width: 0px; padding: 0px"+r+y+(u?"":"; padding: 1px; font-size: inherit;")),typeof l!==t&&!l()&&p.setAttribute("disabled","true"),p.addEventListener("change",function(){o(p.value)},!0),p.addEventListener("keypress",function(f){13==f.keyCode&&(f.preventDefault(),f.stopPropagation(),o(p.value))},!0),p.addEventListener("focus",function(){p.style.backgroundColor="White"},!0),p.addEventListener("blur",function(){p.style.backgroundColor="Transparent"},!0),p},dateTimeInputColumnTemplateBase:function(e,n,s,r,o,l,y,d){return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(e,n,function(){var u=s();return null!=u?DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter(u):""},function(u){u=""!=u?DlhSoft.Controls.GanttChartView.defaultDateTimeParser(u):null,r(u)},o,l,y,d)},getIndexColumnTemplate:function(){return function(e){var n=e.ganttChartView;return DlhSoft.Controls.GanttChartView.textColumnTemplateBase(n.ownerDocument,function(){return n.getItemIndexString(e)})}},getWbsColumnTemplate:function(e){return function(n){var s=n.ganttChartView;return DlhSoft.Controls.GanttChartView.textColumnTemplateBase(s.ownerDocument,function(){return s.getItemWbsIndexString(n,e)})}},getEffortColumnTemplate:function(e,n,s,r){return typeof n===t&&(n=1),function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemEffort(o)},function(y){l.setItemEffort(o,y),l.refreshItemPath(o)},n,function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly)||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled))},function(){return!(o.isMilestone||typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getDurationColumnTemplate:function(e,n,s,r){return typeof n===t&&(n=1),function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemDuration(o)},function(y){l.setItemDuration(o,y),l.refreshItemPath(o)},n,function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly)||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled))},function(){return!(o.isMilestone||typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getTotalEffortColumnTemplate:function(e,n,s,r){return typeof n===t&&(n=1),function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemTotalEffort(o)},function(y){l.setItemTotalEffort(o,y),l.refreshItemPath(o)},n,function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly)||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled))},function(){return!(o.isMilestone||typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getCompletedEffortColumnTemplate:function(e,n,s,r){return typeof n===t&&(n=1),function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemCompletedEffort(o)},function(y){l.setItemCompletedEffort(o,y),l.refreshItemPath(o)},n,function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly)||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled))},function(){return!(o.isMilestone||typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getTotalCompletedEffortColumnTemplate:function(e,n,s,r){return typeof n===t&&(n=1),function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemTotalCompletedEffort(o)},function(y){l.setItemTotalCompletedEffort(o,y),l.refreshItemPath(o)},n,function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly)||o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled))},function(){return!(o.isMilestone||typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getCompletionColumnTemplate:function(e,n,s){return function(r){var o=r.ganttChartView,l=o.settings;return DlhSoft.Controls.GanttChartView.percentInputColumnTemplateBase(o.ownerDocument,e,function(){var y=100*o.getItemCompletion(r);return Math.round(y*(l.integralCompletionPercents?1:100))/(l.integralCompletionPercents?1:100)},function(y){if(typeof r.gridItem!==t&&typeof r.completedInput!==t){var d=r.completedInput;typeof d.changeEventListener!==t&&d.removeEventListener("change",d.changeEventListener,!0),delete r.completedInput}y=parseFloat(y)/100,o.setItemCompletion(r,y),o.refreshItemPath(r)},function(){return!(r.isReadOnly||n||typeof r.ganttChartView!==t&&typeof r.ganttChartView.settings!==t&&(r.ganttChartView.settings.isReadOnly||r.ganttChartView.settings.isGridReadOnly)||r.hasChildren&&(typeof r.isSummaryEnabled===t||r.isSummaryEnabled))},function(){return!(r.isMilestone||typeof r.isBarVisible!==t&&!r.isBarVisible)},function(){return r.hasChildren&&(typeof r.isSummaryEnabled===t||r.isSummaryEnabled)},s)}},getCostColumnTemplate:function(e,n,s){return function(r){var o=r.ganttChartView;return DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(o.ownerDocument,e,function(){return o.getItemCost(r)},function(l){o.setItemCost(r,l),o.refreshItemPath(r)},function(){return!(r.isReadOnly||n||typeof r.ganttChartView!==t&&typeof r.ganttChartView.settings!==t&&(r.ganttChartView.settings.isReadOnly||r.ganttChartView.settings.isGridReadOnly))},void 0,function(){return r.hasChildren&&(typeof r.isSummaryEnabled===t||r.isSummaryEnabled)},s)}},getPredecessorsColumnTemplate:function(e,n,s,r){return function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(l.ownerDocument,e,function(){return l.getItemPredecessorsString(o,s)},function(y){l.setItemPredecessorsString(o,y,s),l.refreshItemGraph(o)},function(){return!(o.isReadOnly||n||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly))},function(){return!(typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getAssignmentSelectorColumnTemplate:function(e,n,s,r){return function(o){var l=o.ganttChartView;return DlhSoft.Controls.GanttChartView.optionSelectColumnTemplateBase(l.ownerDocument,e,function(){return"array"==typeof n?n:n(o)},function(){return o.assignmentsContent},function(y){o.assignmentsContent=y,l.onItemPropertyChanged(o,"assignmentsContent",!0,!0),l.refreshItem(o)},function(){return!(o.isReadOnly||s||typeof o.ganttChartView!==t&&typeof o.ganttChartView.settings!==t&&(o.ganttChartView.settings.isReadOnly||o.ganttChartView.settings.isGridReadOnly))},function(){return!(typeof o.isBarVisible!==t&&!o.isBarVisible)},function(){return o.hasChildren&&(typeof o.isSummaryEnabled===t||o.isSummaryEnabled)},r)}},getBaselineStartColumnTemplate:function(e,n,s,r,o,l,y,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var T=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(T.ownerDocument,e,function(){return null!=f.baselineStart?c(f.baselineStart):void 0},function(C){null!=C?f.baselineStart=S(C):delete f.baselineStart,T.onItemPropertyChanged(f,"baselineStart",!0,!0),T.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly))},function(){return!(typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r,o,l,y,function(C){return null==C?"":T.settings.dateTimeFormatter(C)},function(C){return""==C?null:T.settings.dateTimeParser(C)},u,p)}},getBaselineFinishColumnTemplate:function(e,n,s,r,o,l,y,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var T=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(T.ownerDocument,e,function(){return null!=f.baselineFinish?c(f.baselineFinish):void 0},function(C){null!=C?f.baselineFinish=S(C):delete f.baselineFinish,T.onItemPropertyChanged(f,"baselineFinish",!0,!0),T.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly))},function(){return!(f.isMilestone||typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r||864e5,o,l,y,function(C){return null==C?"":T.settings.dateTimeFormatter(C)},function(C){return""==C?null:T.settings.dateTimeParser(C)},u,p)}},getMinStartColumnTemplate:function(e,n,s,r,o,l,y,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var T=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(T.ownerDocument,e,function(){return null!=f.minStart?c(f.minStart):void 0},function(C){null!=C?f.minStart=S(C):delete f.minStart,T.onItemPropertyChanged(f,"minStart",!0,!0),T.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly)||f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled))},function(){return!(typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r,o,l,y,function(C){return null==C?"":T.settings.dateTimeFormatter(C)},function(C){return""==C?null:T.settings.dateTimeParser(C)},u,p)}},getMaxStartColumnTemplate:function(e,n,s,r,o,l,y,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var T=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(T.ownerDocument,e,function(){return null!=f.maxStart?c(f.maxStart):void 0},function(C){null!=C?f.maxStart=S(C):delete f.maxStart,T.onItemPropertyChanged(f,"maxStart",!0,!0),T.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly)||f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled))},function(){return!(typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r||864e5,o,l,y,function(C){return null==C?"":T.settings.dateTimeFormatter(C)},function(C){return""==C?null:T.settings.dateTimeParser(C)},u,p)}},getMinFinishColumnTemplate:function(e,n,s,r,o,l,y,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var T=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(T.ownerDocument,e,function(){return null!=f.minFinish?c(f.minFinish):void 0},function(C){null!=C?f.minFinish=S(C):delete f.minFinish,T.onItemPropertyChanged(f,"minFinish",!0,!0),T.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly)||f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled))},function(){return!(f.isMilestone||typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r,o,l,y,function(C){return null==C?"":T.settings.dateTimeFormatter(C)},function(C){return""==C?null:T.settings.dateTimeParser(C)},u,p)}},getMaxFinishColumnTemplate:function(e,n,s,r,o,l,y,d,u,p){return typeof n===t&&(n=!0),typeof s===t&&(s=!0),function(f){var T=f.ganttChartView;return(n?s?DlhSoft.Controls.GanttChartView.dateTimePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(T.ownerDocument,e,function(){return null!=f.maxFinish?c(f.maxFinish):void 0},function(C){null!=C?f.maxFinish=S(C):delete f.maxFinish,T.onItemPropertyChanged(f,"maxFinish",!0,!0),T.refreshItem(f)},function(){return!(f.isReadOnly||d||typeof f.ganttChartView!==t&&typeof f.ganttChartView.settings!==t&&(f.ganttChartView.settings.isReadOnly||f.ganttChartView.settings.isGridReadOnly)||f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled))},function(){return!(f.isMilestone||typeof f.isBarVisible!==t&&!f.isBarVisible)},function(){return f.hasChildren&&(typeof f.isSummaryEnabled===t||f.isSummaryEnabled)},r||864e5,o,l,y,function(C){return null==C?"":T.settings.dateTimeFormatter(C)},function(C){return""==C?null:T.settings.dateTimeParser(C)},u,p)}},getIconColumnTemplate:function(f,n,s,r,o,l,y,d,u){if("string"==typeof f){var p=f;f=function(){return p}}return typeof r===t||0==r?r=function(){return!1}:1==r&&(r=function(){return!0}),function(T){var C=T.ganttChartView,k=C.ownerDocument.createElement("img");return k.setAttribute("src",f(T)),typeof n!==t&&k.setAttribute("class",n),typeof s!==t&&k.setAttribute("style",s),!C.settings.isReadOnly&&!C.settings.isGridReadOnly&&r(T)&&(k.style.cursor="move",function(e,n,s,r,o,l,y,d,u,p){function f(E){delete r.cancelDrag,r.draggingItem=n,r.dragType="Ordering",r.style.cursor=e.style.cursor,r.draggingInitialY=E.clientY,r.draggingInitialThumbPosition=0,r.resetChartAreaDefinitions()}e.addEventListener("mousedown",oe(r,e,"mousedown",function(E){0==E.button&&(f(E),E.preventDefault())},!0),!0),e.addEventListener("touchstart",oe(r,e,"touchstart",function(E){f(E.touches[0]),E.preventDefault()},!0),!0),typeof r.draggableOrderingItems===t&&(r.draggableOrderingItems=[]);for(var T=!1,C=0;C<r.draggableOrderingItems.length;C++)if(r.draggableOrderingItems[C]==n){T=!0;break}if(!T){var k=function(E){if(typeof r.draggingItem!==t&&r.draggingItem==n&&"Ordering"==r.dragType){typeof r.temporaryHoveredGridItemSelectionContainer!==t&&(r.temporaryHoveredGridItemSelectionContainer.setAttribute("class",r.temporaryHoveredGridItemClass),r.temporaryHoveredGridItemSelectionContainer.setAttribute("style",r.temporaryHoveredGridItemStyle),delete r.temporaryHoveredGridItemSelectionContainer,delete r.temporaryHoveredGridItemClass,delete r.temporaryHoveredGridItemStyle);var R=E.clientY-r.draggingInitialY;if(Ji(E.clientY,r),delete r.draggingItem,r.cancelDrag)$(n,o),delete r.cancelDrag,delete r.draggingItem,r.style.cursor="default";else{E=Math.floor((n.itemTop+r.draggingInitialThumbPosition+R)/o.itemHeight),R=null;for(var B=0,ee=0;ee<s.length;ee++){var N=s[ee];if(N.isVisible&&(typeof N.isHidden===t||!N.isHidden)&&typeof N.displayRowIndex===t){if(B==E){R=N;break}B++}}null!=R&&R!=n&&null!=R.gridItemSelectionContainer&&(r.temporaryHoveredGridItemSelectionContainer=R.gridItemSelectionContainer,r.temporaryHoveredGridItemClass=R.gridItemSelectionContainer.getAttribute("class"),r.temporaryHoveredGridItemStyle=R.gridItemSelectionContainer.getAttribute("style"),typeof l===t||l(E,R)?typeof y!==t?R.gridItemSelectionContainer.setAttribute("class",y):typeof d!==t&&R.gridItemSelectionContainer.setAttribute("style",d):typeof u!==t?R.gridItemSelectionContainer.setAttribute("class",u):typeof p!==t&&R.gridItemSelectionContainer.setAttribute("style",p)),r.draggingItem=n}}};r.addEventListener("mousemove",oe(r,r,"mousemove",function(E){k(E)},!0),!0),r.addEventListener("touchmove",oe(r,r,"touchmove",function(E){k(E.touches[0])},!0),!0);var V=function(E){if(typeof r.draggingItem!==t&&r.draggingItem==n&&"Ordering"==r.dragType){typeof r.temporaryHoveredGridItemSelectionContainer!==t&&(r.temporaryHoveredGridItemSelectionContainer.setAttribute("class",r.temporaryHoveredGridItemClass),r.temporaryHoveredGridItemSelectionContainer.setAttribute("style",r.temporaryHoveredGridItemStyle),delete r.temporaryHoveredGridItemSelectionContainer,delete r.temporaryHoveredGridItemClass,delete r.temporaryHoveredGridItemStyle),E=Math.floor((n.itemTop+r.draggingInitialThumbPosition+(E.clientY-r.draggingInitialY))/o.itemHeight);for(var R=null,B=0,ee=0;ee<s.length;ee++){var N=s[ee];if(N.isVisible&&(typeof N.isHidden===t||!N.isHidden)&&typeof N.displayRowIndex===t){if(B==E){R=N;break}B++}}null!=R&&(typeof l===t||l(E,R))&&r.moveItemHierarchy(r.draggingItem,R.index),setTimeout(function(){$(n,o),qi(n)},0),r.resetChartAreaDefinitions(),delete r.draggingItem,r.style.cursor="default"}};document.addEventListener("mouseup",oe(r,document,"mouseup",function(E){0==E.button&&V(E)},!0),!0),document.addEventListener("touchend",oe(r,document,"touchend",function(E){V(E.changedTouches[0])},!0),!0),r.draggableOrderingItems.push(n)}}(k,T,C.items,C,C.settings,o,l,y,d,u)),k}},getOutputDate:cn,getInputDate:mn}}()),null==DlhSoft.Controls.ScheduleChartView&&(DlhSoft.Controls.ScheduleChartView=function(){var t=function(c,g,S,A,F){return c.internalEventListeners&&c.internalEventListeners.push({object:g,event:S,handler:A,useCapture:F}),A},pe=function(c,g,S,A){var F=["DlhSoft.Controls","ScheduleChartView","DlhSoft.ProjectData.GanttChart.HTML.Controls","5","validate","Licensing"];DlhSoft[F[5]][F[4]](c,F[0],F[1],F[2],F[3],A,S),c.isScheduleChartInitializing=!0,A=g,g=[];for(var z=F=0,P=0;P<A.length;P++){var U=A[P];if(!(typeof U.scheduleChartItem<"u"&&U.scheduleChartItem!=U)&&(U.scheduleChartIndex=F++,U.isHidden||(U.scheduleChartVisibilityIndex=z++),U.isBarVisible=!1,g.push(U),typeof U.ganttChartItems<"u"))for(var $=0;$<U.ganttChartItems.length;$++){var de=U.ganttChartItems[$];de.scheduleChartItem=U,U.isHidden&&(de.isHidden=!0),de.displayRowIndex=U.scheduleChartVisibilityIndex,de.indentation=(U.indentation?U.indentation:0)+1,g.push(de)}}return"object"!=typeof S&&(S={}),DlhSoft.Controls.GanttChartView.initializeItems(g,S),z=g,Be(F=S),typeof F.gridWidth>"u"&&(F.gridWidth="15%"),typeof F.chartWidth>"u"&&(F.chartWidth=F.isGridVisible?"85%":"100%"),typeof F.columns>"u"&&(F.columns=We(z,F)),typeof F.areTaskDependenciesVisible>"u"&&(F.areTaskDependenciesVisible=!1),typeof F.isBaselineVisible>"u"&&(F.isBaselineVisible=!1),typeof F.areStandardTaskLabelsVisible>"u"&&(F.areStandardTaskLabelsVisible=!1),typeof F.areMilestoneTaskLabelsVisible>"u"&&(F.areMilestoneTaskLabelsVisible=!1),typeof F.areAssignmentsReadOnly>"u"&&(F.areAssignmentsReadOnly=!1),typeof F.assignmentThumbStyle>"u"&&(F.assignmentThumbStyle="Aero"===F.theme?"fill: none; stroke: Blue; stroke-dasharray: 2, 2":"fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2"),typeof F.temporaryAssignmentThumbStyle>"u"&&(F.temporaryAssignmentThumbStyle="Aero"===F.theme?"fill: none; stroke: Blue; stroke-width: 0.65px; stroke-dasharray: 2, 2":"fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2"),typeof F.assignmentThumbTemplate>"u"&&(F.assignmentThumbTemplate=he(z,c,F)),F.internalExtraTaskTemplate=F.assignmentThumbTemplate,D(c,g,A,S),DlhSoft.Controls.GanttChartView.initialize(c,g,S,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),m(c,g),c.isScheduleChartInitializing=!1,c.isScheduleChartInitialized=!0,c},Ee=function(c){pe(c,c.scheduleChartItems,c.settings,c.license)},Be=function(c){typeof c.useUpdatingToolTips>"u"&&(c.useUpdatingToolTips=!0),typeof c.target>"u"&&(c.target="Standard"),typeof c.theme>"u"&&(c.theme="Modern"),typeof c.isGridVisible>"u"&&(c.isGridVisible="Phone"!==c.target),typeof c.interaction>"u"&&(c.interaction="Phone"!=c.target?"Standard":"TouchEnabled"),typeof c.isReadOnly>"u"&&(c.isReadOnly=!1),typeof c.isGridReadOnly>"u"&&(c.isGridReadOnly=!1),typeof c.isContentReadOnly>"u"&&(c.isContentReadOnly=!1),typeof c.selectionMode>"u"&&(c.selectionMode="Focus"),typeof c.isVirtualizing>"u"&&(c.isVirtualizing=!0),"Phone"==c.target&&typeof c.areTaskAssignmentsVisible>"u"&&(c.areTaskAssignmentsVisible=!1)},We=function(c,g){"object"!=typeof g&&(g={}),Be(g);var S=[{header:"",width:32,isSelection:!0},{header:"Resource",width:120,isTreeView:!0}];return S[0].cellTemplate=Ke(g,S[0],c),S[1].cellTemplate=xe(g,S[1],c),S[1].exportCellTemplate=xe(g,S[1],c,!1),"Single"!=g.selectionMode&&"Extended"!=g.selectionMode&&"ExtendedFocus"!=g.selectionMode&&S.splice(0,1),S},Ke=function(c,g){return function(S){return g.isReadOnly?getBooleanNode(S.ganttChartView.ownerDocument,S.isSelected):oe(S)}},oe=function(c){var S,g=c.ganttChartView.ownerDocument;typeof c.selectionInput>"u"?(S=g.createElement("input"),c.selectionInput=S,S.type="checkbox",S.setAttribute("style","margin: 0px")):S=c.selectionInput,c.isSelected?(S.setAttribute("checked","checked"),S.checked||(S.checked=!0)):S.checked&&(S.checked=!1);var A=function(){S.checked?we(c):typeof c.scheduleChartView<"u"&&c.scheduleChartView.unselectItem(c)};return typeof S.changeEventListener<"u"&&S.removeEventListener("change",S.changeEventListener,!0),S.addEventListener("change",t(c.ganttChartView,S,"change",A,!0),!0),S.changeEventListener=A,g=function(F){13==F.keyCode&&(F.preventDefault(),F.stopPropagation(),A())},typeof S.keyPressEventListener<"u"&&S.removeEventListener("keypress",S.keyPressEventListener,!0),S.addEventListener("keypress",t(c.ganttChartView,S,"keypress",g,!0),!0),S.keyPressEventListener=g,S},we=function(c){typeof c.scheduleChartView<"u"&&c.scheduleChartView.selectItem(c)},me=function(c,g){typeof c.scheduleChartView<"u"&&(c.scheduleChartView.currentItem=c),("Focus"==g.selectionMode||"ExtendedFocus"==g.selectionMode)&&!c.isSelected&&we(c)},xe=function(c,g,S,A){var F=function(U){var P=U.content;return(U=U.ganttChartView.ownerDocument.createElement("span")).innerHTML=P,U};return!(typeof A>"u"||A)||c.isReadOnly||c.isGridReadOnly||c.isContentReadOnly?F:function(z){return g.isReadOnly||!(typeof z.isReadOnly>"u")&&z.isReadOnly?F(z):Se(z,Math.max(0,g.width-z.indentation*z.ganttChartView.settings.indentationLevelWidth-z.ganttChartView.settings.toggleButtonAreaWidth-16),c)}},Se=function(c,g,S){var F,A=c.ganttChartView.ownerDocument;if(typeof c.contentInput>"u"){F=A.createElement("input"),c.contentInput=F,F.type="text",F.addEventListener("focus",t(c.ganttChartView,F,"focus",function(){me(c,S)}));var z=function(){c.content=F.value,c.scheduleChartView.onItemPropertyChanged(c,"content",!0,!0),c.scheduleChartView.refreshItem(c)};typeof F.changeEventListener<"u"&&F.removeEventListener("change",F.changeEventListener,!0),F.addEventListener("change",t(c.ganttChartView,F,"change",z,!0),!0),F.changeEventListener=z,A=function(P){13==P.keyCode&&(P.preventDefault(),P.stopPropagation(),z())},typeof F.keyPressEventListener<"u"&&F.removeEventListener("keypress",F.keyPressEventListener,!0),F.addEventListener("keypress",t(c.ganttChartView,F,"keypress",A,!0),!0),F.keyPressEventListener=A,F.addEventListener("focus",t(c.ganttChartView,F,"focus",function(){F.style.backgroundColor="White"})),F.addEventListener("blur",t(c.ganttChartView,F,"blur",function(){F.style.backgroundColor="Transparent"}))}else F=c.contentInput;return F.value=c.content,A="",c.hasChildren&&(typeof c.isSummaryEnabled>"u"||c.isSummaryEnabled)&&(A="; font-weight: bold"),F.setAttribute("style","outline: none; background-color: Transparent; width: "+g+"px; border-width: 0px; padding: 0px"+A+(S.classic?"":"; font-size: 12px; padding: 1px;")),F},he=function(c,g,S){return function(A){var F=A.ganttChartView.ownerDocument,z=F.createElementNS("http://www.w3.org/2000/svg","g");if(!S.isReadOnly&&!S.isChartReadOnly&&(typeof A.isReadOnly>"u"||!A.isReadOnly)&&!S.areAssignmentsReadOnly){var P=g.getChartPosition(A.start,S),U=Math.max(g.getChartPosition(A.finish,S),P+4),$=F.createElementNS("http://www.w3.org/2000/svg","line");$.setAttribute("x1",P),$.setAttribute("y1",S.barMargin+S.barHeight+2),$.setAttribute("x2",U-1),$.setAttribute("y2",S.barMargin+S.barHeight+2);var de=S.assignmentThumbClass;typeof de<"u"&&$.setAttribute("class",de),$.setAttribute("style",S.assignmentThumbStyle),$.style.visibility="hidden",z.appendChild($),(F=F.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",P),F.setAttribute("y",S.barMargin+S.barHeight-2),F.setAttribute("width",Math.max(0,U-P-1)),F.setAttribute("height",7),F.setAttribute("style","fill: White; fill-opacity: 0; cursor: move"),F.addEventListener("mouseover",t(g,F,"mouseover",function(){typeof g.draggingItem>"u"&&($.style.visibility="visible")},!0),!0),F.addEventListener("mouseout",t(g,F,"mouseout",function(){$.style.visibility="hidden"},!0),!0),z.appendChild(F),ae(F,z,A,P,U,c,g,S)}return z}},ge=function(c){var g=c.scheduleChartView;if(c.itemTop=c.scheduleChartVisibilityIndex*g.settings.itemHeight,g.refreshGridItem(c),typeof c.ganttChartItems<"u")for(var S=0;S<c.ganttChartItems.length;S++){var A=c.ganttChartItems[S];A.itemTop=c.itemTop,g.refreshChartItem(A)}},ae=function(c,g,S,A,F,z,P,U){function $(be,ue){delete S.assignmentThumbParentNode,delete P.cancelDrag,P.draggingItem=S,P.dragType="Assignment",P.style.cursor=c.style.cursor,P.draggingInitialY=be.clientY,P.draggingInitialThumbPosition=U.barMargin,g.itemLeft=A,g.itemRight=F,S.assignmentThumb=g,DlhSoft.Controls.ToolTip&&U.useUpdatingToolTips&&!ue&&((toolTip=DlhSoft.Controls.ToolTip.get(c))||(toolTip=DlhSoft.Controls.ToolTip.initialize(void 0,c,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+U.border+"; background-color: White; color: Black; font-family: "+(U.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),toolTip.setContent(S.content+" \u2013"),toolTip.show(),toolTip.setPosition(toolTip.x+(F-A)+4,toolTip.y-U.itemHeight-1),toolTip.originalY=toolTip.y,P.toolTip=toolTip)}var de=S.ganttChartView.ownerDocument;c.addEventListener("mousedown",t(P,c,"mousedown",function(be){0==be.button&&($(be),be.preventDefault())},!0),!0),c.addEventListener("touchstart",t(P,c,"touchstart",function(be){$(be.touches[0],!0),be.preventDefault()},!0),!0),typeof P.draggableAssignmentItems>"u"&&(P.draggableAssignmentItems=[]);for(var Me=!1,Fe=0;Fe<P.draggableAssignmentItems.length;Fe++)if(P.draggableAssignmentItems[Fe]==S){Me=!0;break}if(!Me){var He=function(be,ue){if(!(typeof P.draggingItem>"u"||P.draggingItem!=S||"Assignment"!=P.dragType)){var De,ke=Math.ceil((be.clientY-P.draggingInitialY)/U.itemHeight)*U.itemHeight;if(H(be.clientY,P),delete P.draggingItem,(g=S.assignmentThumb).parentNode?S.assignmentThumbParentNode=g.parentNode:S.assignmentThumbParentNode&&S.assignmentThumbParentNode.appendChild(g),A=g.itemLeft,F=g.itemRight,typeof P.temporaryAssignmentThumb<"u"){try{g.removeChild(P.temporaryAssignmentThumb)}catch{}delete P.temporaryAssignmentThumb}if(P.cancelDrag)delete P.cancelDrag,delete P.draggingItem,P.style.cursor="default";else if(U.temporaryAssignmentThumbTemplate?De=U.temporaryAssignmentThumbTemplate(P,A,P.draggingInitialThumbPosition+ke,Math.max(U.classic?4:12,F-A-1),U.barHeight):((De=de.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",A),De.setAttribute("y",P.draggingInitialThumbPosition+ke),De.setAttribute("width",Math.max(U.classic?4:12,F-A-1)),De.setAttribute("height",U.barHeight),typeof U.temporaryAssignmentThumbClass<"u"&&De.setAttribute("class",U.temporaryAssignmentThumbClass),De.setAttribute("style",U.temporaryAssignmentThumbStyle)),P.temporaryAssignmentThumb=De,g.appendChild(De),P.draggingItem=S,DlhSoft.Controls.ToolTip&&U.useUpdatingToolTips&&!ue){toolTip=P.toolTip,De=Math.floor((S.itemTop+P.draggingInitialThumbPosition+ke)/U.itemHeight);var Ye,Te=null,tt=0;for(Ye=0;Ye<z.length;Ye++){var Oe=z[Ye];if(Oe.isVisible&&!(typeof Oe.isHidden<"u"&&Oe.isHidden)&&typeof Oe.displayRowIndex>"u"){if(tt==De){Oe.hasChildren||(Te=Oe);break}tt++}}toolTip.setContent(S.content+" \u2013"+(null!=Te?" "+Te.content:"")),toolTip.setVerticalPosition(Math.max(fe(P)+P.chartHeaderContainer.clientHeight,toolTip.originalY+ke)),typeof toolTip.originalX>"u"&&(toolTip.originalX=toolTip.x),toolTip.setHorizontalPosition(toolTip.originalX)}}};P.addEventListener("mousemove",t(P,P,"mousemove",function(be){He(be)},!0),!0),P.addEventListener("touchmove",t(P,P,"touchmove",function(be){He(be.touches[0],!0)},!0),!0);var Ie=function(be){if(!(typeof P.draggingItem>"u"||P.draggingItem!=S||"Assignment"!=P.dragType)){if(delete S.assignmentThumbParentNode,g=S.assignmentThumb,typeof P.temporaryAssignmentThumb<"u"){try{g.removeChild(P.temporaryAssignmentThumb)}catch{}delete P.temporaryAssignmentThumb}be=Math.ceil((be.clientY-P.draggingInitialY)/U.itemHeight)*U.itemHeight,be=Math.floor((S.itemTop+P.draggingInitialThumbPosition+be)/U.itemHeight);var De,ue=null,ke=0;for(De=0;De<z.length;De++)if((Te=z[De]).isVisible&&!(typeof Te.isHidden<"u"&&Te.isHidden)&&typeof Te.displayRowIndex>"u"){if(ke==be){Te.hasChildren||(ue=Te);break}ke++}if(null!=ue){var Te=(ke=S.scheduleChartItem).ganttChartItems,tt=[];for(De=0;De<Te.length;De++)Te[De]!=S&&tt.push(Te[De]);ke.ganttChartItems=tt,P.onItemPropertyChanged(ke,"ganttChartItems",!0,!0),typeof ue.ganttChartItems>"u"&&(ue.ganttChartItems=[]),ue.ganttChartItems.push(S),P.onItemPropertyChanged(ue,"ganttChartItems",!0,!0),S.scheduleChartItem=ue,P.onItemPropertyChanged(S,"scheduleChartItem",!0,!0),S.displayRowIndex=be,S.isVirtuallyVisible=!0,P.refreshChartItem(S),P.refreshPredecessorItems(S),me(ue,U)}delete P.draggingItem,P.style.cursor="default"}};de.addEventListener("mouseup",t(P,de,"mouseup",function(be){0==be.button&&Ie(be)},!0),!0),de.addEventListener("touchend",t(P,de,"touchend",function(be){Ie(be.changedTouches[0])},!0),!0),P.draggableAssignmentItems.push(S)}},fe=function(c){var g=0;if(c.offsetParent)do{g+=c.offsetTop,c=c.offsetParent}while(c);return g},H=function(c,g){if(typeof g.draggingItem<"u"){var A,F,S=new Date;g.lastDraggingTime&&S>g.lastDraggingTime&&S-g.lastDraggingTime<50||(g.lastDraggingTime=S,(c-=fe(g))>=g.chartHeaderContainer.clientHeight&&c<g.chartHeaderContainer.clientHeight+24?(A=g.chartContentContainer.scrollTop,g.chartContentContainer.scrollTop=g.chartContentContainer.scrollTop-settings.itemHeight,typeof g.isDuringVerticalScrolling>"u"&&(g.isDuringVerticalScrolling=!0,setTimeout(function(){F=A-g.chartContentContainer.scrollTop,g.draggingInitialThumbPosition=g.draggingInitialThumbPosition-Math.ceil(F/settings.itemHeight)*settings.itemHeight,delete g.isDuringVerticalScrolling},0))):c>=g.chartHeaderContainer.clientHeight+g.chartContentContainer.clientHeight-24&&(A=g.chartContentContainer.scrollTop,g.chartContentContainer.scrollTop=g.chartContentContainer.scrollTop+settings.itemHeight,typeof g.isDuringVerticalScrolling>"u"&&(g.isDuringVerticalScrolling=!0,setTimeout(function(){F=g.chartContentContainer.scrollTop-A,g.draggingInitialThumbPosition=g.draggingInitialThumbPosition+Math.ceil(F/settings.itemHeight)*settings.itemHeight,delete g.isDuringVerticalScrolling},0))))}},a=function(c,g,S,A){var F=A.indexOf(c);F<0||g<0||g==F||g>=A.length||(A.splice(F,1),A.splice(g,0,c),Ee(S),typeof S.settings.itemMoveHandler<"u"&&S.settings.itemMoveHandler(c,F,g))},D=function(c,g,S,A){for(var F=0;F<g.length;F++)g[F].scheduleChartView=c;c.scheduleChartItems=S,c.settings=A,c.refreshScheduleChartItem=ge,c.initializeAssignmentDraggingThumb=function(z,P,U,$,de){ae(z,P,U,$,de,c.items,c,c.settings)},c.insertScheduleChartItem=function(z,P){var U=z;P.scheduleChartView=c,P.isVirtuallyVisible=!0,P.scheduleChartIndex=U;var de,$=0;for(de=0;de<U;de++)S[de].isHidden||$++;if(P.scheduleChartVisibilityIndex=$,P.isBarVisible=!1,U=U<S.length?S[U].index:g.length,S.splice(P.scheduleChartIndex,0,P),c.insertItem(U++,P),typeof P.ganttChartItems<"u")for(de=0;de<P.ganttChartItems.length;de++)($=P.ganttChartItems[de]).scheduleChartView=c,$.scheduleChartItem=P,$.isHidden=P.isHidden,$.displayRowIndex=P.scheduleChartVisibilityIndex,$.indentation=P.indentation,c.insertItem(U++,$);for(de=P.scheduleChartIndex+1;de<S.length;de++){if((U=S[de]).scheduleChartIndex=de,typeof U.scheduleChartVisibilityIndex<"u"&&U.scheduleChartVisibilityIndex++,typeof U.ganttChartItems<"u")for($=0;$<U.ganttChartItems.length;$++)U.ganttChartItems[$].displayRowIndex=U.scheduleChartVisibilityIndex;ge(U)}},c.addScheduleChartItem=function(z){c.insertScheduleChartItem(S.length,z)},c.insertScheduleChartItems=function(z,P){for(var U=0;U<P.length;U++)c.insertScheduleChartItem(z++,P[U])},c.addScheduleChartItems=function(z){for(var P=0;P<z.length;P++)c.addScheduleChartItem(z[P])},c.removeScheduleChartItem=function(z){if(typeof z.ganttChartItems<"u")for(var P=0;P<z.ganttChartItems.length;P++)c.removeItem(z.ganttChartItems[P]);for(S.splice(z.scheduleChartIndex,1),P=z.scheduleChartIndex;P<S.length;P++){var U=S[P];if(U.scheduleChartIndex=P,typeof U.scheduleChartVisibilityIndex<"u"&&U.scheduleChartVisibilityIndex--,typeof U.ganttChartItems<"u")for(var $=0;$<U.ganttChartItems.length;$++)U.ganttChartItems[$].displayRowIndex=U.scheduleChartVisibilityIndex;ge(U)}c.removeItem(z)},c.removeScheduleChartItems=function(z){for(var P=0;P<z.length;P++)c.removeScheduleChartItem(z[P])},c.moveScheduleChartRange=function(z,P,U){if(!(z<0||U<0||U==z||U>S.length-P)){var de,$=[];for(de=z;de<z+P;de++)$.push(S[de]);for(S.splice(z,P),de=0;de<$.length;de++)S.splice(U+de,0,$[de]);if(Ee(c),typeof c.settings.itemMoveHandler<"u")for(de=0;de<$.length;de++)c.settings.itemMoveHandler($[de],z+de,U+de)}},c.moveScheduleChartItem=function(z,P){a(z,P,c,S)},c.moveScheduleChartItemUp=function(z){var P=S.indexOf(z);P<=0||a(z,P-1,c,S)},c.moveScheduleChartItemDown=function(z){var P=S.indexOf(z);P<0||P>=S.length-1||a(z,P+1,c,S)},c.moveGanttChartItem=function(z,P){var U=z.scheduleChartItem,$=U.ganttChartItems.indexOf(z);U.ganttChartItems.splice($,1),P.ganttChartItems.push(z),z.scheduleChartItem=P,z.displayRowIndex=P.scheduleChartVisibilityIndex,c.refreshChartItem(z)}},m=function(c,g){c.items=g,c.refresh=function(){Ee(c)}};return{initialize:pe,refresh:Ee,getDefaultColumns:We,getDefaultScales:DlhSoft.Controls.GanttChartView.getDefaultScales,getDefaultStyleDefinitionTemplate:DlhSoft.Controls.GanttChartView.getDefaultStyleDefinitionTemplate,getDefaultStandardTaskTemplate:DlhSoft.Controls.GanttChartView.getDefaultStandardTaskTemplate,getDefaultMilestoneTaskTemplate:DlhSoft.Controls.GanttChartView.getDefaultMilestoneTaskTemplate,getDefaultItemTemplate:DlhSoft.Controls.GanttChartView.getDefaultItemTemplate,getDefaultAssignmentsTemplate:DlhSoft.Controls.GanttChartView.getDefaultAssignmentsTemplate,initializeTaskDraggingThumbs:DlhSoft.Controls.GanttChartView.initializeTaskDraggingThumbs,initializeDependencyDraggingThumb:DlhSoft.Controls.GanttChartView.initializeDependencyDraggingThumb,initializeAssignmentDraggingThumb:function(c,g,S,A,F){S.scheduleChartView.initializeAssignmentDraggingThumb(c,g,S,A,F)},getWorkingTime:DlhSoft.Controls.GanttChartView.getWorkingTime,getEffort:DlhSoft.Controls.GanttChartView.getEffort,getFinish:DlhSoft.Controls.GanttChartView.getFinish,getStart:DlhSoft.Controls.GanttChartView.getStart,getCompletion:DlhSoft.Controls.GanttChartView.getCompletion,getCompletedFinish:DlhSoft.Controls.GanttChartView.getCompletedFinish,textColumnTemplateBase:DlhSoft.Controls.GanttChartView.textColumnTemplateBase,textInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase,getOutputDate:DlhSoft.Controls.GanttChartView.getOutputDate,getInputDate:DlhSoft.Controls.GanttChartView.getInputDate}}()),null==DlhSoft.Controls.LoadChartView&&(DlhSoft.Controls.LoadChartView=function(){var t=function(m,c,g,S,A){return m.internalEventListeners&&m.internalEventListeners.push({object:c,event:g,handler:S,useCapture:A}),S},pe=function(m,c,g,S){var A=["DlhSoft.Controls","LoadChartView","DlhSoft.ProjectData.GanttChart.HTML.Controls","5","validate","Licensing"];DlhSoft[A[5]][A[4]](m,A[0],A[1],A[2],A[3],S,g),m.isLoadChartInitializing=!0,S=c,c=[];for(var F=A=0,z=0;z<S.length;z++){var P=S[z];if(typeof P.isExported<"u"&&P.isExported)c.push(P);else if(!(typeof P.loadChartItem<"u"&&P.loadChartItem!=P)&&(P.loadChartIndex=P.scheduleChartIndex=A++,P.isHidden||(P.scheduleChartVisibilityIndex=F++),P.isBarVisible=!1,c.push(P),typeof P.ganttChartItems<"u"))for(var U=0;U<P.ganttChartItems.length;U++){var $=P.ganttChartItems[U];$.loadChartItem=$.scheduleChartItem=P,P.isHidden&&($.isHidden=!0),$.displayRowIndex=P.scheduleChartVisibilityIndex,$.indentation=P.indentation+(P.indentation?P.indentation:0),c.push($)}}return"object"!=typeof g&&(g={}),DlhSoft.Controls.GanttChartView.initializeItems(c,g),F=c,Be(A=g),typeof A.gridWidth>"u"&&(A.gridWidth="15%"),typeof A.chartWidth>"u"&&(A.chartWidth=A.isGridVisible?"85%":"100%"),typeof A.columns>"u"&&(A.columns=We(F,A)),typeof A.normalAllocationBarStyle>"u"&&null==A.normalAllocationBarClass&&(A.normalAllocationBarStyle=A.classic?"Aero"===A.theme?"fill: Blue; stroke: Blue":"fill: Blue; fill-opacity: 0.8; stroke: Blue; stroke-width: 0.65px":"fill: #8abbed; fill-opacity: 0.8;"),typeof A.underAllocationBarStyle>"u"&&null==A.underAllocationBarClass&&(A.underAllocationBarStyle=A.normalAllocationBarStyle),typeof A.overAllocationBarStyle>"u"&&null==A.overAllocationBarClass&&(A.overAllocationBarStyle=A.classic?"Aero"===A.theme?"fill: Red; stroke: Red":"fill: Red; fill-opacity: 0.8; stroke: Red; stroke-width: 0.65px":"fill: #D03642; fill-opacity: 0.8; stroke-width: 0.65px;"),typeof A.maxDisplayedUnits>"u"&&(A.maxDisplayedUnits=1.5),typeof A.allocationTemplate>"u"&&(A.allocationTemplate=ge()),A.standardTaskTemplate=A.allocationTemplate,A.milestoneTaskTemplate=A.allocationTemplate,A.areTaskDependenciesVisible=!1,A.isBaselineVisible=!1,A.isTaskCompletedEffortVisible=!1,A.areTaskAssignmentsVisible=!1,a(m,c,S,g),DlhSoft.Controls.GanttChartView.initialize(m,c,g,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),D(m,c,g),m.isLoadChartInitializing=!1,m.isLoadChartInitialized=!0,m},Ee=function(m){pe(m,m.loadChartItems,m.settings,m.license)},Be=function(m){typeof m.target>"u"&&(m.target="Standard"),typeof m.theme>"u"&&(m.theme="Modern"),typeof m.isGridVisible>"u"&&(m.isGridVisible="Phone"!==m.target),typeof m.isReadOnly>"u"&&(m.isReadOnly=!0),typeof m.selectionMode>"u"&&(m.selectionMode="Focus"),typeof m.isVirtualizing>"u"&&(m.isVirtualizing=!0)},We=function(m,c){"object"!=typeof c&&(c={}),Be(c);var g=[{header:"",width:32,isSelection:!0},{header:"Resource",width:120,isTreeView:!0}];return g[0].cellTemplate=Ke(c,g[0],m),g[1].cellTemplate=me(c,g[1]),g[1].exportCellTemplate=me(c,g[1],!1),"Single"!=c.selectionMode&&"Extended"!=c.selectionMode&&"ExtendedFocus"!=c.selectionMode&&g.splice(0,1),g},Ke=function(m,c){return function(g){return c.isReadOnly?getBooleanNode(g.ganttChartView.ownerDocument,g.isSelected):oe(g)}},oe=function(m){var g,c=m.ganttChartView.ownerDocument;typeof m.selectionInput>"u"?(g=c.createElement("input"),m.selectionInput=g,g.type="checkbox",g.setAttribute("style","margin: 0px")):g=m.selectionInput,m.isSelected?(g.setAttribute("checked","checked"),g.checked||(g.checked=!0)):g.checked&&(g.checked=!1);var S=function(){g.checked?we(m):typeof m.loadChartView<"u"&&m.loadChartView.unselectItem(m)};return typeof g.changeEventListener<"u"&&g.removeEventListener("change",g.changeEventListener,!0),g.addEventListener("change",t(m.ganttChartView,g,"change",S,!0),!0),g.changeEventListener=S,c=function(A){13==A.keyCode&&(A.preventDefault(),A.stopPropagation(),S())},typeof g.keyPressEventListener<"u"&&g.removeEventListener("keypress",g.keyPressEventListener,!0),g.addEventListener("keypress",t(m.ganttChartView,g,"keypress",c,!0),!0),g.keyPressEventListener=c,g},we=function(m){typeof m.loadChartView<"u"&&m.loadChartView.selectItem(m)},me=function(m,c,g){var S=function(z){var F=z.content;return(z=z.ganttChartView.ownerDocument.createElement("span")).innerHTML=F,z};return!(typeof g>"u"||g)||m.isReadOnly||m.isGridReadOnly||m.isContentReadOnly?S:function(A){return c.isReadOnly||!(typeof A.isReadOnly>"u")&&A.isReadOnly?S(A):xe(A,Math.max(0,c.width-2),m)}},xe=function(m,c,g){var A,S=m.ganttChartView.ownerDocument;if(typeof m.contentInput>"u"){A=S.createElement("input"),m.contentInput=A,A.type="text",A.addEventListener("focus",t(m.ganttChartView,A,"focus",function(){typeof m.loadChartView<"u"&&(m.loadChartView.currentItem=m),("Focus"==g.selectionMode||"ExtendedFocus"==g.selectionMode)&&!m.isSelected&&we(m)}));var F=function(){m.content=A.value,m.loadChartView.onItemPropertyChanged(m,"content",!0,!0),m.loadChartView.refreshItem(m)};typeof A.changeEventListener<"u"&&A.removeEventListener("change",A.changeEventListener,!0),A.addEventListener("change",t(m.ganttChartView,A,"change",F,!0),!0),A.changeEventListener=F,S=function(z){13==z.keyCode&&(z.preventDefault(),z.stopPropagation(),F())},typeof A.keyPressEventListener<"u"&&A.removeEventListener("keypress",A.keyPressEventListener,!0),A.addEventListener("keypress",t(m.ganttChartView,A,"keypress",S,!0),!0),A.keyPressEventListener=S,A.addEventListener("focus",t(m.ganttChartView,A,"focus",function(){A.style.backgroundColor="White"})),A.addEventListener("blur",t(m.ganttChartView,A,"blur",function(){A.style.backgroundColor="Transparent"}))}else A=m.contentInput;return A.value=m.content,A.setAttribute("style","outline: none; background-color: Transparent; width: "+c+"px; border-width: 0px; padding: 0px"+(g.classic?"":"; font-size: 12px; padding: 1px;")),A},he=function(m){var c=m.loadChartView;if(m.itemTop=m.scheduleChartVisibilityIndex*c.settings.itemHeight,c.refreshGridItem(m),typeof m.ganttChartItems<"u")for(var g=0;g<m.ganttChartItems.length;g++){var S=m.ganttChartItems[g];S.itemTop=m.itemTop,c.refreshChartItem(S)}},ge=function(m,c,g){return function(S){var F,P=typeof c<"u"?c:S.loadChartView,A=typeof g<"u"?g:P.settings,U=P.ownerDocument;for(F=P.ownerDocument,typeof S.chartItemArea>"u"&&(S.chartItemArea=F.createElementNS("http://www.w3.org/2000/svg","g")),F=S.chartItemArea.childNodes.length;F-- >0;)S.chartItemArea.removeChild(S.chartItemArea.childNodes[F]);F=S.chartItemArea;var z=P.getChartPosition(S.start,A),$=(P=Math.max(P.getChartPosition(S.finish,A),z+4),U=U.createElementNS("http://www.w3.org/2000/svg","rect"),typeof S.units<"u"?S.units:1),de=Math.min($,A.maxDisplayedUnits)/A.maxDisplayedUnits*A.barHeight;return U.setAttribute("x",z),U.setAttribute("y",A.barMargin+(A.barHeight-de)),U.setAttribute("width",Math.max(0,P-z-1)),U.setAttribute("height",de),z=1==$?A.normalAllocationBarClass:$<1?A.underAllocationBarClass:A.overAllocationBarClass,typeof S.allocationBarClass<"u"&&(z=S.allocationBarClass),typeof z<"u"?U.setAttribute("class",z):(A=1==$?A.normalAllocationBarStyle:$<1?A.underAllocationBarStyle:A.overAllocationBarStyle,typeof S.allocationBarStyle<"u"&&(A=S.allocationBarStyle),typeof A<"u"&&U.setAttribute("style",A)),F.appendChild(U),F}},ae=function(m,c,g,S){var A=S.indexOf(m);A<0||c<0||c==A||c>=S.length||(S.splice(A,1),S.splice(c,0,m),Ee(g),typeof g.settings.itemMoveHandler<"u"&&g.settings.itemMoveHandler(m,A,c))},fe=function(m,c){for(var g in c)0!=g.indexOf("custom")&&0!=g.indexOf("description")||typeof m[g]>"u"&&(m[g]=c[g])},H=function(m,c,g,S,A,F,z,P,U,$,de,Me,Fe,He,Ie,be,ue){var ke,Te,De=[];if(typeof S<"u")for(ke=0;ke<S.length;ke++)De.push({isTreeView:(Te=ue.columns[S[ke]]).isTreeView,header:Te.header,width:Te.width,headerClass:Te.headerClass,headerStyle:Te.headerStyle,cellClass:Te.cellClass,cellStyle:Te.cellStyle,cellTemplate:typeof Te.exportCellTemplate<"u"?Te.exportCellTemplate:Te.cellTemplate});else for(ke=0;ke<ue.columns.length;ke++)(Te=ue.columns[ke]).isSelection||De.push({isTreeView:Te.isTreeView,header:Te.header,width:Te.width,headerClass:Te.headerClass,headerStyle:Te.headerStyle,cellClass:Te.cellClass,cellStyle:Te.cellStyle,cellTemplate:typeof Te.exportCellTemplate<"u"?Te.exportCellTemplate:Te.cellTemplate});typeof g>"u"&&(g=ue.isGridVisible),ke=g?function(m){for(var c=0,g=0;g<m.length;g++)c+=m[g].width;return c}(De)+1:0,typeof A<"u"?(typeof z>"u"||!z)&&(A=new Date(A.valueOf()-6e4*A.getTimezoneOffset())):A=ue.timelineStart,typeof F<"u"?(typeof z>"u"||!z)&&(F=new Date(F.valueOf()-6e4*F.getTimezoneOffset())):F=ue.timelineFinish,(A={isExport:!0,isReadOnly:!0,selectionMode:"None",isVirtualizing:!1,isGridVisible:g,isSplitterEnabled:!1,gridWidth:ke+"px",columns:De,allowUserToResizeColumns:!1,isGridRowClickTimeScrollingEnabled:!1,isMouseWheelZoomEnabled:!1,timelineStart:A,timelineFinish:F,hourWidth:typeof P<"u"?P:ue.hourWidth,displayedTime:typeof A<"u"?A:ue.timelineStart,currentTime:ue.currentTime,isTaskToolTipVisible:!1,isDependencyToolTipVisible:!1,areTaskDependenciesVisible:!1,isBaselineVisible:!1,isTaskCompletedEffortVisible:!1,areTaskAssignmentsVisible:!1,containerClass:ue.containerClass,containerStyle:ue.containerStyle,border:ue.border,theme:ue.theme,headerBackground:ue.headerBackground,headerHeight:ue.headerHeight,itemHeight:ue.itemHeight,itemClass:ue.itemClass,itemStyle:ue.itemStyle,indentationLevelWidth:ue.indentationLevelWidth,toggleButtonClass:ue.toggleButtonClass,toggleButtonStyle:ue.toggleButtonStyle,scales:[],visibleWeekStart:ue.visibleWeekStart,visibleWeekFinish:ue.visibleWeekFinish,workingWeekStart:ue.workingWeekStart,workingWeekFinish:ue.workingWeekFinish,visibleDayStart:ue.visibleDayStart,visibleDayFinish:ue.visibleDayFinish,specialNonworkingDays:ue.specialNonworkingDays,barMargin:ue.barMargin,barHeight:ue.barHeight,normalAllocationBarClass:ue.normalAllocationBarClass,underAllocationBarClass:ue.underAllocationBarClass,overAllocationBarClass:ue.overAllocationBarClass,normalAllocationBarStyle:ue.normalAllocationBarStyle,underAllocationBarStyle:ue.underAllocationBarStyle,overAllocationBarStyle:ue.overAllocationBarStyle,alternativeItemClass:ue.alternativeItemClass,alternativeChartItemClass:ue.alternativeChartItemClass,alternativeItemStyle:ue.alternativeItemStyle,alternativeChartItemStyle:ue.alternativeChartItemStyle,gridLines:ue.gridLines,horizontalGridLines:ue.horizontalGridLines,verticalGridLines:ue.verticalGridLines,verticalGridHeaderLines:ue.verticalGridHeaderLines,horizontalChartLines:ue.horizontalChartLines,target:ue.target,months:ue.months,daysOfWeek:ue.daysOfWeek,weekStartDay:ue.weekStartDay,dateFormatter:ue.dateFormatter,dateTimeFormatter:ue.dateTimeFormatter,isRelativeToTimezone:ue.isRelativeToTimezone,allocationTemplate:ue.allocationTemplate,classic:ue.classic}).timelineStart=DlhSoft.Controls.GanttChartView.getWeekStart(A.timelineStart,A.weekStartDay),A.timelineFinish=DlhSoft.Controls.GanttChartView.getWeekFinish(A.timelineFinish,A.weekStartDay),Ie=(Ie.getChartPosition(A.timelineFinish)-Ie.getChartPosition(A.timelineStart))/Ie.settings.hourWidth*A.hourWidth,A.chartWidth=Ie+"px";var tt=ke+Ie+2+(g?1:0);for(ke=0;ke<ue.scales.length;ke++)A.scales.push({scaleType:(g=ue.scales[ke]).scaleType,isHeaderVisible:g.isHeaderVisible,headerHeight:g.headerHeight,headerTextFormat:g.headerTextFormat,headerClass:g.headerClass,headerStyle:g.headerStyle,isHighlightingVisible:g.isHighlightingVisible,highlightingClass:g.highlightingClass,highlightingStyle:g.highlightingStyle,isSeparatorVisible:g.isSeparatorVisible,separatorClass:g.separatorClass,separatorStyle:g.separatorStyle,intervals:g.intervals});var Ye,Oe,it=!1;if(null!=de&&typeof de.createElement<"u")Ye=de;else{null!=de&&typeof de.focus<"u"?Oe=de:(Oe=window.open("",de??"_blank",typeof Me<"u"&&Me&&(typeof He>"u"||He)?"width=800,height=640,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),it=!0),Ye=Oe.document;try{var Le=document.head.getElementsByTagName("link");for(ke=0;ke<Le.length;ke++){var et=Le[ke],ft=Ye.adoptNode(et.cloneNode(!0));ft.href=et.href,Ye.head.appendChild(ft)}}catch{}}for(Ye.title=typeof m<"u"?m:"Exported chart"+(typeof Me<"u"&&Me?" (printable)":""),typeof U>"u"&&(U=0),typeof $>"u"&&($=be.length-1),m=[],ke=Le=0;ke<be.length;ke++)typeof(de=be[ke]).displayRowIndex<"u"&&(de.displayRowIndex<U||de.displayRowIndex>$)||typeof de.displayRowIndex>"u"&&(Le++<U||Le>$+1)||(ue={content:de.content,indentation:de.indentation,start:de.start,finish:de.finish,units:de.units,isBarVisible:de.isBarVisible,isRelativeToTimezone:de.isRelativeToTimezone,class:de.class,style:de.style,barClass:de.barClass,barStyle:de.barStyle,isSummaryEnabled:de.isSummaryEnabled,isParentSummarizationEnabled:de.isParentSummarizationEnabled,isHidden:de.isHidden,isExported:!0,tag:de},typeof de.displayRowIndex<"u"&&(ue.displayRowIndex=de.displayRowIndex-U),fe(ue,de),m.push(ue),de.exportItem=ue);var Qe=Ye.createElement("p");Qe.innerHTML=typeof c<"u"?c:"",Ye.body.appendChild(Qe);var st=Ye.createElement("div");st.setAttribute("style","width: "+tt+"px");try{DlhSoft.Controls.LoadChartView.initialize(st,m,A,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch{}setTimeout(function(){it&&Ye.body.setAttribute("style","margin: 0px");var x=Ye.createElement("div");x.appendChild(st),Ye.body.replaceChild(x,Qe),Fe&&(x.setAttribute("style","width: "+st.offsetHeight+"px; height: "+tt+"px; overflow: hidden"),x=Math.round((st.offsetWidth-st.offsetHeight)/2),st.setAttribute("style","width: "+tt+"px; transform: rotate(90deg) translateX("+x+"px) translateY("+x+"px); -webkit-transform: rotate(90deg) translateX("+x+"px) translateY("+x+"px)")),Ye.close(),void 0!==typeof Oe&&(Oe.focus(),typeof Me<"u"&&Me&&(Oe.print(),(typeof He>"u"||He)&&setTimeout(function(){Oe.close()})))},0)},a=function(m,c,g,S){for(var A=0;A<c.length;A++)c[A].loadChartView=c[A].scheduleChartView=m;m.loadChartItems=m.scheduleChartItems=g,m.settings=S,m.refreshLoadChartItem=he,m.insertLoadChartItem=function(F,z){var P=F;z.loadChartView=z.scheduleChartView=m,z.isVirtuallyVisible=!0,z.loadChartIndex=z.scheduleChartIndex=P;var $,U=0;for($=0;$<P;$++)g[$].isHidden||U++;if(z.scheduleChartVisibilityIndex=U,z.isBarVisible=!1,P=P<g.length?g[P].index:c.length,g.splice(z.loadChartIndex,0,z),m.insertItem(P++,z),typeof z.ganttChartItems<"u")for($=0;$<z.ganttChartItems.length;$++)(U=z.ganttChartItems[$]).loadChartView=U.scheduleChartView=m,U.loadChartItem=U.scheduleChartItem=z,U.isHidden=z.isHidden,U.displayRowIndex=z.scheduleChartVisibilityIndex,U.indentation=z.indentation,m.insertItem(P++,U);for($=z.loadChartIndex+1;$<g.length;$++){if((P=g[$]).loadChartIndex=P.scheduleChartIndex=$,typeof P.scheduleChartVisibilityIndex<"u"&&P.scheduleChartVisibilityIndex++,typeof P.ganttChartItems<"u")for(U=0;U<P.ganttChartItems.length;U++)P.ganttChartItems[U].displayRowIndex=P.scheduleChartVisibilityIndex;he(P)}},m.addLoadChartItem=function(F){m.insertLoadChartItem(g.length,F)},m.insertLoadChartItems=function(F,z){for(var P=0;P<z.length;P++)m.insertLoadChartItem(F++,z[P])},m.addLoadChartItems=function(F){for(var z=0;z<F.length;z++)m.addLoadChartItem(F[z])},m.removeLoadChartItem=function(F){if(typeof F.ganttChartItems<"u")for(var z=0;z<F.ganttChartItems.length;z++)m.removeItem(F.ganttChartItems[z]);for(m.removeItem(F),g.splice(F.loadChartIndex,1),F=F.loadChartIndex;F<g.length;F++){if((z=g[F]).loadChartIndex=z.scheduleChartIndex=F,typeof z.scheduleChartVisibilityIndex<"u"&&z.scheduleChartVisibilityIndex--,typeof z.ganttChartItems<"u")for(var P=0;P<z.ganttChartItems.length;P++)z.ganttChartItems[P].displayRowIndex=z.scheduleChartVisibilityIndex;he(z)}},m.removeLoadChartItems=function(F){for(var z=0;z<F.length;z++)m.removeLoadChartItem(F[z])},m.moveLoadChartRange=function(F,z,P){if(!(F<0||P<0||P==F||P>g.length-z)){var $,U=[];for($=F;$<F+z;$++)U.push(g[$]);for(g.splice(F,z),$=0;$<U.length;$++)g.splice(P+$,0,U[$]);if(Ee(m),typeof m.settings.itemMoveHandler<"u")for($=0;$<U.length;$++)m.settings.itemMoveHandler(U[$],F+$,P+$)}},m.moveLoadChartItem=function(F,z){ae(F,z,m,g)},m.moveLoadChartItemUp=function(F){var z=g.indexOf(F);z<=0||ae(F,z-1,m,g)},m.moveLoadChartItemDown=function(F){var z=g.indexOf(F);z<0||z>=g.length-1||ae(F,z+1,m,g)}},D=function(m,c,g){m.items=c,m.refresh=function(){Ee(m)},m.exportContent=function(S,A){typeof S>"u"&&(S={}),H(S.title,S.preparingMessage,S.isGridVisible,S.columnIndexes,S.timelineStart,S.timelineFinish,S.isRelativeToTimezone,S.hourWidth,S.startRowIndex,S.endRowIndex,A,!1,S.rotate,!1,m,c,g)},m.print=function(S){typeof S>"u"&&(S={}),H(S.title,S.preparingMessage,S.isGridVisible,S.columnIndexes,S.timelineStart,S.timelineFinish,S.isRelativeToTimezone,S.hourWidth,S.startRowIndex,S.endRowIndex,null,!0,S.rotate,S.autoClose,m,c,g)}};return{initialize:pe,refresh:Ee,getDefaultColumns:We,getDefaultScales:DlhSoft.Controls.GanttChartView.getDefaultScales,getDefaultAllocationTemplate:ge,getDefaultItemTemplate:DlhSoft.Controls.GanttChartView.getDefaultItemTemplate,getWorkingTime:DlhSoft.Controls.GanttChartView.getWorkingTime,textColumnTemplateBase:DlhSoft.Controls.GanttChartView.textColumnTemplateBase,textInputColumnTemplateBase:DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase,getOutputDate:DlhSoft.Controls.GanttChartView.getOutputDate,getInputDate:DlhSoft.Controls.GanttChartView.getInputDate}}()),typeof DlhSoft>"u"&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)}),DlhSoft.assemblies.push({assembly:"DlhSoft.ProjectData.PertChart.HTML.Controls",company:"DlhSoft",product:"Project Data Modern Library",version:"5.3.20.10",copyright:"Copyright \xa9 2012-2023 DlhSoft",title:"Project Data PERT Chart HTML Controls",description:"Project Data PERT Chart related HTML client components"}),DlhSoft.buildReleaseDate=function(t,pe,Ee){return(t=new Date(t,10,25))>DlhSoft.buildReleaseDate?t:DlhSoft.buildReleaseDate}(2023),_0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{"),null==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var t=_0x5c25[1],pe=_0x5c25[2],Ee=[],Be=[],We=_0x5c25[3];return{setLicense:function(we,me){Ee[_0x5c25[7]]({type:we,content:me})},validate:function(we,me,xe,Se,he,ge,ae){me=me+_0x5c25[4]+xe;for(var fe=0;fe<Be[_0x5c25[5]];fe++)if(Be[fe]==me)return;e:if(typeof ge!==pe&&typeof ae!==t&&(ae[_0x5c25[6]]!==t&&(ge=ae[_0x5c25[6]]),typeof ae===pe&&(ge=ae)),typeof ge!==pe)for(ae=0;ae<Ee[_0x5c25[5]];ae++)if((fe=Ee[ae])[_0x5c25[8]]==me&&typeof fe[_0x5c25[9]]===pe){ge=fe[_0x5c25[9]];break e}!function(we,me){if(typeof we!==pe||typeof me!==pe)return!1;if(me==We)return!0;var xe=me[_0x5c25[11]](_0x5c25[10]);if(0<=xe){var he,Se=me[_0x5c25[12]](0,xe),ge=Se[_0x5c25[11]](_0x5c25[10]);if(0<=ge)try{he=new Date(parseInt(Se[_0x5c25[12]](ge+1)))}catch{}if(typeof he===t&&(he=new Date(2013,11,31)),DlhSoft[_0x5c25[13]]>he)return!1;for(Se=Se+_0x5c25[10]+we,i=he=0;i<Se[_0x5c25[5]];i++)he=(he<<5)-he+(ge=Se[_0x5c25[14]](i)),he&=he;if(0>he&&(he=Math[_0x5c25[15]](2,32)-he),(Se=he.toString(16)[_0x5c25[16]]())==(xe=me[_0x5c25[12]](xe+1)))return!0}return!1}(me,ge)?function(we,me,xe,Se,he){var ge=_0x5c25[17],fe=typeof ComponentSource!==t&&ComponentSource?_0x5c25[21]:_0x5c25[18]+_0x5c25[19]+Se+_0x5c25[20]+he,H=Se+_0x5c25[22]+he+_0x5c25[23],a=_0x5c25[24],D=_0x5c25[25],m=_0x5c25[26];setTimeout(function(){var c=we[_0x5c25[27]],g=c[_0x5c25[29]](_0x5c25[28]);g[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var S=c[_0x5c25[29]](_0x5c25[28]);S[_0x5c25[32]](_0x5c25[30],_0x5c25[33]);var A=c[_0x5c25[29]](_0x5c25[28]);A[_0x5c25[32]](_0x5c25[30],_0x5c25[34]),S[_0x5c25[35]](A),A[_0x5c25[35]](c[_0x5c25[36]](ge)),S[_0x5c25[35]](c[_0x5c25[36]](a+_0x5c25[10])),(A=c[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),A[_0x5c25[35]](c[_0x5c25[36]](me)),S[_0x5c25[35]](A),S[_0x5c25[35]](c[_0x5c25[36]](D+_0x5c25[10])),(A=c[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),A[_0x5c25[35]](c[_0x5c25[36]](H)),S[_0x5c25[35]](A),S[_0x5c25[35]](c[_0x5c25[36]](m+_0x5c25[10])),(A=c[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var F=c[_0x5c25[29]](_0x5c25[39]);F[_0x5c25[32]](_0x5c25[30],_0x5c25[40]),F[_0x5c25[32]](_0x5c25[41],fe),F[_0x5c25[32]](_0x5c25[42],_0x5c25[43]),F[_0x5c25[35]](c[_0x5c25[36]](_0x5c25[44])),A[_0x5c25[35]](F),(F=c[_0x5c25[29]](_0x5c25[39]))[_0x5c25[32]](_0x5c25[30],_0x5c25[45]),F[_0x5c25[32]](_0x5c25[41],_0x5c25[46]),F[_0x5c25[35]](c[_0x5c25[36]](_0x5c25[47])),F[_0x5c25[50]](_0x5c25[48],function(){we[_0x5c25[49]](g),Be[_0x5c25[7]](xe)},!1),A[_0x5c25[35]](F),S[_0x5c25[35]](A),g[_0x5c25[35]](S),we[_0x5c25[35]](g)},0),setTimeout(function(){alert(ge+_0x5c25[51]+a+_0x5c25[52]+me+_0x5c25[51]+D+_0x5c25[53]+H+_0x5c25[51]+m+_0x5c25[4])},6e5)}(we,xe,me,Se,he):we[_0x5c25[6]]=ge}}}()),null==DlhSoft.Controls&&(DlhSoft.Controls={}),null==DlhSoft.Controls.Pert&&(DlhSoft.Controls.Pert={}),null==DlhSoft.Controls.Pert.PertChartView&&(DlhSoft.Controls.Pert.PertChartView=function(){var t=function(x,W,O,h,w){return x.internalEventListeners&&x.internalEventListeners.push({object:W,event:O,handler:h,useCapture:w}),h},pe=function(x,W,O,b){var w=["DlhSoft.Controls.Pert","PertChartView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];if(DlhSoft[w[5]][w[4]](x,w[0],w[1],w[2],w[3],b,O),x.isInitializing=!0,typeof x.initializedItems<"u"&&(x.initializedItems.forEach(function(te){te.chartItemArea&&te.chartItemArea.parentNode&&te.chartItemArea.parentNode.removeChild(te.chartItemArea),delete te.pertChartView,delete te.chartItem,delete te.chartItemArea}),typeof x.draggableItems<"u"&&delete x.draggableItems),x.initializedItems=W.slice(),x.internalEventListeners&&x.internalEventListeners.forEach(function(te){te.object.removeEventListener(te.event,te.handler,te.useCapture)}),x.internalEventListeners=[],typeof x.items<"u")for(b=0;b<x.items.length;b++)delete x.items[b].successors;"object"!=typeof O&&(O={}),Ke(W,O),We(O,W,x),st(x,W,O),oe(W);var v=Se(x,W,O),I=x.ownerDocument;(b=I.createElement("div")).setAttribute("style","font-family: "+(O.classic?"Arial":"system-ui, Arial")+"; font-size: "+(O.classic?"small":"12px")+"; overflow: auto"),w=I.createElement("div"),typeof O.containerClass<"u"&&w.setAttribute("class",O.containerClass),typeof O.containerStyle<"u"&&w.setAttribute("style",O.containerStyle),b.appendChild(w),(M=I.createElement("div")).setAttribute("style","border: solid 1px "+O.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden"),w.appendChild(M),(w=I.createElement("div")).setAttribute("style","overflow: auto"),M.appendChild(w);var L=I.createElement("div");L.setAttribute("style","overflow: "+(typeof O.isExport>"u"||!O.isExport?"auto":"hidden")+"; height: "+v),w.appendChild(L);var K,M=ae(W,O),Y=fe(W,O),J=I.createElement("div");J.setAttribute("style","float: left; overflow: hidden; width: "+M+"px; height: "+Y+"px"),L.appendChild(J),(v=I.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("style","width: "+M+"px; height: "+Y+"px"),M=O.styleDefinitionTemplate(),v.appendChild(M),v.chartAreaDefinitions=M,v.addEventListener("mousedown",t(x,v,"mousedown",M=function(){setTimeout(function(){try{var te=J.chartArea,G=te.chartAreaDefinitions;te.removeChild(G),te.childNodes.length>0?te.insertBefore(G,te.childNodes[0]):te.appendChild(G)}catch{}},0)},!0),!0),I.addEventListener("mouseup",t(x,I,"mouseup",M,!0),!0),J.appendChild(v),J.chartArea=v,setTimeout(function(){K=x.clientHeight},0),typeof x.heightUpdateTimer<"u"&&clearInterval(x.heightUpdateTimer),x.heightUpdateTimer=setInterval(function(){try{if(!(x.clientHeight<=0)){var te=x.clientHeight;if(te!=K){var G=Se(x,W,O);L.style.height=G,K=te}}}catch{try{clearInterval(x.heightUpdateTimer)}catch{}}},100);var q=function(te,G,Q,ie){var ye;if(O.mouseHandler||O.mouseMoveHandler&&"mousemove"==ie||O.mouseDownHandler&&"mousedown"==ie||O.clickHandler&&"click"==ie||O.doubleClickHandler&&"dblclick"==ie){var Z=te.which;!Z&&te.button&&(1&te.button?Z=1:4&te.button?Z=2:2&te.button&&(Z=3)),ye=Q.getBoundingClientRect();var j=I.body,Ce=I.documentElement;for(Q=ye.left+(window.pageXOffset||Ce.scrollLeft||j.scrollLeft)-(Ce.clientLeft||j.clientLeft||0),ye=Math.round(ye.top+(window.pageYOffset||Ce.scrollTop||j.scrollTop)-(Ce.clientTop||j.clientTop||0)),Q=Math.round(Q),Q=te.pageX-Q,ye=te.pageY-ye,j=0;j<W.length;j++){var Ne=a(Ce=W[j],O),Ue=D(Ce,O);Q>=Ne&&Q<Ne+O.itemWidth&&ye>=Ue&&ye<Ue+O.itemHeight&&(O.mouseHandler&&O.mouseHandler(ie,Ce,Z,G,te),O.mouseMoveHandler&&"mousemove"==ie&&O.mouseMoveHandler(Ce),O.mouseDownHandler&&"mousedown"==ie&&O.mouseDownHandler(Ce,Z),O.itemClickHandler&&"click"==ie&&O.itemClickHandler(Ce),O.itemDoubleClickHandler&&"dblclick"==ie&&O.itemDoubleClickHandler(Ce))}}};return J.addEventListener("mousemove",t(x,J,"mousemove",function(te){q(te,0,J,"mousemove")})),J.addEventListener("mousedown",t(x,J,"mousedown",function(te){q(te,1,J,"mousedown")})),J.addEventListener("click",t(x,J,"click",function(te){q(te,1,J,"click")})),J.addEventListener("dblclick",t(x,J,"dblclick",function(te){q(te,2,J,"dblclick")})),J.addEventListener("click",t(x,J,"click",function(te){te.srcElement&&"rect"!=te.srcElement.nodeName&&te.stopPropagation()},!0),!0),J.addEventListener("touchmove",t(x,J,"touchmove",function(te){x.draggingItem&&te.preventDefault()},!0),!0),J.container=L,x.chartContainer=w,x.chartContent=J,x.chartContentContainer=L,L.isInitializing=!0,De(x,b),H(J,v,W,O),L.isInitializing=!1,x.isInitializing=!1,x.isInitialized=!0,x},Ee=function(x){pe(x,x.items,x.settings,x.license)},We=function(x,W,O){if(function(x){typeof x.timeSpanFormatter>"u"&&(x.timeSpanFormatter=ge),typeof x.itemPropertyChangeHandler>"u"&&(x.itemPropertyChangeHandler=function(){}),typeof x.target>"u"&&(x.target="Standard"),typeof x.theme>"u"&&(x.theme="Modern")}(x),typeof x.border>"u")switch(x.theme){default:x.border="#e0e0e0";break;case"ModernBordered":case"Aero":x.border="#9a9a9a"}typeof x.canUserRearrangeItems>"u"&&(x.canUserRearrangeItems=!0),typeof x.snapRearrangedItemsToGuidelines>"u"&&(x.snapRearrangedItemsToGuidelines=!0),typeof x.itemWidth>"u"&&(x.itemWidth=40),typeof x.itemHeight>"u"&&(x.itemHeight=40),typeof x.aspectRatio>"u"&&(x.aspectRatio=1),typeof x.shapeWidth>"u"&&(x.shapeWidth=32),typeof x.shapeHeight>"u"&&(x.shapeHeight=32),typeof x.styleDefinitionTemplate>"u"&&(x.styleDefinitionTemplate=P(O,x)),typeof x.dependencyTextBlockWidth>"u"&&(x.dependencyTextBlockWidth=120),typeof x.shapeStyle>"u"&&null==x.shapeClass&&(x.shapeStyle="fill: White; stroke: #606060; stroke-width: 0.75px"),typeof x.temporaryThumbStyle>"u"&&null==x.temporaryThumbClass&&(x.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; "),typeof x.dependencyLineStyle>"u"&&null==x.dependencyLineClass&&(x.dependencyLineStyle="stroke: "+(x.classic?"#8080FF":"#3b87d9")+"; stroke-width: 0.65px; fill: none; marker-end: url(#PertArrowMarker)"),typeof x.virtualEffortDependencyLineStyle>"u"&&null==x.virtualEffortDependencyLineClass&&(x.virtualEffortDependencyLineStyle="stroke: "+(x.classic?"#8080FF":"#3b87d9")+"; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#PertArrowMarker)"),typeof x.dependencyLineZoneStyle>"u"&&null==x.dependencyLineZoneClass&&(x.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none"),typeof x.taskEventTemplate>"u"&&(x.taskEventTemplate=de()),typeof x.dependencyTextStyle>"u"&&(x.dependencyTextStyle="color: #606060; text-anchor: middle"),typeof x.chartMargin>"u"&&(x.chartMargin=16),typeof x.isTaskEventToolTipVisible>"u"&&(x.isTaskEventToolTipVisible="Phone"!==x.target),typeof x.itemTemplate>"u"&&(x.itemTemplate=U(x)),typeof x.dependencyLineTemplate>"u"&&(x.dependencyLineTemplate=Me()),typeof x.isDependencyToolTipVisible>"u"&&(x.isDependencyToolTipVisible=x.isTaskEventToolTipVisible),typeof x.predecessorItemTemplate>"u"&&(x.predecessorItemTemplate=Fe(x)),typeof x.useInlineToolTips>"u"&&(x.useInlineToolTips=!0),typeof x.useInlineToolTipsForDependencies>"u"&&(x.useInlineToolTipsForDependencies=!0)},Ke=function(x){for(var W=0;W<x.length;W++){var O=x[W];if("string"==typeof O&&(x[W]=O={content:O}),typeof O.predecessors<"u"){"string"==typeof O.predecessors&&(O.predecessors=O.predecessors.split(","));for(var h=0;h<O.predecessors.length;h++){var w=O.predecessors[h];if("string"==typeof w&&(O.predecessors[h]=w={item:w}),"string"==typeof w.item){var v=parseInt(w.item)-1;w.item=v>=0&&v<x.length?x[v]:null}"string"==typeof w.effort&&(w.effort=parseFloat(w.effort))}}typeof O.displayedRowIndex<"u"&&(O.actualRowIndex=O.displayedRowIndex),typeof O.displayedColumnIndex<"u"&&(O.actualColumnIndex=O.displayedColumnIndex),typeof O.actualRowIndex>"u"&&(O.actualRowIndex=0),typeof O.actualColumnIndex>"u"&&(O.actualColumnIndex=0)}},oe=function(x){x.positionedItems=[],x.maxRowIndex=null;for(var W=0;W<x.length;W++){var O=x[W],h=x;if(typeof O.displayedRowIndex>"u"){var w;if(typeof O.predecessors<"u"){w=h.positionedItems;for(var v=[],I=O.predecessors,b=0;b<w.length;b++)for(var L=w[b],M=0;M<I.length;M++)if(I[M].item==L){v.push(L);break}w=v}else w=null;if(null!=w){for(v=w,I=[],b=0;b<v.length;b++)I.indexOf(L=v[b].actualRowIndex)<0&&I.push(L);v=I}else v=null;if(v=null!=v&&v.length>0?Qe(v):null!=h.maxRowIndex?h.maxRowIndex+1:0,I=I=void 0,typeof O.displayedColumnIndex>"u"){if(I=(I=we(h.positionedItems,v)).length>0?Qe(I)+1:0,null!=(b=null!=w?we(w,v):null)&&b.length>0){for(L=null,M=0;M<b.length;M++)(null==L||b[M]<L)&&(L=b[M]);b=L+1}else b=null;for(null!=b&&b!=I&&(v++,I=null!=(w=null!=w?me(w):null)&&w.length>0?Qe(w)+1:0),O.actualColumnIndex=I;xe(h.positionedItems,v,I);)v++}else for(;!((I=(I=we(h.positionedItems,v)).length>0?Qe(I)+1:0)<=O.actualColumnIndex);v++);O.actualRowIndex=v}else typeof O.displayedColumnIndex>"u"&&(w=me(h.positionedItems),O.actualColumnIndex=w.length>0?Qe(w)+1:0);h.positionedItems.push(O),(null==h.maxRowIndex||O.actualRowIndex>h.maxRowIndex)&&(h.maxRowIndex=O.actualRowIndex)}},we=function(x,W){for(var O=[],h=0;h<x.length;h++){var w=x[h];w.actualRowIndex==W&&O.indexOf(w=w.actualColumnIndex)<0&&O.push(w)}return O},me=function(x){for(var W=[],O=0;O<x.length;O++){var h=x[O].actualColumnIndex;W.indexOf(h)<0&&W.push(h)}return W},xe=function(x,W,O){for(var h=0;h<x.length;h++){var w=x[h];if(w.actualRowIndex==W&&w.actualColumnIndex==O)return!0}return!1},Se=function(x,W,O){var h;if(x.isContentHeightInitialized&&x.isContentHeightAuto)h=W.length>0?"auto":O.itemHeight+"px";else{var w=x.clientHeight-2;w<0&&(w=0),h=w+"px",w<O.itemHeight&&(x.isContentHeightInitialized||(x.isContentHeightAuto=!0),h=W.length>0?"auto":O.itemHeight+"px"),x.isContentHeightInitialized=!0}return h},he=function(x,W){var O=x.createElement("span");return O.innerHTML=W,O},ge=function(x){return Math.ceil(x/36e5*1e4/100)/100+"h"},ae=function(x,W){for(var O=0,h=0;h<x.length;h++)O=Math.max(O,x[h].actualColumnIndex);return W.itemWidth+O*(W.itemWidth+W.dependencyTextBlockWidth)+2*W.chartMargin},fe=function(x,W){for(var O=0,h=0;h<x.length;h++)O=Math.max(O,x[h].actualRowIndex);return W.itemHeight+O*(W.itemHeight+W.dependencyTextBlockWidth/W.aspectRatio)+2*W.chartMargin},H=function(x,W,O,h){for(x=0;x<O.length;x++){var w=O[x],v=a(w,h),I=D(w,h);W.appendChild(c(w,v,I,h))}},a=function(x,W){return typeof x.displayedColumnIndex<"u"&&(x.actualColumnIndex=x.displayedColumnIndex),Math.max(0,W.chartMargin+x.actualColumnIndex*(W.itemWidth+W.dependencyTextBlockWidth))},D=function(x,W){return typeof x.displayedRowIndex<"u"&&(x.actualRowIndex=x.displayedRowIndex),Math.max(0,W.chartMargin+x.actualRowIndex*(W.itemHeight+W.dependencyTextBlockWidth/W.aspectRatio))},m=function(x){for(var O,h,W=[],w=0;w<x.length;w++){var v=x[w];if(typeof v.predecessors<"u"&&v.predecessors.length>0)for(var I=0;I<v.predecessors.length;I++){var b=v.predecessors[I].item;if(typeof b<"u"){for(O=!0,h=0;h<W;h++)if(b==W[h]){O=!1;break}O&&(g(b.chartItem,b,b.pertChartView.settings),O=a(b,b.pertChartView.settings),h=D(b,b.pertChartView.settings),b.chartItem.setAttribute("transform","translate("+O+", "+h+")"),W.push(b))}}if(typeof v.predecessors<"u"&&v.predecessors.length>0){for(O=!0,h=0;h<W;h++)if(typeof v<"u"&&v==W[h]){O=!1;break}O&&(g(v.chartItem,v,v.pertChartView.settings),O=a(v,v.pertChartView.settings),h=D(v,v.pertChartView.settings),v.chartItem.setAttribute("transform","translate("+O+", "+h+")"),W.push(v))}}},c=function(x,W,O,h){var w=x.pertChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");return x.chartItem=w,w.setAttribute("style","-ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),w.setAttribute("transform","translate("+W+", "+O+")"),g(w,x,h),w},g=function(x,W,O){for(var h=x.childNodes.length;h-- >0;)x.removeChild(x.childNodes[h]);if(typeof W.isShapeVisible>"u"||W.isShapeVisible){if(h=O.taskEventTemplate,typeof W.taskEventTemplate<"u"&&(h=W.taskEventTemplate),h=h(W),x.appendChild(h),typeof O.internalExtraTaskTemplate<"u"){var w=O.internalExtraTaskTemplate(W);null!=w&&x.appendChild(w)}if(typeof O.extraTaskEventTemplate<"u"&&null!=(w=O.extraTaskEventTemplate(W))&&x.appendChild(w),O.isTaskEventToolTipVisible&&!O.useInlineToolTips&&(w=O.itemTemplate,typeof W.template<"u"&&(w=W.template),h.appendChild(w(W))),typeof W.predecessors<"u")for(h=0;h<W.predecessors.length;h++)if(w=W.predecessors[h],!((typeof W.pertChartView>"u"||W.pertChartView.items.indexOf(w.item))<0)){var v=O.dependencyLineTemplate(W,w);if(v.predecessorIndex=h,function(b){v.addEventListener("click",t(W.pertChartView,v,"click",function(L){O.dependencyLineClickHandler&&O.dependencyLineClickHandler(b,W,L)})),v.addEventListener("dblclick",t(W.pertChartView,v,"dblclick",function(L){O.dependencyLineDoubleClickHandler&&O.dependencyLineDoubleClickHandler(b,W,L)}))}(w),x.appendChild(v),O.isDependencyToolTipVisible&&(!O.useInlineToolTips||!O.useInlineToolTipsForDependencies)){var I=O.predecessorItemTemplate;typeof w.template<"u"&&(I=w.template),v.appendChild(I(W,w))}}}},S=function(x){typeof x.isWaitingToRefreshChartItem>"u"&&(x.isWaitingToRefreshChartItem=!0,setTimeout(function(){g(x.chartItem,x,x.pertChartView.settings);var W=a(x,x.pertChartView.settings),O=D(x,x.pertChartView.settings);x.chartItem.setAttribute("transform","translate("+W+", "+O+")"),delete x.isWaitingToRefreshChartItem},0))},A=function(x){S(x)},F=function(x){typeof x.isWaitingToRefreshPredecessorItems>"u"&&(x.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){m(x.pertChartView.items),delete x.isWaitingToRefreshPredecessorItems},0))},z=function(x){typeof x.isWaitingToRefreshChartItem<"u"||typeof x.isWaitingToRefreshPredecessorItems<"u"?(typeof x.isWaitingToRefreshChartItem>"u"&&S(x),typeof x.isWaitingToRefreshPredecessorItems>"u"&&F(x)):(x.isWaitingToRefreshChartItem=!0,x.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){g(x.chartItem,x,x.pertChartView.settings);var W=a(x,x.pertChartView.settings),O=D(x,x.pertChartView.settings);x.chartItem.setAttribute("transform","translate("+W+", "+O+")"),m(x.pertChartView.items),delete x.isWaitingToRefreshChartItem,delete x.isWaitingToRefreshPredecessorItems},0))},P=function(x,W){return function(){var O=x.ownerDocument,h=O.createElementNS("http://www.w3.org/2000/svg","defs"),w=O.createElementNS("http://www.w3.org/2000/svg","marker");return w.setAttribute("id","PertArrowMarker"),w.setAttribute("viewBox","0 0 10 10"),w.setAttribute("refX","0"),w.setAttribute("refY","5"),w.setAttribute("markerUnits","strokeWidth"),w.setAttribute("markerWidth","5"),w.setAttribute("markerHeight","4"),w.setAttribute("orient","auto"),(O=O.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M 0 0 L 10 5 L 0 10 z"),O.setAttribute("fill",W.arrowFill?W.arrowFill:"Aero"==W.theme?"Blue":"#8080ff"),w.appendChild(O),h.appendChild(w),h}},U=function(){return function(x){var W=x.pertChartView.ownerDocument,O=W.createElementNS("http://www.w3.org/2000/svg","title");return O.appendChild(he(W,typeof x.content<"u"?x.content:"")),O}},de=function(x,W,O){return function(h){var te,w=typeof W<"u"?W:h.pertChartView,v=typeof O<"u"?O:w.settings,I=typeof x<"u"?x:w.items,b=w.ownerDocument,L=function(x){var W=x.pertChartView.ownerDocument;for(typeof x.chartItemArea>"u"&&(x.chartItemArea=W.createElementNS("http://www.w3.org/2000/svg","g")),W=x.chartItemArea.childNodes.length;W-- >0;)x.chartItemArea.removeChild(x.chartItemArea.childNodes[W]);return x.chartItemArea}(h),M=(v.itemWidth-v.shapeWidth)/2,Y=M+v.shapeWidth,J=(v.itemHeight-v.shapeHeight)/2,K=J+v.shapeHeight,q=v.shapeHeight,G=b.createElementNS("http://www.w3.org/2000/svg","rect");return G.setAttribute("x",M),G.setAttribute("y",J),G.setAttribute("width",Math.max(0,Y-M-1)),G.setAttribute("height",Math.max(0,K-J-1)),G.setAttribute("rx",v.shapeWidth/10),G.setAttribute("ry",v.shapeHeight/10),te=v.shapeClass,typeof h.shapeClass<"u"&&(te=h.shapeClass),typeof te<"u"?G.setAttribute("class",te):(te=v.shapeStyle,typeof h.shapeStyle<"u"&&(te=h.shapeStyle),typeof te<"u"&&G.setAttribute("style",te)),L.appendChild(G),L.addEventListener("mouseover",t(w,L,"mouseover",function(){var Q=DlhSoft.Controls.ToolTip.get(G);Q||(Q=DlhSoft.Controls.ToolTip.initialize(void 0,G,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+v.border+"; background-color: White; color: Black; font-family: "+(v.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),Q.setContent(v.itemTemplate(h).innerHTML.replaceAll("\n","<br/>")),Q.show(),w.toolTip=Q})),L.addEventListener("mouseout",t(w,L,"mouseout",function(){var Q=w.toolTip;Q.disable(),Q.hide()})),(te=b.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",(M+Y)/2),te.setAttribute("y",K-1.5*q/8-6),te.setAttribute("style","font-weight: bold; text-anchor: middle"),typeof(q=h.displayedText)>"u"&&(q=""),te.appendChild(b.createTextNode(q)),L.appendChild(te),v.canUserRearrangeItems&&((b=b.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",M),b.setAttribute("y",J),b.setAttribute("width",Math.max(0,Y-M-1)),b.setAttribute("height",Math.max(0,K-J-1)),b.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),L.appendChild(b),be(b,h,I,a(h,v),D(h,v),w,v)),L}},Me=function(x,W){return function(O,h){var w=O.pertChartView,v=typeof W<"u"?W:w.settings,M=typeof x<"u"?x:w.items,I=w.ownerDocument,b=I.createElementNS("http://www.w3.org/2000/svg","g"),L={x:void 0,y:void 0},Y=(M=He(O,h,M,v,L),I.createElementNS("http://www.w3.org/2000/svg","path"));Y.setAttribute("d",M),typeof v.dependencyLineZoneClass<"u"&&Y.setAttribute("class",v.dependencyLineZoneClass),typeof v.dependencyLineZoneStyle<"u"&&Y.setAttribute("style",v.dependencyLineZoneStyle),b.appendChild(Y);var J=I.createElementNS("http://www.w3.org/2000/svg","path");return J.setAttribute("d",M),(typeof h.isEffortVirtual<"u"?!h.isEffortVirtual:typeof h.effort<"u"&&h.effort>0)?(M=v.dependencyLineClass,typeof h.dependencyLineClass<"u"&&(M=h.dependencyLineClass),typeof M<"u"&&J.setAttribute("class",M),M=v.dependencyLineStyle,typeof h.dependencyLineStyle<"u"&&(M=h.dependencyLineStyle)):(M=v.virtualEffortDependencyLineClass,typeof h.virtualEffortDependencyLineClass<"u"&&(M=h.virtualEffortDependencyLineClass),typeof M<"u"&&J.setAttribute("class",M),M=v.virtualEffortDependencyLineStyle,typeof h.virtualEffortDependencyLineStyle<"u"&&(M=h.virtualEffortDependencyLineStyle)),typeof M<"u"&&J.setAttribute("style",M),b.appendChild(J),v.isDependencyToolTipVisible&&v.useInlineToolTips&&v.useInlineToolTipsForDependencies&&(b.addEventListener("mouseover",t(w,b,"mouseover",function(K){var q=v.predecessorItemTemplate(O,h).innerHTML.replaceAll("\n","<br/>");if(""!=q&&"<span></span>"!=q){(q=DlhSoft.Controls.ToolTip.get(J))||(q=DlhSoft.Controls.ToolTip.initialize(void 0,J,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+v.border+"; background-color: White; color: Black; font-family: "+(v.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),q.setContent(v.predecessorItemTemplate(O,h).innerHTML.replaceAll("\n","<br/>")),q.show();var te=b.getBoundingClientRect();q.setHorizontalPosition(q.x+K.clientX-te.left),q.setVerticalPosition(q.y+K.clientY-te.bottom+10),w.toolTip=q}})),b.addEventListener("mouseout",t(w,b,"mouseout",function(){var K=w.toolTip;K.disable(),K.hide()}))),(M=I.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",L.x),M.setAttribute("y",L.y-6),L=v.dependencyTextClass,typeof h.dependencyTextClass<"u"&&(L=h.dependencyTextClass),typeof L<"u"&&M.setAttribute("class",L),L=v.dependencyTextStyle,typeof h.dependencyTextStyle<"u"&&(L=h.dependencyTextStyle),M.setAttribute("style",L),typeof(L=h.displayedText)>"u"&&(L=""),M.appendChild(I.createTextNode(L)),b.appendChild(M),b}},Fe=function(){return function(x,W){var O=x.pertChartView.ownerDocument,h=O.createElementNS("http://www.w3.org/2000/svg","title");return h.appendChild(he(O,typeof W.content<"u"?W.content:"")),h}},He=function(J,M,v,G,w){v="M ";var I=a(J,G)-2,b=D(J,G)-2,L=a(M.item,G),Y=(M=D(M.item,G),a(J,G)),K=(J=D(J,G),Math.abs(Y-L)),q=Math.abs(J-M),te=G.shapeWidth+2,Q=te/2,ie=(G=G.shapeHeight+2)/2,ye=Math.max(te,G);return K<ye?v=M<=J?v+(L+Q-I+",")+(M+G-b)+" L "+(Y+Q-I)+","+(J-b):v+(L+Q-I+",")+(M-b)+" L "+(Y+Q-I)+","+(J+G-b):(v=L<=Y?v+(L+te-I+",")+(M+ie-b):v+(L-I+",")+(M+ie-b),v=q<4*ye?L<=Y?v+" L "+(Y-I)+","+(J+ie-b):v+" L "+(Y+te-I)+","+(J+ie-b):M<=J?v+" L "+(Y+Q-I)+","+(J-b):v+" L "+(Y+Q-I)+","+(J+G-b)),w.x=((L<=Y?L:Y)+(L>=Y?L:Y))/2+Q-I,w.y=((M<=J?M:J)+(M>=J?M:J))/2+ie-b,v},Ie=function(x,W,O,h){typeof x.pertChartView<"u"&&x.pertChartView.settings.itemPropertyChangeHandler(x,W,O,h)},be=function(x,W,O,h,w,v,I){function b(K){v.draggingItem=W,v.dragType="Position",v.style.cursor=x.style.cursor,v.draggingInitialX=K.clientX,v.draggingInitialY=K.clientY,v.draggingInitialThumbXPosition=h,v.draggingInitialThumbYPosition=w}x.addEventListener("mousedown",t(v,x,"mousedown",function(K){0==K.button&&(b(K),K.preventDefault())},!0),!0),x.addEventListener("touchstart",t(v,x,"touchstart",function(K){b(K.touches[0]),K.preventDefault()},!0),!0),typeof v.draggableItems>"u"&&(v.draggableItems=[]);for(var L=!1,M=0;M<v.draggableItems.length;M++)if(v.draggableItems[M]==W){L=!0;break}if(!L){var Y=function(K){if(!(typeof v.draggingItem>"u"||v.draggingItem!=W||"Position"!=v.dragType)){var q=K.clientX-v.draggingInitialX,te=K.clientY-v.draggingInitialY,G=K.clientX,Q=v;if(typeof Q.draggingItem<"u"){var ie=new Date;if(!Q.lastXDraggingTime||!(ie>Q.lastXDraggingTime&&ie-Q.lastXDraggingTime<200)){Q.lastXDraggingTime=ie;var ye=0;if((ie=Q).offsetParent)do{ye+=ie.offsetLeft,ie=ie.offsetParent}while(ie);(G-=ye)<24?(G=Q.chartContentContainer.scrollLeft,Q.chartContentContainer.scrollLeft=Q.chartContentContainer.scrollLeft-48,G-=Q.chartContentContainer.scrollLeft,typeof Q.draggingInitialThumbXPosition<"u"&&(Q.draggingInitialThumbXPosition=Q.draggingInitialThumbXPosition-G)):G>=Q.chartContentContainer.clientWidth-24&&(G=Q.chartContentContainer.scrollLeft,Q.chartContentContainer.scrollLeft=Q.chartContentContainer.scrollLeft+48,G=Q.chartContentContainer.scrollLeft-G,typeof Q.draggingInitialThumbXPosition<"u"&&(Q.draggingInitialThumbXPosition=Q.draggingInitialThumbXPosition+G))}}if(Q=K.clientY,typeof(K=v).draggingItem<"u"&&(G=new Date,!K.lastYDraggingTime||!(G>K.lastYDraggingTime&&G-K.lastYDraggingTime<200))){if(K.lastYDraggingTime=G,ie=0,(G=K).offsetParent)do{ie+=G.offsetTop,G=G.offsetParent}while(G);(Q-=ie)<24?(Q=K.chartContentContainer.scrollTop,K.chartContentContainer.scrollTop=K.chartContentContainer.scrollTop-48,Q-=K.chartContentContainer.scrollTop,typeof K.draggingInitialThumbYPosition<"u"&&(K.draggingInitialThumbYPosition=K.draggingInitialThumbYPosition-Q)):Q>=K.chartContentContainer.clientHeight-24&&(Q=K.chartContentContainer.scrollTop,K.chartContentContainer.scrollTop=K.chartContentContainer.scrollTop+48,Q=K.chartContentContainer.scrollTop-Q,typeof K.draggingInitialThumbYPosition<"u"&&(K.draggingInitialThumbYPosition=K.draggingInitialThumbYPosition+Q))}delete v.draggingItem,v.draggingInitialThumbXPosition+q<0&&(q=-v.draggingInitialThumbXPosition),v.draggingInitialThumbYPosition+te<0&&(te=-v.draggingInitialThumbYPosition),K=W,te=(v.draggingInitialThumbYPosition+te-I.chartMargin)/(I.itemHeight+I.dependencyTextBlockWidth/I.aspectRatio),I.snapRearrangedItemsToGuidelines&&(te=Math.round(te)),K.actualRowIndex=te,te=W,q=(v.draggingInitialThumbXPosition+q-I.chartMargin)/(I.itemWidth+I.dependencyTextBlockWidth),I.snapRearrangedItemsToGuidelines&&(q=Math.round(q)),te.actualColumnIndex=q,Ie(W,"actualRowIndex",!0,!1),Ie(W,"actualColumnIndex",!0,!1),typeof W.displayedColumnIndex<"u"&&delete W.displayedColumnIndex,typeof W.displayedRowIndex<"u"&&delete W.displayedRowIndex,ue(W,O,v.chartContent,I,!1),v.draggingItem=W,v.draggingPerformed=!0}};v.addEventListener("mousemove",t(v,v,"mousemove",function(K){Y(K)},!0),!0),v.addEventListener("touchmove",t(v,v,"touchmove",function(K){Y(K.touches[0])},!0),!0);var J=function(){if(!(typeof v.draggingItem>"u"||v.draggingItem!=W||"Position"!=v.dragType)){ue(W,O,v.chartContent,I,!0);var K=v.draggingItem;delete v.draggingItem,v.style.cursor="default",v.draggingPerformed&&(Ie(K,"actualColumnIndex",!0,!0),Ie(K,"actualRowIndex",!0,!0),delete v.draggingPerformed)}};document.addEventListener("mouseup",t(v,document,"mouseup",function(K){0==K.button&&J()},!0),!0),document.addEventListener("touchend",t(v,document,"touchend",function(){J()},!0),!0),v.draggableItems.push(W)}},ue=function(x,W,O,h,w){var v=x.pertChartView.ownerDocument;if(w)typeof O.temporaryRectangle<"u"&&((w=O.chartArea).removeChild(O.temporaryRectangle),delete O.temporaryRectangle),setTimeout(function(){g(x.chartItem,x,h),I=a(x,h),b=D(x,h),x.chartItem.setAttribute("transform","translate("+I+", "+b+")"),m(W),setTimeout(function(){ke(O,W,h,!0)},0)});else{typeof O.temporaryRectangle<"u"?v=O.temporaryRectangle:((v=v.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",0),v.setAttribute("y",0),v.setAttribute("width",h.shapeWidth),v.setAttribute("height",h.shapeHeight),v.setAttribute("rx",h.shapeWidth/10),v.setAttribute("ry",h.shapeHeight/10),typeof h.temporaryThumbClass<"u"&&v.setAttribute("class",h.temporaryThumbClass),v.setAttribute("style",h.temporaryThumbStyle),O.temporaryRectangle=v,(w=O.chartArea).appendChild(v));var I=a(x,h)+(h.itemWidth-h.shapeWidth)/2,b=D(x,h)+(h.itemHeight-h.shapeHeight)/2;v.setAttribute("transform","translate("+I+", "+b+")"),setTimeout(function(){ke(O,W,h,!1)},0)}},ke=function(x,v,O,h){var w=ae(v,O);v=fe(v,O),(h||w>x.clientWidth)&&(x.style.width=w+"px"),(h||v>x.clientHeight)&&(x.style.height=v+"px"),(x=x.chartArea).setAttribute("style",h?"width: "+w+"px; height: "+v+"px":"width: "+Math.max(x.clientWidth,w)+"px; height: "+Math.max(x.clientHeight,v)+"px")},De=function(x,W){for(var O=x.childNodes.length;O-- >0;)x.removeChild(x.childNodes[O]);x.appendChild(W)},Te=function(x,W){for(var O in W)0!=O.indexOf("custom")&&0!=O.indexOf("description")||typeof x[O]>"u"&&(x[O]=W[O])},tt=function(x,W,O,h,w,v,I,L){var J=ae(I,L={isExport:!0,canUserRearrangeItems:!1,isTaskEventToolTipVisible:!1,isDependencyToolTipVisible:!1,containerClass:L.containerClass,containerStyle:L.containerStyle,border:L.border,theme:L.theme,itemWidth:L.itemWidth,itemHeight:L.itemHeight,aspectRatio:L.aspectRatio,shapeWidth:L.shapeWidth,shapeHeight:L.shapeHeight,shapeClass:L.shapeClass,shapeStyle:L.shapeStyle,shapeCornerRadius:L.shapeCornerRadius,dependencyTextStyle:L.dependencyTextStyle,dependencyLineClass:L.dependencyLineClass,dependencyLineStyle:L.dependencyLineStyle,virtualEffortDependencyLineClass:L.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:L.virtualEffortDependencyLineStyle,dependencyTextBlockWidth:L.dependencyTextBlockWidth,chartMargin:0,target:L.target,timeSpanFormatter:L.timeSpanFormatter,taskEventTemplate:L.taskEventTemplate,dependencyLineTemplate:L.dependencyLineTemplate,classic:L.classic}),M=fe(I,L);L.chartWidth=J+"px",L.chartHeight=M+"px";var K,q,Y=J+2,te=(J=M+2,!1);if(null!=O&&typeof O.createElement<"u")K=O;else{null!=O&&typeof O.focus<"u"?q=O:(q=window.open("",O??"_blank",typeof h<"u"&&h&&(typeof v>"u"||v)?"width=800,height=480,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),te=!0),K=q.document;try{var G=document.head.getElementsByTagName("link");for(O=0;O<G.length;O++){var Q=G[O],ie=K.adoptNode(Q.cloneNode(!0));ie.href=Q.href,K.head.appendChild(ie)}}catch{}}for(K.title=typeof x<"u"?x:"Exported chart"+(typeof h<"u"&&h?" (printable)":""),x=[],O=0;O<I.length;O++)Te(Q={content:(G=I[O]).content,displayedText:G.displayedText,isShapeVisible:G.isShapeVisible,shapeClass:G.shapeClass,shapeStyle:G.shapeStyle,dependencyTextStyle:G.dependencyTextStyle,displayedRowIndex:G.actualRowIndex,displayedColumnIndex:G.actualColumnIndex,isExported:!0},G),x.push(Q),G.exportItem=Q;for(O=0;O<I.length;O++)if(Q=(G=I[O]).exportItem,typeof G.predecessors<"u")for(Q.predecessors=[],ie=0;ie<G.predecessors.length;ie++)Q.predecessors.push({item:(M=G.predecessors[ie]).item.exportItem,content:M.content,displayedText:M.displayedText,effort:M.effort,isEffortVirtual:M.isEffortVirtual,dependencyLineClass:M.dependencyLineClass,dependencyLineStyle:M.dependencyLineStyle,virtualEffortDependencyLineClass:M.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:M.virtualEffortDependencyLineStyle,dependencyTextStyle:M.dependencyTextStyle});var ye=K.createElement("p");ye.innerHTML=typeof W<"u"?W:"",K.body.appendChild(ye);var Z=K.createElement("div");Z.setAttribute("style","width: "+Y+"px; height: "+J+"px");try{DlhSoft.Controls.Pert.PertChartView.initialize(Z,x,L,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch{}setTimeout(function(){te&&K.body.setAttribute("style","margin: 0px");var j=K.createElement("div");j.appendChild(Z),K.body.replaceChild(j,ye),w&&(j.setAttribute("style","width: "+Z.offsetHeight+"px; height: "+Y+"px; overflow: hidden"),j=Math.round((Z.offsetWidth-Z.offsetHeight)/2),Z.setAttribute("style","width: "+Y+"px; transform: rotate(90deg) translateX("+j+"px) translateY("+j+"px); -webkit-transform: rotate(90deg) translateX("+j+"px) translateY("+j+"px)")),K.close(),void 0!==typeof q&&(q.focus(),typeof h<"u"&&h&&setTimeout(function(){q.print(),(typeof v>"u"||v)&&setTimeout(function(){q.close()})}))},0)},Ye=function(x,W){for(var O=0;O<W.length;O++)delete(h=W[O]).successorInfo,delete h.effortInfo;if(typeof x>"u"&&(x=0),null==(O=Le(W)))return[];O=[O];for(var h=Oe(x,W),w=0;w<h.length;w++)O.push(h[w].dependentItem);return O},Oe=function(x,W){for(var O=0;O<W.length;O++){var h=W[O];delete h.successorInfo,delete h.effortInfo}var w=Le(W);if(null==w)return[];e:{for(O=W.length;O-- >0;)if(0==ft(h=W[O]).length){O=h;break e}O=null}if(null==O)return[];for(O=it(w,O),w=[],h=0;h<O.length;h++)w.push(O[h]);for(O=0;O<W.length;O++)delete(h=W[O]).successorInfo,delete h.effortInfo;return w},it=function(x,W){if(null==x||null==W||x==W||typeof W.predecessors>"u")return[];var w,O=[],h=[],v=null;for(w=0;w<W.predecessors.length;w++)predecessorItem=W.predecessors[w],predecessorItem.dependentItem=W,typeof predecessorItem.item<"u"&&null!=(I=et(x,predecessorItem.item))&&((typeof predecessorItem.isEffortVirtual>"u"||!predecessorItem.isEffortVirtual)&&predecessorItem.effort>0&&(I+=predecessorItem.effort),(null==v||I>=v)&&((null==v||I>v)&&(v=I,h=[]),h.push(predecessorItem)));for(w=0;w<h.length;w++){for(var I=it(x,(v=h[w]).item),b=0;b<I.length;b++)O.push(I[b]);O.push(v)}return O},Le=function(x){for(var W=0;W<x.length;W++){var O=x[W];if(typeof O.predecessors>"u"||0==O.predecessors.length)return O}return null},et=function(x,W){if(null==x||null==W)return null;if(x==W)return 0;x.effortInfo||(x.effortInfo={});var O=W.index.toString();if(typeof x.effortInfo[O]<"u")return x.effortInfo[O];for(var h=null,w=ft(x),v=0;v<w.length;v++){var I=w[v],b=et(I.dependentItem,W);null!=b&&((b+=(typeof predecessorItem.isEffortVirtual>"u"||!predecessorItem.isEffortVirtual)&&I.predecessorItem.effort>0?I.predecessorItem.effort:0)<0&&(b=0),(null==h||b>h)&&(h=b))}return null!=h&&(x.effortInfo[O]=h),h},ft=function(x){if(x.successorInfo)return x.successorInfo;for(var W=[],O=x.pertChartView.items,h=0;h<O.length;h++){var w=O[h];if(typeof w.predecessors<"u")for(var v=0;v<w.predecessors.length;v++){var I=w.predecessors[v];typeof I.item<"u"&&I.item==x&&W.push({dependentItem:w,predecessorItem:I})}}return x.successorInfo=W},Qe=function(x){for(var W=null,O=0;O<x.length;O++)(null==W||x[O]>W)&&(W=x[O]);return W},st=function(x,W,O){for(var h=0;h<W.length;h++)W[h].pertChartView=x,W[h].index=h;x.items=W,x.settings=O,x.refresh=function(){Ee(x)},x.refreshItems=function(){for(var w=0;w<W.length;w++){var v=W[w];S(v),F(v)}},x.refreshChartItems=function(){for(var w=0;w<W.length;w++)S(W[w])},x.refreshItem=A,x.refreshChartItem=S,x.refreshPredecessorItems=F,x.refreshItemGraph=z,x.scrollToItem=function(w){var v=a(w,O),I=v-w.pertChartView.chartContentContainer.scrollLeft;I<0?w.pertChartView.chartContentContainer.scrollLeft=v:I>w.pertChartView.chartContentContainer.clientWidth-w.pertChartView.settings.itemWidth&&(w.pertChartView.chartContentContainer.scrollLeft=v-(w.pertChartView.chartContentContainer.clientWidth-w.pertChartView.settings.itemWidth)),(I=(v=D(w,O))-w.pertChartView.chartContentContainer.scrollTop)<0?w.pertChartView.chartContentContainer.scrollTop=v:I>w.pertChartView.chartContentContainer.clientHeight-w.pertChartView.settings.itemHeight&&(w.pertChartView.chartContentContainer.scrollTop=v-(w.pertChartView.chartContentContainer.clientHeight-w.pertChartView.settings.itemHeight))},x.scrollToLeft=function(){x.chartContentContainer.scrollLeft=0},x.scrollToRight=function(){x.chartContentContainer.scrollLeft=x.chartContent.clientWidth},x.scrollToTop=function(){x.chartContentContainer.scrollTop=0},x.scrollToBottom=function(){x.chartContentContainer.scrollTop=x.chartContent.clientHeight},x.getChartWidth=function(){return ae(W,O)},x.getChartHeight=function(){return fe(W,O)},x.getItemTop=function(w){return D(w,O)},x.getItemLeft=function(w){return a(w,O)},x.onItemPropertyChanged=Ie,x.initializeTasEventkDraggingThumbs=function(w,v,I,b){be(w,v,x.items,I,b,x,x.settings)},x.exportContent=function(w,v){typeof w>"u"&&(w={}),tt(w.title,w.preparingMessage,v,!1,w.rotate,!1,W,O)},x.print=function(w){typeof w>"u"&&(w={}),tt(w.title,w.preparingMessage,null,!0,w.rotate,w.autoClose,W,O)},x.isItemCritical=function(w,v){return Ye(v,W).indexOf(w)>=0},x.isDependencyCritical=function(w,v){return Oe(v,W).indexOf(w)>=0},x.getCriticalItems=function(w){return Ye(w,W)},x.getCriticalDependencies=function(w){return Oe(w,W)},x.repositionEnds=function(){if(0!=W.length){for(var w=!1,v=0;v<W.length;v++){for(var I=W[v],b=0,L=0;L<W.length;L++){var M=W[L];if(typeof M.predecessors<"u"){for(var Y=0;Y<M.predecessors.length&&!(typeof M.predecessors[Y].item<"u"&&M.predecessors[Y].item==I&&(b++,b>1));Y++);if(b>1)break}}b>1&&(w=!0)}(v=W[0]).displayedRowIndex=w?.5:0,(I=W[W.length-1]).displayedRowIndex=w?.5:0,z(v),z(I)}}};return{initialize:pe,initializeItems:Ke,refresh:Ee,getDefaultStyleDefinitionTemplate:P,getDefaultTaskEventTemplate:de,getDefaultItemTemplate:U,getDefaultDependencyLineTemplate:Me,getDefaultPredecessorItemTemplate:Fe,initializeTaskEventDraggingThumbs:function(x,W,O,h){W.pertChartView.initializeTaskEventDraggingThumbs(x,W,O,h)},defaultTimeSpanFormatter:ge}}()),null==DlhSoft.Controls.Pert.NetworkDiagramView&&(DlhSoft.Controls.Pert.NetworkDiagramView=function(){var t=function(h,w,v,I,b){return h.internalEventListeners&&h.internalEventListeners.push({object:w,event:v,handler:I,useCapture:b}),I},pe=function(h,w,v,Y){var b=["DlhSoft.Controls.Pert","NetworkDiagramView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];if(DlhSoft[b[5]][b[4]](h,b[0],b[1],b[2],b[3],Y,v),h.isInitializing=!0,typeof h.initializedItems<"u"&&(h.initializedItems.forEach(function(ie){ie.chartItemArea&&ie.chartItemArea.parentNode&&ie.chartItemArea.parentNode.removeChild(ie.chartItemArea),delete ie.networkDiagramView,delete ie.chartItem,delete ie.chartItemArea}),typeof h.draggableItems<"u"&&delete h.draggableItems),h.initializedItems=w.slice(),h.internalEventListeners&&h.internalEventListeners.forEach(function(ie){ie.object.removeEventListener(ie.event,ie.handler,ie.useCapture)}),h.internalEventListeners=[],typeof h.items<"u")for(Y=0;Y<h.items.length;Y++)delete h.items[Y].successors;"object"!=typeof v&&(v={}),Ke(w,v),We(v,w,h),O(h,w,v),fe(w,v),oe(w);var L=Se(h,w,v),M=h.ownerDocument;(Y=M.createElement("div")).setAttribute("style","font-family: "+(v.classic?"Arial":"system-ui, Arial")+"; font-size: "+(v.classic?"small":"12px")+"; overflow: auto"),b=M.createElement("div"),typeof v.containerClass<"u"&&b.setAttribute("class",v.containerClass),typeof v.containerStyle<"u"&&b.setAttribute("style",v.containerStyle),Y.appendChild(b),(K=M.createElement("div")).setAttribute("style","border: solid 1px "+v.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden"),b.appendChild(K),(b=M.createElement("div")).setAttribute("style","overflow: auto"),K.appendChild(b);var J=M.createElement("div");J.setAttribute("style","overflow: "+(typeof v.isExport>"u"||!v.isExport?"auto":"hidden")+"; height: "+L),b.appendChild(J);var G,K=H(w,v),q=a(w,v),te=M.createElement("div");te.setAttribute("style","float: left; overflow: hidden; width: "+K+"px; height: "+q+"px"),J.appendChild(te),(L=M.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("style","width: "+K+"px; height: "+q+"px"),K=v.styleDefinitionTemplate(),L.appendChild(K),L.chartAreaDefinitions=K,L.addEventListener("mousedown",t(h,L,"mousedown",K=function(){setTimeout(function(){try{var ie=te.chartArea,ye=ie.chartAreaDefinitions;ie.removeChild(ye),ie.childNodes.length>0?ie.insertBefore(ye,ie.childNodes[0]):ie.appendChild(ye)}catch{}},0)},!0),!0),M.addEventListener("mouseup",t(h,M,"mouseup",K,!0),!0),te.appendChild(L),te.chartArea=L,setTimeout(function(){G=h.clientHeight},0),typeof h.heightUpdateTimer<"u"&&clearInterval(h.heightUpdateTimer),h.heightUpdateTimer=setInterval(function(){try{if(!(h.clientHeight<=0)){var ie=h.clientHeight;if(ie!=G){var ye=Se(h,w,v);J.style.height=ye,G=ie}}}catch{try{clearInterval(h.heightUpdateTimer)}catch{}}},100);var Q=function(ie,ye,Z,j){var Ce;if(v.mouseHandler||v.mouseMoveHandler&&"mousemove"==j||v.mouseDownHandler&&"mousedown"==j||v.clickHandler&&"click"==j||v.doubleClickHandler&&"dblclick"==j){var Ne=ie.which;!Ne&&ie.button&&(1&ie.button?Ne=1:4&ie.button?Ne=2:2&ie.button&&(Ne=3)),Ce=Z.getBoundingClientRect();var Ue=M.body,ze=M.documentElement;for(Z=Ce.left+(window.pageXOffset||ze.scrollLeft||Ue.scrollLeft)-(ze.clientLeft||Ue.clientLeft||0),Ce=Math.round(Ce.top+(window.pageYOffset||ze.scrollTop||Ue.scrollTop)-(ze.clientTop||Ue.clientTop||0)),Z=Math.round(Z),Z=ie.pageX-Z,Ce=ie.pageY-Ce,Ue=0;Ue<w.length;Ue++){var Gt=m(ze=w[Ue],v),wt=c(ze,v);Z>=Gt&&Z<Gt+v.itemWidth&&Ce>=wt&&Ce<wt+v.itemHeight&&(v.mouseHandler&&v.mouseHandler(j,ze,Ne,ye,ie),v.mouseMoveHandler&&"mousemove"==j&&v.mouseMoveHandler(ze),v.mouseDownHandler&&"mousedown"==j&&v.mouseDownHandler(ze,Ne),v.itemClickHandler&&"click"==j&&v.itemClickHandler(ze),v.itemDoubleClickHandler&&"dblclick"==j&&v.itemDoubleClickHandler(ze))}}};return te.addEventListener("mousemove",t(h,te,"mousemove",function(ie){Q(ie,0,te,"mousemove")})),te.addEventListener("mousedown",t(h,te,"mousedown",function(ie){Q(ie,1,te,"mousedown")})),te.addEventListener("click",t(h,te,"click",function(ie){Q(ie,1,te,"click")})),te.addEventListener("dblclick",t(h,te,"dblclick",function(ie){Q(ie,2,te,"dblclick")})),te.addEventListener("click",t(h,te,"click",function(ie){ie.srcElement&&"rect"!=ie.srcElement.nodeName&&ie.stopPropagation()},!0),!0),te.addEventListener("touchmove",t(h,te,"touchmove",function(ie){h.draggingItem&&ie.preventDefault()},!0),!0),te.container=J,h.chartContainer=b,h.chartContent=te,h.chartContentContainer=J,J.isInitializing=!0,tt(h,Y),D(te,L,w,v),J.isInitializing=!1,h.isInitializing=!1,h.isInitialized=!0,h},Ee=function(h){pe(h,h.items,h.settings,h.license)},We=function(h,w,v){if(function(h){typeof h.dateTimeFormatter>"u"&&(h.dateTimeFormatter=ge),typeof h.timeSpanFormatter>"u"&&(h.timeSpanFormatter=ae),typeof h.itemPropertyChangeHandler>"u"&&(h.itemPropertyChangeHandler=function(){}),typeof h.target>"u"&&(h.target="Standard"),typeof h.theme>"u"&&(h.theme="Modern")}(h),typeof h.border>"u")switch(h.theme){default:h.border="#e0e0e0";break;case"ModernBordered":case"Aero":h.border="#9a9a9a"}typeof h.canUserRearrangeItems>"u"&&(h.canUserRearrangeItems=!0),typeof h.snapRearrangedItemsToGuidelines>"u"&&(h.snapRearrangedItemsToGuidelines=!0),typeof h.itemWidth>"u"&&(h.itemWidth=220),typeof h.itemHeight>"u"&&(h.itemHeight=100),typeof h.aspectRatio>"u"&&(h.aspectRatio=1),typeof h.shapeWidth>"u"&&(h.shapeWidth=212),typeof h.shapeHeight>"u"&&(h.shapeHeight=92),typeof h.styleDefinitionTemplate>"u"&&(h.styleDefinitionTemplate=$(v,h)),typeof h.shapeStyle>"u"&&null==h.shapeClass&&(h.shapeStyle="fill: White; stroke: "+(h.classic?"#0000ff":"#3b87d9")+"; stroke-width: 1px"),typeof h.milestoneStyle>"u"&&null==h.milestoneClass&&(h.milestoneStyle="fill: White; stroke: "+(h.classic?"#000000":"#3b87d9")+"; stroke-width: 1px"),typeof h.temporaryThumbStyle>"u"&&null==h.temporaryThumbClass&&(h.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; "),typeof h.dependencyLineStyle>"u"&&null==h.dependencyLineClass&&(h.dependencyLineStyle="stroke: "+(h.classic?"#8080FF":"#3b87d9")+"; stroke-width: 0.65px; fill: none; marker-end: url(#PertArrowMarker)"),typeof h.dependencyLineZoneStyle>"u"&&null==h.dependencyLineZoneClass&&(h.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none"),typeof h.taskTemplate>"u"&&(h.taskTemplate=Fe()),typeof h.minDependencyLineLength>"u"&&(h.minDependencyLineLength=48),typeof h.diagramMargin>"u"&&(h.diagramMargin=16),typeof h.isTaskToolTipVisible>"u"&&(h.isTaskToolTipVisible="Phone"!==h.target),typeof h.itemTemplate>"u"&&(h.itemTemplate=de(h)),typeof h.dependencyLineTemplate>"u"&&(h.dependencyLineTemplate=He()),typeof h.isDependencyToolTipVisible>"u"&&(h.isDependencyToolTipVisible=h.isTaskToolTipVisible),typeof h.predecessorItemTemplate>"u"&&(h.predecessorItemTemplate=Ie(h)),typeof h.useInlineToolTips>"u"&&(h.useInlineToolTips=!0),typeof h.useInlineToolTipsForDependencies>"u"&&(h.useInlineToolTipsForDependencies=!0)},Ke=function(h,w){for(var v=new Date,I=0;I<h.length;I++){var b=h[I];if("string"==typeof b&&(h[I]=b={content:b}),"string"==typeof b.earlyStart){try{b.earlyStart=Date.parse(b.earlyStart)}catch{b.earlyStart=new Date(parseInt(b.earlyStart))}(typeof w.isRelativeToTimezone>"u"||w.isRelativeToTimezone)&&(b.earlyStart=new Date(b.earlyStart.valueOf()+6e4*v.getTimezoneOffset()))}if("string"==typeof b.earlyFinish){try{b.earlyFinish=Date.parse(b.earlyFinish)}catch{b.earlyFinish=new Date(parseInt(b.earlyFinish))}(typeof w.isRelativeToTimezone>"u"||w.isRelativeToTimezone)&&(b.earlyFinish=new Date(b.earlyFinish.valueOf()+6e4*v.getTimezoneOffset()))}if("string"==typeof b.lateStart){try{b.lateStart=Date.parse(b.lateStart)}catch{b.lateStart=new Date(parseInt(b.lateStart))}(typeof w.isRelativeToTimezone>"u"||w.isRelativeToTimezone)&&(b.lateStart=new Date(b.lateStart.valueOf()+6e4*v.getTimezoneOffset()))}if("string"==typeof b.lateFinish){try{b.lateFinish=Date.parse(b.lateFinish)}catch{b.lateFinish=new Date(parseInt(b.lateFinish))}(typeof w.isRelativeToTimezone>"u"||w.isRelativeToTimezone)&&(b.earlyFinish=new Date(b.earlyFinish.valueOf()+6e4*v.getTimezoneOffset()))}if("string"==typeof b.effort)try{b.effort=parseInt(b.effort)}catch{}if("string"==typeof b.isMilestone&&(b.isMilestone=b.isMilestone.toLowerCase()==trueStringValue),"string"==typeof b.slack)try{b.slack=parseInt(b.slack)}catch{}if(typeof b.predecessors<"u"){"string"==typeof b.predecessors&&(b.predecessors=b.predecessors.split(","));for(var L=0;L<b.predecessors.length;L++){var M=b.predecessors[L];if("string"==typeof M&&(b.predecessors[L]=M={item:M}),"string"==typeof M.item){var Y=parseInt(M.item)-1;M.item=Y>=0&&Y<h.length?h[Y]:null}"string"==typeof M.lag&&(M.lag=parseFloat(M.lag))}}typeof b.displayedRowIndex<"u"&&(b.actualRowIndex=b.displayedRowIndex),typeof b.displayedColumnIndex<"u"&&(b.actualColumnIndex=b.displayedColumnIndex),typeof b.actualRowIndex>"u"&&(b.actualRowIndex=0),typeof b.actualColumnIndex>"u"&&(b.actualColumnIndex=0)}},oe=function(h){h.positionedItems=[],h.maxRowIndex=null;for(var w=0;w<h.length;w++){var v=h[w],I=h;if(typeof v.displayedRowIndex>"u"){var b;if(typeof v.predecessors<"u"){b=I.positionedItems;for(var L=[],M=v.predecessors,Y=0;Y<b.length;Y++)for(var J=b[Y],K=0;K<M.length;K++)if(M[K].item==J){L.push(J);break}b=L}else b=null;if(null!=b){for(L=b,M=[],Y=0;Y<L.length;Y++)M.indexOf(J=L[Y].actualRowIndex)<0&&M.push(J);L=M}else L=null;if(L=null!=L&&L.length>0?st(L):null!=I.maxRowIndex?I.maxRowIndex+1:0,M=M=void 0,typeof v.displayedColumnIndex>"u"){if(M=(M=we(I.positionedItems,L)).length>0?st(M)+1:0,null!=(Y=null!=b?we(b,L):null)&&Y.length>0){for(J=null,K=0;K<Y.length;K++)(null==J||Y[K]<J)&&(J=Y[K]);Y=J+1}else Y=null;for(null!=Y&&Y!=M&&(L++,M=null!=(b=null!=b?me(b):null)&&b.length>0?st(b)+1:0),v.actualColumnIndex=M;xe(I.positionedItems,L,M);)L++}else for(;!((M=(M=we(I.positionedItems,L)).length>0?st(M)+1:0)<=v.actualColumnIndex);L++);v.actualRowIndex=L}else typeof v.displayedColumnIndex>"u"&&(b=me(I.positionedItems),v.actualColumnIndex=b.length>0?st(b)+1:0);I.positionedItems.push(v),(null==I.maxRowIndex||v.actualRowIndex>I.maxRowIndex)&&(I.maxRowIndex=v.actualRowIndex)}},we=function(h,w){for(var v=[],I=0;I<h.length;I++){var b=h[I];b.actualRowIndex==w&&v.indexOf(b=b.actualColumnIndex)<0&&v.push(b)}return v},me=function(h){for(var w=[],v=0;v<h.length;v++){var I=h[v].actualColumnIndex;w.indexOf(I)<0&&w.push(I)}return w},xe=function(h,w,v){for(var I=0;I<h.length;I++){var b=h[I];if(b.actualRowIndex==w&&b.actualColumnIndex==v)return!0}return!1},Se=function(h,w,v){var I;if(h.isContentHeightInitialized&&h.isContentHeightAuto)I=w.length>0?"auto":v.itemHeight+"px";else{var b=h.clientHeight-2;b<0&&(b=0),I=b+"px",b<v.itemHeight&&(h.isContentHeightInitialized||(h.isContentHeightAuto=!0),I=w.length>0?"auto":v.itemHeight+"px"),h.isContentHeightInitialized=!0}return I},he=function(h,w){var v=h.createElement("span");return v.innerHTML=w,v},ge=function(h){var w;w=h.getFullYear();var v=h.getMonth()+1;v<10&&(v="0"+v);var I=h.getDate();return I<10&&(I="0"+I),w=v+"/"+I+"/"+w,(v=h.getHours())<10&&(v="0"+v.toString()),(h=h.getMinutes())<10&&(h="0"+h.toString()),w+" "+v+":"+h},ae=function(h){return Math.ceil(h/36e5*1e4/100)/100+"h"},fe=function(h){var I,b,w=new Date(864e5*Math.floor((new Date).valueOf()/864e5)),v=new Date;for(b=0;b<h.length;b++){var L=(I=h[b]).earlyStart,M=I.earlyFinish,Y=I.lateStart,J=I.lateFinish;typeof I.earlyStart>"u"&&(I.earlyStart=w),typeof I.earlyFinish>"u"&&(I.earlyFinish=typeof I.isMilestone>"u"||!I.isMilestone?new Date(w.valueOf()+864e5):I.earlyStart),typeof I.lateStart>"u"&&(I.lateStart=w),typeof I.lateFinish>"u"&&(I.lateFinish=typeof I.isMilestone>"u"||!I.isMilestone?new Date(w.valueOf()+864e5):I.lateStart),(typeof I.isRelativeToTimezone>"u"||I.isRelativeToTimezone)&&(I.earlyStart=new Date(I.earlyStart.valueOf()-6e4*v.getTimezoneOffset()),I.earlyFinish=new Date(I.earlyFinish.valueOf()-6e4*v.getTimezoneOffset()),I.lateStart=new Date(I.lateStart.valueOf()-6e4*v.getTimezoneOffset()),I.lateFinish=new Date(I.lateFinish.valueOf()-6e4*v.getTimezoneOffset()),I.isRelativeToTimezone=!1),typeof I.effort>"u"&&(I.effort=0),typeof I.slack>"u"&&(I.slack=0),typeof I.isMilestone>"u"&&(I.isMilestone=!1),(typeof L>"u"||I.earlyStart.valueOf()!=L.valueOf())&&ue(I,"earlyStart",!1,!0),(typeof M>"u"||I.earlyFinish.valueOf()!=M.valueOf())&&ue(I,"earlyFinish",!1,!0),(typeof Y>"u"||I.lateStart.valueOf()!=Y.valueOf())&&ue(I,"lateStart",!1,!0),(typeof J>"u"||I.lateFinish.valueOf()!=J.valueOf())&&ue(I,"lateFinish",!1,!0)}},H=function(h,w){for(var v=0,I=0;I<h.length;I++)v=Math.max(v,h[I].actualColumnIndex);return w.itemWidth+v*(w.itemWidth+w.minDependencyLineLength)+2*w.diagramMargin},a=function(h,w){for(var v=0,I=0;I<h.length;I++)v=Math.max(v,h[I].actualRowIndex);return w.itemHeight+v*(w.itemHeight+w.minDependencyLineLength/w.aspectRatio)+2*w.diagramMargin},D=function(h,w,v,I){for(h=0;h<v.length;h++){var b=v[h],L=m(b,I),M=c(b,I);w.appendChild(S(b,L,M,I))}},m=function(h,w){return typeof h.displayedColumnIndex<"u"&&(h.actualColumnIndex=h.displayedColumnIndex),Math.max(0,w.diagramMargin+h.actualColumnIndex*(w.itemWidth+w.minDependencyLineLength))},c=function(h,w){return typeof h.displayedRowIndex<"u"&&(h.actualRowIndex=h.displayedRowIndex),Math.max(0,w.diagramMargin+h.actualRowIndex*(w.itemHeight+w.minDependencyLineLength/w.aspectRatio))},g=function(h){for(var v,I,w=[],b=0;b<h.length;b++){var L=h[b];if(typeof L.predecessors<"u"&&L.predecessors.length>0)for(var M=0;M<L.predecessors.length;M++){var Y=L.predecessors[M].item;if(typeof Y<"u"){for(v=!0,I=0;I<w;I++)if(Y==w[I]){v=!1;break}v&&(A(Y.chartItem,Y,Y.networkDiagramView.settings),v=m(Y,Y.networkDiagramView.settings),I=c(Y,Y.networkDiagramView.settings),Y.chartItem.setAttribute("transform","translate("+v+", "+I+")"),w.push(Y))}}if(typeof L.predecessors<"u"&&L.predecessors.length>0){for(v=!0,I=0;I<w;I++)if(typeof L<"u"&&L==w[I]){v=!1;break}v&&(A(L.chartItem,L,L.networkDiagramView.settings),v=m(L,L.networkDiagramView.settings),I=c(L,L.networkDiagramView.settings),L.chartItem.setAttribute("transform","translate("+v+", "+I+")"),w.push(L))}}},S=function(h,w,v,I){var b=h.networkDiagramView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");return h.chartItem=b,b.setAttribute("style","-ms-touch-action: pinch-zoom; touch-action: pinch-zoom"),b.setAttribute("transform","translate("+w+", "+v+")"),A(b,h,I),b},A=function(h,w,v){for(var I=h.childNodes.length;I-- >0;)h.removeChild(h.childNodes[I]);if(typeof w.isShapeVisible>"u"||w.isShapeVisible){if(I=v.taskTemplate,typeof w.taskTemplate<"u"&&(I=w.taskTemplate),I=I(w),h.appendChild(I),typeof v.internalExtraTaskTemplate<"u"){var b=v.internalExtraTaskTemplate(w);null!=b&&h.appendChild(b)}if(typeof v.extraTaskTemplate<"u"&&null!=(b=v.extraTaskTemplate(w))&&h.appendChild(b),v.isTaskToolTipVisible&&!v.useInlineToolTips&&(b=v.itemTemplate,typeof w.template<"u"&&(b=w.template),I.appendChild(b(w))),typeof w.predecessors<"u")for(I=0;I<w.predecessors.length;I++)if(b=w.predecessors[I],!((typeof w.networkDiagramView>"u"||w.networkDiagramView.items.indexOf(b.item))<0||typeof b.item.isShapeVisible<"u"&&!b.item.isShapeVisible)){var L=v.dependencyLineTemplate(w,b);if(L.predecessorIndex=I,function(Y){L.addEventListener("click",t(w.networkDiagramView,L,"click",function(J){v.dependencyLineClickHandler&&v.dependencyLineClickHandler(Y,w,J)})),L.addEventListener("dblclick",t(w.networkDiagramView,L,"dblclick",function(J){v.dependencyLineDoubleClickHandler&&v.dependencyLineDoubleClickHandler(Y,w,J)}))}(b),h.appendChild(L),v.isDependencyToolTipVisible&&(!v.useInlineToolTips||!v.useInlineToolTipsForDependencies)){var M=v.predecessorItemTemplate;typeof b.template<"u"&&(M=b.template),L.appendChild(M(w,b))}}}},F=function(h){typeof h.isWaitingToRefreshChartItem>"u"&&(h.isWaitingToRefreshChartItem=!0,setTimeout(function(){A(h.chartItem,h,h.networkDiagramView.settings);var w=m(h,h.networkDiagramView.settings),v=c(h,h.networkDiagramView.settings);h.chartItem.setAttribute("transform","translate("+w+", "+v+")"),delete h.isWaitingToRefreshChartItem},0))},z=function(h){F(h)},P=function(h){typeof h.isWaitingToRefreshPredecessorItems>"u"&&(h.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){g(h.networkDiagramView.items),delete h.isWaitingToRefreshPredecessorItems},0))},U=function(h){typeof h.isWaitingToRefreshChartItem<"u"||typeof h.isWaitingToRefreshPredecessorItems<"u"?(typeof h.isWaitingToRefreshChartItem>"u"&&F(h),typeof h.isWaitingToRefreshPredecessorItems>"u"&&P(h)):(h.isWaitingToRefreshChartItem=!0,h.isWaitingToRefreshPredecessorItems=!0,setTimeout(function(){A(h.chartItem,h,h.networkDiagramView.settings);var w=m(h,h.networkDiagramView.settings),v=c(h,h.networkDiagramView.settings);h.chartItem.setAttribute("transform","translate("+w+", "+v+")"),g(h.networkDiagramView.items),delete h.isWaitingToRefreshChartItem,delete h.isWaitingToRefreshPredecessorItems},0))},$=function(h,w){return function(){var v=h.ownerDocument,I=v.createElementNS("http://www.w3.org/2000/svg","defs"),b=v.createElementNS("http://www.w3.org/2000/svg","marker");return b.setAttribute("id","PertArrowMarker"),b.setAttribute("viewBox","0 0 10 10"),b.setAttribute("refX","0"),b.setAttribute("refY","5"),b.setAttribute("markerUnits","strokeWidth"),b.setAttribute("markerWidth",(4.5*(w.arrowSize?w.arrowSize:1)).toString()),b.setAttribute("markerHeight",(3.5*(w.arrowSize?w.arrowSize:1)).toString()),b.setAttribute("orient","auto"),(v=v.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M 0 0 L 10 5 L 0 10 z"),v.setAttribute("fill",w.arrowFill?w.arrowFill:"Aero"==w.theme?"Blue":"#8080ff"),b.appendChild(v),I.appendChild(b),I}},de=function(){return function(h){var w=h.networkDiagramView.ownerDocument,v=w.createElementNS("http://www.w3.org/2000/svg","title");return v.appendChild(he(w,h.content)),v}},Fe=function(h,w,v){return function(I){var b=typeof w<"u"?w:I.networkDiagramView,L=typeof v<"u"?v:b.settings,M=typeof h<"u"?h:b.items,Y=b.ownerDocument,J=function(h){var w=h.networkDiagramView.ownerDocument;for(typeof h.chartItemArea>"u"&&(h.chartItemArea=w.createElementNS("http://www.w3.org/2000/svg","g")),w=h.chartItemArea.childNodes.length;w-- >0;)h.chartItemArea.removeChild(h.chartItemArea.childNodes[w]);return h.chartItemArea}(I),K=(L.itemWidth-L.shapeWidth)/2,q=K+L.shapeWidth,te=(L.itemHeight-L.shapeHeight)/2,G=te+L.shapeHeight,Z=0,Q=L.shapeHeight,ie=L.shapeWidth;I.isMilestone&&(K+=Z=ie/16,q-=Z,ie-=2*Z),I.isMilestone&&((j=Y.createElementNS("http://www.w3.org/2000/svg","polygon")).setAttribute("points",K+","+te+" "+(K-Z)+","+(te+G)/2+" "+K+","+G+" "+q+","+G+" "+(q+Z)+","+(te+G)/2+" "+q+","+te),Z=L.milestoneClass,typeof I.milestoneClass<"u"&&(Z=I.milestoneClass),typeof Z<"u"?j.setAttribute("class",Z):(Z=L.milestoneStyle,typeof I.milestoneStyle<"u"&&(Z=I.milestoneStyle),typeof Z<"u"&&j.setAttribute("style",Z)),J.appendChild(j));var ye=Y.createElementNS("http://www.w3.org/2000/svg","rect");ye.setAttribute("x",K),ye.setAttribute("y",te),ye.setAttribute("width",Math.max(0,q-K-1)),ye.setAttribute("height",Math.max(0,G-te-1)),Z=L.shapeClass,typeof I.shapeClass<"u"&&(Z=I.shapeClass),typeof Z<"u"?ye.setAttribute("class",Z):(Z=L.shapeStyle,typeof I.shapeStyle<"u"&&(Z=I.shapeStyle),typeof Z<"u"&&ye.setAttribute("style",Z)),J.appendChild(ye),J.addEventListener("mouseover",t(b,J,"mouseover",function(){var Ne=DlhSoft.Controls.ToolTip.get(ye);Ne||(Ne=DlhSoft.Controls.ToolTip.initialize(void 0,ye,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+L.border+"; background-color: White; color: Black; font-family: "+(L.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),Ne.setContent(L.itemTemplate(I).innerHTML.replaceAll("\n","<br/>")),Ne.show(),b.toolTip=Ne})),J.addEventListener("mouseout",t(b,J,"mouseout",function(){var Ne=b.toolTip;Ne.disable(),Ne.hide()})),(Z=Y.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",K),Z.setAttribute("y1",te+3*Q/8),Z.setAttribute("x2",q-1),Z.setAttribute("y2",te+3*Q/8),j=L.shapeClass,typeof I.shapeClass<"u"&&(j=I.shapeClass),typeof j<"u"&&Z.setAttribute("class",j),j=L.shapeStyle,typeof I.shapeStyle<"u"&&(j=I.shapeStyle),typeof j<"u"&&Z.setAttribute("style",j),J.appendChild(Z),(Z=Y.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",K),Z.setAttribute("y1",G-3*Q/8),Z.setAttribute("x2",q-1),Z.setAttribute("y2",G-3*Q/8),j=L.shapeClass,typeof I.shapeClass<"u"&&(j=I.shapeClass),typeof j<"u"&&Z.setAttribute("class",j),j=L.shapeStyle,typeof I.shapeStyle<"u"&&(j=I.shapeStyle),typeof j<"u"&&Z.setAttribute("style",j),J.appendChild(Z),(Z=Y.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",K+3*ie/8),Z.setAttribute("y1",te),Z.setAttribute("x2",K+3*ie/8),Z.setAttribute("y2",te+3*Q/8),j=L.shapeClass,typeof I.shapeClass<"u"&&(j=I.shapeClass),typeof j<"u"&&Z.setAttribute("class",j),j=L.shapeStyle,typeof I.shapeStyle<"u"&&(j=I.shapeStyle),typeof j<"u"&&Z.setAttribute("style",j),J.appendChild(Z),(Z=Y.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",q-3*ie/8),Z.setAttribute("y1",te),Z.setAttribute("x2",q-3*ie/8),Z.setAttribute("y2",te+3*Q/8),j=L.shapeClass,typeof I.shapeClass<"u"&&(j=I.shapeClass),typeof j<"u"&&Z.setAttribute("class",j),j=L.shapeStyle,typeof I.shapeStyle<"u"&&(j=I.shapeStyle),typeof j<"u"&&Z.setAttribute("style",j),J.appendChild(Z),(Z=Y.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",K+3*ie/8),Z.setAttribute("y1",G),Z.setAttribute("x2",K+3*ie/8),Z.setAttribute("y2",G-3*Q/8),j=L.shapeClass,typeof I.shapeClass<"u"&&(j=I.shapeClass),typeof j<"u"&&Z.setAttribute("class",j),j=L.shapeStyle,typeof I.shapeStyle<"u"&&(j=I.shapeStyle),typeof j<"u"&&Z.setAttribute("style",j),J.appendChild(Z),(Z=Y.createElementNS("http://www.w3.org/2000/svg","line")).setAttribute("x1",q-3*ie/8),Z.setAttribute("y1",G),Z.setAttribute("x2",q-3*ie/8),Z.setAttribute("y2",G-3*Q/8),j=L.shapeClass,typeof I.shapeClass<"u"&&(j=I.shapeClass),typeof j<"u"&&Z.setAttribute("class",j),j=L.shapeStyle,typeof I.shapeStyle<"u"&&(j=I.shapeStyle),typeof j<"u"&&Z.setAttribute("style",j),J.appendChild(Z),(j=Y.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",(K+q)/2),j.setAttribute("y",G-3*Q/8-6),j.setAttribute("style","font-weight: bold; text-anchor: middle"),typeof(Z=I.displayedText)>"u"&&(Z=""),j.appendChild(Y.createTextNode(Z)),J.appendChild(j);var j=(Z=function(Ue){var ze;return(ze=(Ue=L.dateTimeFormatter(new Date(Ue.valueOf()+6e4*(new Date).getTimezoneOffset()))).indexOf(" "))>=0?(value1=Ue.substr(0,ze),value2=Ue.substr(ze+1)):(value1=Ue,value2=""),[value1,value2]})(I.earlyStart),Ce=Y.createElementNS("http://www.w3.org/2000/svg","text");return Ce.setAttribute("x",K+3*ie/8/2),Ce.setAttribute("y",G-5*Q/8-20),Ce.setAttribute("style","text-anchor: middle"),Ce.appendChild(Y.createTextNode(j[0])),J.appendChild(Ce),(Ce=Y.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",K+3*ie/8/2),Ce.setAttribute("y",G-5*Q/8-4),Ce.setAttribute("style","text-anchor: middle"),Ce.appendChild(Y.createTextNode(j[1])),J.appendChild(Ce),j=L.timeSpanFormatter(I.effort),(Ce=Y.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",(K+q)/2),Ce.setAttribute("y",G-5*Q/8-12),Ce.setAttribute("style","text-anchor: middle"),Ce.appendChild(Y.createTextNode(j)),J.appendChild(Ce),j=Z(I.earlyFinish),(Ce=Y.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",q-3*ie/8/2),Ce.setAttribute("y",G-5*Q/8-20),Ce.setAttribute("style","text-anchor: middle"),Ce.appendChild(Y.createTextNode(j[0])),J.appendChild(Ce),(Ce=Y.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",q-3*ie/8/2),Ce.setAttribute("y",G-5*Q/8-4),Ce.setAttribute("style","text-anchor: middle"),Ce.appendChild(Y.createTextNode(j[1])),J.appendChild(Ce),j=Z(I.lateStart),(Q=Y.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",K+3*ie/8/2),Q.setAttribute("y",G-20),Q.setAttribute("style","text-anchor: middle"),Q.appendChild(Y.createTextNode(j[0])),J.appendChild(Q),(Q=Y.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",K+3*ie/8/2),Q.setAttribute("y",G-4),Q.setAttribute("style","text-anchor: middle"),Q.appendChild(Y.createTextNode(j[1])),J.appendChild(Q),j=L.timeSpanFormatter(I.slack),(Q=Y.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",(K+q)/2),Q.setAttribute("y",G-12),Q.setAttribute("style","text-anchor: middle"),Q.appendChild(Y.createTextNode(j)),J.appendChild(Q),j=Z(I.lateFinish),(Q=Y.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",q-3*ie/8/2),Q.setAttribute("y",G-20),Q.setAttribute("style","text-anchor: middle"),Q.appendChild(Y.createTextNode(j[0])),J.appendChild(Q),(Q=Y.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",q-3*ie/8/2),Q.setAttribute("y",G-4),Q.setAttribute("style","text-anchor: middle"),Q.appendChild(Y.createTextNode(j[1])),J.appendChild(Q),L.canUserRearrangeItems&&((Y=Y.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",K),Y.setAttribute("y",te),Y.setAttribute("width",Math.max(0,q-K-1)),Y.setAttribute("height",Math.max(0,G-te-1)),Y.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer"),J.appendChild(Y),ke(Y,I,M,m(I,L),c(I,L),b,L)),J}},He=function(h,w){return function(v,I){var b=v.networkDiagramView,L=typeof w<"u"?w:b.settings,J=typeof h<"u"?h:b.items,M=b.ownerDocument,Y=M.createElementNS("http://www.w3.org/2000/svg","g"),K=(J=be(v,I,J,L),M.createElementNS("http://www.w3.org/2000/svg","path"));K.setAttribute("d",J),typeof L.dependencyLineZoneClass<"u"&&K.setAttribute("class",L.dependencyLineZoneClass),typeof L.dependencyLineZoneStyle<"u"&&K.setAttribute("style",L.dependencyLineZoneStyle),Y.appendChild(K);var q=M.createElementNS("http://www.w3.org/2000/svg","path");return q.setAttribute("d",J),M=L.dependencyLineClass,typeof I.dependencyLineClass<"u"&&(M=I.dependencyLineClass),typeof M<"u"&&q.setAttribute("class",M),M=L.dependencyLineStyle,typeof I.dependencyLineStyle<"u"&&(M=I.dependencyLineStyle),typeof M<"u"&&q.setAttribute("style",M),Y.appendChild(q),L.isDependencyToolTipVisible&&L.useInlineToolTips&&L.useInlineToolTipsForDependencies&&(Y.addEventListener("mouseover",t(b,Y,"mouseover",function(te){var G=DlhSoft.Controls.ToolTip.get(q);G||(G=DlhSoft.Controls.ToolTip.initialize(void 0,q,{duration:NaN,containerStyle:"cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+L.border+"; background-color: White; color: Black; font-family: "+(L.classic?"Arial":"system-ui, Arial")+"; font-size: 12px; padding: 4px; margin-top: 1px"},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),G.setContent(L.predecessorItemTemplate(v,I).innerHTML.replaceAll("\n","<br/>")),G.show();var Q=Y.getBoundingClientRect();G.setHorizontalPosition(G.x+te.clientX-Q.left),G.setVerticalPosition(G.y+te.clientY-Q.bottom+10),b.toolTip=G})),Y.addEventListener("mouseout",t(b,Y,"mouseout",function(){var te=b.toolTip;te.disable(),te.hide()}))),Y}},Ie=function(){return function(h,w){var v=h.networkDiagramView.ownerDocument,I=v.createElementNS("http://www.w3.org/2000/svg","title");return I.appendChild(he(v,w.item.displayedText+" - "+h.displayedText)),I}},be=function(q,J,b,ie){b="M ";var L=m(q,ie)-2,M=c(q,ie)-2,Y=m(J.item,ie),K=(J=c(J.item,ie),m(q,ie)),te=(q=c(q,ie),Math.abs(K-Y)),G=Math.abs(q-J),Q=ie.shapeWidth+2,ye=Q/2,Z=(ie=ie.shapeHeight+2)/2,j=Math.max(Q,ie);return te<j?b=J<=q?b+(Y+ye-L+",")+(J+ie-M)+" L "+(K+ye-L)+","+(q-M):b+(Y+ye-L+",")+(J-M)+" L "+(K+ye-L)+","+(q+ie-M):(b=Y<=K?b+(Y+Q-L+",")+(J+Z-M):b+(Y-L+",")+(J+Z-M),b=G<4*j?Y<=K?b+" L "+(K-L)+","+(q+Z-M):b+" L "+(K+Q-L)+","+(q+Z-M):J<=q?b+" L "+(K+ye-L)+","+(q-M):b+" L "+(K+ye-L)+","+(q+ie-M)),b},ue=function(h,w,v,I){typeof h.networkDiagramView<"u"&&h.networkDiagramView.settings.itemPropertyChangeHandler(h,w,v,I)},ke=function(h,w,v,I,b,L,M){function Y(G){L.draggingItem=w,L.dragType="Position",L.style.cursor=h.style.cursor,L.draggingInitialX=G.clientX,L.draggingInitialY=G.clientY,L.draggingInitialThumbXPosition=I,L.draggingInitialThumbYPosition=b}h.addEventListener("mousedown",t(L,h,"mousedown",function(G){0==G.button&&(Y(G),G.preventDefault())},!0),!0),h.addEventListener("touchstart",t(L,h,"touchstart",function(G){Y(G.touches[0]),G.preventDefault()},!0),!0),typeof L.draggableItems>"u"&&(L.draggableItems=[]);for(var J=!1,K=0;K<L.draggableItems.length;K++)if(L.draggableItems[K]==w){J=!0;break}if(!J){var q=function(G){if(!(typeof L.draggingItem>"u"||L.draggingItem!=w||"Position"!=L.dragType)){var Q=G.clientX-L.draggingInitialX,ie=G.clientY-L.draggingInitialY,ye=G.clientX,Z=L;if(typeof Z.draggingItem<"u"){var j=new Date;if(!Z.lastXDraggingTime||!(j>Z.lastXDraggingTime&&j-Z.lastXDraggingTime<200)){Z.lastXDraggingTime=j;var Ce=0;if((j=Z).offsetParent)do{Ce+=j.offsetLeft,j=j.offsetParent}while(j);(ye-=Ce)<24?(ye=Z.chartContentContainer.scrollLeft,Z.chartContentContainer.scrollLeft=Z.chartContentContainer.scrollLeft-48,ye-=Z.chartContentContainer.scrollLeft,typeof Z.draggingInitialThumbXPosition<"u"&&(Z.draggingInitialThumbXPosition=Z.draggingInitialThumbXPosition-ye)):ye>=Z.chartContentContainer.clientWidth-24&&(ye=Z.chartContentContainer.scrollLeft,Z.chartContentContainer.scrollLeft=Z.chartContentContainer.scrollLeft+48,ye=Z.chartContentContainer.scrollLeft-ye,typeof Z.draggingInitialThumbXPosition<"u"&&(Z.draggingInitialThumbXPosition=Z.draggingInitialThumbXPosition+ye))}}if(Z=G.clientY,typeof(G=L).draggingItem<"u"&&(ye=new Date,!G.lastYDraggingTime||!(ye>G.lastYDraggingTime&&ye-G.lastYDraggingTime<200))){if(G.lastYDraggingTime=ye,j=0,(ye=G).offsetParent)do{j+=ye.offsetTop,ye=ye.offsetParent}while(ye);(Z-=j)<24?(Z=G.chartContentContainer.scrollTop,G.chartContentContainer.scrollTop=G.chartContentContainer.scrollTop-48,Z-=G.chartContentContainer.scrollTop,typeof G.draggingInitialThumbYPosition<"u"&&(G.draggingInitialThumbYPosition=G.draggingInitialThumbYPosition-Z)):Z>=G.chartContentContainer.clientHeight-24&&(Z=G.chartContentContainer.scrollTop,G.chartContentContainer.scrollTop=G.chartContentContainer.scrollTop+48,Z=G.chartContentContainer.scrollTop-Z,typeof G.draggingInitialThumbYPosition<"u"&&(G.draggingInitialThumbYPosition=G.draggingInitialThumbYPosition+Z))}delete L.draggingItem,L.draggingInitialThumbXPosition+Q<0&&(Q=-L.draggingInitialThumbXPosition),L.draggingInitialThumbYPosition+ie<0&&(ie=-L.draggingInitialThumbYPosition),G=w,ie=(L.draggingInitialThumbYPosition+ie-M.diagramMargin)/(M.itemHeight+M.minDependencyLineLength/M.aspectRatio),M.snapRearrangedItemsToGuidelines&&(ie=Math.round(ie)),G.actualRowIndex=ie,ie=w,Q=(L.draggingInitialThumbXPosition+Q-M.diagramMargin)/(M.itemWidth+M.minDependencyLineLength),M.snapRearrangedItemsToGuidelines&&(Q=Math.round(Q)),ie.actualColumnIndex=Q,ue(w,"actualRowIndex",!0,!1),ue(w,"actualColumnIndex",!0,!1),typeof w.displayedColumnIndex<"u"&&delete w.displayedColumnIndex,typeof w.displayedRowIndex<"u"&&delete w.displayedRowIndex,De(w,v,L.chartContent,M,!1),L.draggingItem=w,L.draggingPerformed=!0}};L.addEventListener("mousemove",t(L,L,"mousemove",function(G){q(G)},!0),!0),L.addEventListener("touchmove",t(L,L,"touchmove",function(G){q(G.touches[0])},!0),!0);var te=function(){if(!(typeof L.draggingItem>"u"||L.draggingItem!=w||"Position"!=L.dragType)){De(w,v,L.chartContent,M,!0);var G=L.draggingItem;delete L.draggingItem,L.style.cursor="default",L.draggingPerformed&&(ue(G,"actualColumnIndex",!0,!0),ue(G,"actualRowIndex",!0,!0),delete L.draggingPerformed)}};document.addEventListener("mouseup",t(L,document,"mouseup",function(G){0==G.button&&te()},!0),!0),document.addEventListener("touchend",t(L,document,"touchend",function(){te()},!0),!0),L.draggableItems.push(w)}},De=function(h,w,v,I,b){var L=h.networkDiagramView.ownerDocument;if(b)typeof v.temporaryRectangle<"u"&&((b=v.chartArea).removeChild(v.temporaryRectangle),delete v.temporaryRectangle),setTimeout(function(){A(h.chartItem,h,I),M=m(h,I),Y=c(h,I),h.chartItem.setAttribute("transform","translate("+M+", "+Y+")"),g(w),setTimeout(function(){Te(v,w,I,!0)},0)});else{typeof v.temporaryRectangle<"u"?L=v.temporaryRectangle:((L=L.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",0),L.setAttribute("y",0),L.setAttribute("width",I.shapeWidth),L.setAttribute("height",I.shapeHeight),typeof I.temporaryThumbClass<"u"&&L.setAttribute("class",I.temporaryThumbClass),L.setAttribute("style",I.temporaryThumbStyle),v.temporaryRectangle=L,(b=v.chartArea).appendChild(L));var M=m(h,I)+(I.itemWidth-I.shapeWidth)/2,Y=c(h,I)+(I.itemHeight-I.shapeHeight)/2;L.setAttribute("transform","translate("+M+", "+Y+")"),setTimeout(function(){Te(v,w,I,!1)},0)}},Te=function(h,L,v,I){var b=H(L,v);L=a(L,v),(I||b>h.clientWidth)&&(h.style.width=b+"px"),(I||L>h.clientHeight)&&(h.style.height=L+"px"),(h=h.chartArea).setAttribute("style",I?"width: "+b+"px; height: "+L+"px":"width: "+Math.max(h.clientWidth,b)+"px; height: "+Math.max(h.clientHeight,L)+"px")},tt=function(h,w){for(var v=h.childNodes.length;v-- >0;)h.removeChild(h.childNodes[v]);h.appendChild(w)},Ye=function(h,w){for(var v in w)0!=v.indexOf("custom")&&0!=v.indexOf("description")||typeof h[v]>"u"&&(h[v]=w[v])},Oe=function(h,w,K,I,b,L,M,Y,G){G=H(Y,K={isExport:!0,canUserRearrangeItems:!1,isTaskToolTipVisible:!1,isDependencyToolTipVisible:!1,containerClass:G.containerClass,containerStyle:G.containerStyle,border:G.border,theme:G.theme,itemWidth:G.itemWidth,itemHeight:G.itemHeight,aspectRatio:G.aspectRatio,shapeWidth:G.shapeWidth,shapeHeight:G.shapeHeight,shapeClass:G.shapeClass,milestoneClass:G.milestoneClass,shapeStyle:G.shapeStyle,milestoneStyle:G.milestoneStyle,dependencyLineClass:G.dependencyLineClass,dependencyLineStyle:G.dependencyLineStyle,minDependencyLineLength:G.minDependencyLineLength,diagramMargin:0,target:G.target,dateTimeFormatter:G.dateTimeFormatter,timeSpanFormatter:G.timeSpanFormatter,isRelativeToTimezone:G.isRelativeToTimezone,arrowSize:G.arrowSize,arrowFill:G.arrowFill,taskTemplate:G.taskTemplate,dependencyLineTemplate:G.dependencyLineTemplate,classic:G.classic});var q=a(Y,K);K.chartWidth=G+"px",K.chartHeight=q+"px";var Q,ie,te=G+2,ye=(G=q+2,!1);if(null!=I&&typeof I.createElement<"u")Q=I;else{null!=I&&typeof I.focus<"u"?ie=I:(ie=window.open("",I??"_blank",typeof b<"u"&&b&&(typeof M>"u"||M)?"width=800,height=480,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":""),ye=!0),Q=ie.document;try{var Z=document.head.getElementsByTagName("link");for(I=0;I<Z.length;I++){var j=Z[I],Ce=Q.adoptNode(j.cloneNode(!0));Ce.href=j.href,Q.head.appendChild(Ce)}}catch{}}for(Q.title=typeof h<"u"?h:"Exported diagram"+(typeof b<"u"&&b?" (printable)":""),h=[],I=0;I<Y.length;I++)Ye(j={content:(Z=Y[I]).content,earlyStart:Z.earlyStart,earlyFinish:Z.earlyFinish,lateStart:Z.lateStart,lateFinish:Z.lateFinish,isMilestone:Z.isMilestone,effort:Z.effort,slack:Z.slack,isShapeVisible:Z.isShapeVisible,isRelativeToTimezone:Z.isRelativeToTimezone,shapeClass:Z.shapeClass,milestoneClass:Z.milestoneClass,shapeStyle:Z.shapeStyle,milestoneStyle:Z.milestoneStyle,displayedRowIndex:Z.actualRowIndex,displayedColumnIndex:Z.actualColumnIndex,isExported:!0},Z),h.push(j),Z.exportItem=j;for(I=0;I<Y.length;I++)if(j=(Z=Y[I]).exportItem,typeof Z.predecessors<"u")for(j.predecessors=[],Ce=0;Ce<Z.predecessors.length;Ce++)j.predecessors.push({item:(q=Z.predecessors[Ce]).item.exportItem,dependencyLineClass:q.dependencyLineClass,dependencyLineStyle:q.dependencyLineStyle});var Ne=Q.createElement("p");Ne.innerHTML=typeof w<"u"?w:"",Q.body.appendChild(Ne);var Ue=Q.createElement("div");Ue.setAttribute("style","width: "+te+"px; height: "+G+"px");try{DlhSoft.Controls.Pert.NetworkDiagramView.initialize(Ue,h,K,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch{}setTimeout(function(){ye&&Q.body.setAttribute("style","margin: 0px");var ze=Q.createElement("div");ze.appendChild(Ue),Q.body.replaceChild(ze,Ne),L&&(ze.setAttribute("style","width: "+Ue.offsetHeight+"px; height: "+te+"px; overflow: hidden"),ze=Math.round((Ue.offsetWidth-Ue.offsetHeight)/2),Ue.setAttribute("style","width: "+te+"px; transform: rotate(90deg) translateX("+ze+"px) translateY("+ze+"px); -webkit-transform: rotate(90deg) translateX("+ze+"px) translateY("+ze+"px)")),Q.close(),void 0!==typeof ie&&(ie.focus(),typeof b<"u"&&b&&(ie.print(),(typeof M>"u"||M)&&setTimeout(function(){ie.close()})))},0)},it=function(h,w){for(var v=0;v<w.length;v++){var I=w[v];delete I.successorInfo,delete I.effortInfo}e:{for(var b=0;b<w.length;b++)if(typeof(v=w[b]).predecessors>"u"||0==v.predecessors.length)break e;v=null}if(null==v)return[];e:{for(b=w.length;b-- >0;)if(0==Qe(I=w[b]).length)break e;I=null}if(null==I)return[];for(b=[v],v=et(v,I),I=0;I<v.length;I++)b.push(v[I]);for(v=0;v<w.length;v++)delete(I=w[v]).successorInfo,delete I.effortInfo;return b},Le=function(h,w){for(var v=it(0,w),I=[],b=0;b<v.length;b++){var L=v[b];if(typeof L.predecessors<"u")for(var M=0;M<L.predecessors.length;M++){var Y=L.predecessors[M];typeof Y.item<"u"&&v.indexOf(Y.item)>=0&&I.push(Y)}}return I},et=function(h,w){if(null==h||null==w||h==w||typeof w.predecessors>"u")return[];var b,v=[],I=[],L=null;for(b=0;b<w.predecessors.length;b++)if(predecessorItem=w.predecessors[b],typeof predecessorItem.item<"u"){var M=ft(h,predecessorItem.item);null!=M&&(predecessorItem.item.effort>0&&(M+=predecessorItem.item.effort),(null==L||M>=L)&&((null==L||M>L)&&(L=M,I=[]),I.push(predecessorItem)))}for(b=0;b<I.length;b++){for(nextPredecessorItem=I[b],L=et(h,nextPredecessorItem.item),M=0;M<L.length;M++)v.push(L[M]);v.push(w)}return v},ft=function(h,w){if(null==h||null==w)return null;if(h==w)return 0;h.effortInfo||(h.effortInfo={});var v=w.index.toString();if(typeof h.effortInfo[v]<"u")return h.effortInfo[v];for(var I=null,b=Qe(h),L=0;L<b.length;L++){var M=b[L],Y=ft(M.dependentItem,w);null!=Y&&((Y+=typeof M.predecessorItem.item<"u"&&M.predecessorItem.item.effort>0?M.predecessorItem.item.effort:0)<0&&(Y=0),(null==I||Y>I)&&(I=Y))}return h.effortInfo[v]=I},Qe=function(h){if(h.successorInfo)return h.successorInfo;for(var w=[],v=h.networkDiagramView.items,I=0;I<v.length;I++){var b=v[I];if(typeof b.predecessors<"u")for(var L=0;L<b.predecessors.length;L++){var M=b.predecessors[L];typeof M.item<"u"&&M.item==h&&w.push({dependentItem:b,predecessorItem:M})}}return h.successorInfo=w},st=function(h){for(var w=null,v=0;v<h.length;v++)(null==w||h[v]>w)&&(w=h[v]);return w},x=function(h){return typeof h<"u"?new Date(h.valueOf()+6e4*h.getTimezoneOffset()):h},W=function(h){return typeof h<"u"?new Date(h.valueOf()-6e4*h.getTimezoneOffset()):h},O=function(h,w,v){for(var I=0;I<w.length;I++)w[I].networkDiagramView=h,w[I].index=I;h.items=w,h.settings=v,h.refresh=function(){Ee(h)},h.refreshItems=function(){for(var b=0;b<w.length;b++){var L=w[b];F(L),P(L)}},h.refreshChartItems=function(){for(var b=0;b<w.length;b++)F(w[b])},h.refreshItem=z,h.refreshChartItem=F,h.refreshPredecessorItems=P,h.refreshItemGraph=U,h.scrollToItem=function(b){var L=m(b,v),M=L-b.networkDiagramView.chartContentContainer.scrollLeft;M<0?b.networkDiagramView.chartContentContainer.scrollLeft=L:M>b.networkDiagramView.chartContentContainer.clientWidth-b.networkDiagramView.settings.itemWidth&&(b.networkDiagramView.chartContentContainer.scrollLeft=L-(b.networkDiagramView.chartContentContainer.clientWidth-b.networkDiagramView.settings.itemWidth)),(M=(L=c(b,v))-b.networkDiagramView.chartContentContainer.scrollTop)<0?b.networkDiagramView.chartContentContainer.scrollTop=L:M>b.networkDiagramView.chartContentContainer.clientHeight-b.networkDiagramView.settings.itemHeight&&(b.networkDiagramView.chartContentContainer.scrollTop=L-(b.networkDiagramView.chartContentContainer.clientHeight-b.networkDiagramView.settings.itemHeight))},h.scrollToLeft=function(){h.chartContentContainer.scrollLeft=0},h.scrollToRight=function(){h.chartContentContainer.scrollLeft=h.chartContent.clientWidth},h.scrollToTop=function(){h.chartContentContainer.scrollTop=0},h.scrollToBottom=function(){h.chartContentContainer.scrollTop=h.chartContent.clientHeight},h.getChartWidth=function(){return H(w,v)},h.getChartHeight=function(){return a(w,v)},h.getItemTop=function(b){return c(b,v)},h.getItemLeft=function(b){return m(b,v)},h.onItemPropertyChanged=ue,h.initializeTaskDraggingThumbs=function(b,L,M,Y){ke(b,L,h.items,M,Y,h,h.settings)},h.exportContent=function(b,L){typeof b>"u"&&(b={}),Oe(b.title,b.preparingMessage,b.isRelativeToTimezone,L,!1,b.rotate,!1,w,v)},h.print=function(b){typeof b>"u"&&(b={}),Oe(b.title,b.preparingMessage,b.isRelativeToTimezone,null,!0,b.rotate,b.autoClose,w,v)},h.isItemCritical=function(b,L){return it(0,w).indexOf(b)>=0},h.isDependencyCritical=function(b,L){return Le(0,w).indexOf(b)>=0},h.getCriticalItems=function(b){return it(0,w)},h.getCriticalDependencies=function(b){return Le(0,w)},h.repositionEnds=function(){if(0!=w.length){for(var b=!1,L=0;L<w.length;L++){for(var M=w[L],Y=0,J=0;J<w.length;J++){var K=w[J];if(typeof K.predecessors<"u"){for(var q=0;q<K.predecessors.length&&!(typeof K.predecessors[q].item<"u"&&K.predecessors[q].item==M&&(Y++,Y>1));q++);if(Y>1)break}}Y>1&&(b=!0)}(L=w[0]).displayedRowIndex=b?.5:0,(M=w[w.length-1]).displayedRowIndex=b?.5:0,U(L),U(M)}},h.getOutputDate=x,h.getInputDate=W};return{initialize:pe,initializeItems:Ke,refresh:Ee,getDefaultStyleDefinitionTemplate:$,getDefaultTaskTemplate:Fe,getDefaultItemTemplate:de,getDefaultDependencyLineTemplate:He,getDefaultPredecessorItemTemplate:Ie,initializeTaskDraggingThumbs:function(h,w,v,I){w.networkDiagramView.initializeTaskDraggingThumbs(h,w,v,I)},defaultDateTimeFormatter:function(h){return ge(new Date(h.valueOf()+6e4*(new Date).getTimezoneOffset()))},defaultTimeSpanFormatter:ae,getOutputDate:x,getInputDate:W}}()),typeof DlhSoft>"u"&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)}),DlhSoft.assemblies.push({assembly:"DlhSoft.Data.HTML.Controls",company:"DlhSoft",product:"Data Modern Library",version:"5.2.3.1",copyright:"Copyright \ufffd 2014-2021 DlhSoft",title:"Data HTML Controls",description:"Data related HTML client components"}),DlhSoft.buildReleaseDate=function(t,pe,Ee){return(t=new Date(t,4,8))>DlhSoft.buildReleaseDate?t:DlhSoft.buildReleaseDate}(2015),_0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{"),null==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var t=_0x5c25[1],pe=_0x5c25[2],Ee=[],Be=[],We=_0x5c25[3];return{setLicense:function(we,me){Ee[_0x5c25[7]]({type:we,content:me})},validate:function(we,me,xe,Se,he,ge,ae){me=me+_0x5c25[4]+xe;for(var fe=0;fe<Be[_0x5c25[5]];fe++)if(Be[fe]==me)return;e:if(typeof ge!==pe&&typeof ae!==t&&(ae[_0x5c25[6]]!==t&&(ge=ae[_0x5c25[6]]),typeof ae===pe&&(ge=ae)),typeof ge!==pe)for(ae=0;ae<Ee[_0x5c25[5]];ae++)if((fe=Ee[ae])[_0x5c25[8]]==me&&typeof fe[_0x5c25[9]]===pe){ge=fe[_0x5c25[9]];break e}!function(we,me){if(typeof we!==pe||typeof me!==pe)return!1;if(me==We)return!0;var xe=me[_0x5c25[11]](_0x5c25[10]);if(0<=xe){var he,Se=me[_0x5c25[12]](0,xe),ge=Se[_0x5c25[11]](_0x5c25[10]);if(0<=ge)try{he=new Date(parseInt(Se[_0x5c25[12]](ge+1)))}catch{}if(typeof he===t&&(he=new Date(2013,11,31)),DlhSoft[_0x5c25[13]]>he)return!1;for(Se=Se+_0x5c25[10]+we,i=he=0;i<Se[_0x5c25[5]];i++)he=(he<<5)-he+(ge=Se[_0x5c25[14]](i)),he&=he;if(0>he&&(he=Math[_0x5c25[15]](2,32)-he),(Se=he.toString(16)[_0x5c25[16]]())==(xe=me[_0x5c25[12]](xe+1)))return!0}return!1}(me,ge)?function(we,me,xe,Se,he){var ge=_0x5c25[17],fe=typeof ComponentSource!==t&&ComponentSource?_0x5c25[21]:_0x5c25[18]+_0x5c25[19]+Se+_0x5c25[20]+he,H=Se+_0x5c25[22]+he+_0x5c25[23],a=_0x5c25[24],D=_0x5c25[25],m=_0x5c25[26];setTimeout(function(){var c=we[_0x5c25[27]],g=c[_0x5c25[29]](_0x5c25[28]);g[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var S=c[_0x5c25[29]](_0x5c25[28]);S[_0x5c25[32]](_0x5c25[30],_0x5c25[33]);var A=c[_0x5c25[29]](_0x5c25[28]);A[_0x5c25[32]](_0x5c25[30],_0x5c25[34]),S[_0x5c25[35]](A),A[_0x5c25[35]](c[_0x5c25[36]](ge)),S[_0x5c25[35]](c[_0x5c25[36]](a+_0x5c25[10])),(A=c[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),A[_0x5c25[35]](c[_0x5c25[36]](me)),S[_0x5c25[35]](A),S[_0x5c25[35]](c[_0x5c25[36]](D+_0x5c25[10])),(A=c[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[37]),A[_0x5c25[35]](c[_0x5c25[36]](H)),S[_0x5c25[35]](A),S[_0x5c25[35]](c[_0x5c25[36]](m+_0x5c25[10])),(A=c[_0x5c25[29]](_0x5c25[28]))[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var F=c[_0x5c25[29]](_0x5c25[39]);F[_0x5c25[32]](_0x5c25[30],_0x5c25[40]),F[_0x5c25[32]](_0x5c25[41],fe),F[_0x5c25[32]](_0x5c25[42],_0x5c25[43]),F[_0x5c25[35]](c[_0x5c25[36]](_0x5c25[44])),A[_0x5c25[35]](F),(F=c[_0x5c25[29]](_0x5c25[39]))[_0x5c25[32]](_0x5c25[30],_0x5c25[45]),F[_0x5c25[32]](_0x5c25[41],_0x5c25[46]),F[_0x5c25[35]](c[_0x5c25[36]](_0x5c25[47])),F[_0x5c25[50]](_0x5c25[48],function(){we[_0x5c25[49]](g),Be[_0x5c25[7]](xe)},!1),A[_0x5c25[35]](F),S[_0x5c25[35]](A),g[_0x5c25[35]](S),we[_0x5c25[35]](g)},0),setTimeout(function(){alert(ge+_0x5c25[51]+a+_0x5c25[52]+me+_0x5c25[51]+D+_0x5c25[53]+H+_0x5c25[51]+m+_0x5c25[4])},6e5)}(we,xe,me,Se,he):we[_0x5c25[6]]=ge}}}());var DlhSoft,__extends=this&&this.__extends||function(t,pe){function Ee(){this.constructor=t}for(var Be in pe)pe.hasOwnProperty(Be)&&(t[Be]=pe[Be]);t.prototype=null===pe?Object.create(pe):(Ee.prototype=pe.prototype,new Ee)};function initializeGanttChartTheme(t,pe){if("Default"!=pe){if("Aero"==pe)return void(t.theme="Aero");switch(typeof t.headerHeight>"u"&&(t.headerHeight=62),typeof t.itemHeight>"u"&&(t.itemHeight=28),typeof t.barMargin>"u"&&(t.barMargin=4),typeof t.completedBarMargin>"u"&&(t.completedBarMargin=1),typeof t.barCornerRadius>"u"&&(t.barCornerRadius=1),typeof t.completedBarCornerRadius>"u"&&(t.completedBarCornerRadius=1),typeof t.arrowSize>"u"&&(t.arrowSize=2),typeof t.hourWidth>"u"&&(t.hourWidth=5),pe){case"Generic-bright":typeof t.headerBackground>"u"&&(t.headerBackground="white"),typeof t.mainStroke>"u"&&(t.mainStroke="#005c9e"),typeof t.mainFill>"u"&&(t.mainFill="white"),typeof t.accentFill>"u"&&(t.accentFill="#005c9e"),typeof t.diamondFill>"u"&&(t.diamondFill="#e31d3b"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#005c9e"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#daae66"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Generic-blue":typeof t.headerBackground>"u"&&(t.headerBackground="white");break;case"Royal-blue":typeof t.border>"u"&&(t.border="#ccc"),typeof t.headerBackground>"u"&&(t.headerBackground="#aaa"),typeof t.headerForeground>"u"&&(t.headerForeground="white"),typeof t.toggleFill>"u"&&(t.toggleFill="#ccc"),typeof t.selectedGridForeground>"u"&&(t.selectedGridForeground="#4b5d6b"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#ddd"),typeof t.nonworkingBackground>"u"&&(t.nonworkingBackground="#f8f8f8"),typeof t.mainStroke>"u"&&(t.mainStroke="#407cee"),typeof t.mainFill>"u"&&(t.mainFill="#407cee"),typeof t.accentFill>"u"&&(t.accentFill="#6aa84f"),typeof t.diamondFill>"u"&&(t.diamondFill="#fdbb86"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#222222"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Purple-green":typeof t.headerBackground>"u"&&(t.headerBackground="#dddfd4"),typeof t.mainStroke>"u"&&(t.mainStroke="#005173"),typeof t.mainFill>"u"&&(t.mainFill="#a0729d"),typeof t.accentFill>"u"&&(t.accentFill="#91bc0e"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#fff;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#fff;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Blue-navy":typeof t.headerBackground>"u"&&(t.headerBackground="#eeeeee"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#e8e8e8"),typeof t.mainStroke>"u"&&(t.mainStroke="#6534ff"),typeof t.mainFill>"u"&&(t.mainFill="#369bf9"),typeof t.accentFill>"u"&&(t.accentFill="#227fd5"),typeof t.alternativeGridBackground>"u"&&(t.alternativeGridBackground="#f9f9f9"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Orange-brown":typeof t.headerBackground>"u"&&(t.headerBackground="#eeeeee"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#e8e8e8"),typeof t.mainStroke>"u"&&(t.mainStroke="#cc9d38"),typeof t.mainFill>"u"&&(t.mainFill="#ffcf6b"),typeof t.accentFill>"u"&&(t.accentFill="#d5a05a"),typeof t.diamondFill>"u"&&(t.diamondFill="#00c389"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#222222"),typeof t.alternativeBackground>"u"&&(t.alternativeBackground="#f9f9f9"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#fff;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#fff;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#6a66b3;");break;case"Teal-green":typeof t.headerBackground>"u"&&(t.headerBackground="#eeeeee"),typeof t.mainStroke>"u"&&(t.mainStroke="#3294a1"),typeof t.mainFill>"u"&&(t.mainFill="#5ebccc"),typeof t.accentFill>"u"&&(t.accentFill="#3294a1"),typeof t.diamondFill>"u"&&(t.diamondFill="#faffb3"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#3294a1"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Steel-blue":typeof t.border>"u"&&(t.border="#aaaaaa"),typeof t.headerBackground>"u"&&(t.headerBackground="#6b7d8b"),typeof t.headerForeground>"u"&&(t.headerForeground="white"),typeof t.headerBorder>"u"&&(t.headerBorder="#aaaaaa"),typeof t.containerBackground>"u"&&(t.containerBackground="#d5e5f2"),typeof t.chartBackground>"u"&&(t.chartBackground="#bfcfda"),typeof t.gridForeground>"u"&&(t.gridForeground="gray"),typeof t.toggleFill>"u"&&(t.toggleFill="gray"),typeof t.selectedGridForeground>"u"&&(t.selectedGridForeground="#4b5d6b"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#95a5b2"),typeof t.nonworkingBackground>"u"&&(t.nonworkingBackground="#95a5b2"),typeof t.mainStroke>"u"&&(t.mainStroke="#4477aa"),typeof t.mainFill>"u"&&(t.mainFill="#6699cc"),typeof t.accentFill>"u"&&(t.accentFill="#4c7f3d"),typeof t.diamondFill>"u"&&(t.diamondFill="#999"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#222222"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Cyan-green":typeof t.headerBackground>"u"&&(t.headerBackground="#dddddd"),typeof t.mainStroke>"u"&&(t.mainStroke="#7fc6ce"),typeof t.mainFill>"u"&&(t.mainFill="#1fb5ce"),typeof t.accentFill>"u"&&(t.accentFill="#1fce43"),typeof t.diamondFill>"u"&&(t.diamondFill="#d6485b"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#222222"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Purple-beige":typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#d0d5e5"),typeof t.mainStroke>"u"&&(t.mainStroke="#bfb8a4"),typeof t.mainFill>"u"&&(t.mainFill="#d0d5f5"),typeof t.accentFill>"u"&&(t.accentFill="#bfb8a4"),typeof t.diamondFill>"u"&&(t.diamondFill="#bfb8a4"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#005c9e"),typeof t.alternativeGridBackground>"u"&&(t.alternativeGridBackground="#f0eeeb"),typeof t.alternativeChartBackground>"u"&&(t.alternativeChartBackground="#f9f9f9"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#555;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#fff;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Dark-black":typeof t.containerClass>"u"&&(t.containerClass="dark"),typeof t.border>"u"&&(t.border="#222222"),typeof t.headerBackground>"u"&&(t.headerBackground="#111111"),typeof t.headerForeground>"u"&&(t.headerForeground="#eeeeee"),typeof t.headerBorder>"u"&&(t.headerBorder="#222222"),typeof t.containerBackground>"u"&&(t.containerBackground="#222222"),typeof t.gridForeground>"u"&&(t.gridForeground="#dddddd"),typeof t.chartForeground>"u"&&(t.chartForeground="#dddddd"),typeof t.scaleSeparatorBorder>"u"&&(t.scaleSeparatorBorder="#505050"),typeof t.toggleFill>"u"&&(t.toggleFill="#808080"),typeof t.toggleHoveringFill>"u"&&(t.toggleHoveringFill="white"),typeof t.selectedGridForeground>"u"&&(t.selectedGridForeground="white"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#404040"),typeof t.nonworkingBackground>"u"&&(t.nonworkingBackground="#333333"),typeof t.mainStroke>"u"&&(t.mainStroke="gray"),typeof t.accentFill>"u"&&(t.accentFill="#ffbb00"),typeof t.summaryFill>"u"&&(t.summaryFill="#505050"),typeof t.diamondFill>"u"&&(t.diamondFill="#ffbb00"),typeof t.currentTimeStroke>"u"&&(t.currentTimeStroke="#289451"),typeof t.standardLabelColor>"u"&&(t.standardLabelColor="#dcf2f8;"),typeof t.summaryLabelColor>"u"&&(t.summaryLabelColor="#dcf2f8;"),typeof t.milestoneLabelColor>"u"&&(t.milestoneLabelColor="#ff851b;");break;case"Gray-blue":typeof t.headerBackground>"u"&&(t.headerBackground="white"),typeof t.containerBackground>"u"&&(t.containerBackground="#fafafa"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#def8ff"),typeof t.mainStroke>"u"&&(t.mainStroke="#005c9e"),typeof t.mainFill>"u"&&(t.mainFill="white"),typeof t.accentFill>"u"&&(t.accentFill="#007acc"),typeof t.diamondFill>"u"&&(t.diamondFill="#abe2ff"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#007acc");break;case"DlhSoft-gray":typeof t.border>"u"&&(t.border="#aaaaaa"),typeof t.headerBackground>"u"&&(t.headerBackground="#CDDFFC"),typeof t.headerForeground>"u"&&(t.headerForeground="#333"),typeof t.headerBorder>"u"&&(t.headerBorder="transparent"),typeof t.selectedGridBackground>"u"&&(t.selectedGridBackground="#e8e8e8"),typeof t.mainStroke>"u"&&(t.mainStroke="#777"),typeof t.mainFill>"u"&&(t.mainFill="#f9f9f9"),typeof t.accentFill>"u"&&(t.accentFill="#decfb9"),typeof t.summaryFill>"u"&&(t.summaryFill="#777"),typeof t.diamondFill>"u"&&(t.diamondFill="#99c9ce"),typeof t.diamondStroke>"u"&&(t.diamondStroke="#777"),typeof t.alternativeGridBackground>"u"&&(t.alternativeGridBackground="#f8f8f8"),typeof t.currentTimeStroke>"u"&&(t.currentTimeStroke="#82a0b3")}typeof t.containerStyle>"u"&&t.containerBackground&&(t.containerStyle="background-color: "+t.containerBackground),typeof t.columnHeaderStyle>"u"&&t.headerForeground&&(t.columnHeaderStyle="color: "+t.headerForeground),t.gridForeground?(typeof t.itemStyle>"u"&&(t.itemStyle="color: "+t.gridForeground+(t.gridBackground?"; background-color: "+t.gridBackground:"")),typeof t.selectedItemStyle>"u"&&t.selectedGridForeground&&(t.selectedItemStyle="color: "+t.selectedGridForeground+"; background-color: "+(t.selectedGridBackground?t.selectedGridBackground:t.gridForeground))):typeof t.selectedItemStyle>"u"&&(t.selectedGridForeground||t.selectedGridBackground)&&(t.selectedItemStyle="color: "+(t.selectedGridForeground?t.selectedGridForeground:"black")+"; background-color: "+(t.selectedGridBackground?t.selectedGridBackground:"#f0f0f0")),typeof t.toggleButtonStyle>"u"&&t.toggleFill&&(t.toggleButtonStyle="fill: "+t.toggleFill),typeof t.toggleButtonHoveringStyle>"u"&&t.toggleHoveringFill&&(t.toggleButtonHoveringStyle="fill: "+t.toggleHoveringFill),typeof t.scales>"u"&&(t.scales=[{scaleType:"NonworkingTime",isHeaderVisible:!1,isHighlightingVisible:!0,highlightingStyle:"stroke-width: 0; fill: "+(t.nonworkingBackground?t.nonworkingBackground:"#f8f8f8")+"; fill-opacity: 0.65"},{scaleType:"Weeks",headerTextFormat:"Date",headerStyle:"padding: 7px 5px; border-right: 1px solid "+(t.headerBorder?t.headerBorder:"#e8e8e8")+"; border-bottom: 1px solid "+(t.headerBorder?t.headerBorder:"#e8e8e8")+(t.headerForeground?"; color: "+t.headerForeground:""),isSeparatorVisible:!0,separatorStyle:"stroke: "+(t.scaleSeparatorBorder?t.scaleSeparatorBorder:"#c8bfe7")+"; stroke-width: 0.5px"},{scaleType:"Days",headerTextFormat:"DayOfWeekAbbreviation",headerStyle:"padding: 7px 5px; border-right: 1px solid "+(t.headerBorder?t.headerBorder:"#e8e8e8")+(t.headerForeground?"; color: "+t.headerForeground:"")},{scaleType:"CurrentTime",isHeaderVisible:!1,isSeparatorVisible:!0,separatorStyle:"stroke: "+(t.currentTimeStroke?t.currentTimeStroke:"#e31d3b")+"; stroke-width: 0.5px"}]),t.chartBackground&&t.scales.splice(0,0,{scaleType:"Custom",isHeaderVisible:!1,intervals:[{start:new Date(1,0,1),finish:new Date(1e4,11,31,23,59,59,999)}],isHighlightingVisible:!0,highlightingStyle:"fill: "+t.chartBackground}),t.mainFill&&(typeof t.standardBarStyle>"u"&&(t.standardBarStyle="stroke: "+(t.mainStroke?t.mainStroke:t.mainFill)+"; fill: "+t.mainFill),typeof t.collapsedSummaryLineStyle>"u"&&(t.collapsedSummaryLineStyle="stroke: "+(t.mainStroke?t.mainStroke:t.mainFill)+"; stroke-width: 0.65px; stroke-dasharray: 2 2")),typeof t.standardCompletedBarStyle>"u"&&t.accentFill&&(t.standardCompletedBarStyle="stroke: "+t.accentFill+"; fill: "+t.accentFill),typeof t.summaryBarStyle>"u"&&t.summaryFill&&(t.summaryBarStyle="stroke: "+(t.summaryStroke?t.summaryStroke:t.summaryFill)+"; fill: "+t.summaryFill),typeof t.milestoneBarStyle>"u"&&t.diamondFill&&(t.milestoneBarStyle="stroke: "+(t.diamondStroke?t.diamondStroke:t.diamondFill)+"; fill: "+t.diamondFill),t.mainStroke&&(typeof t.arrowFill>"u"&&(t.baselineBarStyle="fill: none; stroke: "+t.mainStroke+"; stroke-width: 0.65px; stroke-dasharray: 2, 2"),t.arrowFill||(t.arrowFill=t.mainStroke),typeof t.dependencyLineStyle>"u"&&(t.dependencyLineStyle="stroke: "+t.arrowFill+"; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)")),typeof t.assignmentsStyle>"u"&&t.chartForeground&&(t.assignmentsStyle="font-size: x-small; fill: "+t.chartForeground),t.alternativeBackground&&(typeof t.alternativeGridBackground>"u"&&(t.alternativeGridBackground=t.alternativeBackground),typeof t.alternativeChartBackground>"u"&&(t.alternativeChartBackground=t.alternativeBackground)),typeof t.alternativeItemStyle>"u"&&t.alternativeGridBackground&&(t.alternativeItemStyle="background-color: "+t.alternativeGridBackground),typeof t.alternativeChartItemStyle>"u"&&t.alternativeChartBackground&&(t.alternativeChartItemStyle="fill: "+t.alternativeChartBackground)}}function initializeLoadChartTheme(t,pe){initializeGanttChartTheme(t,pe),"Default"!=pe&&(typeof t.barHeight>"u"&&(t.barHeight=20),typeof t.allocationFill>"u"&&(t.allocationFill=t.mainFill?"white"!=t.mainFill?t.mainFill:t.mainStroke:"#8abbed"),typeof t.normalAllocationBarStyle>"u"&&(t.normalAllocationBarStyle=t.underAllocationBarStyle="stroke: "+t.allocationFill+"; fill: "+t.allocationFill),typeof t.overAllocationBarStyle>"u"&&(t.overAllocationBarStyle="stroke: #e31d3b; fill: #e31d3b"))}function initializePertChartTheme(t,pe){if("Default"!=pe){typeof t.shapeStyle>"u"&&(t.shapeStyle="fill: White; stroke: #606060; stroke-width: 1px"),typeof t.milestoneStyle>"u"&&(t.milestoneStyle="fill: White; stroke: #606060; stroke-width: 1px"),typeof t.dependencyLineStyle>"u"&&(t.dependencyLineStyle="stroke: #8abbed; stroke-width: 0.65px; fill: none; marker-end: url(#PertArrowMarker)"),typeof t.arrowFill>"u"&&(t.arrowFill="#8abbed"),typeof t.virtualEffortDependencyLineStyle>"u"&&(t.virtualEffortDependencyLineStyle="stroke: #8abbed; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#PertArrowMarker)");var Ee="http://www.w3.org/2000/svg";typeof t.styleDefinitionTemplate>"u"&&(t.styleDefinitionTemplate=function(){var Be=document.createElementNS(Ee,"defs"),We=document.createElementNS(Ee,"marker");We.setAttribute("id","PertArrowMarker"),We.setAttribute("viewBox","0 0 10 10"),We.setAttribute("refX","0"),We.setAttribute("refY","5"),We.setAttribute("markerUnits","strokeWidth"),We.setAttribute("markerWidth","5"),We.setAttribute("markerHeight","4"),We.setAttribute("orient","auto");var Ke=document.createElementNS(Ee,"path");return Ke.setAttribute("fill",t.arrowFill?t.arrowFill:"#3b87d9"),Ke.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),We.appendChild(Ke),Be.appendChild(We),Be})}}!function(t){var pe,Ee,Be,We,Ke,oe,we,me,ae,fe,xe,Se,he,ge;pe=t.Controls||(t.Controls={}),function(ae){ae.initialize=function(H,a,D){return new fe(H,a,D)},ae.get=function(H){return H.component};var fe=function(){function H(a,D,m){this.host=a,this.settings=D,this.isInitialized=!1;var c="DlhSoft.Controls ContentControl DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[c[5]][c[4]](a,c[0],c[1],c[2],c[3],m,D),this.host.component=this,typeof D>"u"&&(D={}),this.settings=D,H.initializeSettings(this.settings),(typeof(D=this.settings.content)>"u"||null==D)&&(D=H.getContent(a)),this.content=D,this.settings.content=D,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.containerStyle>"u"&&(a.containerStyle="font-family: Arial; font-size: "+("Modern"==a.theme?"12px":"small")),typeof a.contentTemplate>"u"&&(a.contentTemplate=function(D,m){if((typeof m>"u"||null==m)&&(m=""),m instanceof HTMLElement)return m;var c=D.createElement("span");return c.innerHTML=m.toString(),c})},H.getContent=function(a){var c,D=a.ownerDocument.createElement("span"),m=[];for(c=0;c<a.childNodes.length;c++)m.push(a.childNodes[c]);for(c=a.childNodes.length;0<c--;)a.removeChild(a.childNodes[c]);for(c=0;c<m.length;c++)D.appendChild(m[c]);return D},H.prototype.refresh=function(){for(var a=this.host.ownerDocument,D=this.host.childNodes.length;0<D--;)this.host.removeChild(this.host.childNodes[D]);this.contentContainer=this.settings.contentTemplate(a,this.content),null!=this.settings.containerStyle&&this.contentContainer.setAttribute("style",this.settings.containerStyle),typeof this.settings.containerClass<"u"&&this.contentContainer.setAttribute("class",this.settings.containerClass),this.host.appendChild(this.contentContainer)},H.prototype.setContent=function(a){this.content=a,this.settings.content=a,this.refresh()},H}();ae.Element=fe}(Ee=pe.ContentControl||(pe.ContentControl={})),function(ae){ae.initialize=function(H,a,D,m){return new fe(H,a,D,m)},ae.get=function(H){return H.component};var fe=function(){function H(a,D,m,c){this.host=a,this.settings=m,this.isInitialized=!1;var g="DlhSoft.Controls ItemsControl DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[g[5]][g[4]](a,g[0],g[1],g[2],g[3],c,m),this.host.component=this,typeof m>"u"&&(m={}),this.settings=m,H.initializeSettings(this.settings),(typeof D>"u"||null==D)&&(D=this.settings.items),(typeof D>"u"||null==D)&&(D=H.getItems(a)),this.items=D,this.settings.items=D,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.itemContainerStyle>"u"&&(a.itemContainerStyle="font-family: Arial; font-size: "+("Modern"==a.theme?"12px":"small")),typeof a.itemTemplate>"u"&&(a.itemTemplate=function(D,m){if((typeof m>"u"||null==m)&&(m=""),m instanceof HTMLElement)return m;var c=D.createElement("span");return c.innerHTML=m.toString(),c})},H.getItems=function(a){var m,D=[];for(m=0;m<a.childNodes.length;m++)a.childNodes[m]instanceof HTMLElement&&D.push(a.childNodes[m]);for(m=a.childNodes.length;0<m--;)a.removeChild(a.childNodes[m]);return D},H.prototype.refresh=function(){for(var a=this.host.ownerDocument,D=this.host.childNodes.length;0<D--;)this.host.removeChild(this.host.childNodes[D]);for(this.itemContainers=[],D=0;D<this.items.length;D++){var m=this.settings.itemTemplate(a,this.items[D]);null!=this.settings.itemContainerStyle&&m.setAttribute("style",this.settings.itemContainerStyle),typeof this.settings.itemContainerClass<"u"&&m.setAttribute("class",this.settings.itemContainerClass),this.host.appendChild(m)}},H.prototype.setItems=function(a){this.items=a,this.settings.items=a,this.refresh()},H}();ae.Element=fe}(pe.ItemsControl||(pe.ItemsControl={})),function(ae){ae.initialize=function(H,a,D,m){return new fe(H,a,D,m)},ae.get=function(H){return H.component};var fe=function(){function H(a,D,m,c){this.host=a,this.clickHandler=D,this.settings=m,this.isInitialized=!1,D="DlhSoft.Controls Button DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" "),t[D[5]][D[4]](a,D[0],D[1],D[2],D[3],c,m),this.host.component=this,typeof m>"u"&&(m={}),this.settings=m,H.initializeSettings(this.settings);var g=this.host.ownerDocument;(this.inputHost=a instanceof HTMLInputElement?a:null)&&(g=g.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(g,this.inputHost),this.host=g,t[D[5]][D[4]](g,D[0],D[1],D[2],D[3],c,m),this.host.component=this),(m=this.host.getAttribute("style"))&&(this.settings.containerStyle=m+";"+this.settings.containerStyle,this.host.setAttribute("style","")),(m=this.host.getAttribute("class"))&&!this.settings.containerClass&&(this.settings.containerClass=m,this.host.setAttribute("class","")),(typeof(m=this.settings.content)>"u"||null==m)&&(m=Ee.Element.getContent(a)),this.content=m,this.settings.content=m,this.isEnabled=this.settings.isEnabled,this.isInitialRefresh=!0,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){Ee.Element.initializeSettings(a),a.containerStyle+=("Modern"==a.theme?"; color: #505050":"")+"; display: inline-block; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; background-color: #f0f0f0; border: 1px solid #e0e0e0; "+("Modern"==a.theme?"":"; border-radius: 3px"),typeof a.inputType>"u"&&(a.inputType="button"),typeof a.isEnabled>"u"&&(a.isEnabled=!0),typeof a.disabledStyle>"u"&&(a.disabledStyle="opacity: 0.5"),typeof a.hoveringStyle>"u"&&(a.hoveringStyle="background-color: "+("Modern"==a.theme?"#e8e8ff":"#e8e8e8")),typeof a.pressedStyle>"u"&&(a.pressedStyle="background-color: "+("Modern"==a.theme?"#d0d0ff":"#e8e8e8")),typeof a.contentStyle>"u"&&(a.contentStyle="padding: 4px 8px 4px 8px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default")},H.prototype.refresh=function(){var a=this;if(!(this.isInitialRefresh&&(delete this.isInitialRefresh,this instanceof We.Element))){for(var D=this.host.ownerDocument,m=this.host.childNodes.length;0<m--;)this.host.removeChild(this.host.childNodes[m]);this.inputHost?(this.inputElement=this.inputHost,this.inputElement.value&&(this.content=this.inputElement.value)):this.inputElement=D.createElement("input"),this.settings.inputName&&this.inputElement.setAttribute("name",this.settings.inputName),this.inputElement.value||(this.inputElement.value=this.inputElement.name),this.inputElement.setAttribute("type","toggleButton"!=this.settings.inputType?this.settings.inputType:"checkbox"),this.inputElement.style.display="none",this.host.appendChild(this.inputElement),this.contentControlHost=D.createElement("div"),this.contentControlHost.setAttribute("style",this.settings.containerStyle),typeof this.settings.containerClass<"u"&&this.contentControlHost.setAttribute("class",this.settings.containerClass),this.host.appendChild(this.contentControlHost),this.contentControl=new Ee.Element(this.contentControlHost,{theme:this.settings.theme,containerStyle:null,content:this.content,contentTemplate:function(c,g){(typeof g>"u"||null==g)&&(g="");var S=c.createElement("div");a.contentContainer=S,S.setAttribute("style",a.settings.contentStyle),typeof a.settings.contentClass<"u"&&S.setAttribute("class",a.settings.contentClass),S.appendChild(a.settings.contentTemplate(c,g));var A=c.createElement("div");a.hoverableContainer=A,a.isEnabled||(a.hoverableContainer.setAttribute("style",a.settings.disabledStyle),typeof a.settings.disabledClass<"u"&&a.hoverableContainer.setAttribute("class",a.settings.disabledClass));var F=c.createElement("div");return a.pressableContainer=F,F.appendChild(S),A.appendChild(F),A.onmouseenter=function(){a.isEnabled&&a.hoverableContainer==A&&(A.setAttribute("style",a.settings.hoveringStyle),typeof a.settings.hoveringClass<"u"&&A.setAttribute("class",a.settings.hoveringClass),"toggleButton"!=a.settings.inputType&&a.isPressed&&(F.setAttribute("style",a.settings.pressedStyle),typeof a.settings.pressedClass<"u"&&F.setAttribute("class",a.settings.pressedClass)),a.isHovering=!0,a.settings.hoveringHandler&&a.settings.hoveringHandler(a))},A.onmouseleave=function(){a.isEnabled&&a.hoverableContainer==A&&(a.isHovering=!1,A.setAttribute("style",""),A.setAttribute("class",""),"toggleButton"!=a.settings.inputType&&(F.setAttribute("style",""),F.setAttribute("class","")),a.settings.unhoveringHandler&&a.settings.unhoveringHandler(a))},"toggleButton"!=a.settings.inputType?(F.onmousedown=function(){a.isEnabled&&a.pressableContainer==F&&(F.setAttribute("style",a.settings.pressedStyle),typeof a.settings.pressedClass<"u"&&F.setAttribute("class",a.settings.pressedClass),a.isPressed=!0,a.settings.pressedHandler&&a.settings.pressedHandler(a))},c.addEventListener("mouseup",function(){a.isEnabled&&a.pressableContainer==F&&(a.isPressed=!1,F.setAttribute("style",""),F.setAttribute("class",""),a.settings.unpressedHandler&&a.settings.unpressedHandler(a))},!1),F.onmouseup=function(){if(a.isEnabled&&a.pressableContainer==F){a.clickHandler&&a.clickHandler();try{var z=a.inputElement.ownerDocument.createEvent("HTMLEvents");z.initEvent("click",!0,!0),a.inputElement.dispatchEvent(z)}catch{}}}):F.onmousedown=function(){if(a.isEnabled&&a.pressableContainer==F)if(a.isPressed){a.isPressed=!1,F.setAttribute("style",""),F.setAttribute("class",""),a.settings.unpressedHandler&&a.settings.unpressedHandler(a),a.clickHandler&&a.clickHandler();try{(z=a.inputElement.ownerDocument.createEvent("HTMLEvents")).initEvent("click",!0,!0),a.inputElement.dispatchEvent(z),(P=a.inputElement.ownerDocument.createEvent("HTMLEvents")).initEvent("change",!0,!0),a.inputElement.dispatchEvent(P)}catch{}}else{F.setAttribute("style",a.settings.pressedStyle),typeof a.settings.pressedClass<"u"&&F.setAttribute("class",a.settings.pressedClass),a.isPressed=!0,a.settings.pressedHandler&&a.settings.pressedHandler(a),a.clickHandler&&a.clickHandler();try{var z=a.inputElement.ownerDocument.createEvent("HTMLEvents");z.initEvent("click",!0,!0),a.inputElement.dispatchEvent(z);var P=a.inputElement.ownerDocument.createEvent("HTMLEvents");P.initEvent("change",!0,!0),a.inputElement.dispatchEvent(P)}catch{}}},A}},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}},H.prototype.setContent=function(a){this.content=a,this.settings.content=a,this.refresh()},H.prototype.enable=function(){this.isEnabled=!0,this.settings.isEnabled=!0,this.refresh()},H.prototype.disable=function(){this.isEnabled=!1,this.settings.isEnabled=!1,this.refresh()},H}();ae.Element=fe}(Be=pe.Button||(pe.Button={})),function(ae){ae.initialize=function(H,a,D,m){return new fe(H,a,D,m)},ae.get=function(H){return H.component};var fe=function(H){function a(D,m,c,g){var S=this;H.call(this,D,void 0,c,g),this.toggleHandler=m,this.isInitialized=!1,this.settings.inputType="toggleButton",this.clickHandler=function(){S.toggleHandler&&S.toggleHandler(S.isPressed)},this.refresh(),this.isInitialized=!0}return __extends(a,H),a}(Be.Element);ae.Element=fe}(We=pe.ToggleButton||(pe.ToggleButton={})),function(ae){ae.initialize=function(H,a,D){return new fe(H,a,D)},ae.get=function(H){return H.component};var fe=function(){function H(a,D,m){this.host=a,this.settings=D,this.isInitialized=!1;var c="DlhSoft.Controls TextBox DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[c[5]][c[4]](a,c[0],c[1],c[2],c[3],m,D),this.host.component=this,typeof D>"u"&&(D={}),this.settings=D,H.initializeSettings(this.settings);var g=this.host.ownerDocument;(this.inputHost=a instanceof HTMLInputElement?a:null)&&(a=g.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(a,this.inputHost),this.host=a,t[c[5]][c[4]](a,c[0],c[1],c[2],c[3],m,D),this.host.component=this),(typeof(D=D.value)>"u"||null==D)&&(D=this.inputHost?this.inputHost.value:this.host.innerText?this.host.innerText:this.host.innerHTML),this.value=D,this.settings.value=D,this.isEnabled=this.settings.isEnabled,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isEnabled>"u"&&(a.isEnabled=!0),typeof a.isReadOnly>"u"&&(a.isReadOnly=!1),typeof a.inputStyle>"u"&&"Modern"==a.theme&&(a.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,m=this.host.childNodes.length;0<m--;)this.host.removeChild(this.host.childNodes[m]);this.inputElement=this.inputHost?this.inputHost:D.createElement("input"),this.settings.inputName&&this.inputElement.setAttribute("name",this.settings.inputName),this.inputElement.setAttribute("type","text"),typeof this.settings.inputStyle<"u"&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass),this.inputElement.value=this.value,this.settings.isReadOnly?this.inputElement.setAttribute("readonly","readonly"):this.inputElement.removeAttribute("readonly"),this.settings.isEnabled?this.inputElement.removeAttribute("disabled"):this.inputElement.setAttribute("disabled","disabled"),this.host.appendChild(this.inputElement),this.inputElement.onchange=function(){a.isEnabled&&(a.value=a.inputElement.value,a.settings.changeHandler&&a.settings.changeHandler(a.value))},this.inputElement.onclick=function(){a.settings.clickHandler&&a.settings.clickHandler()}},H.prototype.getValue=function(){return this.value},H.prototype.setValue=function(a){this.value=a,this.settings.value=a,this.refresh()},H.prototype.enable=function(){this.isEnabled=!0,this.settings.isEnabled=!0,this.refresh()},H.prototype.disable=function(){this.isEnabled=!1,this.settings.isEnabled=!1,this.refresh()},H}();ae.Element=fe}(pe.TextBox||(pe.TextBox={})),function(ae){ae.initialize=function(H,a,D,m){return new fe(H,a,D,m)},ae.get=function(H){return H.component};var fe=function(){function H(a,D,m,c){this.host=a,this.selectedTime=D,this.settings=m,this.isInitialized=!1;var g="DlhSoft.Controls CalendarSelector DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[g[5]][g[4]](a,g[0],g[1],g[2],g[3],c,m),this.host.component=this,typeof m>"u"&&(m={}),this.settings=m,H.initializeSettings(this.settings),typeof D>"u"&&(D=m.minValue),D<m.minValue&&(D=m.minValue),this.selectedTime=D,null==this.settings.displayedTime&&(a=this.settings.rows*this.settings.columns,this.settings.displayedTime=Math.floor(this.selectedTime/a)*a),this.settings.displayedTime<m.minValue&&(this.settings.displayedTime=m.minValue),this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.rows>"u"?a.rows=4:0>=a.rows&&(a.rows=1),typeof a.columns>"u"?a.columns=3:0>=a.columns&&(a.columns=1),typeof a.headerProvider>"u"&&(a.headerProvider=function(D,m){return D.createTextNode(null!=m?m.toString()+" - "+(m+a.rows*a.columns-1).toString():"?")}),typeof a.headerStyle>"u"&&(a.headerStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; background-color: #f0f0f0; padding: 8px; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.timeStyle>"u"&&(a.timeStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; min-width: "+Math.max(128/a.columns,64)+"px; height: "+Math.max(80/a.rows,20)+"px; padding: 2px; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; font-size: "+("Modern"==a.theme?"12px":"small")),typeof a.selectedTimeStyle>"u"&&(a.selectedTimeStyle="background-color: #3399ff; color: White; padding: 2px"),typeof a.timeFormatter>"u"&&(a.timeFormatter=function(D){return D.toString()}),typeof a.invertMatrix>"u"&&(a.invertMatrix=!1),typeof a.minValue>"u"&&(a.minValue=0),typeof a.scrollingHeight>"u"&&(a.scrollingHeight="auto")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,m=this.host.childNodes.length;0<m--;)this.host.removeChild(this.host.childNodes[m]);(m=D.createElement("table")).cellSpacing="0",m.cellPadding="0",m.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&m.setAttribute("class",this.settings.containerClass);var c=null!=this.settings.displayedTime?this.settings.displayedTime:0,g=D.createElement("tr");g.setAttribute("style",this.settings.headerStyle),g.setAttribute("class",this.settings.headerClass),(S=D.createElement("td")).setAttribute("style","text-align: left; padding-left: 4px"),(A=D.createElement("a")).setAttribute("href","javascript://"),A.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),A.appendChild(D.createTextNode("\u25c4")),A.onclick=function(Ie){a.setDisplayedValue(c-a.settings.rows*a.settings.columns),Ie.stopPropagation()},S.appendChild(A),g.appendChild(S),(S=D.createElement("td")).setAttribute("style",this.settings.headerStyle),S.setAttribute("class",this.settings.headerClass),(A=D.createElement("span")).appendChild(this.settings.headerProvider(D,this.settings.displayedTime)),S.appendChild(A),g.appendChild(S),(S=D.createElement("td")).setAttribute("style","text-align: right; padding-right: 4px"),(A=D.createElement("a")).setAttribute("href","javascript://"),A.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),A.appendChild(D.createTextNode("\u25ba")),A.onclick=function(Ie){a.setDisplayedValue(c+a.settings.rows*a.settings.columns),Ie.stopPropagation()},S.appendChild(A),g.appendChild(S),m.appendChild(g),S=D.createElement("tr"),m.appendChild(S),(g=D.createElement("td")).colSpan=3,S.appendChild(g),(S=D.createElement("div")).setAttribute("style","padding: 2px; max-height: "+this.settings.scrollingHeight+"; overflow-y: auto"),g.appendChild(S),(g=D.createElement("table")).cellSpacing="0",g.cellPadding="0",S.appendChild(g);for(var S=null!=this.settings.displayedTime?this.settings.displayedTime:0,A=null!=this.selectedTime?this.selectedTime:0,F=this.settings.rows,z=this.settings.columns,P=0;P<F;P++){for(var U=D.createElement("tr"),$=0;$<z;$++){this.settings.invertMatrix&&(S=c+$*F+P);var Me,de=D.createElement("td");de.setAttribute("style",this.settings.timeStyle),de.setAttribute("class",this.settings.timeClass);try{Me=this.settings.timeFormatter(S)}catch{Me=S.toString()}var Fe=D.createElement("div");de.appendChild(Fe);var He=D.createElement("a");He.setAttribute("href","javascript://"),He.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),He.appendChild(D.createTextNode(Me)),Fe.appendChild(He),null!=A&&S==A&&(Fe.setAttribute("style",this.settings.selectedTimeStyle),Fe.setAttribute("class",this.settings.selectedTimeClass),this.selectedElement=Fe),He.value=S,He.onclick=function(ue){a.setValue(ue.currentTarget.value),ue.stopPropagation()},U.appendChild(de),S++}g.appendChild(U)}this.host.appendChild(m)},H.prototype.getValue=function(){return this.selectedTime},H.prototype.setValue=function(a){(!a||a<this.settings.minValue)&&(a=this.settings.minValue),this.selectedTime=a,this.refresh(),this.settings.selectedTimeChangeHandler&&this.settings.selectedTimeChangeHandler(a)},H.prototype.setDisplayedValue=function(a){(!a||a<this.settings.minValue)&&(a=this.settings.minValue),(null==this.settings.displayedTime||a!=this.settings.displayedTime)&&(this.settings.displayedTime=a,this.refresh(),this.settings.displayedTimeChangeHandler&&this.settings.displayedTimeChangeHandler(a))},H}();ae.Element=fe}(Ke=pe.CalendarSelector||(pe.CalendarSelector={})),function(ae){ae.initialize=function(H,a,D,m){return new fe(H,a,D,m)},ae.get=function(H){return H.component};var fe=function(){function H(a,D,m,c){this.host=a,this.selectedDate=D,this.settings=m,this.isInitialized=!1;var g="DlhSoft.Controls Calendar DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[g[5]][g[4]](a,g[0],g[1],g[2],g[3],c,m),this.host.component=this,typeof m>"u"&&(m={}),this.settings=m,H.initializeSettings(this.settings),typeof D>"u"&&(D=new Date),D<this.settings.minValue&&(D=this.settings.minValue),this.selectedDates=(this.selectedDate=D)?[this.selectedDate]:[],this.selectedDateRanges=(this.selectedDateRange=this.selectedDate?{start:this.selectedDate,finish:this.selectedDate}:null)?[this.selectedDateRange]:null,null==this.settings.displayedDate&&(this.settings.displayedDate=this.selectedDate),this.settings.displayedDate<this.settings.minValue&&(this.settings.displayedDate=this.settings.minValue),this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isReadOnly>"u"&&(a.isReadOnly=!1),typeof a.isTodayLinkVisible>"u"&&(a.isTodayLinkVisible=!1),typeof a.defaultTimeOfDay>"u"&&(a.defaultTimeOfDay=0),typeof a.allowMultipleSelection>"u"&&(a.allowMultipleSelection=!1),typeof a.allowRangeSelection>"u"&&(a.allowRangeSelection=!1),typeof a.monthYearHeaderStyle>"u"&&(a.monthYearHeaderStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; background-color: #f0f0f0; padding: 8px; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.dayOfWeekHeaderStyle>"u"&&(a.dayOfWeekHeaderStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; padding: 3px; padding-top: 4px; padding-bottom: 2px; border-bottom: 1px solid "+("Modern"==a.theme?"#e0e0e0":"Silver")+"; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.dayStyle>"u"&&(a.dayStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; min-width: 24px; padding: 2px; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; font-size: "+("Modern"==a.theme?"12px":"small")+(a.allowMultipleSelection||a.allowRangeSelection?"; height: "+("Modern"==a.theme?"18px":"20px"):"")),typeof a.otherMonthDayStyle>"u"&&(a.otherMonthDayStyle="color: "+("Modern"==a.theme?"#c0c0c0":"Silver")),typeof a.selectedDayStyle>"u"&&(a.selectedDayStyle="background-color: #3399ff; color: White; padding: 2px"),typeof a.disabledDayStyle>"u"&&(a.disabledDayStyle="color: "+("Modern"==a.theme?"#c0c0c0":"Silver")),typeof a.todayLinkStyle>"u"&&(a.todayLinkStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; padding: 4px; border-top: 1px solid "+("Modern"==a.theme?"#e0e0e0":"Silver")+"; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.todayString>"u"&&(a.todayString="Today"),typeof a.months>"u"&&(a.months="January February March April May June July August September October November December".split(" ")),typeof a.daysOfWeek>"u"&&(a.daysOfWeek="Su Mo Tu We Th Fr Sa".split(" ")),typeof a.monthRows>"u"&&(a.monthRows=1),1>a.monthRows&&(a.monthRows=1),typeof a.monthColumns>"u"&&(a.monthColumns=1),1>a.monthColumns&&(a.monthColumns=1),typeof a.monthCellSpacing>"u"&&(a.monthCellSpacing="0"),typeof a.applyMonthStyleForSingleCell>"u"&&(a.applyMonthStyleForSingleCell=!1),typeof a.applyNextMonthButtonToLastColumn>"u"&&(a.applyNextMonthButtonToLastColumn=!0),typeof a.applyNextMonthButtonToLastRow>"u"&&(a.applyNextMonthButtonToLastRow=!1),typeof a.containerStyle>"u"&&(a.containerStyle=("Modern"==a.theme?"":"border: 1px solid #707070; ")+"font-family: Arial"+(typeof a.monthCellStyle>"u"&&(1<a.monthRows||1<a.monthColumns||a.applyMonthStyleForSingleCell)?"Modern"==a.theme?"; margin: -2px":"; padding: 2px":"Modern"==a.theme?"; border: 1px solid #e0e0e0":"")),typeof a.monthCellStyle>"u"&&(a.monthCellStyle="margin: 2px; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"Silver")),typeof a.calendarSelectorLevels>"u"&&(a.calendarSelectorLevels=0),typeof a.calendarSelectorPopupStyle>"u"&&(a.calendarSelectorPopupStyle="background-color: White; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"#707070")+"; font-family: Arial"),typeof a.minValue>"u"&&(a.minValue=new Date(101,0,1)),typeof a.weekStart>"u"&&(a.weekStart=0)},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,m=this.host.childNodes.length;0<m--;)this.host.removeChild(this.host.childNodes[m]);var c,g;(m=D.createElement("table")).cellSpacing=this.settings.monthCellSpacing,m.cellPadding="0",m.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&m.setAttribute("class",this.settings.containerClass);var S=H.getDate(null!=this.settings.displayedDate?this.settings.displayedDate:null!=this.selectedDate?this.selectedDate:new Date);this.settings.defaultTimeOfDay>=H.dayDuration&&(S=H.subtractDay(S)),c=S;for(var A=0;A<this.settings.monthRows;A++){var F=D.createElement("tr");m.appendChild(F);for(var z=0;z<this.settings.monthColumns;z++){var P=D.createElement("td");F.appendChild(P);var U=D.createElement("table");U.cellSpacing="0",U.cellPadding="0",(1<this.settings.monthRows||1<this.settings.monthColumns||this.settings.applyMonthStyleForSingleCell)&&(U.setAttribute("style",this.settings.monthCellStyle),U.setAttribute("class",this.settings.monthCellClass)),P.appendChild(U),(P=D.createElement("tr")).setAttribute("style",this.settings.monthYearHeaderStyle),P.setAttribute("class",this.settings.monthYearHeaderClass),(Ie=D.createElement("td")).setAttribute("style","text-align: left; padding-left: 4px"),0==A&&0==z&&(($=D.createElement("a")).setAttribute("href","javascript://"),$.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),$.appendChild(D.createTextNode("\u25c4")),$.onclick=function(Le){for(var et=S;et.getMonth()==S.getMonth();)et=H.subtractDay(et);a.setDisplayedValue(et),Le.stopPropagation()},Ie.appendChild($)),P.appendChild(Ie),(Ie=D.createElement("td")).setAttribute("style",this.settings.monthYearHeaderStyle),Ie.setAttribute("class",this.settings.monthYearHeaderClass),Ie.colSpan=5;var $=D.createElement("span"),He=D.createTextNode(this.settings.months[c.getMonth()]+" "+c.getFullYear());if(1>this.settings.calendarSelectorLevels||0<A||0<z)$.appendChild(He);else{var de=D.createElement("a");de.setAttribute("href","javascript://"),de.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),de.appendChild(He),$.appendChild(de);var Me=D.createElement("div");Me.setAttribute("style","display: none; position: absolute; margin-left: -40px"),de.appendChild(Me);var Fe=D.createElement("div");Fe.setAttribute("style",this.settings.calendarSelectorPopupStyle),this.settings.calendarSelectorPopupClass&&Fe.setAttribute("class",this.settings.calendarSelectorPopupClass),Me.appendChild(Fe),de.onclick=function(it){if((it.target||it.srcElement)==de){if("none"!=Me.style.display)Me.style.display="none";else{var Le=12*S.getFullYear()+S.getMonth(),et={theme:a.settings.theme,headerProvider:function(Qe,st){var x=Qe.createTextNode(Math.floor(st/12).toString());if(2>a.settings.calendarSelectorLevels)return x;var W=Qe.createElement("a");W.setAttribute("href","javascript://"),W.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),W.appendChild(x);var O=Qe.createElement("div");O.setAttribute("style","display: none; position: absolute; margin-left: -10px"),W.appendChild(O);var h=Qe.createElement("div");return h.setAttribute("style",a.settings.calendarSelectorPopupStyle),a.settings.calendarSelectorPopupClass&&h.setAttribute("class",a.settings.calendarSelectorPopupClass),O.appendChild(h),W.onclick=function(w){if((w.target||w.srcElement)==W){if("none"!=O.style.display)O.style.display="none";else{var v=Math.floor(st/12)-1;O.style.display="block";var I=Ke.initialize(h,v,{rows:5,columns:2,invertMatrix:!0,headerProvider:function(b,L){var M=b.createTextNode((L+1).toString()+" - "+(L+10).toString());if(3>a.settings.calendarSelectorLevels)return M;var Y=b.createElement("a");Y.setAttribute("href","javascript://"),Y.setAttribute("style","text-decoration: none; display: inline-block; cursor: pointer; color: inherit"),Y.appendChild(M);var J=b.createElement("div");J.setAttribute("style","display: none; position: absolute; margin-left: -10px"),Y.appendChild(J);var K=b.createElement("div");return K.setAttribute("style",a.settings.calendarSelectorPopupStyle),a.settings.calendarSelectorPopupClass&&K.setAttribute("class",a.settings.calendarSelectorPopupClass),J.appendChild(K),Y.onclick=function(q){if((q.target||q.srcElement)==Y){if("none"!=J.style.display)J.style.display="none";else{var te=Math.floor(L/10);J.style.display="block",Ke.initialize(K,te,{rows:5,columns:2,invertMatrix:!0,headerProvider:function(G,Q){return G.createTextNode((10*Q+1).toString()+" - "+(10*(Q+10)).toString())},timeFormatter:function(G){return(10*G+1).toString()+"-"+(10*G+10).toString().substr((10*G+10).toString().length-2)},minValue:10},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.").settings.selectedTimeChangeHandler=function(G){I.setDisplayedValue(10*G)}}q.stopPropagation()}},Y},timeFormatter:function(b){return(b+1).toString()},minValue:100},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");I.settings.selectedTimeChangeHandler=function(b){ft.setDisplayedValue(12*(b+1))}}w.stopPropagation()}},W},timeFormatter:function(Qe){return a.settings.months[Qe-12*Math.floor(Qe/12)]},minValue:1212};Me.style.display="block";var ft=Ke.initialize(Fe,Le,et,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");ft.settings.selectedTimeChangeHandler=function(Qe){a.setDisplayedValue(new Date(Math.floor(Qe/12),Qe-12*Math.floor(Qe/12),1))}}it.stopPropagation()}}}for(Ie.appendChild($),P.appendChild(Ie),(Ie=D.createElement("td")).setAttribute("style","text-align: right; padding-right: 4px"),(this.settings.applyNextMonthButtonToLastRow?A==this.settings.monthRows-1:0==A)&&(this.settings.applyNextMonthButtonToLastColumn?z==this.settings.monthColumns-1:0==z)&&(($=D.createElement("a")).setAttribute("href","javascript://"),$.setAttribute("style","text-decoration: none; color: Gray; font-size: "+("Modern"==this.settings.theme?"10px":"x-small")+"; cursor: pointer"),$.appendChild(D.createTextNode("\u25ba")),$.onclick=function(it){for(var Le=S;Le.getMonth()==S.getMonth();)Le=H.addDay(Le);a.setDisplayedValue(Le),it.stopPropagation()},Ie.appendChild($)),P.appendChild(Ie),U.appendChild(P),$=D.createElement("tr"),Ie=P=this.settings.weekStart;Ie<P+7;Ie++)g=Ie%7,(He=D.createElement("td")).setAttribute("style",this.settings.dayOfWeekHeaderStyle),He.setAttribute("class",this.settings.dayOfWeekHeaderClass),He.appendChild(D.createTextNode(this.settings.daysOfWeek[g%7])),$.appendChild(He);U.appendChild($),null!=($=null!=this.selectedDate?H.getDate(this.selectedDate):null)&&this.settings.defaultTimeOfDay>=H.dayDuration&&($=H.subtractDay($)),He=c.getMonth();var Ie=H.getFirstDayOfMonth(c),be=H.getPreviousWeekStart(Ie,P);for(c=0;6>c;c++){var ue=D.createElement("tr");for(Ie=P;Ie<P+7;Ie++){g=Ie%7,(g=D.createElement("td")).setAttribute("style",this.settings.dayStyle),g.setAttribute("class",this.settings.dayClass);var ke=be.getDate().toString(),De=D.createElement("span");g.appendChild(De);var Te=D.createElement("span");De.appendChild(Te);var tt=typeof this.settings.disabledDateSelector<"u"&&this.settings.disabledDateSelector(be),Ye=be.getMonth()==He,Oe=D.createElement("a");Oe.setAttribute("href","javascript://"),Oe.setAttribute("style","text-decoration: none; display: inline-block; cursor: "+(this.settings.isReadOnly||tt||!Ye&&(this.settings.allowRangeSelection||this.settings.allowMultipleSelection)?"default":"pointer")+"; color: inherit; width: 20px"),Oe.appendChild(D.createTextNode(ke)),Te.appendChild(Oe),tt?(De.setAttribute("style",this.settings.disabledDayStyle),De.setAttribute("class",this.settings.disabledDayClass)):Ye?((ke=$&&Math.abs(be.valueOf()-$.valueOf())<=H.hourDuration||this.isValueSelected(be))&&(De.setAttribute("style",this.settings.selectedDayStyle),De.setAttribute("class",this.settings.selectedDayClass)),this.settings.highlightingStyleSelector&&(De=this.settings.highlightingStyleSelector(be,ke))&&Te.setAttribute("style",De),this.settings.highlightingClassSelector&&(De=this.settings.highlightingClassSelector(be,ke))&&Te.setAttribute("class",De)):(Te.setAttribute("style",this.settings.otherMonthDayStyle),Te.setAttribute("class",this.settings.otherMonthDayClass)),!this.settings.isReadOnly&&!tt&&(Oe.value=H.addTimeOfDay(be,this.settings.defaultTimeOfDay),this.settings.allowMultipleSelection||this.settings.allowRangeSelection?this.settings.allowRangeSelection?Ye&&(Oe.onmousedown=function(Le){var et=Le.currentTarget.value;a.draggingFromDate=et,a.setValue(et),Le.preventDefault()},Oe.onmouseover=function(Le){a.draggingFromDate&&(Le=Le.currentTarget.value,!a.draggingToDate||Le.valueOf()!=a.draggingToDate.valueOf())&&(a.draggingToDate=Le,a.setValueRange({start:a.draggingFromDate,finish:a.draggingToDate}))}):Ye&&(Oe.onclick=function(Le){a.invertValueSelection(Le.currentTarget.value),Le.stopPropagation()}):Oe.onclick=function(Le){var et=Le.currentTarget.value;a.setDisplayedValue(et),a.setValue(et),Le.stopPropagation()}),ue.appendChild(g),be=H.addDay(be)}U.appendChild(ue)}c=be}}!this.settings.isReadOnly&&this.settings.isTodayLinkVisible&&(A=D.createElement("tr"),(F=D.createElement("td")).colSpan=7,F.setAttribute("style",this.settings.todayLinkStyle),F.setAttribute("class",this.settings.todayLinkClass),(z=D.createElement("a")).setAttribute("href","javascript://"),z.setAttribute("style","text-decoration: none; color: inherit; cursor: pointer"),z.appendChild(D.createTextNode(this.settings.todayString)),F.appendChild(z),z.value=H.addTimeOfDay(H.getDate(new Date),this.settings.defaultTimeOfDay),z.onclick=function(it){var Le=it.currentTarget.value;a.setDisplayedValue(Le),a.setValue(Le),it.stopPropagation()},A.appendChild(F),m.appendChild(A)),this.host.appendChild(m),this.isInitialized||D.addEventListener("mouseup",function(){a.draggingToDate&&delete a.draggingToDate,a.draggingFromDate&&delete a.draggingFromDate},!0)},H.prototype.getValue=function(){return this.selectedDate},H.prototype.setValue=function(a){null!=a&&a<this.settings.minValue&&(a=this.settings.minValue),(null==this.selectedDate&&null!=a||null!=this.selectedDate&&null==a||null!=this.selectedDate&&null!=a&&a.valueOf()!=this.selectedDate.valueOf()||this.settings.forceSetOnClick)&&(this.isDuringInternalSetValue=!0,this.selectedDate=a,this.setValues(null!=a?[a]:[]),delete this.isDuringInternalSetValue,null==this.settings.displayedDate&&null!=a?(this.settings.displayedDate=a,this.refresh(),this.settings.displayedDateChangeHandler&&this.settings.displayedDateChangeHandler(a)):this.refresh(),this.settings.selectedDateChangeHandler&&this.settings.selectedDateChangeHandler(a))},H.prototype.setDisplayedValue=function(a){null!=a&&a<this.settings.minValue&&(a=this.settings.minValue),(null==this.settings.displayedDate||a.valueOf()!=this.settings.displayedDate.valueOf())&&(this.settings.displayedDate=a,this.refresh(),this.settings.displayedDateChangeHandler&&this.settings.displayedDateChangeHandler(a))},H.prototype.getValues=function(){return this.selectedDates},H.prototype.setValues=function(a){this.selectedDates=a,0<a.length&&(this.isDuringInternalSetValues=!0,this.selectedDate=a[0],this.setValueRanges([{start:this.selectedDate,finish:this.selectedDate}]),delete this.isDuringInternalSetValues)},H.prototype.getValueRange=function(){return this.selectedDateRange},H.prototype.setValueRange=function(a){if(a.finish||(a.finish=a.start),a.finish<a.start){var D=a.finish;a.finish=a.start,a.start=D}this.setValueRanges([a])},H.prototype.getValueRanges=function(){return this.selectedDateRanges},H.prototype.setValueRanges=function(a){if(this.selectedDateRanges=a,0<a.length&&(this.selectedDateRange=a[0],!this.isDuringInternalSetValues)){this.selectedDates=[];for(var D=0;D<a.length;D++){var m=a[D];if(m.finish||(m.finish=m.start),m.finish<m.start){var c=m.finish;m.finish=m.start,m.start=c}for(c=m.start;c<=m.finish;c=H.addDay(c))this.selectedDates.push(c)}this.selectedDate=this.selectedDateRange.start}this.isDuringInternalSetValue||(this.refresh(),this.settings.selectedDateChangeHandler&&this.settings.selectedDateChangeHandler(this.selectedDate)),this.settings.selectionChangedHandler&&this.settings.selectionChangedHandler()},H.prototype.isValueSelected=function(a){a=a.valueOf();for(var D=0;D<this.selectedDates.length;D++)if(this.selectedDates[D].valueOf()==a)return!0;return!1},H.prototype.invertValueSelection=function(a){for(var D=a.valueOf(),m=0;m<this.selectedDates.length;m++)if(this.selectedDates[m].valueOf()==D)return void(1<this.selectedDates.length&&(this.selectedDates.splice(m,1),this.setValues(this.selectedDates)));this.selectedDates.push(a),this.setValues(this.selectedDates)},H.getDate=function(a){var D=a.getTimezoneOffset()*H.minuteDuration;return new Date(Math.floor((a.valueOf()-D)/H.dayDuration)*H.dayDuration+D)},H.getPreviousWeekStart=function(a,D){for(var m=H.getDate(a),c=m;m.getDay()!=D;)m=H.subtractDay(m);if(c.valueOf()-m.valueOf()>6.5*H.dayDuration)for(c=0;7>c;c++)m=H.addDay(m);return m},H.addDay=function(D){var m=D.getTimezoneOffset()*H.minuteDuration;return m=(D=new Date(D.valueOf()-m+H.dayDuration)).getTimezoneOffset()*H.minuteDuration,new Date(D.valueOf()+m)},H.subtractDay=function(a){return H.getDate(new Date(a.valueOf()-H.dayDuration))},H.addTimeOfDay=function(m,D){var c=m.getTimezoneOffset()*H.minuteDuration;return c=(m=new Date(m.valueOf()-c+D)).getTimezoneOffset()*H.minuteDuration,new Date(m.valueOf()+c)},H.getFirstDayOfMonth=function(a){for(a=H.getDate(a);1<a.getDate();)a=H.subtractDay(a);return a},H.weekDuration=7*(H.dayDuration=24*(H.hourDuration=60*(H.minuteDuration=60*(H.secondDuration=1e3)))),H.initialSundayDateTimeValue=3*H.dayDuration,H}();ae.Element=fe}(oe=pe.Calendar||(pe.Calendar={})),function(ae){ae.initialize=function(H,a,D,m){return new fe(H,a,D,m)},ae.get=function(H){return H.component};var fe=function(){function H(a,D,m,c){this.host=a,this.value=D,this.settings=m,this.isInitialized=!1,this.dropDownButtonElement=null;var g="DlhSoft.Controls DatePicker DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[g[5]][g[4]](a,g[0],g[1],g[2],g[3],c,m),this.host.component=this,typeof m>"u"&&(m={}),this.settings=m,H.initializeSettings(this.settings);var S=this.host.ownerDocument;if(this.inputHost=a instanceof HTMLInputElement?a:null){if(null==D)try{D=this.settings.dateTimeParser(this.inputHost.value)}catch{}a=S.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(a,this.inputHost),this.host=a,t[g[5]][g[4]](a,g[0],g[1],g[2],g[3],c,m),this.host.component=this}typeof D>"u"&&(D=m.isNullValueAccepted?null:new Date),this.value=D,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.isTodayLinkVisible>"u"&&(a.isTodayLinkVisible=!0),typeof a.calendarSelectorLevels>"u"&&(a.calendarSelectorLevels=1/0),typeof a.popupStyle>"u"&&(a.popupStyle="background-color: White; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"#707070")+"; font-family: Arial"),typeof a.calendarSelectorPopupStyle>"u"&&(a.calendarSelectorPopupStyle=a.popupStyle),typeof a.calendarSelectorPopupClass>"u"&&(a.calendarSelectorPopupClass=a.popupClass),oe.Element.initializeSettings(a),typeof a.openDropDownOnInputClick>"u"&&(a.openDropDownOnInputClick=!0),typeof a.dateTimeFormatter>"u"&&(a.dateTimeFormatter=function(F){if(null==F&&a.isNullValueAccepted)return"";var m=function(z,P){void 0===P&&(P=2);for(var U=z.toString();U.length<P;)U="0"+U;return U},c=F.getFullYear(),g=F.getMonth()+1,S=F.getDate(),A=F.getHours();return F=F.getMinutes(),m(g)+"/"+m(S)+"/"+m(c,4)+" "+m(A)+":"+m(F)}),typeof a.dateTimeParser>"u"&&(a.dateTimeParser=function(D){return typeof D>"u"||null==D||0==D.length?a.isNullValueAccepted?null:new Date:(D=new Date(D),isNaN(D.valueOf())||D.getFullYear()<=0?new Date:D)}),typeof a.isNullValueAccepted>"u"&&(a.isNullValueAccepted=!0),typeof a.isDropDownButtonVisible>"u"&&(a.isDropDownButtonVisible=!1),typeof a.dropDownButtonDefinition>"u"&&(a.dropDownButtonDefinition="<svg style='display: inline-block; margin-left: 4px; cursor: pointer; vertical-align: middle' width='12' height='12'><rect x='0' y='0' width='12' height='3' style='fill: #707070; stroke: #707070; stroke-width: 0.65'/><rect x='0' y='3' width='12' height='9' style='fill: none; stroke: #707070; stroke-width: 0.65'/><line x1='3' y1='3' x2='3' y2='12' style='stroke: #707070; stroke-width: 0.65'/><line x1='6' y1='3' x2='6' y2='12' style='stroke: #707070; stroke-width: 0.65'/><line x1='9' y1='3' x2='9' y2='12' style='stroke: #707070; stroke-width: 0.65'/><line x1='0' y1='6' x2='12' y2='6' style='stroke: #707070; stroke-width: 0.65'/><line x1='0' y1='9' x2='12' y2='9' style='stroke: #707070; stroke-width: 0.65'/></svg>"),typeof a.inputStyle>"u"&&"Modern"==a.theme&&(a.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,m=this.host.childNodes.length;0<m--;)this.host.removeChild(this.host.childNodes[m]);if((m=D.createElement("div")).setAttribute("style","margin-top: -1px"),this.inputHost)(c=D.createElement("span")).setAttribute("style","display: inline-block"),c.appendChild(m),this.host.appendChild(c),this.popupElement=(m=this.host.firstChild).firstChild,this.inputHost.parentElement&&this.inputHost.parentElement.removeChild(this.inputHost),this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.inputHost,this.popupElement),this.inputElement=this.inputHost;else{var c=D.createElement("span");c.setAttribute("style","display: inline-block");var g=D.createElement("input");c.appendChild(g),c.appendChild(m),this.host.appendChild(c),this.inputElement=(m=this.host.firstChild).firstChild,this.popupElement=m.childNodes[1]}this.popupElement&&((m=D.createElement("div")).setAttribute("style",this.settings.popupStyle),this.settings.popupClass&&m.setAttribute("class",this.settings.popupClass),this.popupElement.appendChild(m)),this.inputElement&&(typeof this.settings.inputStyle<"u"&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass)),this.settings.isDropDownButtonVisible&&(this.dropDownButtonElement=D.createElement("span"),this.dropDownButtonElement.setAttribute("style","display: inline-block"),this.dropDownButtonElement.innerHTML=this.settings.dropDownButtonDefinition,this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.dropDownButtonElement,this.popupElement)),this.inputElement&&(this.inputElement.DatePicker=this,this.setValue(this.value),this.settings.isReadOnly&&this.inputElement.setAttribute("readonly","readonly")),this.popupElement&&(m=this.popupElement.firstChild,this.calendarHost=D.createElement("div"),m.appendChild(this.calendarHost)),this.calendarHost&&(this.calendar=new oe.Element(this.calendarHost,this.value,{theme:this.settings.theme,isReadOnly:this.settings.isReadOnly,displayedDate:this.settings.displayedDate,defaultTimeOfDay:this.settings.defaultTimeOfDay,weekStart:this.settings.weekStart,isTodayLinkVisible:this.settings.isTodayLinkVisible,containerStyle:null,monthYearHeaderStyle:this.settings.monthYearHeaderStyle,monthYearHeaderClass:this.settings.monthYearHeaderClass,dayOfWeekHeaderStyle:this.settings.dayOfWeekHeaderStyle,dayOfWeekHeaderClass:this.settings.dayOfWeekHeaderClass,dayStyle:this.settings.dayStyle,dayClass:this.settings.dayClass,otherMonthDayStyle:this.settings.otherMonthDayStyle,otherMonthDayClass:this.settings.otherMonthDayClass,selectedDayStyle:this.settings.selectedDayStyle,selectedDayClass:this.settings.selectedDayClass,disabledDayStyle:this.settings.disabledDayStyle,disabledDayClass:this.settings.disabledDayClass,todayLinkStyle:this.settings.todayLinkStyle,todayLinkClass:this.settings.todayLinkClass,monthRows:this.settings.monthRows,monthColumns:this.settings.monthColumns,monthCellSpacing:this.settings.monthCellSpacing,monthCellStyle:this.settings.monthCellStyle,monthCellClass:this.settings.monthCellClass,highlightingStyleSelector:this.settings.highlightingStyleSelector,highlightingClassSelector:this.settings.highlightingClassSelector,disabledDateSelector:this.settings.disabledDateSelector,applyMonthStyleForSingleCell:this.settings.applyMonthStyleForSingleCell,applyNextMonthButtonToLastColumn:!0,applyNextMonthButtonToLastRow:!1,allowMultipleSelection:!1,allowRangeSelection:!1,calendarSelectorLevels:this.settings.calendarSelectorLevels,calendarSelectorPopupStyle:this.settings.calendarSelectorPopupStyle,calendarSelectorPopupClass:this.settings.calendarSelectorPopupClass,minValue:this.settings.minValue,months:this.settings.months,daysOfWeek:this.settings.daysOfWeek,todayString:this.settings.todayString,forceSetOnClick:!0,selectedDateChangeHandler:function(S){a.setValue(S),a.settings.selectedDateChangeHandler&&a.settings.selectedDateChangeHandler(S)}},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),this.inputElement&&(this.inputElement.addEventListener("change",function(){a.refreshValue()},!0),this.dropDownButtonElement&&(this.dropDownButtonElement.onmousedown=function(){a.recordClick(),a.refreshValue(),setTimeout(function(){a.toggleDropDown()},0)}),this.popupElement)&&(this.popupElement.style.position="absolute",this.popupElement.style.display="none",this.inputElement.addEventListener("focus",function(){a.settings.openDropDownOnInputClick&&(a.openDropDown(),a.focusValue=a.inputElement.value)},!0),this.inputElement.addEventListener("blur",function(){a.settings.openDropDownOnInputClick&&typeof a.focusValue<"u"&&delete a.focusValue},!0),this.inputElement.addEventListener("keydown",function(S){13==S.keyCode?a.settings.openDropDownOnInputClick&&a.refreshValue():a.closeDropDown()},!0),this.inputElement.addEventListener("mousedown",function(){setTimeout(function(){a.settings.openDropDownOnInputClick&&!(typeof a.focusValue<"u"&&a.inputElement.value!=a.focusValue)&&(a.refreshValue(),a.openDropDown())},0),a.recordClick()},!0),this.inputElement.addEventListener("input",function(){a.closeDropDown()},!0),this.popupElement.onmousedown=function(){a.recordClick()},D.addEventListener("mousedown",function(){setTimeout(function(){a.isDuringRecordedClick()||a.closeDropDown()},0)},!0),D.addEventListener("mousewheel",function(){a.closeDropDown()},!0),D.addEventListener("DOMMouseScroll",function(){a.closeDropDown()},!0))},H.prototype.recordClick=function(){var a=this;this.isDuringClick||(this.isDuringClick=!0,setTimeout(function(){delete a.isDuringClick},0))},H.prototype.isDuringRecordedClick=function(){return typeof this.isDuringClick<"u"},H.prototype.getValue=function(){return this.value},H.prototype.setValue=function(a){this.resetValue(a)},H.prototype.setDisplayedValue=function(a){this.calendar&&this.calendar.setDisplayedValue(a)},H.prototype.refreshValue=function(){this.resetValue()},H.prototype.resetValue=function(a){if(!this.isDuringInternalSetValue){this.isDuringInternalSetValue=!0,this.closeDropDown();var m,D=this.value;try{this.value=a??this.settings.dateTimeParser(this.inputElement.value)}catch{}null!=this.value&&this.value<this.settings.minValue&&(this.value=this.settings.isNullValueAccepted?null:this.settings.minValue),this.settings.disabledDateSelector&&null!=this.value&&this.settings.disabledDateSelector(this.value)&&(this.value=this.settings.isNullValueAccepted?null:new Date);try{m=this.settings.dateTimeFormatter(this.value)}catch{m=""}if(m!=this.inputElement.value&&(this.inputElement.value=m,this.isInitialized))try{var c=this.inputElement.ownerDocument.createEvent("HTMLEvents");c.initEvent("change",!0,!0),this.inputElement.dispatchEvent(c)}catch{}(this.value&&!D||!this.value&&D||this.value&&D&&this.value.valueOf()!=D.valueOf())&&(this.calendar&&(this.calendar.selectedDate=this.value,this.calendar.refresh()),this.settings.valueChangeHandler&&this.settings.valueChangeHandler(this.value)),delete this.isDuringInternalSetValue}},H.prototype.openDropDown=function(){this.isOpen||this.toggleDropDown()},H.prototype.closeDropDown=function(){this.isOpen&&this.toggleDropDown()},H.prototype.toggleDropDown=function(){var a=this;(this.isOpen=!this.isOpen)&&this.value&&this.setDisplayedValue(this.value);var D=function(){var S=a.inputElement.getBoundingClientRect();a.popupElement.style.position="fixed",a.popupElement.style.zIndex="1",a.popupElement.style.left=S.left+"px",a.popupElement.style.top=S.top+S.height+"px",a.popupElement.style.display=a.isOpen?"block":"none";var A=a.popupElement.getBoundingClientRect();A.bottom>a.popupElement.ownerDocument.documentElement.clientHeight&&S.top>=A.height&&(a.popupElement.style.top=S.top-A.height+2+"px"),A.right>a.popupElement.ownerDocument.documentElement.clientWidth&&a.popupElement.ownerDocument.documentElement.clientWidth>=A.width&&(a.popupElement.style.left=a.popupElement.ownerDocument.documentElement.clientWidth-A.width+"px")};if(D(),this.isOpen&&this.settings.dropDownOpenedHandler?this.settings.dropDownOpenedHandler():!this.isOpen&&this.settings.dropDownClosedHandler&&this.settings.dropDownClosedHandler(),this.isOpen){var m=this.host.ownerDocument.documentElement.clientWidth,c=this.host.ownerDocument.documentElement.clientHeight,g=this.host.getBoundingClientRect();this.positionChangeHandlerTimer=setInterval(function(){var S=a.host.ownerDocument.documentElement.clientWidth,A=a.host.ownerDocument.documentElement.clientHeight,F=a.host.getBoundingClientRect();S!=m||A!=c?a.closeDropDown():(F.left!=g.left||F.top!=g.top||F.width!=g.width||F.height!=g.height)&&D(),m=S,c=A,g=F},100)}else this.positionChangeHandlerTimer&&(clearInterval(this.positionChangeHandlerTimer),delete this.positionChangeHandlerTimer)},H}();ae.Element=fe}(we=pe.DatePicker||(pe.DatePicker={})),ae=me=pe.CalendarDay||(pe.CalendarDay={}),fe=function(){function H(a,D,m,c,g){this.host=a,this.selectedTime=D,this.header=m,this.settings=c,this.isInitialized=!1;var S="DlhSoft.Controls CalendarDay DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[S[5]][S[4]](a,S[0],S[1],S[2],S[3],g,c),this.host.component=this,typeof c>"u"&&(c={}),typeof m<"u"&&typeof c.header>"u"&&(c.header=m),this.settings=c,H.initializeSettings(this.settings),typeof D>"u"&&(a=new Date,D=new Date(a.valueOf()-a.getTimezoneOffset()*H.minuteDuration).getTime(),D-=Math.floor(D/H.dayDuration)*H.dayDuration),this.selectedTime=D,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isReadOnly>"u"&&(a.isReadOnly=!1),typeof a.isNowLinkVisible>"u"&&(a.isNowLinkVisible=!1),typeof a.header>"u"&&(a.header="Time of day"),typeof a.isHeaderVisible>"u"&&(a.isHeaderVisible=!0),typeof a.headerStyle>"u"&&(a.headerStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; background-color: #f0f0f0; padding: 8px; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.timeStyle>"u"&&(a.timeStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; min-width: 24px; padding: 2px; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; font-size: "+("Modern"==a.theme?"12px":"small")),typeof a.selectedTimeStyle>"u"&&(a.selectedTimeStyle="background-color: #3399ff; color: White; padding: 2px"),typeof a.disabledTimeStyle>"u"&&(a.disabledTimeStyle="color: "+("Modern"==a.theme?"#c0c0c0":"Silver")),typeof a.nowLinkStyle>"u"&&(a.nowLinkStyle="color: "+("Modern"==a.theme?"#505050":"Black")+"; padding: 4px; border-top: 1px solid "+("Modern"==a.theme?"#e0e0e0":"Silver")+"; font-size: "+("Modern"==a.theme?"12px":"small")+"; text-align: center; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default"),typeof a.nowString>"u"&&(a.nowString="Now"),typeof a.hourDivisions>"u"?a.hourDivisions=2:0>=a.hourDivisions&&(a.hourDivisions=1),typeof a.timeFormatter>"u"&&(a.timeFormatter=function(c){var m=Math.floor(c/H.hourDuration),g=(c=Math.floor((c-m*H.hourDuration)/H.minuteDuration),function(S,A){void 0===A&&(A=2);for(var F=S.toString();F.length<A;)F="0"+F;return F});return g(m)+":"+g(c)}),typeof a.hourColumns>"u"?a.hourColumns=4:0>=a.hourColumns&&(a.hourColumns=1),typeof a.scrollingHeight>"u"&&(a.scrollingHeight="auto")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,m=this.host.childNodes.length;0<m--;)this.host.removeChild(this.host.childNodes[m]);if((m=D.createElement("table")).cellSpacing="0",m.cellPadding="0",m.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&m.setAttribute("class",this.settings.containerClass),this.settings.isHeaderVisible){var c=D.createElement("tr");c.setAttribute("style",this.settings.headerStyle),c.setAttribute("class",this.settings.headerClass),(g=D.createElement("td")).setAttribute("style",this.settings.headerStyle),g.setAttribute("class",this.settings.headerClass),(S=D.createElement("span")).appendChild(D.createTextNode(this.settings.header)),g.appendChild(S),c.appendChild(g),m.appendChild(c)}g=D.createElement("tr"),m.appendChild(g),c=D.createElement("td"),g.appendChild(c),(g=D.createElement("div")).setAttribute("style","max-height: "+this.settings.scrollingHeight+"; overflow-y: auto"),c.appendChild(g),(c=D.createElement("table")).cellSpacing="0",c.cellPadding="0",g.appendChild(c);for(var g=null!=this.selectedTime?H.getTime(this.selectedTime,this.settings.hourDivisions):null,S=this.settings.hourDivisions,A=this.settings.hourColumns,F=24/A,z=0;z<F*S;z++){for(var P=D.createElement("tr"),U=0;U<A;U++){var Me,$=(U*F+z/S)*H.hourDuration,de=D.createElement("td");de.setAttribute("style",this.settings.timeStyle),de.setAttribute("class",this.settings.timeClass);try{Me=this.settings.timeFormatter($)}catch{Me=($/H.hourDuration).toString()}var Fe=D.createElement("span");de.appendChild(Fe);var He=D.createElement("span");Fe.appendChild(He);var Ie=typeof this.settings.disabledTimeSelector<"u"&&this.settings.disabledTimeSelector($),be=D.createElement("a");if(be.setAttribute("href","javascript://"),be.setAttribute("style","text-decoration: none; display: inline-block; cursor: "+(this.settings.isReadOnly||Ie?"default":"pointer")+"; color: inherit; width: 40px"),be.appendChild(D.createTextNode(Me)),He.appendChild(be),Ie)Fe.setAttribute("style",this.settings.disabledTimeStyle),Fe.setAttribute("class",this.settings.disabledTimeClass);else{var ue=null!=g&&$==g;ue&&(Fe.setAttribute("style",this.settings.selectedTimeStyle),Fe.setAttribute("class",this.settings.selectedTimeClass),this.selectedElement=Fe),this.settings.highlightingStyleSelector&&(Fe=this.settings.highlightingStyleSelector($,ue))&&He.setAttribute("style",Fe),this.settings.highlightingClassSelector&&(ue=this.settings.highlightingClassSelector($,ue))&&He.setAttribute("class",ue)}!this.settings.isReadOnly&&!Ie&&(be.value=$,be.onclick=function(Te){a.setValue(Te.currentTarget.value),Te.stopPropagation()}),P.appendChild(de)}c.appendChild(P)}!this.settings.isReadOnly&&this.settings.isNowLinkVisible&&(Me=D.createElement("tr"),(c=D.createElement("td")).setAttribute("style",this.settings.nowLinkStyle),c.setAttribute("class",this.settings.nowLinkClass),(g=D.createElement("a")).setAttribute("href","javascript://"),g.setAttribute("style","text-decoration: none; color: inherit; cursor: pointer"),g.appendChild(D.createTextNode(this.settings.nowString)),c.appendChild(g),g.value=-1,g.onclick=function(ke){var De=ke.currentTarget.value;0>De&&(De=new Date,De=new Date(De.valueOf()-De.getTimezoneOffset()*H.minuteDuration).getTime(),De-=Math.floor(De/H.dayDuration)*H.dayDuration),a.setValue(De),ke.stopPropagation()},Me.appendChild(c),m.appendChild(Me)),this.host.appendChild(m)},H.prototype.getValue=function(){return this.selectedTime},H.prototype.setValue=function(a){null!=a&&0>a&&(a=0),(a!=this.selectedTime||this.settings.forceSetOnClick)&&(this.selectedTime=a,this.refresh(),this.settings.selectedTimeChangeHandler&&this.settings.selectedTimeChangeHandler(a))},H.getTime=function(a,D){var m=H.hourDuration/D;return Math.floor(a/m)*m},H.dayDuration=24*(H.hourDuration=60*(H.minuteDuration=60*(H.secondDuration=1e3))),H}(),ae.Element=fe,function(ae){ae.initialize=function(H,a,D,m,c){return new fe(H,a,D,m,c)},ae.get=function(H){return H.component};var fe=function(){function H(a,D,m,c,g){this.host=a,this.value=D,this.header=m,this.settings=c,this.isInitialized=!1,this.dropDownButtonElement=null;var S="DlhSoft.Controls TimePicker DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");if(t[S[5]][S[4]](a,S[0],S[1],S[2],S[3],g,c),this.host.component=this,typeof c>"u"&&(c={}),typeof m<"u"&&typeof c.header>"u"&&(c.header=m),this.settings=c,H.initializeSettings(this.settings),m=this.host.ownerDocument,this.inputHost=a instanceof HTMLInputElement?a:null){if(null==D)try{D=this.settings.timeParser(this.inputHost.value)}catch{}a=m.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(a,this.inputHost),this.host=a,t[S[5]][S[4]](a,S[0],S[1],S[2],S[3],g,c),this.host.component=this}typeof D>"u"&&(c.isNullValueAccepted?D=null:(D=new Date,D=new Date(D.valueOf()-D.getTimezoneOffset()*H.minuteDuration).getTime(),D-=Math.floor(D/H.dayDuration)*H.dayDuration)),this.value=D,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.isNowLinkVisible>"u"&&(a.isNowLinkVisible=!0),typeof a.timeFormatter>"u"&&(a.timeFormatter=function(c){if(null==c&&a.isNullValueAccepted)return"";var m=Math.floor(c/H.hourDuration),g=(c=Math.floor((c-m*H.hourDuration)/H.minuteDuration),function(S,A){void 0===A&&(A=2);for(var F=S.toString();F.length<A;)F="0"+F;return F});return g(m)+":"+g(c)}),me.Element.initializeSettings(a),typeof a.openDropDownOnInputClick>"u"&&(a.openDropDownOnInputClick=!0),typeof a.timeParser>"u"&&(a.timeParser=function(D){if(typeof D>"u"||null==D||0==D.length)return a.isNullValueAccepted?null:0;var m=D.lastIndexOf(" ");return m>=0&&(D=D.substr(m+1)),D=new Date("01/01/1970 "+D),isNaN(D.valueOf())||D.getFullYear()<=0||1970!=D.getFullYear()||0!=D.getMonth()||1!=D.getDate()?(D=new Date,D=new Date(D.valueOf()-D.getTimezoneOffset()*H.minuteDuration).getTime(),D-=Math.floor(D/H.dayDuration)*H.dayDuration):D.getTime()-D.getTimezoneOffset()*H.minuteDuration}),typeof a.isNullValueAccepted>"u"&&(a.isNullValueAccepted=!0),typeof a.isDropDownButtonVisible>"u"&&(a.isDropDownButtonVisible=!1),typeof a.dropDownButtonDefinition>"u"&&(a.dropDownButtonDefinition="<svg style='display: inline-block; margin-left: 4px; cursor: pointer; vertical-align: middle' width='12' height='12'><circle cx='6' cy='6' r='6' style='fill: none; stroke: #707070; stroke-width: 0.65'/><line x1='6' y1='2' x2='6' y2='6' style='stroke: #707070; stroke-width: 0.65'/><line x1='6' y1='6' x2='10' y2='6' style='stroke: #707070; stroke-width: 0.65'/></svg>"),typeof a.popupStyle>"u"&&(a.popupStyle="background-color: White; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"#707070")+"; font-family: Arial"),typeof a.inputStyle>"u"&&"Modern"==a.theme&&(a.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px"),typeof a.defaultPrefix>"u"&&(a.defaultPrefix="")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,m=this.host.childNodes.length;0<m--;)this.host.removeChild(this.host.childNodes[m]);if((m=D.createElement("div")).setAttribute("style","margin-top: -1px"),this.inputHost)(c=D.createElement("span")).setAttribute("style","display: inline-block"),c.appendChild(m),this.host.appendChild(c),this.popupElement=(m=this.host.firstChild).firstChild,this.inputHost.parentElement&&this.inputHost.parentElement.removeChild(this.inputHost),this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.inputHost,this.popupElement),this.inputElement=this.inputHost;else{var c=D.createElement("span");c.setAttribute("style","display: inline-block");var g=D.createElement("input");c.appendChild(g),c.appendChild(m),this.host.appendChild(c),this.inputElement=(m=this.host.firstChild).firstChild,this.popupElement=m.childNodes[1]}this.popupElement&&((m=D.createElement("div")).setAttribute("style",this.settings.popupStyle),this.settings.popupClass&&m.setAttribute("class",this.settings.popupClass),this.popupElement.appendChild(m)),this.inputElement&&(typeof this.settings.inputStyle<"u"&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass)),this.settings.isDropDownButtonVisible&&(this.dropDownButtonElement=D.createElement("span"),this.dropDownButtonElement.setAttribute("style","display: inline-block"),this.dropDownButtonElement.innerHTML=this.settings.dropDownButtonDefinition,this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.dropDownButtonElement,this.popupElement)),this.inputElement&&(this.inputElement.TimePicker=this,this.setValue(this.value),this.settings.isReadOnly&&this.inputElement.setAttribute("readonly","readonly")),this.popupElement&&(m=this.popupElement.firstChild,this.calendarDayHost=D.createElement("div"),m.appendChild(this.calendarDayHost)),this.calendarDayHost&&(this.calendarDay=new me.Element(this.calendarDayHost,this.value,void 0,{theme:this.settings.theme,isReadOnly:this.settings.isReadOnly,header:this.settings.header,isHeaderVisible:this.settings.isHeaderVisible,isNowLinkVisible:this.settings.isNowLinkVisible,containerStyle:null,headerStyle:this.settings.headerStyle,headerClass:this.settings.headerClass,timeStyle:this.settings.timeStyle,timeClass:this.settings.timeClass,selectedTimeStyle:this.settings.selectedTimeStyle,selectedTimeClass:this.settings.selectedTimeClass,disabledTimeStyle:this.settings.disabledTimeStyle,disabledTimeClass:this.settings.disabledTimeClass,nowLinkStyle:this.settings.nowLinkStyle,nowLinkClass:this.settings.nowLinkClass,highlightingStyleSelector:this.settings.highlightingStyleSelector,highlightingClassSelector:this.settings.highlightingClassSelector,disabledTimeSelector:this.settings.disabledTimeSelector,nowString:this.settings.nowString,hourDivisions:this.settings.hourDivisions,timeFormatter:this.settings.timeFormatter,hourColumns:this.settings.hourColumns,scrollingHeight:this.settings.scrollingHeight,forceSetOnClick:!0,selectedTimeChangeHandler:function(S){a.setValue(S),a.settings.selectedTimeChangeHandler&&a.settings.selectedTimeChangeHandler(S)}},"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")),this.inputElement&&(this.inputElement.addEventListener("change",function(){a.refreshValue()},!0),this.dropDownButtonElement&&(this.dropDownButtonElement.onmousedown=function(){a.recordClick(),a.refreshValue(),setTimeout(function(){a.toggleDropDown()},0)}),this.popupElement)&&(this.popupElement.style.position="absolute",this.popupElement.style.display="none",this.inputElement.addEventListener("focus",function(){a.settings.openDropDownOnInputClick&&(a.openDropDown(),a.focusValue=a.inputElement.value)},!0),this.inputElement.addEventListener("blur",function(){a.settings.openDropDownOnInputClick&&typeof a.focusValue<"u"&&delete a.focusValue},!0),this.inputElement.addEventListener("keydown",function(S){13==S.keyCode?a.settings.openDropDownOnInputClick&&a.refreshValue():a.closeDropDown()},!0),this.inputElement.addEventListener("mousedown",function(){setTimeout(function(){a.settings.openDropDownOnInputClick&&!(typeof a.focusValue<"u"&&a.inputElement.value!=a.focusValue)&&(a.refreshValue(),a.openDropDown())},0),a.recordClick()},!0),this.inputElement.addEventListener("input",function(){a.closeDropDown()},!0),this.popupElement.onmousedown=function(){a.recordClick()},D.addEventListener("mousedown",function(){setTimeout(function(){a.isDuringRecordedClick()||a.closeDropDown()},0)},!0),D.addEventListener("mousewheel",function(S){a.isMouseWheelScrollingPopup(S)||a.closeDropDown()},!0),D.addEventListener("DOMMouseScroll",function(S){a.isMouseWheelScrollingPopup(S)||a.closeDropDown()},!0))},H.prototype.recordClick=function(){var a=this;this.isDuringClick||(this.isDuringClick=!0,setTimeout(function(){delete a.isDuringClick},0))},H.prototype.isDuringRecordedClick=function(){return typeof this.isDuringClick<"u"},H.prototype.isMouseWheelScrollingPopup=function(a){for(var D=typeof a.wheelDelta<"u"?a.wheelDelta/120:typeof a.detail<"u"?-a.detail/3:0,m=(a=a.target,!1);null!=a;){if(0<a.offsetHeight&&a.offsetHeight<a.scrollHeight&&!(1>=a.scrollTop&&0<D||a.scrollTop>=a.scrollHeight-a.clientHeight-1&&0>D)&&(m=!0),a==this.popupElement)return m;a=a.parentElement}return!1},H.prototype.getValue=function(){return this.value},H.prototype.setValue=function(a){this.resetValue(a)},H.prototype.refreshValue=function(){this.resetValue()},H.prototype.resetValue=function(a){if(!this.isDuringInternalSetValue){this.isDuringInternalSetValue=!0,this.closeDropDown();var m,D=this.value;try{this.value=a??this.settings.timeParser(this.inputElement.value)}catch{}this.settings.disabledTimeSelector&&null!=this.value&&this.settings.disabledTimeSelector(this.value)&&(this.settings.isNullValueAccepted?this.value=null:(a=new Date,this.value=new Date(a.valueOf()-a.getTimezoneOffset()*H.minuteDuration).getTime(),this.value-=Math.floor(this.value/H.dayDuration)*H.dayDuration)),0<(a=0<=(a=this.inputElement.value?this.inputElement.value.lastIndexOf(" "):-1)?this.inputElement.value.substr(0,a):this.settings.defaultPrefix).length&&(a+=" ");try{m=a+this.settings.timeFormatter(this.value)}catch{}if(m!=this.inputElement.value&&(this.inputElement.value=m,this.isInitialized))try{var c=this.inputElement.ownerDocument.createEvent("HTMLEvents");c.initEvent("change",!0,!0),this.inputElement.dispatchEvent(c)}catch{}(this.value&&!D||!this.value&&D||this.value&&D&&this.value!=D)&&(this.calendarDay&&(this.calendarDay.selectedTime=this.value,this.calendarDay.refresh()),this.settings.valueChangeHandler&&this.settings.valueChangeHandler(this.value)),delete this.isDuringInternalSetValue}},H.prototype.openDropDown=function(){this.isOpen||this.toggleDropDown()},H.prototype.closeDropDown=function(){this.isOpen&&this.toggleDropDown()},H.prototype.toggleDropDown=function(){var a=this;this.isOpen=!this.isOpen;var D=function(){var S=a.inputElement.getBoundingClientRect();a.popupElement.style.position="fixed",a.popupElement.style.zIndex="1",a.popupElement.style.left=S.left+"px",a.popupElement.style.top=S.top+S.height+"px",a.popupElement.style.display=a.isOpen?"block":"none";var A=a.popupElement.getBoundingClientRect();A.bottom>a.popupElement.ownerDocument.documentElement.clientHeight&&S.top>=A.height&&(a.popupElement.style.top=S.top-A.height+2+"px"),A.right>a.popupElement.ownerDocument.documentElement.clientWidth&&a.popupElement.ownerDocument.documentElement.clientWidth>=A.width&&(a.popupElement.style.left=a.popupElement.ownerDocument.documentElement.clientWidth-A.width+"px")};if(D(),this.isOpen&&this.settings.dropDownOpenedHandler?this.settings.dropDownOpenedHandler():!this.isOpen&&this.settings.dropDownClosedHandler&&this.settings.dropDownClosedHandler(),this.isOpen){this.calendarDay.selectedElement&&this.calendarDay.selectedElement.scrollIntoView();var m=this.host.ownerDocument.documentElement.clientWidth,c=this.host.ownerDocument.documentElement.clientHeight,g=this.host.getBoundingClientRect();this.positionChangeHandlerTimer=setInterval(function(){var S=a.host.ownerDocument.documentElement.clientWidth,A=a.host.ownerDocument.documentElement.clientHeight,F=a.host.getBoundingClientRect();S!=m||A!=c?a.closeDropDown():(F.left!=g.left||F.top!=g.top||F.width!=g.width||F.height!=g.height)&&D(),m=S,c=A,g=F},100)}else this.positionChangeHandlerTimer&&(clearInterval(this.positionChangeHandlerTimer),delete this.positionChangeHandlerTimer)},H.dayDuration=24*(H.hourDuration=60*(H.minuteDuration=60*(H.secondDuration=1e3))),H}();ae.Element=fe}(xe=pe.TimePicker||(pe.TimePicker={})),function(ae){ae.initialize=function(H,a,D,m){return new fe(H,a,D,m)},ae.get=function(H){return H["DateTimePicker.component"]};var fe=function(){function H(a,D,m,c){var S,g=this;this.host=a,this.value=D,this.settings=m,this.isInitialized=!1,this.host["DateTimePicker.component"]=this,typeof m>"u"&&(m={}),typeof m.license<"u"&&typeof m.datePickerSettings<"u"&&(m.datePickerSettings.license=m.license),this.settings=m,H.initializeSettings(this.settings),typeof D>"u"&&(D=m.datePickerSettings.isNullValueAccepted?null:new Date),this.value=D,this.timePicker=xe.initialize(a,void 0,void 0,this.settings.timePickerSettings,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase."),this.inputElement=this.timePicker.inputElement,this.inputElement["DateTimePicker.component"]=this,this.datePicker=we.initialize(this.inputElement,this.value,this.settings.datePickerSettings,c),this.value=this.datePicker.value;try{S=D?this.datePicker.settings.dateTimeFormatter(D):""}catch{S=""}0<=(a=S.lastIndexOf(" "))&&(S=S.substr(0,a)),this.timePicker.settings.defaultPrefix=S;var A=this.datePicker.settings.dropDownOpenedHandler;this.datePicker.settings.dropDownOpenedHandler=function(){g.datePicker.isOpen&&g.timePicker.isOpen&&g.timePicker.closeDropDown(),g.isOpen=g.datePicker.isOpen,A&&A()};var F=this.datePicker.settings.dropDownClosedHandler;this.datePicker.settings.dropDownClosedHandler=function(){g.isOpen=g.datePicker.isOpen,F&&F()};var z=this.timePicker.settings.dropDownOpenedHandler;this.timePicker.settings.dropDownOpenedHandler=function(){g.timePicker.isOpen&&!g.value?g.timePicker.closeDropDown():(g.timePicker.isOpen&&g.datePicker.isOpen&&g.datePicker.closeDropDown(),g.isTimeOpen=g.timePicker.isOpen,z&&z())};var P=this.timePicker.settings.dropDownClosedHandler;this.timePicker.settings.dropDownClosedHandler=function(){g.isTimeOpen=g.timePicker.isOpen,P&&P()};var U=this.datePicker.settings.valueChangeHandler;this.datePicker.settings.valueChangeHandler=function($){g.value=$,U&&U($)},this.inputElement&&(this.inputElement.addEventListener("focus",function(){g.settings.openDropDownOnInputClick&&("Time"===g.getCurrentValuePart()?(g.timePicker.refreshValue(),g.openTimeDropDown()):g.openDropDown(),g.focusValue=g.inputElement.value)},!0),this.inputElement.addEventListener("blur",function(){g.settings.openDropDownOnInputClick&&typeof g.focusValue<"u"&&delete g.focusValue},!0),this.inputElement.addEventListener("keydown",function($){13==$.keyCode?g.settings.openDropDownOnInputClick&&g.refreshValue():g.closeDropDown()},!0),this.inputElement.addEventListener("mousedown",function(){setTimeout(function(){!g.settings.openDropDownOnInputClick||typeof g.focusValue<"u"&&g.inputElement.value!=g.focusValue||("Time"===g.getCurrentValuePart()?(g.timePicker.refreshValue(),g.openTimeDropDown()):(g.datePicker.refreshValue(),g.openDropDown()))},0)},!0)),this.isInitialized=!0}return H.initializeSettings=function(a){if(typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isReadOnly>"u"&&(a.isReadOnly=!1),typeof a.isNullValueAccepted>"u"&&(a.isNullValueAccepted=!0),typeof a.openDropDownOnInputClick>"u"&&(a.openDropDownOnInputClick=!0),typeof a.datePickerSettings>"u"&&(a.datePickerSettings={}),a.datePickerSettings.isReadOnly=a.isReadOnly,a.datePickerSettings.theme=a.theme,typeof a.datePickerSettings.isTodayLinkVisible>"u"&&(a.datePickerSettings.isTodayLinkVisible=a.areCurrentLinksVisible),typeof a.datePickerSettings.defaultTimeOfDay>"u"&&(a.datePickerSettings.defaultTimeOfDay=a.defaultTimeOfDay),a.datePickerSettings.openDropDownOnInputClick=!1,typeof a.datePickerSettings.isDropDownButtonVisible>"u"&&(a.datePickerSettings.isDropDownButtonVisible=a.areDropDownButtonsVisible),a.datePickerSettings.allowMultipleSelection=!1,a.datePickerSettings.allowRangeSelection=!1,typeof a.datePickerSettings.dateTimeFormatter>"u"&&(a.datePickerSettings.dateTimeFormatter=a.dateTimeFormatter),typeof a.datePickerSettings.dateTimeParser>"u"&&(a.datePickerSettings.dateTimeParser=a.dateTimeParser),a.datePickerSettings.isNullValueAccepted=a.isNullValueAccepted,typeof a.datePickerSettings.valueChangeHandler>"u"&&(a.datePickerSettings.valueChangeHandler=a.valueChangeHandler),typeof a.datePickerSettings.popupClass>"u"&&(a.datePickerSettings.popupClass=a.popupClass),typeof a.datePickerSettings.popupStyle>"u"&&(a.datePickerSettings.popupStyle=a.popupStyle),typeof a.datePickerSettings.inputClass>"u"&&(a.datePickerSettings.inputClass=a.inputClass),typeof a.datePickerSettings.inputStyle>"u"&&(a.datePickerSettings.inputStyle=a.inputStyle),typeof a.datePickerSettings.disabledDateSelector>"u"&&(a.datePickerSettings.disabledDateSelector=a.disabledDateSelector),typeof a.datePickerSettings.calendarSelectorLevels>"u"&&(a.datePickerSettings.calendarSelectorLevels=a.calendarSelectorLevels),typeof a.datePickerSettings.months>"u"&&(a.datePickerSettings.months=a.months),typeof a.datePickerSettings.daysOfWeek>"u"&&(a.datePickerSettings.daysOfWeek=a.daysOfWeek),typeof a.timePickerSettings>"u"&&(a.timePickerSettings={}),a.timePickerSettings.theme=a.theme,a.timePickerSettings.isReadOnly=a.isReadOnly,typeof a.timePickerSettings.isNowLinkVisible>"u"&&(a.timePickerSettings.isNowLinkVisible=a.areCurrentLinksVisible),typeof a.timePickerSettings.nowString>"u"&&(a.timePickerSettings.nowString="Current"),a.timePickerSettings.openDropDownOnInputClick=!1,typeof a.timePickerSettings.isDropDownButtonVisible>"u"&&(a.timePickerSettings.isDropDownButtonVisible=a.areDropDownButtonsVisible),typeof a.timePickerSettings.timeFormatter>"u"&&typeof a.datePickerSettings.dateTimeFormatter<"u"&&(a.timePickerSettings.timeFormatter=function(c){var g=new Date(1970,0,1);return c=null!=c?a.datePickerSettings.dateTimeFormatter(new Date(g.valueOf()+c)):"",(g=c.lastIndexOf(" "))<0?"":c.substr(g+1)}),typeof a.timePickerSettings.timeParser>"u"&&typeof a.datePickerSettings.dateTimeParser<"u"&&typeof a.datePickerSettings.dateTimeFormatter<"u"&&(a.timePickerSettings.timeParser=function(c){if((S=c.lastIndexOf(" "))<0)return a.isNullValueAccepted?null:(c=new Date,(c=new Date(c.valueOf()-c.getTimezoneOffset()*H.minuteDuration).getTime())-Math.floor(c/H.dayDuration)*H.dayDuration);c=c.substr(S+1);var S,g=a.datePickerSettings.dateTimeFormatter(new Date(1970,0,1));return(S=g.indexOf(" "))>=0&&(g=g.substr(0,S+1)),c=a.datePickerSettings.dateTimeParser(g+c),isNaN(c.valueOf())||c.getFullYear()<=0||1970!=c.getFullYear()||0!=c.getMonth()||1!=c.getDate()?(c=new Date,c=new Date(c.valueOf()-c.getTimezoneOffset()*H.minuteDuration).getTime(),c-=Math.floor(c/H.dayDuration)*H.dayDuration):c.getTime()-c.getTimezoneOffset()*H.minuteDuration}),a.timePickerSettings.isNullValueAccepted=a.isNullValueAccepted,typeof a.timePickerSettings.disabledTimeSelector<"u"){var D=a.datePickerSettings.disabledDateSelector;a.datePickerSettings.disabledDateSelector=function(m){var c=!1;return D&&(c=D(m)),!!c||(m=new Date(m.valueOf()-m.getTimezoneOffset()*H.minuteDuration).getTime(),m-=Math.floor(m/H.dayDuration)*H.dayDuration,a.timePickerSettings.disabledTimeSelector(m))}}typeof a.timePickerSettings.popupClass>"u"&&(a.timePickerSettings.popupClass=a.popupClass),typeof a.timePickerSettings.popupStyle>"u"&&(a.timePickerSettings.popupStyle=a.popupStyle),a.timePickerSettings.inputClass=void 0,a.timePickerSettings.inputStyle=null,typeof a.timePickerSettings.disabledTimeSelector>"u"&&(a.timePickerSettings.disabledTimeSelector=a.disabledTimeSelector)},H.prototype.refreshValue=function(){this.datePicker.refreshValue(),this.timePicker.refreshValue()},H.prototype.getValue=function(){return this.datePicker.getValue()},H.prototype.setValue=function(a){this.datePicker.setValue(a)},H.prototype.getTimeValue=function(){return this.timePicker.getValue()},H.prototype.setTimeValue=function(a){this.timePicker.setValue(a)},H.prototype.openDropDown=function(){this.datePicker.openDropDown()},H.prototype.closeDropDown=function(){this.datePicker.closeDropDown()},H.prototype.openTimeDropDown=function(){this.timePicker.openDropDown()},H.prototype.closeTimeDropDown=function(){this.timePicker.closeDropDown()},H.prototype.getCurrentValuePart=function(){if(!this.inputElement||!this.inputElement.value)return null;var a=this.inputElement.value.lastIndexOf(" ");return 0>a?"Date":this.inputElement.selectionStart>a?"Time":"Date"},H.dayDuration=24*(H.hourDuration=60*(H.minuteDuration=60*(H.secondDuration=1e3))),H}();ae.Element=fe}(pe.DateTimePicker||(pe.DateTimePicker={})),function(ae){ae.initialize=function(H,a,D,m,c){return new fe(H,a,D,m,c)},ae.get=function(H){return H.component};var fe=function(){function H(a,D,m,c,g){this.host=a,this.availableChoices=D,this.value=m,this.settings=c,this.isInitialized=!1,this.dropDownButtonElement=null;var S="DlhSoft.Controls MultiSelectorComboBox DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[S[5]][S[4]](a,S[0],S[1],S[2],S[3],g,c),this.host.component=this,typeof c>"u"&&(c={}),this.settings=c,H.initializeSettings(this.settings),typeof this.settings.choiceStyle>"u"&&!(this instanceof he.Element)&&(this.settings.choiceStyle="cursor: pointer");var A=this.host.ownerDocument;(this.inputHost=a instanceof HTMLInputElement?a:null)&&(null==m&&(m=this.inputHost.value),a=A.createElement("span"),this.inputHost.parentElement&&this.inputHost.parentElement.insertBefore(a,this.inputHost),this.host=a,t[S[5]][S[4]](a,S[0],S[1],S[2],S[3],g,c),this.host.component=this),(typeof D>"u"||null==D)&&(D=[]),this.availableChoices=D,(typeof m>"u"||null==m)&&(m=""),this.value=m,this.refresh(),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isReadOnly>"u"&&(a.isReadOnly=!1),typeof a.autoAppendAvailableChoices>"u"&&(a.autoAppendAvailableChoices=!1),typeof a.openDropDownOnInputClick>"u"&&(a.openDropDownOnInputClick=!0),typeof a.isDropDownButtonVisible>"u"&&(a.isDropDownButtonVisible=!1),typeof a.dropDownButtonDefinition>"u"&&(a.dropDownButtonDefinition="<span style='display: inline-block; margin-left: 1px; color: "+("Modern"==a.theme?"#909090":"#707070")+"; font-size: "+("Modern"==a.theme?"10px":"x-small")+"; "+(a.isReadOnly?"opacity: 0.25":"cursor: pointer")+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none'>\u25bc</span>"),typeof a.separator>"u"&&(a.separator=","),typeof a.isSpaceSeparated>"u"&&(a.isSpaceSeparated=!0),typeof a.delimiters>"u"&&(a.delimiters=["["]),typeof a.areCheckBoxesVisible>"u"&&(a.areCheckBoxesVisible=!0),typeof a.popupStyle>"u"&&(a.popupStyle="background-color: White; color: "+("Modern"==a.theme?"#505050":"Black")+"; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"#707070")+"; font-family: Arial; font-size: "+("Modern"==a.theme?"12px":"small")+"; max-height: 188px; overflow-y: auto"),typeof a.inputStyle>"u"&&"Modern"==a.theme&&(a.inputStyle="border: 1px solid #e0e0e0; background-color: White; color: #505050; font-family: Arial; font-size: 12px; padding: 4px")},H.prototype.refresh=function(){for(var a=this,D=this.host.ownerDocument,m=this.host.childNodes.length;0<m--;)this.host.removeChild(this.host.childNodes[m]);if((m=D.createElement("div")).setAttribute("style","margin-top: -1px"),this.inputHost)(c=D.createElement("span")).setAttribute("style","display: inline-block"),c.appendChild(m),this.host.appendChild(c),this.popupElement=(m=this.host.firstChild).firstChild,this.inputHost.parentElement&&this.inputHost.parentElement.removeChild(this.inputHost),this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.inputHost,this.popupElement),this.inputElement=this.inputHost;else{var c=D.createElement("span");c.setAttribute("style","display: inline-block");var g=D.createElement("input");c.appendChild(g),c.appendChild(m),this.host.appendChild(c),this.inputElement=(m=this.host.firstChild).firstChild,this.popupElement=m.childNodes[1]}this.popupElement&&((m=D.createElement("div")).setAttribute("style",this.settings.popupStyle),this.settings.popupClass&&m.setAttribute("class",this.settings.popupClass),this.popupElement.appendChild(m)),this.inputElement&&(typeof this.settings.inputStyle<"u"&&this.inputElement.setAttribute("style",this.settings.inputStyle+(this.inputElement.getAttribute("style")?";"+this.inputElement.getAttribute("style"):"")),this.settings.inputClass&&this.inputElement.setAttribute("class",this.settings.inputClass)),this.settings.isDropDownButtonVisible&&(this.dropDownButtonElement=D.createElement("span"),this.dropDownButtonElement.setAttribute("style","display: inline-block"),this.dropDownButtonElement.innerHTML=this.settings.dropDownButtonDefinition,this.popupElement&&this.popupElement.parentElement&&this.popupElement.parentElement.insertBefore(this.dropDownButtonElement,this.popupElement)),this.inputElement&&(this.inputElement.MultiSelectorComboBox=this,this.setValue(this.value),(this.settings.isReadOnly||this instanceof ge.Element)&&this.inputElement.setAttribute("readonly","readonly")),this.popupElement&&(m=this.popupElement.firstChild,this.checkBoxListElement=D.createElement("div"),this.checkBoxListElement.setAttribute("style","margin: 2px; margin-left: 0px; padding-right: 2px; padding-bottom: 2px"),m.appendChild(this.checkBoxListElement),this.refreshSelectedChoices()),this.inputElement&&(this.inputElement.addEventListener("change",function(){a.refreshValue(),a.refreshAvailableChoices()},!0),this.dropDownButtonElement&&(this.dropDownButtonElement.onmousedown=function(){a.recordClick(),a.refreshValue(),setTimeout(function(){a.toggleDropDown()},0)}),this.popupElement)&&(this.popupElement.style.position="absolute",this.popupElement.style.display="none",this.inputElement.addEventListener("focus",function(){a.settings.openDropDownOnInputClick&&(a.openDropDown(),a.focusValue=a.inputElement.value)},!0),this.inputElement.addEventListener("blur",function(){a.settings.openDropDownOnInputClick&&typeof a.focusValue<"u"&&delete a.focusValue},!0),this.inputElement.addEventListener("keydown",function(S){13==S.keyCode?a.settings.openDropDownOnInputClick&&a.refreshValue():a.closeDropDown()},!0),this.inputElement.addEventListener("mousedown",function(){setTimeout(function(){a.settings.openDropDownOnInputClick&&!(typeof a.focusValue<"u"&&a.inputElement.value!=a.focusValue)&&(a.refreshValue(),a.openDropDown())},0),a.recordClick()},!0),this.inputElement.addEventListener("input",function(){a.closeDropDown()},!0),this.popupElement.onmousedown=function(){a.recordClick()},D.addEventListener("mousedown",function(){setTimeout(function(){a.isDuringRecordedClick()||a.closeDropDown()},0)},!0),D.addEventListener("mousewheel",function(S){a.isMouseWheelScrollingPopup(S)||a.closeDropDown()},!0),D.addEventListener("DOMMouseScroll",function(S){a.isMouseWheelScrollingPopup(S)||a.closeDropDown()},!0))},H.prototype.recordClick=function(){var a=this;this.isDuringClick||(this.isDuringClick=!0,setTimeout(function(){delete a.isDuringClick},0))},H.prototype.isDuringRecordedClick=function(){return typeof this.isDuringClick<"u"},H.prototype.isMouseWheelScrollingPopup=function(a){for(var D=typeof a.wheelDelta<"u"?a.wheelDelta/120:typeof a.detail<"u"?-a.detail/3:0,m=(a=a.target,!1);null!=a;){if(0<a.offsetHeight&&a.offsetHeight<a.scrollHeight&&!(1>=a.scrollTop&&0<D||a.scrollTop>=a.scrollHeight-a.clientHeight-1&&0>D)&&(m=!0),a==this.popupElement)return m;a=a.parentElement}return!1},H.prototype.getValue=function(){return this.value},H.prototype.setValue=function(a){this.resetValue(a)},H.prototype.refreshValue=function(){this.resetValue()},H.prototype.resetValue=function(a){this.isDuringInternalSetValue||(this.closeDropDown(),this.setValueInternal(a))},H.prototype.setValueInternal=function(a,D){if(!this.isDuringInternalSetValue){this.isDuringInternalSetValue=!0,typeof D>"u"&&(D=!0);var m=this.value,c=this.value=typeof a<"u"&&null!=a?a:this.inputElement.value;if(c!=this.inputElement.value&&(this.inputElement.value=c,this.isInitialized))try{var g=this.inputElement.ownerDocument.createEvent("HTMLEvents");g.initEvent("change",!0,!0),this.inputElement.dispatchEvent(g)}catch{}(this.value&&!m||!this.value&&m||this.value&&m&&this.value.valueOf()!=m.valueOf())&&(D&&this.refreshSelectedChoices(),this.settings.valueChangeHandler&&this.settings.valueChangeHandler(this.value)),delete this.isDuringInternalSetValue}},H.prototype.refreshAvailableChoices=function(){if(this.settings.autoAppendAvailableChoices){for(var a=this.getSelectedChoices(!1),D=0;D<a.length;D++){var m=a[D];0>this.availableChoices.indexOf(m)&&this.availableChoices.push(m)}this.refreshSelectedChoices()}},H.prototype.getSelectedChoice=function(a){return this.getSelectedChoices(a)[0]},H.prototype.getSelectedChoices=function(a){typeof a>"u"&&(a=!0);for(var D=[],m=this.value.trim(),c=m.split(this.settings.separator),g=0;g<c.length;g++)if(0!=(m=c[g].trim()).length){for(var S=0;S<this.settings.delimiters.length;S++){var A=m.indexOf(this.settings.delimiters[S]);0<=A&&(m=m.substr(0,A).trim())}(!a||0<=this.availableChoices.indexOf(m))&&D.push(m)}return D},H.prototype.refreshSelectedChoices=function(){for(var a=this,D=this.checkBoxListElement.childNodes.length;0<D--;)this.checkBoxListElement.removeChild(this.checkBoxListElement.childNodes[D]);if(this.checkBoxElements=[],this.checkBoxListElement){D=this.getSelectedChoices();for(var m=0;m<this.availableChoices.length;m++){var c=document.createElement("div");c.setAttribute("style","padding: 1px; padding-left: 2px; padding-right: 2px");var g=this.availableChoices[m],S=document.createElement("input");S.setAttribute("type","checkbox"),S.setAttribute("value",g);var A=0<=D.indexOf(g);A&&S.setAttribute("checked","checked"),this.settings.areCheckBoxesVisible&&(S.setAttribute("style","margin-bottom: -1px"+("Modern"==this.settings.theme&&null!=this.settings.inputStyle?"; border: 1px solid #e0e0e0":"")),S.onchange=function($){var de=($=$.currentTarget).getAttribute("value");a.setSelectedChoice(de,$.checked,!1)},c.appendChild(S)),this.checkBoxElements.push(S);var F=document.createElement(this instanceof he.Element?"div":"span");F.setAttribute("style",this.settings.choiceStyle),F.setAttribute("class",this.settings.choiceClass);var z=document.createElement(this instanceof he.Element?"div":"span");A&&(z.setAttribute("style",this.settings.selectedChoiceStyle),z.setAttribute("class",this.settings.selectedChoiceClass)),(A=document.createElement("span")).innerHTML=g,z.appendChild(A),F.appendChild(z),F.checkBox=S,F.onclick=function(U){var $=U.currentTarget.checkBox.getAttribute("value");a.setValue($),U.stopPropagation()},c.appendChild(F),this.checkBoxListElement.appendChild(c)}}},H.prototype.selectChoice=function(a){this.setSelectedChoice(a,!0)},H.prototype.unselectChoice=function(a){this.setSelectedChoice(a,!1)},H.prototype.setSelectedChoice=function(a,D,m){typeof m>"u"&&(m=!0),a=a.trim();for(var c=this.value.trim(),g=c.split(this.settings.separator),S="",A=!1,F=0;F<g.length;F++)if(0!=(c=g[F].trim()).length){for(var z=c,P=0;P<this.settings.delimiters.length;P++){var U=c.indexOf(this.settings.delimiters[P]);0<=U&&(c=c.substr(0,U).trim())}(c!=a||D)&&(S+=(0<S.length?this.settings.separator+(this.settings.isSpaceSeparated?" ":""):"")+z,c==a&&(A=!0))}!A&&D&&(S+=(0<S.length?this.settings.separator+(this.settings.isSpaceSeparated?" ":""):"")+a),m?this.setValue(S):this.setValueInternal(S,!1)},H.prototype.openDropDown=function(){this.isOpen||this.toggleDropDown()},H.prototype.closeDropDown=function(){this.isOpen&&this.toggleDropDown()},H.prototype.toggleDropDown=function(){var a=this;if(!this.settings.isReadOnly&&(this.isOpen||!(0>=this.availableChoices.length))){(this.isOpen=!this.isOpen)&&this.refreshAvailableChoices();var D=function(){var S=a.inputElement.getBoundingClientRect();a.popupElement.style.position="fixed",a.popupElement.style.zIndex="1",a.popupElement.style.left=S.left+"px",a.popupElement.style.top=S.top+S.height+"px",a.popupElement.style.minWidth=a.inputElement.offsetWidth+"px",a.popupElement.style.display=a.isOpen?"block":"none";var A=a.popupElement.getBoundingClientRect();A.bottom>a.popupElement.ownerDocument.documentElement.clientHeight&&S.top>=A.height&&(a.popupElement.style.top=S.top-A.height+2+"px"),A.right>a.popupElement.ownerDocument.documentElement.clientWidth&&a.popupElement.ownerDocument.documentElement.clientWidth>=A.width&&(a.popupElement.style.left=a.popupElement.ownerDocument.documentElement.clientWidth-A.width+"px")};if(D(),this.isOpen&&this.settings.dropDownOpenedHandler?this.settings.dropDownOpenedHandler():!this.isOpen&&this.settings.dropDownClosedHandler&&this.settings.dropDownClosedHandler(),this.isOpen){var m=this.host.ownerDocument.documentElement.clientWidth,c=this.host.ownerDocument.documentElement.clientHeight,g=this.host.getBoundingClientRect();this.positionChangeHandlerTimer=setInterval(function(){var S=a.host.ownerDocument.documentElement.clientWidth,A=a.host.ownerDocument.documentElement.clientHeight,F=a.host.getBoundingClientRect();S!=m||A!=c?a.closeDropDown():(F.left!=g.left||F.top!=g.top||F.width!=g.width||F.height!=g.height)&&D(),m=S,c=A,g=F},100)}else this.positionChangeHandlerTimer&&(clearInterval(this.positionChangeHandlerTimer),delete this.positionChangeHandlerTimer)}},H}();ae.Element=fe}(Se=pe.MultiSelectorComboBox||(pe.MultiSelectorComboBox={})),function(ae){ae.initialize=function(H,a,D,m,c){return new fe(H,a,D,m,c)},ae.get=function(H){return H.component};var fe=function(H){function a(D,m,c,g,S){H.call(this,D,m,c,g,S),this.isInitialized=!1,this.settings.areCheckBoxesVisible=!1,typeof g.choiceStyle>"u"&&(g.choiceStyle="padding: 2px; margin-right: -4px; cursor: pointer"),typeof g.selectedChoiceStyle>"u"&&(g.selectedChoiceStyle="background-color: #3399ff; color: White; margin: -3px; padding: 2px"),this.refresh(),this.isInitialized=!0}return __extends(a,H),a}(Se.Element);ae.Element=fe}(he=pe.ComboBox||(pe.ComboBox={})),function(ae){ae.initialize=function(H,a,D,m,c){return new fe(H,a,D,m,c)},ae.get=function(H){return H.component};var fe=function(H){function a(){H.apply(this,arguments)}return __extends(a,H),a}(he.Element);ae.Element=fe}(ge=pe.DropDownList||(pe.DropDownList={})),function(ae){ae.initialize=function(H,a,D,m){return new fe(H,a,D,m)},ae.get=function(H){return H["ToolTip.component"]};var fe=function(){function H(a,S,m,c){var g=this;this.content=a,this.targetElement=S,this.settings=m,this.isInitialized=!1,this.isEnabled=!0,this.isVisible=!1;var A=(S=S.ownerDocument).createElement("span");S.body.appendChild(A);var F="DlhSoft.Controls ToolTip DlhSoft.Data.HTML.Controls 5 validate Licensing".split(" ");t[F[5]][F[4]](A,F[0],F[1],F[2],F[3],c,m),a&&a instanceof HTMLElement?(a.parentNode&&a.parentNode.removeChild(a),c=a):(c=S.createElement("span")).innerHTML=a,A.appendChild(c),this.host=A,this.contentContainer=c,this.host["ToolTip.component"]=this,this.contentContainer["ToolTip.component"]=this,this.targetElement["ToolTip.component"]=this,typeof m>"u"&&(m={}),this.settings=m,H.initializeSettings(this.settings),this.contentContainer.setAttribute("style",this.settings.containerStyle),this.settings.containerClass&&this.contentContainer.setAttribute("class",this.settings.containerClass),this.isEnabled=this.settings.isEnabled,(this.isVisible=this.settings.isVisible)?this.show():this.hide(),this.refresh();var z=!1;this.targetElement.addEventListener("mouseenter",function(){g.isEnabled&&(g.show(),z=!0)}),this.targetElement.addEventListener("mouseleave",function(){g.isEnabled&&(z=!1,isNaN(g.settings.duration)||setTimeout(function(){z||g.hide()},g.settings.duration))}),this.contentContainer.addEventListener("mouseenter",function(){g.isEnabled&&(z=!0)}),this.contentContainer.addEventListener("mouseleave",function(){g.isEnabled&&(z=!1,isNaN(g.settings.duration)||setTimeout(function(){z||g.hide()},g.settings.duration))}),this.targetElement.addEventListener("mouseup",function(){g.isEnabled&&g.hide()},!0),S.addEventListener("mousedown",function(){g.isEnabled&&(z||g.hide())},!0),S.addEventListener("mousewheel",function(){g.isEnabled&&g.hide()},!0),S.addEventListener("DOMMouseScroll",function(){g.isEnabled&&g.hide()},!0),this.isInitialized=!0}return H.initializeSettings=function(a){typeof a.theme>"u"&&(a.theme="Modern"),typeof a.isEnabled>"u"&&(a.isEnabled=!0),typeof a.duration>"u"&&(a.duration=0),typeof a.isVisible>"u"&&(a.isVisible=!1),typeof a.containerStyle>"u"&&(a.containerStyle="cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; border: 1px solid "+("Modern"==a.theme?"#e0e0e0":"#707070")+"; background-color: "+("Modern"==a.theme?"White":"#ffffc0")+"; color: "+("Modern"==a.theme?"#505050":"Black")+"; font-family: Arial; font-size: "+("Modern"==a.theme?"12px":"small")+"; padding: 4px")},H.prototype.refresh=function(){var a=this.targetElement.getBoundingClientRect();this.x=a.left,this.y=a.top+a.height,this.contentContainer.style.position="fixed",this.contentContainer.style.zIndex="1",this.contentContainer.style.left=this.x+"px",this.contentContainer.style.top=this.y+"px",this.contentContainer.style.display=this.settings.isVisible?"inline-block":"none";var D=this.contentContainer.getBoundingClientRect();D.bottom>this.contentContainer.ownerDocument.documentElement.clientHeight&&a.top>=D.height&&(this.contentContainer.style.top=a.top-D.height+2+"px"),D.right>this.contentContainer.ownerDocument.documentElement.clientWidth&&this.contentContainer.ownerDocument.documentElement.clientWidth>=D.width&&(this.contentContainer.style.left=this.contentContainer.ownerDocument.documentElement.clientWidth-D.width+"px")},H.prototype.setPosition=function(a,D){this.setHorizontalPosition(a),this.setVerticalPosition(D)},H.prototype.setHorizontalPosition=function(a){this.x=a,this.contentContainer.style.left=this.x+"px"},H.prototype.setVerticalPosition=function(a){this.y=a,this.contentContainer.style.top=this.y+"px"},H.prototype.enable=function(){this.isEnabled||(this.settings.isEnabled=this.isEnabled=!0)},H.prototype.disable=function(){this.isEnabled&&(this.settings.isEnabled=this.isEnabled=!1)},H.prototype.show=function(){H.previouslyShown&&H.previouslyShown.hide(),H.previouslyShown=this,this.isVisible||(this.settings.isVisible=this.isVisible=!0,this.refresh(),this.settings.shownHandler&&this.settings.shownHandler())},H.prototype.hide=function(){this.isVisible&&(this.settings.isVisible=this.isVisible=!1,this.refresh(),this.settings.hiddenHandler&&this.settings.hiddenHandler())},H.prototype.setContent=function(a){a&&a instanceof HTMLElement?(a.parentNode&&a.parentNode.removeChild(a),this.host.replaceChild(a,this.contentContainer),this.contentContainer=a):this.contentContainer.innerHTML=a},H}();ae.Element=fe}(pe.ToolTip||(pe.ToolTip={})),function(ae){function fe(H,a){for(var D=pe.TreeGrid.getDefaultColumns(H,a),m=0;m<D.length;m++)delete D[m].isTreeView;return D}ae.initialize=function(H,a,D,m){if(a)for(var c=0;c<a.length;c++)delete a[c].indentation,delete a[c].isExpanded;return D||(D={}),D.columns||(D.columns=fe(a,D)),pe.TreeGrid.initialize(H,a,D,m)},ae.getDefaultColumns=fe}(pe.Grid||(pe.Grid={}))}(DlhSoft||(DlhSoft={}));